Sun Apr 21 13:23:48 EDT 2024
Your job is running on node(s):
adroit-h11g1
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/cola_mod_0.6
nvidia-smi output:
Sun Apr 21 13:23:48 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:CA:00.0 Off |                    0 |
| N/A   32C    P0              54W / 300W |      2MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/21/2024 13:23:50 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/21/2024 13:23:50 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/runs/Apr21_13-23-50_adroit-h11g1,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/21/2024 13:23:50 - INFO - __main__ - Model Arguments:
04/21/2024 13:23:50 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/21/2024 13:23:50 - INFO - __main__ - config_name = None
04/21/2024 13:23:50 - INFO - __main__ - tokenizer_name = None
04/21/2024 13:23:50 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/21/2024 13:23:50 - INFO - __main__ - use_fast_tokenizer = True
04/21/2024 13:23:50 - INFO - __main__ - model_revision = main
04/21/2024 13:23:50 - INFO - __main__ - use_auth_token = False
04/21/2024 13:23:50 - INFO - __main__ - Data Arguments:
04/21/2024 13:23:50 - INFO - __main__ - task_name = cola
04/21/2024 13:23:50 - INFO - __main__ - dataset_name = None
04/21/2024 13:23:50 - INFO - __main__ - t_name = None
04/21/2024 13:23:50 - INFO - __main__ - dataset_config_name = None
04/21/2024 13:23:50 - INFO - __main__ - max_seq_length = 128
04/21/2024 13:23:50 - INFO - __main__ - overwrite_cache = False
04/21/2024 13:23:50 - INFO - __main__ - pad_to_max_length = True
04/21/2024 13:23:50 - INFO - __main__ - max_train_samples = None
04/21/2024 13:23:50 - INFO - __main__ - max_eval_samples = None
04/21/2024 13:23:50 - INFO - __main__ - max_predict_samples = None
04/21/2024 13:23:50 - INFO - __main__ - train_file = None
04/21/2024 13:23:50 - INFO - __main__ - validation_file = None
04/21/2024 13:23:50 - INFO - __main__ - test_file = None
04/21/2024 13:23:50 - INFO - __main__ - Training Arguments:
04/21/2024 13:23:50 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6
04/21/2024 13:23:50 - INFO - __main__ - overwrite_output_dir = True
04/21/2024 13:23:50 - INFO - __main__ - do_train = True
04/21/2024 13:23:50 - INFO - __main__ - do_eval = True
04/21/2024 13:23:50 - INFO - __main__ - do_predict = False
04/21/2024 13:23:50 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/21/2024 13:23:50 - INFO - __main__ - prediction_loss_only = False
04/21/2024 13:23:50 - INFO - __main__ - per_device_train_batch_size = 32
04/21/2024 13:23:50 - INFO - __main__ - per_device_eval_batch_size = 32
04/21/2024 13:23:50 - INFO - __main__ - per_gpu_train_batch_size = None
04/21/2024 13:23:50 - INFO - __main__ - per_gpu_eval_batch_size = None
04/21/2024 13:23:50 - INFO - __main__ - gradient_accumulation_steps = 1
04/21/2024 13:23:50 - INFO - __main__ - eval_accumulation_steps = None
04/21/2024 13:23:50 - INFO - __main__ - learning_rate = 2e-05
04/21/2024 13:23:50 - INFO - __main__ - weight_decay = 0.0
04/21/2024 13:23:50 - INFO - __main__ - adam_beta1 = 0.9
04/21/2024 13:23:50 - INFO - __main__ - adam_beta2 = 0.999
04/21/2024 13:23:50 - INFO - __main__ - adam_epsilon = 1e-08
04/21/2024 13:23:50 - INFO - __main__ - max_grad_norm = 1.0
04/21/2024 13:23:50 - INFO - __main__ - num_train_epochs = 100.0
04/21/2024 13:23:50 - INFO - __main__ - max_steps = -1
04/21/2024 13:23:50 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/21/2024 13:23:50 - INFO - __main__ - warmup_ratio = 0.0
04/21/2024 13:23:50 - INFO - __main__ - warmup_steps = 0
04/21/2024 13:23:50 - INFO - __main__ - log_level = -1
04/21/2024 13:23:50 - INFO - __main__ - log_level_replica = -1
04/21/2024 13:23:50 - INFO - __main__ - log_on_each_node = True
04/21/2024 13:23:50 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/runs/Apr21_13-23-50_adroit-h11g1
04/21/2024 13:23:50 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/21/2024 13:23:50 - INFO - __main__ - logging_first_step = False
04/21/2024 13:23:50 - INFO - __main__ - logging_steps = 100
04/21/2024 13:23:50 - INFO - __main__ - logging_nan_inf_filter = True
04/21/2024 13:23:50 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/21/2024 13:23:50 - INFO - __main__ - save_steps = 0
04/21/2024 13:23:50 - INFO - __main__ - save_total_limit = None
04/21/2024 13:23:50 - INFO - __main__ - save_on_each_node = False
04/21/2024 13:23:50 - INFO - __main__ - no_cuda = False
04/21/2024 13:23:50 - INFO - __main__ - seed = 57
04/21/2024 13:23:50 - INFO - __main__ - bf16 = False
04/21/2024 13:23:50 - INFO - __main__ - fp16 = False
04/21/2024 13:23:50 - INFO - __main__ - fp16_opt_level = O1
04/21/2024 13:23:50 - INFO - __main__ - half_precision_backend = auto
04/21/2024 13:23:50 - INFO - __main__ - bf16_full_eval = False
04/21/2024 13:23:50 - INFO - __main__ - fp16_full_eval = False
04/21/2024 13:23:50 - INFO - __main__ - tf32 = None
04/21/2024 13:23:50 - INFO - __main__ - local_rank = -1
04/21/2024 13:23:50 - INFO - __main__ - xpu_backend = None
04/21/2024 13:23:50 - INFO - __main__ - tpu_num_cores = None
04/21/2024 13:23:50 - INFO - __main__ - tpu_metrics_debug = False
04/21/2024 13:23:50 - INFO - __main__ - debug = []
04/21/2024 13:23:50 - INFO - __main__ - dataloader_drop_last = False
04/21/2024 13:23:50 - INFO - __main__ - eval_steps = 50
04/21/2024 13:23:50 - INFO - __main__ - dataloader_num_workers = 0
04/21/2024 13:23:50 - INFO - __main__ - past_index = -1
04/21/2024 13:23:50 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6
04/21/2024 13:23:50 - INFO - __main__ - disable_tqdm = False
04/21/2024 13:23:50 - INFO - __main__ - remove_unused_columns = True
04/21/2024 13:23:50 - INFO - __main__ - label_names = None
04/21/2024 13:23:50 - INFO - __main__ - load_best_model_at_end = False
04/21/2024 13:23:50 - INFO - __main__ - metric_for_best_model = None
04/21/2024 13:23:50 - INFO - __main__ - greater_is_better = None
04/21/2024 13:23:50 - INFO - __main__ - ignore_data_skip = False
04/21/2024 13:23:50 - INFO - __main__ - sharded_ddp = []
04/21/2024 13:23:50 - INFO - __main__ - deepspeed = None
04/21/2024 13:23:50 - INFO - __main__ - label_smoothing_factor = 0.0
04/21/2024 13:23:50 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/21/2024 13:23:50 - INFO - __main__ - adafactor = False
04/21/2024 13:23:50 - INFO - __main__ - group_by_length = False
04/21/2024 13:23:50 - INFO - __main__ - length_column_name = length
04/21/2024 13:23:50 - INFO - __main__ - report_to = []
04/21/2024 13:23:50 - INFO - __main__ - ddp_find_unused_parameters = None
04/21/2024 13:23:50 - INFO - __main__ - ddp_bucket_cap_mb = None
04/21/2024 13:23:50 - INFO - __main__ - dataloader_pin_memory = True
04/21/2024 13:23:50 - INFO - __main__ - skip_memory_metrics = True
04/21/2024 13:23:50 - INFO - __main__ - use_legacy_prediction_loop = False
04/21/2024 13:23:50 - INFO - __main__ - push_to_hub = False
04/21/2024 13:23:50 - INFO - __main__ - resume_from_checkpoint = None
04/21/2024 13:23:50 - INFO - __main__ - hub_model_id = None
04/21/2024 13:23:50 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/21/2024 13:23:50 - INFO - __main__ - hub_token = None
04/21/2024 13:23:50 - INFO - __main__ - gradient_checkpointing = False
04/21/2024 13:23:50 - INFO - __main__ - fp16_backend = auto
04/21/2024 13:23:50 - INFO - __main__ - push_to_hub_model_id = None
04/21/2024 13:23:50 - INFO - __main__ - push_to_hub_organization = None
04/21/2024 13:23:50 - INFO - __main__ - push_to_hub_token = None
04/21/2024 13:23:50 - INFO - __main__ - mp_parameters = 
04/21/2024 13:23:50 - INFO - __main__ - _n_gpu = 1
04/21/2024 13:23:50 - INFO - __main__ - __cached__setup_devices = cuda:0
04/21/2024 13:23:50 - INFO - __main__ - Additional Arguments:
04/21/2024 13:23:50 - INFO - __main__ - test = False
04/21/2024 13:23:50 - INFO - __main__ - ex_name = CoLA_sparsity0.6
04/21/2024 13:23:50 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/21/2024 13:23:50 - INFO - __main__ - reg_learning_rate = 0.01
04/21/2024 13:23:50 - INFO - __main__ - scheduler_type = linear
04/21/2024 13:23:50 - INFO - __main__ - freeze_embeddings = True
04/21/2024 13:23:50 - INFO - __main__ - pretrained_pruned_model = None
04/21/2024 13:23:50 - INFO - __main__ - droprate_init = 0.5
04/21/2024 13:23:50 - INFO - __main__ - temperature = 0.6666666666666666
04/21/2024 13:23:50 - INFO - __main__ - prepruning_finetune_epochs = 4
04/21/2024 13:23:50 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/21/2024 13:23:50 - INFO - __main__ - target_sparsity = 0.6
04/21/2024 13:23:50 - INFO - __main__ - sparsity_epsilon = 0
04/21/2024 13:23:50 - INFO - __main__ - distillation_path = mofyrt/bert-base-uncased-finetuned-cola
04/21/2024 13:23:50 - INFO - __main__ - do_distill = True
04/21/2024 13:23:50 - INFO - __main__ - do_layer_distill = True
04/21/2024 13:23:50 - INFO - __main__ - layer_distill_version = 4
04/21/2024 13:23:50 - INFO - __main__ - distill_loss_alpha = 0.9
04/21/2024 13:23:50 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/21/2024 13:23:50 - INFO - __main__ - distill_temp = 2.0
04/21/2024 13:23:50 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/21/2024 13:23:50 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/21/2024 13:23:50 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/21/2024 13:23:50 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 1213.28it/s]
[INFO|configuration_utils.py:648] 2024-04-21 13:23:50,317 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-21 13:23:50,317 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "cola",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-21 13:23:50,318 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-21 13:23:50,318 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-21 13:23:50,320 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-21 13:23:50,320 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-21 13:23:50,320 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-21 13:23:50,320 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-21 13:23:50,321 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-21 13:23:50,322 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/21/2024 13:23:56 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/21/2024 13:23:56 - INFO - __main__ - Model size: 85054464
04/21/2024 13:23:56 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x151a986603a0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/21/2024 13:23:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/21/2024 13:23:56 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x151a986603a0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/21/2024 13:23:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/21/2024 13:23:56 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x151a986603a0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/21/2024 13:23:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/21/2024 13:23:56 - INFO - __main__ - Sample 8423 of the training set: {'sentence': 'Anson saw Anson.', 'label': 1, 'idx': 8423, 'input_ids': [101, 25435, 2387, 25435, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/21/2024 13:23:56 - INFO - __main__ - Sample 5262 of the training set: {'sentence': 'The men would not have all been working.', 'label': 1, 'idx': 5262, 'input_ids': [101, 1996, 2273, 2052, 2025, 2031, 2035, 2042, 2551, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/21/2024 13:23:56 - INFO - __main__ - Sample 7821 of the training set: {'sentence': 'Anson very happily demonized David.', 'label': 1, 'idx': 7821, 'input_ids': [101, 25435, 2200, 11361, 5698, 3550, 2585, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/21/2024 13:23:56 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/21/2024 13:23:57 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/21/2024 13:23:57 - INFO - __main__ - ************* 8551 Training Examples Loaded *************
04/21/2024 13:23:57 - INFO - __main__ - ************* 1043 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-21 13:23:57,613 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:23:57 - INFO - trainer.trainer_mod - Prepruning finetune steps: 100
04/21/2024 13:23:57 - INFO - trainer.trainer_mod - Lagrangian warmup steps: 5360
04/21/2024 13:23:57 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/21/2024 13:23:57 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/21/2024 13:23:57 - INFO - trainer.trainer_mod - ***** Running training *****
04/21/2024 13:23:57 - INFO - trainer.trainer_mod -   Num examples = 8551
04/21/2024 13:23:57 - INFO - trainer.trainer_mod -   Num Epochs = 100
04/21/2024 13:23:57 - INFO - trainer.trainer_mod -   Instantaneous batch size per device = 32
04/21/2024 13:23:57 - INFO - trainer.trainer_mod -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/21/2024 13:23:57 - INFO - trainer.trainer_mod -   Gradient Accumulation steps = 1
04/21/2024 13:23:57 - INFO - trainer.trainer_mod -   Total optimization steps = 26800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-21 13:23:57,617 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:23:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:23:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:23:57 - INFO - trainer.trainer_mod -   Batch size = 32

Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A
Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.40it/s][A
Evaluation:   9%|▉         | 3/33 [00:00<00:02, 14.67it/s][A
Evaluation:  15%|█▌        | 5/33 [00:00<00:01, 16.32it/s][A
Evaluation:  21%|██        | 7/33 [00:00<00:01, 17.13it/s][A
Evaluation:  27%|██▋       | 9/33 [00:00<00:01, 17.57it/s][A
Evaluation:  33%|███▎      | 11/33 [00:00<00:01, 17.82it/s][A
Evaluation:  39%|███▉      | 13/33 [00:00<00:01, 18.00it/s][A
Evaluation:  45%|████▌     | 15/33 [00:00<00:00, 18.11it/s][A
Evaluation:  52%|█████▏    | 17/33 [00:00<00:00, 18.21it/s][A
Evaluation:  58%|█████▊    | 19/33 [00:01<00:00, 18.24it/s][A
Evaluation:  64%|██████▎   | 21/33 [00:01<00:00, 18.27it/s][A
Evaluation:  70%|██████▉   | 23/33 [00:01<00:00, 18.24it/s][A
Evaluation:  76%|███████▌  | 25/33 [00:01<00:00, 18.22it/s][A
Evaluation:  82%|████████▏ | 27/33 [00:01<00:00, 18.21it/s][A
Evaluation:  88%|████████▊ | 29/33 [00:01<00:00, 18.15it/s][A
Evaluation:  94%|█████████▍| 31/33 [00:01<00:00, 18.18it/s][AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.95it/s]04/21/2024 13:23:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:23:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': -0.015667329278145823, 'eval_loss': 0.6626569, 'step': 0}


Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/21/2024 13:23:59 - INFO - trainer.trainer_mod - v4 Global step: 0, Alignment: tensor([ 3,  5,  9, 10], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:51,  5.18it/s][A
Iteration:   1%|          | 3/268 [00:00<00:27,  9.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:22, 11.84it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:20, 12.67it/s][A
Iteration:   3%|▎         | 9/268 [00:00<00:23, 10.98it/s][A
Iteration:   4%|▍         | 11/268 [00:00<00:21, 12.01it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:19, 12.97it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:19, 13.22it/s][A
Iteration:   6%|▋         | 17/268 [00:01<00:18, 13.71it/s][A
Iteration:   7%|▋         | 19/268 [00:01<00:17, 14.43it/s][A
Iteration:   8%|▊         | 21/268 [00:01<00:16, 14.66it/s][A
Iteration:   9%|▊         | 23/268 [00:01<00:16, 15.27it/s][A
Iteration:   9%|▉         | 25/268 [00:01<00:16, 14.72it/s][A
Iteration:  10%|█         | 27/268 [00:02<00:17, 13.78it/s][A
Iteration:  11%|█         | 29/268 [00:02<00:16, 14.09it/s][A
Iteration:  12%|█▏        | 31/268 [00:02<00:16, 14.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:02<00:16, 14.50it/s][A
Iteration:  13%|█▎        | 35/268 [00:02<00:16, 14.45it/s][A
Iteration:  14%|█▍        | 37/268 [00:02<00:15, 14.67it/s][A
Iteration:  15%|█▍        | 39/268 [00:02<00:15, 15.15it/s][A
Iteration:  15%|█▌        | 41/268 [00:03<00:15, 14.98it/s][A
Iteration:  16%|█▌        | 43/268 [00:03<00:15, 14.55it/s][A
Iteration:  17%|█▋        | 45/268 [00:03<00:15, 14.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:03<00:14, 15.04it/s][A
Iteration:  18%|█▊        | 49/268 [00:03<00:14, 15.38it/s][A[INFO|trainer.py:570] 2024-04-21 13:24:03,089 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:24:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:24:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:24:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 18.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 18.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 18.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 18.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 18.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 18.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 18.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 18.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:00<00:00, 18.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 18.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 18.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 18.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 18.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 18.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 18.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 18.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 18.52it/s]04/21/2024 13:24:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:24:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4420898648237221, 'eval_loss': 0.58655524, 'step': 50}


Iteration:  19%|█▉        | 51/268 [00:05<01:13,  2.96it/s][A
Iteration:  20%|█▉        | 53/268 [00:05<00:55,  3.89it/s][A
Iteration:  21%|██        | 55/268 [00:05<00:42,  5.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:05<00:33,  6.26it/s][A
Iteration:  22%|██▏       | 59/268 [00:06<00:27,  7.68it/s][A
Iteration:  23%|██▎       | 61/268 [00:06<00:22,  9.12it/s][A
Iteration:  24%|██▎       | 63/268 [00:06<00:19, 10.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:06<00:17, 11.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:06<00:15, 12.59it/s][A
Iteration:  26%|██▌       | 69/268 [00:06<00:14, 13.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:06<00:13, 14.07it/s][A
Iteration:  27%|██▋       | 73/268 [00:06<00:13, 14.44it/s][A
Iteration:  28%|██▊       | 75/268 [00:07<00:13, 14.75it/s][A
Iteration:  29%|██▊       | 77/268 [00:07<00:12, 14.77it/s][A
Iteration:  29%|██▉       | 79/268 [00:07<00:12, 15.19it/s][A
Iteration:  30%|███       | 81/268 [00:07<00:12, 15.51it/s][A
Iteration:  31%|███       | 83/268 [00:07<00:11, 15.77it/s][A
Iteration:  32%|███▏      | 85/268 [00:07<00:11, 15.61it/s][A
Iteration:  32%|███▏      | 87/268 [00:07<00:11, 15.12it/s][A
Iteration:  33%|███▎      | 89/268 [00:07<00:11, 15.07it/s][A
Iteration:  34%|███▍      | 91/268 [00:08<00:11, 14.99it/s][A
Iteration:  35%|███▍      | 93/268 [00:08<00:11, 14.98it/s][A
Iteration:  35%|███▌      | 95/268 [00:08<00:12, 14.35it/s][A
Iteration:  36%|███▌      | 97/268 [00:08<00:12, 14.03it/s][A
Iteration:  37%|███▋      | 99/268 [00:08<00:11, 14.44it/s][A[INFO|trainer.py:570] 2024-04-21 13:24:08,171 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:24:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:24:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:24:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 18.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 18.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 18.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 18.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 18.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 18.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 18.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 18.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:00<00:00, 18.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 18.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 18.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 18.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 18.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 18.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 18.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 18.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 18.52it/s]04/21/2024 13:24:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:24:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.5127103010689016, 'eval_loss': 0.5428765, 'step': 100}
04/21/2024 13:24:09 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/21/2024 13:24:09 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/21/2024 13:24:09 - INFO - trainer.trainer_mod - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/21/2024 13:24:09 - INFO - trainer.trainer_mod - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/21/2024 13:24:09 - INFO - trainer.trainer_mod - Starting l0 regularization!
04/21/2024 13:24:10 - INFO - trainer.trainer_mod - v4 Global step: 100, Alignment: tensor([ 5,  7,  8, 10], device='cuda:0')


Iteration:  38%|███▊      | 101/268 [00:10<00:59,  2.82it/s][A
Iteration:  38%|███▊      | 103/268 [00:10<00:47,  3.46it/s][A
Iteration:  39%|███▉      | 104/268 [00:11<00:42,  3.82it/s][A
Iteration:  39%|███▉      | 105/268 [00:11<00:38,  4.21it/s][A
Iteration:  40%|███▉      | 106/268 [00:11<00:34,  4.65it/s][A
Iteration:  40%|███▉      | 107/268 [00:11<00:31,  5.11it/s][A
Iteration:  40%|████      | 108/268 [00:11<00:28,  5.56it/s][A
Iteration:  41%|████      | 109/268 [00:11<00:26,  5.96it/s][A
Iteration:  41%|████      | 110/268 [00:11<00:25,  6.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:12<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:12<00:22,  6.80it/s][A
Iteration:  42%|████▏     | 113/268 [00:12<00:23,  6.65it/s][A
Iteration:  43%|████▎     | 114/268 [00:12<00:22,  6.76it/s][A
Iteration:  43%|████▎     | 115/268 [00:12<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 116/268 [00:12<00:21,  7.06it/s][A
Iteration:  44%|████▎     | 117/268 [00:12<00:21,  7.18it/s][A
Iteration:  44%|████▍     | 118/268 [00:13<00:21,  7.09it/s][A
Iteration:  44%|████▍     | 119/268 [00:13<00:20,  7.21it/s][A
Iteration:  45%|████▍     | 120/268 [00:13<00:20,  7.13it/s][A
Iteration:  45%|████▌     | 121/268 [00:13<00:20,  7.23it/s][A
Iteration:  46%|████▌     | 122/268 [00:13<00:20,  7.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:13<00:19,  7.27it/s][A
Iteration:  46%|████▋     | 124/268 [00:13<00:19,  7.35it/s][A
Iteration:  47%|████▋     | 125/268 [00:13<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 126/268 [00:14<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:14<00:19,  7.33it/s][A
Iteration:  48%|████▊     | 128/268 [00:14<00:19,  7.33it/s][A
Iteration:  48%|████▊     | 129/268 [00:14<00:18,  7.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:14<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:14<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:14<00:18,  7.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:15<00:18,  7.48it/s][A
Iteration:  50%|█████     | 134/268 [00:15<00:18,  7.40it/s][A
Iteration:  50%|█████     | 135/268 [00:15<00:17,  7.55it/s][A
Iteration:  51%|█████     | 136/268 [00:15<00:17,  7.49it/s][A
Iteration:  51%|█████     | 137/268 [00:15<00:17,  7.49it/s][A
Iteration:  51%|█████▏    | 138/268 [00:15<00:17,  7.30it/s][A
Iteration:  52%|█████▏    | 139/268 [00:15<00:17,  7.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:15<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:16<00:17,  7.19it/s][A
Iteration:  53%|█████▎    | 142/268 [00:16<00:17,  7.12it/s][A
Iteration:  53%|█████▎    | 143/268 [00:16<00:17,  7.35it/s][A
Iteration:  54%|█████▎    | 144/268 [00:16<00:16,  7.33it/s][A
Iteration:  54%|█████▍    | 145/268 [00:16<00:16,  7.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:16<00:16,  7.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:16<00:16,  7.42it/s][A
Iteration:  55%|█████▌    | 148/268 [00:17<00:16,  7.38it/s][A
Iteration:  56%|█████▌    | 149/268 [00:17<00:15,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 13:24:16,815 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:24:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:24:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:24:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:24:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]04/21/2024 13:24:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:24:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0463559874942472, 'eval_loss': 0.93574077, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2583, 2582, 2582, 2583, 2583, 2581, 2578, 2578, 2580, 2592, 2604, 2600], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9247944, 'remaining_params': 75769656, 'pruned_model_sparsity': 0.1087768179765131, 'expected_sparsity': 0.11035, 'target_sparsity': 0.005597014925373134, 'step': 150}


Iteration:  56%|█████▌    | 150/268 [00:19<01:27,  1.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:19<01:06,  1.77it/s][A
Iteration:  57%|█████▋    | 152/268 [00:19<00:50,  2.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:19<00:40,  2.85it/s][A
Iteration:  57%|█████▋    | 154/268 [00:19<00:32,  3.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:20<00:27,  4.08it/s][A
Iteration:  58%|█████▊    | 156/268 [00:20<00:24,  4.60it/s][A
Iteration:  59%|█████▊    | 157/268 [00:20<00:21,  5.05it/s][A
Iteration:  59%|█████▉    | 158/268 [00:20<00:20,  5.48it/s][A
Iteration:  59%|█████▉    | 159/268 [00:20<00:18,  5.90it/s][A
Iteration:  60%|█████▉    | 160/268 [00:20<00:17,  6.23it/s][A
Iteration:  60%|██████    | 161/268 [00:20<00:16,  6.66it/s][A
Iteration:  60%|██████    | 162/268 [00:21<00:15,  6.85it/s][A
Iteration:  61%|██████    | 163/268 [00:21<00:15,  6.98it/s][A
Iteration:  61%|██████    | 164/268 [00:21<00:14,  7.08it/s][A
Iteration:  62%|██████▏   | 165/268 [00:21<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 166/268 [00:21<00:14,  7.00it/s][A
Iteration:  62%|██████▏   | 167/268 [00:21<00:14,  7.09it/s][A
Iteration:  63%|██████▎   | 168/268 [00:21<00:13,  7.18it/s][A
Iteration:  63%|██████▎   | 169/268 [00:22<00:14,  7.01it/s][A
Iteration:  63%|██████▎   | 170/268 [00:22<00:13,  7.08it/s][A
Iteration:  64%|██████▍   | 171/268 [00:22<00:13,  7.11it/s][A
Iteration:  64%|██████▍   | 172/268 [00:22<00:13,  7.17it/s][A
Iteration:  65%|██████▍   | 173/268 [00:22<00:13,  7.21it/s][A
Iteration:  65%|██████▍   | 174/268 [00:22<00:13,  7.23it/s][A
Iteration:  65%|██████▌   | 175/268 [00:22<00:12,  7.22it/s][A
Iteration:  66%|██████▌   | 176/268 [00:23<00:13,  7.03it/s][A
Iteration:  66%|██████▌   | 177/268 [00:23<00:13,  6.99it/s][A
Iteration:  66%|██████▋   | 178/268 [00:23<00:12,  7.03it/s][A
Iteration:  67%|██████▋   | 179/268 [00:23<00:12,  7.03it/s][A
Iteration:  67%|██████▋   | 180/268 [00:23<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 181/268 [00:23<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:23<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:24<00:11,  7.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:24<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:24<00:11,  7.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:24<00:11,  7.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:24<00:11,  7.26it/s][A
Iteration:  70%|███████   | 188/268 [00:24<00:10,  7.33it/s][A
Iteration:  71%|███████   | 189/268 [00:24<00:10,  7.40it/s][A
Iteration:  71%|███████   | 190/268 [00:24<00:10,  7.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:25<00:10,  7.46it/s][A
Iteration:  72%|███████▏  | 192/268 [00:25<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 193/268 [00:25<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 194/268 [00:25<00:10,  7.27it/s][A
Iteration:  73%|███████▎  | 195/268 [00:25<00:10,  7.29it/s][A
Iteration:  73%|███████▎  | 196/268 [00:25<00:09,  7.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:25<00:09,  7.17it/s][A
Iteration:  74%|███████▍  | 198/268 [00:26<00:09,  7.09it/s][A
Iteration:  74%|███████▍  | 199/268 [00:26<00:09,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 13:24:25,816 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:24:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:24:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:24:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:24:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]04/21/2024 13:24:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:24:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 1.0198545, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2609, 2605, 2603, 2603, 2600, 2597, 2591, 2592, 2603, 2628, 2657, 2675], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8731660, 'remaining_params': 76285940, 'pruned_model_sparsity': 0.10270414596507076, 'expected_sparsity': 0.10425, 'target_sparsity': 0.011194029850746268, 'step': 200}


Iteration:  75%|███████▍  | 200/268 [00:28<00:51,  1.33it/s][A04/21/2024 13:24:27 - INFO - trainer.trainer_mod - v4 Global step: 200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:28<00:38,  1.74it/s][A
Iteration:  75%|███████▌  | 202/268 [00:28<00:29,  2.25it/s][A
Iteration:  76%|███████▌  | 203/268 [00:28<00:23,  2.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:29<00:18,  3.39it/s][A
Iteration:  76%|███████▋  | 205/268 [00:29<00:15,  3.98it/s][A
Iteration:  77%|███████▋  | 206/268 [00:29<00:13,  4.67it/s][A
Iteration:  77%|███████▋  | 207/268 [00:29<00:11,  5.22it/s][A
Iteration:  78%|███████▊  | 208/268 [00:29<00:10,  5.70it/s][A
Iteration:  78%|███████▊  | 209/268 [00:29<00:09,  6.09it/s][A
Iteration:  78%|███████▊  | 210/268 [00:29<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:29<00:08,  6.64it/s][A
Iteration:  79%|███████▉  | 212/268 [00:30<00:08,  6.81it/s][A
Iteration:  79%|███████▉  | 213/268 [00:30<00:07,  6.94it/s][A
Iteration:  80%|███████▉  | 214/268 [00:30<00:07,  6.86it/s][A
Iteration:  80%|████████  | 215/268 [00:30<00:07,  6.96it/s][A
Iteration:  81%|████████  | 216/268 [00:30<00:07,  6.97it/s][A
Iteration:  81%|████████  | 217/268 [00:30<00:07,  7.07it/s][A
Iteration:  81%|████████▏ | 218/268 [00:30<00:06,  7.15it/s][A
Iteration:  82%|████████▏ | 219/268 [00:31<00:06,  7.29it/s][A
Iteration:  82%|████████▏ | 220/268 [00:31<00:06,  7.25it/s][A
Iteration:  82%|████████▏ | 221/268 [00:31<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 222/268 [00:31<00:06,  7.34it/s][A
Iteration:  83%|████████▎ | 223/268 [00:31<00:06,  7.11it/s][A
Iteration:  84%|████████▎ | 224/268 [00:31<00:06,  7.16it/s][A
Iteration:  84%|████████▍ | 225/268 [00:31<00:05,  7.21it/s][A
Iteration:  84%|████████▍ | 226/268 [00:32<00:05,  7.20it/s][A
Iteration:  85%|████████▍ | 227/268 [00:32<00:05,  7.13it/s][A
Iteration:  85%|████████▌ | 228/268 [00:32<00:05,  7.24it/s][A
Iteration:  85%|████████▌ | 229/268 [00:32<00:05,  7.10it/s][A
Iteration:  86%|████████▌ | 230/268 [00:32<00:05,  7.23it/s][A
Iteration:  86%|████████▌ | 231/268 [00:32<00:05,  7.30it/s][A
Iteration:  87%|████████▋ | 232/268 [00:32<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:33<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 234/268 [00:33<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:33<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:33<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 237/268 [00:33<00:04,  7.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:33<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:33<00:03,  7.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:33<00:03,  7.51it/s][A
Iteration:  90%|████████▉ | 241/268 [00:34<00:03,  7.51it/s][A
Iteration:  90%|█████████ | 242/268 [00:34<00:03,  7.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:34<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:34<00:03,  7.39it/s][A
Iteration:  91%|█████████▏| 245/268 [00:34<00:03,  7.37it/s][A
Iteration:  92%|█████████▏| 246/268 [00:34<00:03,  7.15it/s][A
Iteration:  92%|█████████▏| 247/268 [00:34<00:02,  7.00it/s][A
Iteration:  93%|█████████▎| 248/268 [00:35<00:02,  7.09it/s][A
Iteration:  93%|█████████▎| 249/268 [00:35<00:02,  7.05it/s][A[INFO|trainer.py:570] 2024-04-21 13:24:34,809 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:24:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:24:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:24:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:24:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]04/21/2024 13:24:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:24:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.08036809130702588, 'eval_loss': 0.96430224, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2633, 2628, 2625, 2625, 2620, 2615, 2607, 2611, 2631, 2675, 2714, 2746], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8169416, 'remaining_params': 76848184, 'pruned_model_sparsity': 0.09609088000602228, 'expected_sparsity': 0.09769, 'target_sparsity': 0.016791044776119403, 'step': 250}


Iteration:  93%|█████████▎| 250/268 [00:37<00:13,  1.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:37<00:09,  1.76it/s][A
Iteration:  94%|█████████▍| 252/268 [00:37<00:07,  2.27it/s][A
Iteration:  94%|█████████▍| 253/268 [00:37<00:05,  2.86it/s][A
Iteration:  95%|█████████▍| 254/268 [00:37<00:04,  3.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:38<00:03,  4.11it/s][A
Iteration:  96%|█████████▌| 256/268 [00:38<00:02,  4.72it/s][A
Iteration:  96%|█████████▌| 257/268 [00:38<00:02,  5.27it/s][A
Iteration:  96%|█████████▋| 258/268 [00:38<00:01,  5.68it/s][A
Iteration:  97%|█████████▋| 259/268 [00:38<00:01,  6.04it/s][A
Iteration:  97%|█████████▋| 260/268 [00:38<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 261/268 [00:38<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:39<00:00,  6.66it/s][A
Iteration:  98%|█████████▊| 263/268 [00:39<00:00,  6.84it/s][A
Iteration:  99%|█████████▊| 264/268 [00:39<00:00,  7.00it/s][A
Iteration:  99%|█████████▉| 265/268 [00:39<00:00,  7.07it/s][A
Iteration:  99%|█████████▉| 266/268 [00:39<00:00,  6.96it/s][A
Iteration: 100%|█████████▉| 267/268 [00:39<00:00,  6.95it/s][A
Iteration: 100%|██████████| 268/268 [00:39<00:00,  7.44it/s][A04/21/2024 13:24:39 - INFO - trainer.trainer_mod - Epoch 0 finished. Took 39.89 seconds.
Iteration: 100%|██████████| 268/268 [00:39<00:00,  6.72it/s]
Epoch:   1%|          | 1/100 [00:41<1:08:52, 41.74s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.88it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.08it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  6.99it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.31it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.31it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  7.02it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.40it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.45it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.20it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.32it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.35it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.27it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.16it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.26it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.20it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.32it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.08it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.05it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.15it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.97it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.08it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:34,  7.04it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.03it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 13:24:43,803 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:24:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:24:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:24:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:24:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]04/21/2024 13:24:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:24:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0833337385611757, 'eval_loss': 1.2444416, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2658, 2651, 2646, 2646, 2640, 2634, 2627, 2632, 2664, 2723, 2768, 2808], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7607172, 'remaining_params': 77410428, 'pruned_model_sparsity': 0.0894776140469738, 'expected_sparsity': 0.09106, 'target_sparsity': 0.022388059701492536, 'step': 300}


Iteration:  12%|█▏        | 32/268 [00:06<02:57,  1.33it/s][A04/21/2024 13:24:45 - INFO - trainer.trainer_mod - v4 Global step: 300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:13,  1.76it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:43,  2.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:21,  2.86it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:05,  3.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:55,  4.16it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:48,  4.78it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:43,  5.26it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:40,  5.64it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:37,  6.04it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:35,  6.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.62it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.00it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.06it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.04it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.22it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.24it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.14it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.21it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.22it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.15it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.97it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.03it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.21it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.34it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.20it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.44it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.27it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.40it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.46it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.36it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.46it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.32it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.14it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.37it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 13:24:52,728 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:24:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:24:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:24:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:24:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]04/21/2024 13:24:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:24:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.17269794723842352, 'eval_loss': 1.3431177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2681, 2673, 2667, 2667, 2658, 2653, 2640, 2650, 2696, 2766, 2816, 2857], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7106208, 'remaining_params': 77911392, 'pruned_model_sparsity': 0.08358514001806684, 'expected_sparsity': 0.08521, 'target_sparsity': 0.027985074626865673, 'step': 350}


Iteration:  31%|███       | 82/268 [00:15<02:19,  1.33it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:45,  1.76it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:21,  2.26it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:03,  2.86it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:52,  3.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:43,  4.17it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:37,  4.77it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:34,  5.26it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:30,  5.75it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:28,  6.15it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.43it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.66it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.94it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.05it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  6.97it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.89it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.97it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.05it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.07it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.10it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.14it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.01it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.14it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.14it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.24it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.29it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.07it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.08it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.19it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.16it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.25it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.41it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.27it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.20it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.20it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.20it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.19it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.14it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.18it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.21it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.22it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 13:25:01,791 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:25:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:25:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:25:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:25:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]04/21/2024 13:25:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:25:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0928457264044978, 'eval_loss': 1.4309709, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2701, 2691, 2684, 2683, 2672, 2667, 2650, 2666, 2725, 2803, 2853, 2894], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6700228, 'remaining_params': 78317372, 'pruned_model_sparsity': 0.07880989348087926, 'expected_sparsity': 0.08051, 'target_sparsity': 0.033582089552238806, 'step': 400}


Iteration:  49%|████▉     | 132/268 [00:24<01:42,  1.33it/s][A04/21/2024 13:25:03 - INFO - trainer.trainer_mod - v4 Global step: 400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:24<01:16,  1.76it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:58,  2.27it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:46,  2.88it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:37,  3.48it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:32,  4.08it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:27,  4.69it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:24,  5.26it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:22,  5.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:21,  6.01it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:20,  6.27it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.64it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.83it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.86it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.06it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.10it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.16it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.20it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.20it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.14it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.34it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.27it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  7.05it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.94it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:14,  7.36it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.40it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.31it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.36it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.40it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.31it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:12,  7.63it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.28it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.28it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.30it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.19it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.19it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 13:25:10,736 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:25:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:25:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:25:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:25:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]04/21/2024 13:25:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:25:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 1.3281742, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2718, 2706, 2699, 2699, 2683, 2680, 2659, 2679, 2748, 2833, 2884, 2922], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6361656, 'remaining_params': 78655944, 'pruned_model_sparsity': 0.07482751806684733, 'expected_sparsity': 0.07646, 'target_sparsity': 0.039179104477611935, 'step': 450}


Iteration:  68%|██████▊   | 182/268 [00:33<01:05,  1.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:48,  1.75it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:36,  2.27it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:29,  2.83it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:23,  3.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:19,  4.09it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:16,  4.71it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:15,  5.07it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:13,  5.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:12,  6.16it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  6.82it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  6.94it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.02it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.99it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  7.08it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.24it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.24it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.22it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.13it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.16it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.23it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.02it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.06it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.04it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.16it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.24it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.37it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.44it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.42it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.31it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.18it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.23it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.26it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.28it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.18it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:06,  6.98it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:06,  6.72it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  6.87it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  6.92it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.07it/s][A[INFO|trainer.py:570] 2024-04-21 13:25:19,752 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:25:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:25:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:25:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:25:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]04/21/2024 13:25:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:25:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 1.0354699, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2734, 2720, 2712, 2713, 2695, 2691, 2670, 2693, 2771, 2860, 2910, 2944], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6050660, 'remaining_params': 78966940, 'pruned_model_sparsity': 0.0711694990213791, 'expected_sparsity': 0.07281, 'target_sparsity': 0.04477611940298507, 'step': 500}


Iteration:  87%|████████▋ | 232/268 [00:42<00:27,  1.32it/s][A04/21/2024 13:25:21 - INFO - trainer.trainer_mod - v4 Global step: 500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:42<00:20,  1.74it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:15,  2.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:11,  2.84it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:09,  3.48it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:07,  4.12it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:06,  4.74it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:05,  5.29it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  5.74it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.05it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:04,  6.46it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.69it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.84it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.13it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.94it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.04it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.12it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.19it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.22it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.25it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  6.66it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.74it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.85it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.98it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.06it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.26it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.42it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.24it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.08it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.17it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.28it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.34it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.88it/s][A04/21/2024 13:25:26 - INFO - trainer.trainer_mod - Epoch 1 finished. Took 47.41 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.65it/s]
Epoch:   2%|▏         | 2/100 [01:29<1:13:37, 45.07s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  6.97it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.24it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.13it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.22it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.12it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.78it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.93it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.92it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.04it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 13:25:28,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:25:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:25:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:25:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:25:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]04/21/2024 13:25:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:25:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.11385516999396013, 'eval_loss': 1.382913, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2748, 2734, 2726, 2724, 2704, 2700, 2679, 2705, 2791, 2881, 2930, 2962], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5788688, 'remaining_params': 79228912, 'pruned_model_sparsity': 0.06808811352002409, 'expected_sparsity': 0.06976, 'target_sparsity': 0.05037313432835821, 'step': 550}


Iteration:   5%|▌         | 14/268 [00:04<03:12,  1.32it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:24,  1.75it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:51,  2.27it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:27,  2.86it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:11,  3.49it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:00,  4.14it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:52,  4.73it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:46,  5.28it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:42,  5.74it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.21it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.51it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.83it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.88it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.88it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.97it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  7.02it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.21it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.30it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.27it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.17it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.91it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.91it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.99it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.14it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.15it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.25it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.51it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.65it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.34it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.18it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.20it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.19it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.13it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.19it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.10it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 13:25:37,679 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:25:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:25:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:25:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:25:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]04/21/2024 13:25:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:25:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.13069618561079088, 'eval_loss': 1.3733374, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2761, 2745, 2737, 2732, 2713, 2707, 2684, 2709, 2805, 2897, 2947, 2976], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5591060, 'remaining_params': 79426540, 'pruned_model_sparsity': 0.06576355954531768, 'expected_sparsity': 0.06744, 'target_sparsity': 0.055970149253731345, 'step': 600}


Iteration:  24%|██▍       | 64/268 [00:12<02:33,  1.33it/s][A04/21/2024 13:25:39 - INFO - trainer.trainer_mod - v4 Global step: 600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:13<01:55,  1.76it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:28,  2.29it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:09,  2.89it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:56,  3.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:47,  4.17it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:41,  4.78it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:37,  5.30it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:34,  5.71it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:31,  6.12it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.68it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  6.87it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.98it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.99it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.05it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.11it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.17it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.18it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.82it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.00it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.04it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.15it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.14it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.12it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.21it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.27it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.33it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.56it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.37it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.53it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.52it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.40it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.04it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 13:25:46,655 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:25:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:25:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:25:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:25:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]04/21/2024 13:25:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:25:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.09472652226346587, 'eval_loss': 1.3963326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2770, 2754, 2746, 2739, 2717, 2712, 2686, 2714, 2819, 2912, 2961, 2987], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5431732, 'remaining_params': 79585868, 'pruned_model_sparsity': 0.06388950052694971, 'expected_sparsity': 0.0656, 'target_sparsity': 0.061567164179104475, 'step': 650}


Iteration:  43%|████▎     | 114/268 [00:21<01:56,  1.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<01:27,  1.74it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<01:07,  2.24it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:53,  2.83it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:43,  3.46it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:36,  4.10it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:31,  4.71it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:27,  5.27it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:25,  5.75it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:23,  6.12it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:23,  6.26it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.77it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.88it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  6.95it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.04it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.26it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.12it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.07it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.01it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.08it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.05it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.17it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.16it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.31it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.23it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.73it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.93it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.06it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.05it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.17it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.24it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.12it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  7.06it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.14it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.20it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.06it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.23it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.36it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.34it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.14it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 13:25:55,713 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:25:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:25:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:25:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:25:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]04/21/2024 13:25:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:25:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.07380739515541786, 'eval_loss': 1.4257419, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2778, 2762, 2751, 2746, 2722, 2717, 2690, 2716, 2828, 2923, 2972, 2996], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5303044, 'remaining_params': 79714556, 'pruned_model_sparsity': 0.062375837473652516, 'expected_sparsity': 0.06415, 'target_sparsity': 0.06716417910447761, 'step': 700}


Iteration:  61%|██████    | 164/268 [00:30<01:18,  1.32it/s][A04/21/2024 13:25:57 - INFO - trainer.trainer_mod - v4 Global step: 700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:31<00:59,  1.74it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:45,  2.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:35,  2.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:28,  3.48it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:23,  4.13it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:20,  4.75it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:18,  5.30it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:16,  5.69it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:15,  6.07it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.81it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.85it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  6.96it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  6.88it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.00it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.14it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.30it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.28it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.14it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.26it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.28it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.33it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.45it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:09,  7.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.37it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.26it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.36it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.20it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.28it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:08,  7.35it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.12it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.03it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.07it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.11it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.16it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.11it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.18it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 13:26:04,681 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:26:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:26:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:26:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:26:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]04/21/2024 13:26:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:26:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.1077683109552469, 'eval_loss': 1.3864079, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2785, 2769, 2757, 2752, 2728, 2721, 2696, 2722, 2837, 2932, 2982, 3003], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5175888, 'remaining_params': 79841712, 'pruned_model_sparsity': 0.06088019421860885, 'expected_sparsity': 0.06259, 'target_sparsity': 0.07276119402985075, 'step': 750}


Iteration:  80%|███████▉  | 214/268 [00:39<00:40,  1.33it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:30,  1.75it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:22,  2.27it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:17,  2.86it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:14,  3.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:11,  4.13it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:10,  4.70it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:09,  5.16it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:08,  5.64it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:07,  5.91it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:07,  6.17it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.80it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  6.89it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.90it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  7.10it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.17it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.34it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.37it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.34it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.30it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.19it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.33it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.30it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.15it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.21it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.04it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.06it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.90it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.03it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.02it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.84it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.15it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 13:26:13,670 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:26:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:26:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:26:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:26:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]04/21/2024 13:26:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:26:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.09472652226346587, 'eval_loss': 1.4318168, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2791, 2775, 2763, 2758, 2733, 2726, 2698, 2724, 2843, 2939, 2990, 3009], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5076308, 'remaining_params': 79941292, 'pruned_model_sparsity': 0.05970890733212888, 'expected_sparsity': 0.06144, 'target_sparsity': 0.07835820895522387, 'step': 800}


Iteration:  99%|█████████▊| 264/268 [00:48<00:02,  1.34it/s][A04/21/2024 13:26:15 - INFO - trainer.trainer_mod - v4 Global step: 800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:49<00:01,  1.76it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  2.26it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  2.83it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  3.57it/s][A04/21/2024 13:26:16 - INFO - trainer.trainer_mod - Epoch 2 finished. Took 49.5 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.41it/s]
Epoch:   3%|▎         | 3/100 [02:18<1:16:08, 47.10s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.91it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.94it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.08it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.11it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.16it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.17it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.18it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.13it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.17it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.19it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.12it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.03it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.23it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.21it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.05it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.23it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.02it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.25it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.32it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.35it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.40it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.34it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.00it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.13it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.25it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.13it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.14it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.15it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.27it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.31it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.32it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.20it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.24it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.12it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.18it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.09it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.14it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:32,  7.06it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.11it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:31,  7.03it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:31,  7.22it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 13:26:22,677 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:26:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:26:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:26:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:26:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]04/21/2024 13:26:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:26:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.09758197481255393, 'eval_loss': 1.5051548, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2797, 2780, 2768, 2762, 2737, 2728, 2693, 2725, 2847, 2945, 2996, 3014], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5010432, 'remaining_params': 80007168, 'pruned_model_sparsity': 0.05893405600722674, 'expected_sparsity': 0.06066, 'target_sparsity': 0.08395522388059701, 'step': 850}


Iteration:  17%|█▋        | 46/268 [00:08<02:46,  1.33it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:05,  1.76it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:36,  2.28it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:16,  2.87it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:01,  3.53it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:52,  4.12it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:45,  4.79it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:40,  5.32it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:36,  5.79it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:34,  6.15it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:32,  6.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:31,  6.68it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.85it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.01it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.06it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.10it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  7.03it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  6.89it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.87it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.78it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.92it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.05it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.08it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.18it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.30it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.46it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.42it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.08it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.22it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.20it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.43it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.56it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.47it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:23,  7.56it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.45it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.43it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.38it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.25it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:24,  7.25it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:24,  7.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:24,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 13:26:31,618 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:26:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:26:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:26:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:26:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]04/21/2024 13:26:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:26:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.10385466804655791, 'eval_loss': 1.3191873, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2800, 2784, 2772, 2765, 2740, 2729, 2693, 2725, 2849, 2950, 3002, 3018], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4956812, 'remaining_params': 80060788, 'pruned_model_sparsity': 0.058303363068352904, 'expected_sparsity': 0.06006, 'target_sparsity': 0.08955223880597014, 'step': 900}


Iteration:  36%|███▌      | 96/268 [00:17<02:09,  1.33it/s][A04/21/2024 13:26:33 - INFO - trainer.trainer_mod - v4 Global step: 900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:17<01:38,  1.74it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<01:15,  2.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:59,  2.84it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:48,  3.48it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:40,  4.11it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:35,  4.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:31,  5.22it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:29,  5.63it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:27,  6.03it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:25,  6.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:24,  6.62it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.70it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.69it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.84it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.07it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.15it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.07it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:22,  6.96it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.03it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.12it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.08it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.30it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.36it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.36it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.37it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:19,  7.51it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:18,  7.69it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.55it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.52it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.70it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.39it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.59it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.57it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.54it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.48it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.56it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.49it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.32it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.43it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.52it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.03it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.09it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:17,  7.11it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 13:26:40,536 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:26:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:26:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:26:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:26:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]04/21/2024 13:26:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:26:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.1419750597825623, 'eval_loss': 1.4908687, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2802, 2787, 2776, 2769, 2741, 2731, 2694, 2724, 2849, 2954, 3006, 3021], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4915448, 'remaining_params': 80102152, 'pruned_model_sparsity': 0.05781682851550738, 'expected_sparsity': 0.05961, 'target_sparsity': 0.0951492537313433, 'step': 950}


Iteration:  54%|█████▍    | 146/268 [00:26<01:31,  1.33it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<01:08,  1.76it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:52,  2.29it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:41,  2.87it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:34,  3.47it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:28,  4.08it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:24,  4.69it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:21,  5.30it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:20,  5.70it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:18,  6.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:17,  6.52it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.61it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:16,  6.79it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.82it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.05it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  6.72it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.75it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  6.87it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:15,  6.90it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.92it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.03it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.13it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.34it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.12it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.00it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.13it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.24it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.34it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.30it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.37it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.34it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.31it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.27it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.44it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.16it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  6.95it/s][A[INFO|trainer.py:570] 2024-04-21 13:26:49,522 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:26:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:26:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:26:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:26:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]04/21/2024 13:26:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:26:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.12300105566407585, 'eval_loss': 1.590702, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2805, 2789, 2779, 2772, 2743, 2732, 2691, 2717, 2849, 2955, 3009, 3023], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4900128, 'remaining_params': 80117472, 'pruned_model_sparsity': 0.057636630532971994, 'expected_sparsity': 0.05942, 'target_sparsity': 0.10074626865671642, 'step': 1000}


Iteration:  73%|███████▎  | 196/268 [00:35<00:54,  1.32it/s][A04/21/2024 13:26:51 - INFO - trainer.trainer_mod - v4 Global step: 1000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:35<00:40,  1.75it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:31,  2.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:24,  2.84it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:19,  3.47it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:16,  4.08it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:14,  4.63it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:12,  5.25it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:11,  5.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:10,  6.11it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:09,  6.56it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.57it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.67it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.83it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.83it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.97it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.05it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.09it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.17it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.36it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.39it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.14it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.27it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.21it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.31it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.38it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.25it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.53it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.89it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.02it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.12it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.19it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.21it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.28it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.08it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.14it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.19it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.24it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.14it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.18it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.23it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 13:26:58,547 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:26:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:26:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:26:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:26:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]04/21/2024 13:27:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:27:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.13847035035325458, 'eval_loss': 1.432786, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2806, 2790, 2779, 2772, 2741, 2729, 2685, 2709, 2844, 2955, 3012, 3025], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4926172, 'remaining_params': 80091428, 'pruned_model_sparsity': 0.057942967103282145, 'expected_sparsity': 0.05975, 'target_sparsity': 0.10634328358208955, 'step': 1050}


Iteration:  92%|█████████▏| 246/268 [00:44<00:16,  1.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:11,  1.76it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:08,  2.27it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:06,  2.85it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:05,  3.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:04,  4.13it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:03,  4.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  5.20it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  5.62it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  6.04it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.07it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.39it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.71it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.79it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.84it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.96it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.03it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.10it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.16it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.23it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.84it/s][A04/21/2024 13:27:03 - INFO - trainer.trainer_mod - Epoch 3 finished. Took 47.4 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.65it/s]
Epoch:   4%|▍         | 4/100 [03:06<1:15:32, 47.22s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.17it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.40it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.31it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.33it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.25it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.29it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.50it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:32,  7.78it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.42it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.35it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.26it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.18it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.25it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.30it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.28it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.30it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.30it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.29it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.18it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.21it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.26it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.31it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 13:27:07,485 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:27:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:27:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:27:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:27:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]04/21/2024 13:27:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:27:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.12592971470393788, 'eval_loss': 1.5428203, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2806, 2790, 2780, 2773, 2739, 2726, 2678, 2694, 2836, 2948, 3013, 3026], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4984388, 'remaining_params': 80033212, 'pruned_model_sparsity': 0.05862771943691659, 'expected_sparsity': 0.06047, 'target_sparsity': 0.11194029850746269, 'step': 1100}


Iteration:  10%|█         | 28/268 [00:05<02:59,  1.34it/s][A04/21/2024 13:27:09 - INFO - trainer.trainer_mod - v4 Global step: 1100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:05<02:15,  1.77it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:44,  2.28it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:22,  2.87it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:07,  3.50it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:56,  4.14it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:49,  4.76it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:43,  5.32it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:40,  5.80it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.18it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.39it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.63it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.78it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.90it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.92it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.04it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.02it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.09it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.38it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.40it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.29it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.20it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.27it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.36it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.45it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.34it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.45it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.19it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.11it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.81it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.05it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.10it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.32it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.29it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.25it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 13:27:16,446 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:27:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:27:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:27:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:27:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]04/21/2024 13:27:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:27:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.15983428588597068, 'eval_loss': 1.4362578, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2806, 2789, 2779, 2772, 2736, 2721, 2667, 2682, 2828, 2946, 3014, 3026], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5050264, 'remaining_params': 79967336, 'pruned_model_sparsity': 0.05940257076181873, 'expected_sparsity': 0.06128, 'target_sparsity': 0.11753731343283583, 'step': 1150}


Iteration:  29%|██▉       | 78/268 [00:14<02:25,  1.31it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:48,  1.74it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<01:23,  2.26it/s][A
Iteration:  30%|███       | 81/268 [00:15<01:05,  2.85it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:53,  3.46it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:44,  4.14it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:39,  4.70it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:34,  5.27it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:31,  5.69it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:29,  6.11it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:28,  6.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.61it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.66it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.82it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.83it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.09it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  6.99it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.07it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.14it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.12it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.34it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.26it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.31it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.31it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.33it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.33it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.39it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.40it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.34it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.21it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.29it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.05it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.18it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.99it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.06it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  6.97it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.21it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.22it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.20it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  6.85it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:20,  6.97it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 13:27:25,454 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:27:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:27:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:27:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:27:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]04/21/2024 13:27:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:27:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.11198943089800718, 'eval_loss': 1.4404155, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2804, 2787, 2778, 2770, 2731, 2713, 2652, 2668, 2816, 2940, 3014, 3025], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5154440, 'remaining_params': 79863160, 'pruned_model_sparsity': 0.060627917043059316, 'expected_sparsity': 0.0625, 'target_sparsity': 0.12313432835820895, 'step': 1200}


Iteration:  48%|████▊     | 128/268 [00:23<01:45,  1.32it/s][A04/21/2024 13:27:27 - INFO - trainer.trainer_mod - v4 Global step: 1200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:18,  1.76it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<01:00,  2.28it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:48,  2.85it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:39,  3.44it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:33,  4.08it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:28,  4.70it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:25,  5.18it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:23,  5.68it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:21,  6.02it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.77it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.06it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.12it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.08it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.01it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.19it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.10it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.15it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.35it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.29it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.11it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.08it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.08it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.17it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.33it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.14it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.33it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.36it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.22it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.06it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.12it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.14it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.08it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.14it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.16it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.17it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.24it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.16it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 13:27:34,452 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:27:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:27:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:27:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:27:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]04/21/2024 13:27:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:27:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.1270534068811398, 'eval_loss': 1.5521485, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2802, 2786, 2777, 2769, 2729, 2709, 2644, 2655, 2805, 2934, 3014, 3024], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5231040, 'remaining_params': 79786560, 'pruned_model_sparsity': 0.06152890695573622, 'expected_sparsity': 0.06341, 'target_sparsity': 0.1287313432835821, 'step': 1250}


Iteration:  66%|██████▋   | 178/268 [00:32<01:07,  1.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:50,  1.75it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:38,  2.27it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:30,  2.86it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:24,  3.47it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:20,  4.11it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:17,  4.79it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:15,  5.28it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:14,  5.70it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:13,  6.10it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.41it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:12,  6.53it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.74it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.82it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.08it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.17it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.23it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.18it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.16it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.20it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.28it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.42it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.36it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:07,  7.40it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.27it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.29it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.23it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.31it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.34it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.32it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.30it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.07it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  6.94it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.00it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  6.88it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.85it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.08it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.04it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 13:27:43,430 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:27:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:27:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:27:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:27:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]04/21/2024 13:27:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:27:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.20784212350901957, 'eval_loss': 1.3400373, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2800, 2783, 2776, 2767, 2726, 2704, 2633, 2644, 2794, 2925, 3012, 3022], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5326024, 'remaining_params': 79691576, 'pruned_model_sparsity': 0.06264613444745559, 'expected_sparsity': 0.0646, 'target_sparsity': 0.13432835820895522, 'step': 1300}


Iteration:  85%|████████▌ | 228/268 [00:41<00:30,  1.33it/s][A04/21/2024 13:27:45 - INFO - trainer.trainer_mod - v4 Global step: 1300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:41<00:22,  1.76it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:16,  2.27it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:12,  2.86it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:10,  3.50it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:08,  4.14it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:07,  4.76it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:06,  5.27it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:05,  5.75it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:05,  6.15it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.74it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.78it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.96it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.01it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.89it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.92it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.99it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.08it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.19it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.27it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.34it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.28it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.22it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.35it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.15it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.26it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.22it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.27it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.31it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.23it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.37it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.80it/s][A04/21/2024 13:27:50 - INFO - trainer.trainer_mod - Epoch 4 finished. Took 47.31 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:   5%|▌         | 5/100 [03:53<1:14:48, 47.25s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.15it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.40it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.33it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.33it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.44it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.26it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 13:27:52,354 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:27:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:27:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:27:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:27:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]04/21/2024 13:27:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:27:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.18600989454236824, 'eval_loss': 1.499971, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2796, 2779, 2772, 2762, 2718, 2695, 2617, 2622, 2775, 2911, 3009, 3018], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5497608, 'remaining_params': 79519992, 'pruned_model_sparsity': 0.06466435185185185, 'expected_sparsity': 0.0667, 'target_sparsity': 0.13992537313432835, 'step': 1350}


Iteration:   4%|▎         | 10/268 [00:03<03:18,  1.30it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:28,  1.73it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:54,  2.24it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:29,  2.84it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:13,  3.44it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:02,  4.08it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:52,  4.77it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:47,  5.31it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:42,  5.85it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:40,  6.11it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:38,  6.42it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:36,  6.79it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.83it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.83it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.80it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.90it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.83it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.96it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  7.01it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.08it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.17it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.28it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.34it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.29it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.22it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.30it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.45it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.36it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:29,  7.51it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.57it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.50it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.59it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.27it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.05it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.14it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.21it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 13:28:01,281 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:28:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:28:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:28:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:28:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]04/21/2024 13:28:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:28:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.18600989454236824, 'eval_loss': 1.3783679, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2791, 2773, 2766, 2755, 2709, 2681, 2592, 2584, 2738, 2885, 3003, 3011], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5782560, 'remaining_params': 79235040, 'pruned_model_sparsity': 0.06801603432700994, 'expected_sparsity': 0.07026, 'target_sparsity': 0.1455223880597015, 'step': 1400}


Iteration:  22%|██▏       | 60/268 [00:12<02:35,  1.33it/s][A04/21/2024 13:28:03 - INFO - trainer.trainer_mod - v4 Global step: 1400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:57,  1.76it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:30,  2.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:11,  2.86it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:58,  3.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:49,  4.13it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:42,  4.76it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:38,  5.29it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:34,  5.75it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:32,  6.17it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.68it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:28,  6.83it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.95it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  6.94it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.25it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  7.10it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  7.07it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.10it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.13it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.20it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.26it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.35it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.40it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.39it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.42it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.32it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.26it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.35it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.36it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.42it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.38it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.39it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.39it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.35it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.33it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.33it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.88it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 13:28:10,185 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:28:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:28:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:28:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:28:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]04/21/2024 13:28:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:28:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.19717255090707073, 'eval_loss': 1.5781554, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2786, 2769, 2762, 2748, 2701, 2674, 2577, 2563, 2716, 2864, 2993, 3000], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5989380, 'remaining_params': 79028220, 'pruned_model_sparsity': 0.07044870709123757, 'expected_sparsity': 0.07315, 'target_sparsity': 0.15111940298507462, 'step': 1450}


Iteration:  41%|████      | 110/268 [00:21<01:58,  1.33it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<01:29,  1.76it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<01:08,  2.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:54,  2.87it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:44,  3.48it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:37,  4.04it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:33,  4.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:29,  5.14it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:26,  5.64it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:25,  5.92it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:24,  6.14it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.67it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.81it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.84it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  6.99it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.85it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.97it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.04it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.14it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.12it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.08it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.08it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.31it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.20it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.27it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.50it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.52it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.22it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.17it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.10it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  7.05it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.14it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  6.99it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.91it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  6.95it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.02it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.99it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.09it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.18it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.10it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 13:28:19,250 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:28:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:28:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:28:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:28:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]04/21/2024 13:28:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:28:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.19165721676540245, 'eval_loss': 1.3903408, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2781, 2763, 2758, 2743, 2693, 2667, 2564, 2550, 2698, 2835, 2976, 2981], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6209988, 'remaining_params': 78807612, 'pruned_model_sparsity': 0.07304355803974706, 'expected_sparsity': 0.0806, 'target_sparsity': 0.15671641791044774, 'step': 1500}


Iteration:  60%|█████▉    | 160/268 [00:30<01:21,  1.33it/s][A04/21/2024 13:28:21 - INFO - trainer.trainer_mod - v4 Global step: 1500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:30<01:01,  1.74it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:47,  2.25it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:37,  2.81it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:30,  3.41it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:25,  4.06it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:21,  4.70it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:19,  5.25it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:17,  5.81it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:16,  6.17it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:15,  6.47it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.72it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.89it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  7.04it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:12,  7.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.17it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.10it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.16it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.20it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.29it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.17it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.17it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.25it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.36it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.45it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.53it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.20it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.12it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.20it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.23it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.00it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.20it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.21it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.30it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.19it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 13:28:28,204 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:28:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:28:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:28:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:28:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.58it/s]04/21/2024 13:28:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:28:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.26357566347479533, 'eval_loss': 1.4540331, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2775, 2756, 2751, 2735, 2683, 2652, 2535, 2515, 2657, 2784, 2940, 2952], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 11152220, 'remaining_params': 73865380, 'pruned_model_sparsity': 0.13117542720566094, 'expected_sparsity': 0.11405, 'target_sparsity': 0.16231343283582086, 'step': 1550}


Iteration:  78%|███████▊  | 210/268 [00:39<00:43,  1.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:32,  1.75it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:24,  2.28it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:19,  2.79it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:15,  3.42it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:12,  4.08it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:11,  4.68it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:09,  5.17it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:08,  5.66it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:08,  6.04it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.34it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.68it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.71it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.88it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.01it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.13it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.16it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.12it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.20it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.91it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.07it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.07it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.21it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.19it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.41it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.26it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.34it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.30it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.10it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.16it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.19it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.31it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.19it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.12it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.06it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.12it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.01it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.09it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.12it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 13:28:37,220 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:28:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:28:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:28:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:28:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]04/21/2024 13:28:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:28:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.23861100934374366, 'eval_loss': 1.3592336, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2769, 2748, 2746, 2728, 2674, 2641, 2518, 2494, 2625, 2721, 2875, 2934], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 11526028, 'remaining_params': 73491572, 'pruned_model_sparsity': 0.13557225797952424, 'expected_sparsity': 0.13334, 'target_sparsity': 0.16791044776119401, 'step': 1600}


Iteration:  97%|█████████▋| 260/268 [00:48<00:06,  1.33it/s][A04/21/2024 13:28:39 - INFO - trainer.trainer_mod - v4 Global step: 1600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:48<00:03,  1.76it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:02,  2.28it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:01,  2.80it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  3.41it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  4.03it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  4.59it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  5.16it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.92it/s][A04/21/2024 13:28:40 - INFO - trainer.trainer_mod - Epoch 5 finished. Took 49.41 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:   6%|▌         | 6/100 [04:42<1:15:10, 47.98s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.90it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.21it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.20it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.09it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.40it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.20it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.28it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.38it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.43it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.33it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.42it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.42it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.31it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.38it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.40it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.43it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.41it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.38it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.35it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.34it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.06it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  7.05it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.19it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:32,  7.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.13it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.06it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.26it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.27it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 13:28:46,156 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:28:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:28:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:28:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:28:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]04/21/2024 13:28:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:28:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.18600989454236824, 'eval_loss': 1.5123727, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2760, 2741, 2739, 2719, 2662, 2625, 2495, 2453, 2574, 2610, 2741, 2923], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11], 'pruned_params': 12365564, 'remaining_params': 72652036, 'pruned_model_sparsity': 0.1454471074224631, 'expected_sparsity': 0.14823, 'target_sparsity': 0.17350746268656714, 'step': 1650}


Iteration:  16%|█▌        | 42/268 [00:07<02:49,  1.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:07,  1.76it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:38,  2.28it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:17,  2.89it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:03,  3.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:52,  4.20it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:45,  4.82it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:40,  5.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:37,  5.75it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:35,  6.14it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:34,  6.30it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.54it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.65it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.83it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.84it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.98it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.08it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.09it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.21it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.29it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.26it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.30it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.38it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.61it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.15it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.34it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.37it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.21it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.16it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.16it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.19it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.12it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.30it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.29it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.06it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.24it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.26it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.23it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.21it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:28:55,095 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:28:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:28:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:28:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:28:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.58it/s]04/21/2024 13:28:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:28:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.21807991489579495, 'eval_loss': 1.3557183, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2754, 2733, 2732, 2713, 2653, 2612, 2477, 2434, 2533, 2483, 2553, 2916], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 10], 'pruned_params': 13238804, 'remaining_params': 71778796, 'pruned_model_sparsity': 0.15571839242697982, 'expected_sparsity': 0.16478, 'target_sparsity': 0.1791044776119403, 'step': 1700}


Iteration:  34%|███▍      | 92/268 [00:16<02:12,  1.33it/s][A04/21/2024 13:28:57 - INFO - trainer.trainer_mod - v4 Global step: 1700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:39,  1.76it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<01:16,  2.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:00,  2.85it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:49,  3.50it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:41,  4.12it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:35,  4.73it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:32,  5.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:29,  5.74it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:26,  6.19it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.60it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:24,  6.68it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  6.82it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.07it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.16it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.22it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.26it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.27it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.34it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.25it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.33it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.56it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.29it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.55it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.56it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.57it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.55it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.56it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.35it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.15it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.09it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.34it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.13it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.36it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.31it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.31it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.11it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.19it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.15it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.21it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  7.15it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:29:04,005 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:29:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:29:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:29:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:29:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]04/21/2024 13:29:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:29:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.21301163126985315, 'eval_loss': 1.2579718, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2747, 2725, 2725, 2705, 2642, 2598, 2453, 2406, 2477, 2341, 2362, 2909], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 9], 'pruned_params': 15959636, 'remaining_params': 69057964, 'pruned_model_sparsity': 0.18772155412526348, 'expected_sparsity': 0.18187, 'target_sparsity': 0.1847014925373134, 'step': 1750}


Iteration:  53%|█████▎    | 142/268 [00:25<01:34,  1.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<01:10,  1.77it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:54,  2.29it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:42,  2.88it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:34,  3.52it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:29,  4.05it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:25,  4.68it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:22,  5.31it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:20,  5.79it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:19,  6.00it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:18,  6.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:17,  6.58it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.94it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.98it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.24it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.30it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.35it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.53it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.41it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.58it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.60it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.45it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.25it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.23it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.16it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.19it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:13,  6.86it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.13it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.19it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.02it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.15it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.21it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.26it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.14it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.19it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.13it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.17it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.04it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.12it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.05it/s][A[INFO|trainer.py:570] 2024-04-21 13:29:12,970 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:29:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:29:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:29:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:29:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 13:29:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:29:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.21624904403648446, 'eval_loss': 1.1989615, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2738, 2716, 2717, 2695, 2630, 2582, 2424, 2374, 2422, 2205, 2202, 2902], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 8], 'pruned_params': 16688868, 'remaining_params': 68328732, 'pruned_model_sparsity': 0.1962989780939476, 'expected_sparsity': 0.19351, 'target_sparsity': 0.1902985074626866, 'step': 1800}


Iteration:  72%|███████▏  | 192/268 [00:34<00:57,  1.33it/s][A04/21/2024 13:29:15 - INFO - trainer.trainer_mod - v4 Global step: 1800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:34<00:42,  1.76it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:32,  2.28it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:25,  2.85it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:20,  3.49it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:17,  4.08it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:15,  4.60it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:13,  5.18it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:12,  5.60it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:11,  6.00it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.57it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.88it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.98it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.08it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.00it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.26it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.29it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.36it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.53it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.52it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:06,  7.59it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.55it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.54it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.37it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.29it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.21it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.38it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.39it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.37it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.13it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 13:29:21,853 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:29:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:29:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:29:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:29:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 13:29:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:29:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2111960218810086, 'eval_loss': 1.2665076, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2729, 2709, 2710, 2689, 2620, 2571, 2409, 2348, 2376, 2083, 2072, 2894], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 8], 'pruned_params': 17284816, 'remaining_params': 67732784, 'pruned_model_sparsity': 0.2033086796145739, 'expected_sparsity': 0.20175, 'target_sparsity': 0.1958955223880597, 'step': 1850}


Iteration:  90%|█████████ | 242/268 [00:43<00:19,  1.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:14,  1.77it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:10,  2.29it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:07,  2.88it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:06,  3.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:05,  4.11it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:04,  4.69it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:03,  5.25it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:03,  5.72it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.10it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.65it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.63it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.98it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.05it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.11it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.80it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.11it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.21it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.17it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.18it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.78it/s][A04/21/2024 13:29:27 - INFO - trainer.trainer_mod - Epoch 6 finished. Took 47.09 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:   7%|▋         | 7/100 [05:29<1:13:55, 47.69s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.04it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.99it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.12it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.14it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.29it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.30it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.21it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.26it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.18it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.22it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.17it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.39it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.38it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.24it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 13:29:30,806 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:29:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:29:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:29:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:29:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 13:29:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:29:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2880531281790735, 'eval_loss': 1.077789, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2723, 2702, 2704, 2684, 2614, 2561, 2394, 2323, 2329, 1977, 1963, 2884], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 7], 'pruned_params': 17808760, 'remaining_params': 67208840, 'pruned_model_sparsity': 0.20947145061728395, 'expected_sparsity': 0.2085, 'target_sparsity': 0.20149253731343283, 'step': 1900}


Iteration:   9%|▉         | 24/268 [00:05<03:02,  1.34it/s][A04/21/2024 13:29:32 - INFO - trainer.trainer_mod - v4 Global step: 1900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:16,  1.78it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:45,  2.29it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:23,  2.88it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:08,  3.51it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:56,  4.22it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:50,  4.75it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:44,  5.30it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:40,  5.77it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:38,  6.14it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:35,  6.58it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.77it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.92it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.02it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.06it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.91it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.07it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.30it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.48it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.50it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.48it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.47it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.49it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.40it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.32it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.32it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.45it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.30it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.30it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.29it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 13:29:39,662 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:29:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:29:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:29:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:29:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]04/21/2024 13:29:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:29:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.23745213262842438, 'eval_loss': 1.3377529, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2716, 2695, 2698, 2679, 2607, 2551, 2375, 2296, 2284, 1880, 1870, 2873], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 7], 'pruned_params': 18303596, 'remaining_params': 66714004, 'pruned_model_sparsity': 0.21529184545317676, 'expected_sparsity': 0.21487, 'target_sparsity': 0.20708955223880599, 'step': 1950}


Iteration:  28%|██▊       | 74/268 [00:14<02:25,  1.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:48,  1.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:24,  2.26it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:07,  2.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:54,  3.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:45,  4.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:40,  4.70it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:35,  5.24it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:32,  5.70it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:30,  6.11it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.93it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.93it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.05it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.98it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.18it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.40it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:22,  7.62it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.37it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.36it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.47it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.47it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.24it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.18it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.10it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.00it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.10it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.12it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.14it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.10it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.05it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.28it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.29it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.41it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.35it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 13:29:48,559 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:29:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:29:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:29:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:29:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]04/21/2024 13:29:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:29:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.18600989454236824, 'eval_loss': 1.4061123, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2708, 2687, 2692, 2671, 2597, 2538, 2352, 2266, 2235, 1789, 1790, 2861], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 7], 'pruned_params': 18803028, 'remaining_params': 66214572, 'pruned_model_sparsity': 0.22116629968383017, 'expected_sparsity': 0.22126, 'target_sparsity': 0.2126865671641791, 'step': 2000}


Iteration:  46%|████▋     | 124/268 [00:23<01:47,  1.34it/s][A04/21/2024 13:29:50 - INFO - trainer.trainer_mod - v4 Global step: 2000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:23<01:20,  1.77it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<01:01,  2.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:50,  2.81it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:40,  3.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:33,  4.09it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:29,  4.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:25,  5.30it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:23,  5.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:22,  6.07it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.40it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.45it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.70it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.85it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  6.91it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.01it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  7.04it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.16it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.06it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.20it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.20it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.06it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.17it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.08it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.45it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.48it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.32it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.35it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.33it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.20it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.36it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.19it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.22it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  6.87it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.82it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  6.93it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.03it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.12it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.37it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.34it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.26it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 13:29:57,585 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:29:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:29:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:29:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:29:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 13:29:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:29:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.24882114540529945, 'eval_loss': 1.2698561, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2701, 2681, 2688, 2665, 2589, 2528, 2335, 2242, 2192, 1709, 1718, 2846], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 7], 'pruned_params': 19227392, 'remaining_params': 65790208, 'pruned_model_sparsity': 0.2261577838000602, 'expected_sparsity': 0.22663, 'target_sparsity': 0.21828358208955226, 'step': 2050}


Iteration:  65%|██████▍   | 174/268 [00:32<01:10,  1.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:52,  1.76it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:40,  2.27it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:31,  2.86it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:25,  3.49it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:21,  4.10it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:18,  4.64it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:16,  5.28it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:14,  5.74it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:13,  6.14it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:13,  6.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.82it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.95it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.94it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.82it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.93it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.95it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.12it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.33it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.24it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.25it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.39it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.45it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.45it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.16it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.26it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.29it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.28it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.15it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.09it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.17it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.07it/s][A[INFO|trainer.py:570] 2024-04-21 13:30:06,541 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:30:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:30:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:30:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:30:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 13:30:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:30:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2919790524372276, 'eval_loss': 1.1770226, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2695, 2674, 2683, 2658, 2583, 2519, 2318, 2217, 2149, 1636, 1657, 2830], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 19624180, 'remaining_params': 65393420, 'pruned_model_sparsity': 0.23082491154772658, 'expected_sparsity': 0.23178, 'target_sparsity': 0.22388059701492538, 'step': 2100}


Iteration:  84%|████████▎ | 224/268 [00:41<00:33,  1.33it/s][A04/21/2024 13:30:08 - INFO - trainer.trainer_mod - v4 Global step: 2100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:41<00:24,  1.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:18,  2.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:14,  2.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:11,  3.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:09,  4.07it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:08,  4.65it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:07,  5.22it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:06,  5.70it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  5.99it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:05,  6.57it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.11it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.08it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.13it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.24it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.33it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.40it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.55it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.26it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.45it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.36it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.40it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.34it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.24it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.23it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.27it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.25it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.24it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.23it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.28it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.78it/s][A04/21/2024 13:30:14 - INFO - trainer.trainer_mod - Epoch 7 finished. Took 47.1 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:   8%|▊         | 8/100 [06:16<1:12:50, 47.50s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.38it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.05it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 13:30:15,411 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:30:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:30:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:30:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:30:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 13:30:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:30:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.24882114540529945, 'eval_loss': 1.3456315, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2687, 2667, 2675, 2649, 2571, 2503, 2289, 2188, 2099, 1568, 1603, 2811], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 20068460, 'remaining_params': 64949140, 'pruned_model_sparsity': 0.23605065304125264, 'expected_sparsity': 0.23803, 'target_sparsity': 0.2294776119402985, 'step': 2150}


Iteration:   2%|▏         | 6/268 [00:02<03:36,  1.21it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:36,  1.66it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:57,  2.21it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:31,  2.82it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:15,  3.43it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:02,  4.13it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:55,  4.62it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:48,  5.25it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:44,  5.72it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:40,  6.22it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:38,  6.51it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:37,  6.64it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:36,  6.81it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:35,  7.08it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.12it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.35it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:33,  7.40it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.40it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.46it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.49it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.49it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.27it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.34it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:32,  7.26it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.31it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.14it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.36it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.25it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.15it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.17it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.22it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.21it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.26it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.10it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.29it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.29it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.13it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.00it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.09it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 13:30:24,324 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:30:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:30:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:30:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:30:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:30:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:30:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.24316892062216255, 'eval_loss': 1.3576005, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2682, 2660, 2671, 2643, 2561, 2492, 2268, 2159, 2054, 1511, 1554, 2791], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 20442268, 'remaining_params': 64575332, 'pruned_model_sparsity': 0.24044748381511594, 'expected_sparsity': 0.24358, 'target_sparsity': 0.23507462686567165, 'step': 2200}


Iteration:  21%|██        | 56/268 [00:11<02:38,  1.34it/s][A04/21/2024 13:30:26 - INFO - trainer.trainer_mod - v4 Global step: 2200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:59,  1.77it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:31,  2.29it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:12,  2.88it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:59,  3.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:49,  4.22it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:43,  4.77it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:39,  5.21it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:35,  5.68it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:33,  6.04it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:31,  6.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:30,  6.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:29,  6.84it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  6.97it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.07it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.28it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.22it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.31it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.27it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.23it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.31it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.35it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.43it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.35it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.22it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  6.96it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.99it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.10it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.16it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.24it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.11it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.27it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.18it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.22it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.08it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.14it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.29it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.14it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.03it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.04it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.12it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 13:30:33,257 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:30:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:30:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:30:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:30:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:30:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:30:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.23558621884595085, 'eval_loss': 1.4384604, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2674, 2653, 2664, 2636, 2551, 2482, 2249, 2135, 2022, 1466, 1507, 2769], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 20773180, 'remaining_params': 64244420, 'pruned_model_sparsity': 0.24433976023788015, 'expected_sparsity': 0.25009, 'target_sparsity': 0.24067164179104478, 'step': 2250}


Iteration:  40%|███▉      | 106/268 [00:20<02:00,  1.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:30,  1.77it/s][A
Iteration:  40%|████      | 108/268 [00:20<01:09,  2.29it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:55,  2.87it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:45,  3.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:39,  3.99it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:33,  4.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:29,  5.18it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:27,  5.60it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:25,  6.02it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.36it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.59it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.80it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  6.93it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  7.02it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.15it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.24it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:19,  7.34it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.42it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.41it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.36it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:18,  7.51it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.33it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.40it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.23it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.29it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.34it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.24it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.39it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.90it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.74it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.81it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.92it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.04it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.31it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.31it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.33it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.30it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.19it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.19it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.12it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.07it/s][A[INFO|trainer.py:570] 2024-04-21 13:30:42,254 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:30:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:30:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:30:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:30:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:30:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:30:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.31039381595601995, 'eval_loss': 1.1830313, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2668, 2647, 2660, 2629, 2543, 2473, 2230, 2108, 1987, 1428, 1470, 2744], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 21073452, 'remaining_params': 63944148, 'pruned_model_sparsity': 0.24787164069557363, 'expected_sparsity': 0.25881, 'target_sparsity': 0.2462686567164179, 'step': 2300}


Iteration:  58%|█████▊    | 156/268 [00:29<01:23,  1.33it/s][A04/21/2024 13:30:44 - INFO - trainer.trainer_mod - v4 Global step: 2300, Alignment: tensor([ 2,  3,  7, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:29<01:03,  1.76it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:48,  2.29it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:38,  2.85it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:30,  3.49it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:25,  4.14it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:22,  4.76it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:19,  5.25it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:18,  5.74it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:16,  6.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:16,  6.34it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.65it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.85it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.85it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.92it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.96it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.03it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  7.00it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.15it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.26it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.39it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.35it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.27it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.30it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.30it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.33it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.34it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.17it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.21it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.30it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.40it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:08,  7.35it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.97it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.05it/s][A[INFO|trainer.py:570] 2024-04-21 13:30:51,219 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:30:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:30:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:30:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:30:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 13:30:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:30:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.349925899769909, 'eval_loss': 1.109634, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2660, 2639, 2655, 2622, 2534, 2464, 2212, 2085, 1948, 1408, 1438, 2718], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 23503204, 'remaining_params': 61514396, 'pruned_model_sparsity': 0.27645104072568505, 'expected_sparsity': 0.26801, 'target_sparsity': 0.251865671641791, 'step': 2350}


Iteration:  77%|███████▋  | 206/268 [00:38<00:46,  1.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:34,  1.76it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:26,  2.28it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:20,  2.87it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:16,  3.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:13,  4.13it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:11,  4.75it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:10,  5.37it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:09,  5.77it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:08,  6.10it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:08,  6.43it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.58it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:06,  7.05it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.26it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.19it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.19it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.48it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.50it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.50it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:04,  7.46it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.31it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.62it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.43it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.40it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:02,  7.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.13it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.10it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.16it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.11it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.23it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 13:31:00,074 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:31:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:31:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:31:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:31:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:31:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:31:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36228153051710127, 'eval_loss': 1.1462259, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2653, 2632, 2649, 2614, 2524, 2453, 2197, 2064, 1915, 1398, 1414, 2692], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 23720748, 'remaining_params': 61296852, 'pruned_model_sparsity': 0.27900985207768747, 'expected_sparsity': 0.27378, 'target_sparsity': 0.2574626865671642, 'step': 2400}


Iteration:  96%|█████████▌| 256/268 [00:47<00:08,  1.34it/s][A04/21/2024 13:31:02 - INFO - trainer.trainer_mod - v4 Global step: 2400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:47<00:06,  1.76it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:04,  2.28it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:03,  2.87it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:02,  3.50it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  4.14it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  4.71it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  5.33it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  5.91it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.19it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.39it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.57it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.28it/s][A04/21/2024 13:31:03 - INFO - trainer.trainer_mod - Epoch 8 finished. Took 49.17 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.45it/s]
Epoch:   9%|▉         | 9/100 [07:06<1:12:50, 48.02s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.78it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.44it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.50it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.25it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.31it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.36it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.40it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.36it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.34it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.18it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.36it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.53it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.45it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.33it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.23it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.39it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.27it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.12it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.31it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.32it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.34it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.32it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.47it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.43it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.38it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.33it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.35it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:31:08,921 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:31:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:31:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:31:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:31:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 13:31:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:31:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.32915500143122983, 'eval_loss': 1.2547946, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2648, 2627, 2646, 2609, 2520, 2446, 2188, 2053, 1895, 1392, 1391, 2665], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 23861692, 'remaining_params': 61155908, 'pruned_model_sparsity': 0.28066767351701294, 'expected_sparsity': 0.27708, 'target_sparsity': 0.2630597014925373, 'step': 2450}


Iteration:  14%|█▍        | 38/268 [00:07<02:51,  1.34it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:09,  1.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:39,  2.28it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:19,  2.86it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:04,  3.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:54,  4.14it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:46,  4.77it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:41,  5.31it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:38,  5.71it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:36,  6.09it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:34,  6.41it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:33,  6.63it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:32,  6.75it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.19it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.19it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.30it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:27,  7.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.34it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.25it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.35it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.41it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.59it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.67it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.36it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.12it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.01it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  6.94it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.06it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.02it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:26,  7.12it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.24it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.16it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:26,  7.03it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.08it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.15it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:25,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 13:31:17,827 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:31:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:31:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:31:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:31:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 13:31:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:31:19 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2520902704446151, 'eval_loss': 1.315109, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2643, 2621, 2640, 2602, 2511, 2435, 2169, 2031, 1867, 1388, 1372, 2637], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 24063916, 'remaining_params': 60953684, 'pruned_model_sparsity': 0.28304628688648, 'expected_sparsity': 0.28036, 'target_sparsity': 0.26865671641791045, 'step': 2500}


Iteration:  33%|███▎      | 88/268 [00:16<02:14,  1.34it/s][A04/21/2024 13:31:19 - INFO - trainer.trainer_mod - v4 Global step: 2500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:42,  1.75it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<01:18,  2.26it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:01,  2.86it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:50,  3.49it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:42,  4.07it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:37,  4.70it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:32,  5.27it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:29,  5.75it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:28,  6.07it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:26,  6.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:25,  6.63it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:24,  6.70it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.04it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.04it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.08it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.33it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.11it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.25it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.32it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.20it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.31it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.40it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.42it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.56it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:19,  7.70it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:19,  7.61it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.59it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.51it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.47it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.36it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.49it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.42it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.28it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.30it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.34it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.23it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.26it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.26it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.28it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.07it/s][A[INFO|trainer.py:570] 2024-04-21 13:31:26,736 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:31:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:31:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:31:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:31:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 13:31:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:31:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2439588933160818, 'eval_loss': 1.2828137, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2640, 2619, 2638, 2600, 2509, 2434, 2167, 2027, 1852, 1383, 1353, 2607], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 24143580, 'remaining_params': 60874020, 'pruned_model_sparsity': 0.28398331639566393, 'expected_sparsity': 0.28194, 'target_sparsity': 0.27425373134328357, 'step': 2550}


Iteration:  51%|█████▏    | 138/268 [00:25<01:37,  1.34it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<01:13,  1.75it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:56,  2.27it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:44,  2.86it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:36,  3.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:30,  4.12it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:26,  4.74it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:23,  5.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:21,  5.63it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:20,  5.97it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:19,  6.16it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:17,  6.66it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  6.91it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  7.19it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.31it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.18it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.26it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.20it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.28it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.14it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.09it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.24it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.35it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.39it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.44it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.47it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.55it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.47it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.42it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.39it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.37it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.29it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.27it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.26it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.25it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.27it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.28it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.30it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.15it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.20it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 13:31:35,667 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:31:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:31:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:31:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:31:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 13:31:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:31:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2517259790268288, 'eval_loss': 1.3474776, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2635, 2614, 2631, 2593, 2502, 2422, 2147, 2001, 1823, 1381, 1337, 2575], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 24348868, 'remaining_params': 60668732, 'pruned_model_sparsity': 0.2863979693616381, 'expected_sparsity': 0.28489, 'target_sparsity': 0.2798507462686567, 'step': 2600}


Iteration:  70%|███████   | 188/268 [00:33<00:59,  1.34it/s][A04/21/2024 13:31:37 - INFO - trainer.trainer_mod - v4 Global step: 2600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:34<00:44,  1.77it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:34,  2.28it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:26,  2.86it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:21,  3.50it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:18,  4.15it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:15,  4.76it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:13,  5.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:12,  5.80it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:11,  6.16it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.80it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.06it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.16it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.24it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  7.22it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.21it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.30it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.36it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.43it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.47it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.09it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.22it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.78it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.90it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.19it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.27it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.06it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.32it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.34it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.28it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.21it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.19it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.20it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.05it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.25it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.26it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.39it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.29it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 13:31:44,578 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:31:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:31:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:31:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:31:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:31:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:31:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2111960218810086, 'eval_loss': 1.3154919, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2630, 2609, 2625, 2586, 2494, 2411, 2129, 1979, 1799, 1379, 1322, 2541], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 24534240, 'remaining_params': 60483360, 'pruned_model_sparsity': 0.2885783649503162, 'expected_sparsity': 0.28753, 'target_sparsity': 0.28544776119402987, 'step': 2650}


Iteration:  89%|████████▉ | 238/268 [00:42<00:22,  1.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:16,  1.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:12,  2.30it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:09,  2.87it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:07,  3.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:06,  4.06it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:05,  4.69it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:04,  5.25it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  5.73it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.12it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.85it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.02it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.19it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.28it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.16it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.24it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.26it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.31it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.34it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.90it/s][A04/21/2024 13:31:50 - INFO - trainer.trainer_mod - Epoch 9 finished. Took 47.01 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.70it/s]
Epoch:  10%|█         | 10/100 [07:53<1:11:33, 47.71s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.19it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.38it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.33it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.18it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.99it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.10it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.14it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.15it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.23it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.26it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.29it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.33it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.23it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.16it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.03it/s][A[INFO|trainer.py:570] 2024-04-21 13:31:53,532 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:31:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:31:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:31:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:31:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 13:31:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:31:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3360890813268645, 'eval_loss': 1.1868893, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2624, 2605, 2622, 2581, 2487, 2405, 2123, 1967, 1783, 1377, 1309, 2506], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 6], 'pruned_params': 24653736, 'remaining_params': 60363864, 'pruned_model_sparsity': 0.2899839092140921, 'expected_sparsity': 0.2894, 'target_sparsity': 0.291044776119403, 'step': 2700}


Iteration:   7%|▋         | 20/268 [00:04<03:05,  1.34it/s][A04/21/2024 13:31:55 - INFO - trainer.trainer_mod - v4 Global step: 2700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:19,  1.77it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:48,  2.28it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:25,  2.87it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:10,  3.47it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:59,  4.11it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:51,  4.72it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.24it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:41,  5.74it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:39,  6.08it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.12it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.30it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.28it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.53it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.68it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.50it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.29it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:29,  7.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.52it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.54it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.34it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.31it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.51it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.27it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.19it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.11it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.16it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.17it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:27,  7.50it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.23it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.25it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.20it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  7.01it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.06it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.12it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.17it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 13:32:02,419 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:32:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:32:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:32:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:32:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 13:32:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:32:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.33268013542291797, 'eval_loss': 1.1538004, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2620, 2602, 2620, 2580, 2485, 2402, 2117, 1955, 1766, 1375, 1297, 2468], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 5], 'pruned_params': 24944816, 'remaining_params': 60072784, 'pruned_model_sparsity': 0.2934076708822644, 'expected_sparsity': 0.29094, 'target_sparsity': 0.2966417910447761, 'step': 2750}


Iteration:  26%|██▌       | 70/268 [00:13<02:27,  1.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:51,  1.77it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<01:25,  2.29it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<01:07,  2.90it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:55,  3.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:45,  4.22it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:39,  4.89it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:35,  5.43it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:32,  5.87it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:29,  6.41it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.67it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.81it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  6.92it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.15it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.33it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.41it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.36it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.48it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.22it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.33it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:22,  7.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.57it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.37it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.28it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.12it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.31it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.34it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.49it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.44it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.26it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:32:11,261 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:32:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:32:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:32:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:32:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 13:32:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:32:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3210203032701329, 'eval_loss': 1.2399806, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2615, 2598, 2615, 2576, 2478, 2393, 2102, 1939, 1747, 1372, 1285, 2426], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 5], 'pruned_params': 25091888, 'remaining_params': 59925712, 'pruned_model_sparsity': 0.295137571514604, 'expected_sparsity': 0.29323, 'target_sparsity': 0.30223880597014924, 'step': 2800}


Iteration:  45%|████▍     | 120/268 [00:22<01:50,  1.34it/s][A04/21/2024 13:32:13 - INFO - trainer.trainer_mod - v4 Global step: 2800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:22<01:23,  1.77it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<01:03,  2.29it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:50,  2.88it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:40,  3.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:34,  4.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:29,  4.77it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:26,  5.32it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:24,  5.72it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:23,  5.93it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:22,  6.21it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.90it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.08it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.10it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.11it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.14it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.03it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.40it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.43it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.50it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.49it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.47it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.42it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.41it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  7.16it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.04it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.13it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.14it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.87it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  6.98it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.23it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.26it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.38it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.37it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.37it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.14it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.40it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:32:20,197 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:32:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:32:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:32:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:32:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:32:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:32:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3533036364961316, 'eval_loss': 1.0977918, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2611, 2594, 2610, 2571, 2472, 2383, 2086, 1921, 1727, 1370, 1274, 2381], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 5], 'pruned_params': 25243556, 'remaining_params': 59774044, 'pruned_model_sparsity': 0.2969215315417043, 'expected_sparsity': 0.29547, 'target_sparsity': 0.30783582089552236, 'step': 2850}


Iteration:  63%|██████▎   | 170/268 [00:31<01:12,  1.34it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:54,  1.78it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:41,  2.29it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:32,  2.88it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:26,  3.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:22,  4.21it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:19,  4.81it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:17,  5.35it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:15,  5.65it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:14,  5.99it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:14,  6.18it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.78it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.11it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.06it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.31it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.42it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.46it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.59it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.71it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.63it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.18it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.33it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.33it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.16it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.04it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.15it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.23it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.27it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.30it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.09it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.21it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.08it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.02it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.13it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.21it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.22it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.24it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.27it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.31it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.33it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  6.79it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.87it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.99it/s][A[INFO|trainer.py:570] 2024-04-21 13:32:29,146 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:32:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:32:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:32:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:32:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 13:32:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:32:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3679008502105967, 'eval_loss': 0.9745142, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2605, 2587, 2603, 2563, 2462, 2372, 2064, 1892, 1698, 1367, 1263, 2330], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 5], 'pruned_params': 25458036, 'remaining_params': 59559564, 'pruned_model_sparsity': 0.2994443032971996, 'expected_sparsity': 0.29844, 'target_sparsity': 0.3134328358208955, 'step': 2900}


Iteration:  82%|████████▏ | 220/268 [00:40<00:35,  1.34it/s][A04/21/2024 13:32:31 - INFO - trainer.trainer_mod - v4 Global step: 2900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:40<00:26,  1.76it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:20,  2.28it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:15,  2.83it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:12,  3.47it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:10,  4.12it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:08,  4.70it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:07,  5.20it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:07,  5.59it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:06,  6.01it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:06,  6.29it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.68it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.08it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.34it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.39it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.29it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.36it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.36it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.43it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.00it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.02it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.27it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.31it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.42it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.36it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.53it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.42it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.37it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.33it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.26it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.30it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.77it/s][A04/21/2024 13:32:37 - INFO - trainer.trainer_mod - Epoch 10 finished. Took 46.98 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.70it/s]
Epoch:  11%|█         | 11/100 [08:40<1:10:26, 47.49s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.71it/s][A[INFO|trainer.py:570] 2024-04-21 13:32:38,014 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:32:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:32:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:32:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:32:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:32:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:32:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3445701425811254, 'eval_loss': 1.1963172, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2599, 2581, 2598, 2557, 2453, 2362, 2044, 1868, 1669, 1365, 1252, 2273], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 5], 'pruned_params': 25651068, 'remaining_params': 59366532, 'pruned_model_sparsity': 0.30171479787714545, 'expected_sparsity': 0.30108, 'target_sparsity': 0.31902985074626866, 'step': 2950}


Iteration:   1%|          | 2/268 [00:02<05:53,  1.33s/it][A
Iteration:   1%|          | 3/268 [00:02<03:27,  1.28it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:19,  1.90it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:41,  2.58it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:19,  3.29it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:05,  4.01it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:54,  4.74it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:49,  5.27it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:44,  5.77it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:41,  6.18it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:39,  6.50it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:37,  6.76it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:36,  6.95it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:35,  7.13it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:35,  7.16it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:34,  7.25it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.33it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.27it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:32,  7.54it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.30it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:33,  7.37it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.44it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.48it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.48it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.37it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.28it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.53it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.51it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.21it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.22it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.25it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:33,  6.94it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.96it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.10it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.14it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.99it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.19it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.24it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.14it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.01it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.13it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.16it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.23it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.29it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 13:32:46,882 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:32:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:32:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:32:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:32:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:32:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:32:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3299070845681656, 'eval_loss': 1.3817103, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2593, 2575, 2594, 2551, 2446, 2354, 2030, 1852, 1645, 1362, 1242, 2210], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 5], 'pruned_params': 25805800, 'remaining_params': 59211800, 'pruned_model_sparsity': 0.3035347975007528, 'expected_sparsity': 0.30325, 'target_sparsity': 0.32462686567164173, 'step': 3000}


Iteration:  19%|█▉        | 52/268 [00:11<02:40,  1.34it/s][A04/21/2024 13:32:48 - INFO - trainer.trainer_mod - v4 Global step: 3000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:01,  1.78it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:32,  2.31it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:14,  2.87it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:01,  3.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:50,  4.15it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:43,  4.83it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:39,  5.23it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:35,  5.79it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:34,  6.08it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:32,  6.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:28,  7.06it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:28,  7.19it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:27,  7.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.33it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:26,  7.48it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.37it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.22it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.28it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.36it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.17it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.20it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.15it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.18it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  7.03it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.04it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.11it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.09it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.16it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.20it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.11it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.12it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.15it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.19it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.18it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.05it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.11it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:25,  6.65it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.84it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:24,  6.95it/s][A[INFO|trainer.py:570] 2024-04-21 13:32:55,861 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:32:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:32:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:32:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:32:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 13:32:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:32:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34421281878658366, 'eval_loss': 1.3024822, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2584, 2568, 2587, 2543, 2435, 2342, 2012, 1827, 1618, 1359, 1231, 2138], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 5], 'pruned_params': 26012620, 'remaining_params': 59004980, 'pruned_model_sparsity': 0.30596747026498045, 'expected_sparsity': 0.30622, 'target_sparsity': 0.3302238805970149, 'step': 3050}


Iteration:  38%|███▊      | 102/268 [00:20<02:04,  1.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:33,  1.76it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<01:12,  2.27it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:57,  2.86it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:46,  3.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:38,  4.15it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:33,  4.78it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:30,  5.28it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:27,  5.74it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.48it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.63it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.83it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:21,  7.03it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:21,  7.16it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:19,  7.51it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:19,  7.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:19,  7.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:18,  7.73it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.57it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:19,  7.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.44it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.35it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.17it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  6.99it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.97it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.10it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.18it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.38it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.37it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.35it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.37it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.34it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.24it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.17it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.50it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.42it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.36it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 13:33:04,702 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:33:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:33:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:33:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:33:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:33:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:33:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.28277167067783143, 'eval_loss': 1.2529001, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2578, 2559, 2580, 2534, 2425, 2331, 1994, 1806, 1594, 1354, 1221, 2059], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 5], 'pruned_params': 26400216, 'remaining_params': 58617384, 'pruned_model_sparsity': 0.31052647922312554, 'expected_sparsity': 0.30915, 'target_sparsity': 0.33582089552238803, 'step': 3100}


Iteration:  57%|█████▋    | 152/268 [00:28<01:26,  1.35it/s][A04/21/2024 13:33:06 - INFO - trainer.trainer_mod - v4 Global step: 3100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:29<01:05,  1.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:50,  2.27it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:39,  2.86it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:31,  3.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:26,  4.15it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:23,  4.73it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:20,  5.23it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:19,  5.58it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.02it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.29it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.62it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.78it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.91it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.09it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  7.10it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:13,  7.25it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.20it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.28it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.24it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:12,  7.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.38it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.28it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.30it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.29it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.30it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.19it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.22it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.21it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.22it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.05it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  6.95it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.09it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.15it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.22it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.26it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.14it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 13:33:13,678 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:33:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:33:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:33:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:33:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:33:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:33:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.29334895905980624, 'eval_loss': 1.3362492, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2570, 2552, 2573, 2527, 2414, 2321, 1977, 1786, 1569, 1349, 1209, 1973], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 5], 'pruned_params': 26590184, 'remaining_params': 58427416, 'pruned_model_sparsity': 0.3127609342065643, 'expected_sparsity': 0.31207, 'target_sparsity': 0.3414179104477612, 'step': 3150}


Iteration:  75%|███████▌  | 202/268 [00:37<00:49,  1.33it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:37,  1.75it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:28,  2.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:22,  2.83it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:17,  3.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:14,  4.11it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:12,  4.68it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:11,  5.23it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:10,  5.73it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:09,  6.15it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.75it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.98it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.17it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.27it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:06,  7.47it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.25it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.43it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.40it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.37it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.33it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.23it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.42it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.28it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 13:33:22,521 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:33:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:33:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:33:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:33:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 13:33:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:33:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2835704013245166, 'eval_loss': 1.3261719, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2564, 2546, 2569, 2522, 2408, 2315, 1966, 1772, 1546, 1344, 1197, 1877], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 5], 'pruned_params': 26732660, 'remaining_params': 58284940, 'pruned_model_sparsity': 0.31443677544414333, 'expected_sparsity': 0.31459, 'target_sparsity': 0.3470149253731343, 'step': 3200}


Iteration:  94%|█████████▍| 252/268 [00:46<00:11,  1.34it/s][A04/21/2024 13:33:24 - INFO - trainer.trainer_mod - v4 Global step: 3200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:46<00:08,  1.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:06,  2.28it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:04,  2.88it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:03,  3.55it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:02,  4.20it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:02,  4.76it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  5.29it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  5.72it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.07it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.36it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.68it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.79it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.00it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.05it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.08it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.67it/s][A04/21/2024 13:33:26 - INFO - trainer.trainer_mod - Epoch 11 finished. Took 49.0 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.47it/s]
Epoch:  12%|█▏        | 12/100 [09:29<1:10:19, 47.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.43it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.50it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.52it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.38it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.37it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.29it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.32it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.43it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.38it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.50it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.26it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.48it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.50it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.24it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:34,  7.14it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.07it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.93it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  6.96it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.05it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.14it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.23it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.16it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 13:33:31,397 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:33:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:33:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:33:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:33:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 13:33:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:33:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.310120296219058, 'eval_loss': 1.2599244, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2556, 2539, 2562, 2515, 2399, 2307, 1949, 1752, 1522, 1339, 1185, 1772], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12, 5], 'pruned_params': 27111064, 'remaining_params': 57906536, 'pruned_model_sparsity': 0.3188876656127672, 'expected_sparsity': 0.31769, 'target_sparsity': 0.35261194029850745, 'step': 3250}


Iteration:  13%|█▎        | 34/268 [00:06<02:54,  1.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:11,  1.78it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:41,  2.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:20,  2.86it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:06,  3.48it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:55,  4.16it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:48,  4.72it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:43,  5.27it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:39,  5.75it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:36,  6.08it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.29it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.60it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.83it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.93it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.12it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.34it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.56it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.30it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.35it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.06it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.19it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.13it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.24it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.42it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.21it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.23it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.39it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.23it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.18it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.25it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.29it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 13:33:40,297 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:33:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:33:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:33:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:33:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:33:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:33:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2867342894727092, 'eval_loss': 1.3834963, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2549, 2533, 2559, 2511, 2391, 2300, 1940, 1740, 1503, 1333, 1173, 1662], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12, 5], 'pruned_params': 27244348, 'remaining_params': 57773252, 'pruned_model_sparsity': 0.3204553880608251, 'expected_sparsity': 0.31984, 'target_sparsity': 0.3582089552238806, 'step': 3300}


Iteration:  31%|███▏      | 84/268 [00:15<02:17,  1.34it/s][A04/21/2024 13:33:42 - INFO - trainer.trainer_mod - v4 Global step: 3300, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:43,  1.77it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:19,  2.28it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:03,  2.86it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:52,  3.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:43,  4.11it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:37,  4.73it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:33,  5.29it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:30,  5.71it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:29,  6.03it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.93it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.01it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.12it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.34it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.18it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.13it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.21it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.13it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.98it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.22it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.19it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.17it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  6.91it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.14it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:21,  7.02it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:21,  6.99it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  6.97it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:20,  7.25it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.18it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.18it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.15it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.15it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.18it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.21it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.16it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.02it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  6.93it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  6.94it/s][A[INFO|trainer.py:570] 2024-04-21 13:33:49,288 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:33:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:33:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:33:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:33:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:33:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:33:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3395243854719714, 'eval_loss': 1.1708777, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2542, 2527, 2554, 2504, 2384, 2294, 1930, 1726, 1482, 1328, 1160, 1548], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12, 5], 'pruned_params': 27391420, 'remaining_params': 57626180, 'pruned_model_sparsity': 0.3221852886931647, 'expected_sparsity': 0.32208, 'target_sparsity': 0.3638059701492537, 'step': 3350}


Iteration:  50%|█████     | 134/268 [00:24<01:40,  1.33it/s][A
Iteration:  50%|█████     | 135/268 [00:24<01:15,  1.76it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:57,  2.28it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:46,  2.83it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:37,  3.48it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:31,  4.09it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:27,  4.67it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:24,  5.11it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:22,  5.64it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:20,  5.99it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:19,  6.39it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.62it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  6.85it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.05it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.31it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.49it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.51it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.49it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.47it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.38it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.39it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.40it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.35it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.33it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.23it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.25it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.19it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.25it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.30it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.09it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.15it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.40it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.36it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.25it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.27it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.26it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.17it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.09it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 13:33:58,198 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:33:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:33:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:33:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:33:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:34:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:34:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34763727465101074, 'eval_loss': 0.9981377, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2533, 2519, 2548, 2495, 2373, 2282, 1910, 1703, 1455, 1321, 1145, 1430], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12, 5], 'pruned_params': 27605900, 'remaining_params': 57411700, 'pruned_model_sparsity': 0.32470806044866, 'expected_sparsity': 0.32505, 'target_sparsity': 0.3694029850746268, 'step': 3400}


Iteration:  69%|██████▊   | 184/268 [00:33<01:02,  1.34it/s][A04/21/2024 13:34:00 - INFO - trainer.trainer_mod - v4 Global step: 3400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:33<00:46,  1.77it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:35,  2.30it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:27,  2.90it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:22,  3.55it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:18,  4.23it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:16,  4.84it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:14,  5.40it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:12,  5.96it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:12,  6.15it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.60it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.91it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.12it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.29it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.25it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.41it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.42it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.47it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.62it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.36it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.36it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:07,  7.51it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.58it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.48it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.39it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.26it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.27it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.19it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.25it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.26it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.30it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.11it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.17it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.25it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.27it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.29it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.53it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.60it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 13:34:06,977 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:34:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:34:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:34:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:34:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:34:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:34:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37351343547842825, 'eval_loss': 1.0999665, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2522, 2511, 2541, 2487, 2365, 2272, 1894, 1683, 1430, 1313, 1130, 1313], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12, 5], 'pruned_params': 27801996, 'remaining_params': 57215604, 'pruned_model_sparsity': 0.3270145946251129, 'expected_sparsity': 0.32791, 'target_sparsity': 0.375, 'step': 3450}


Iteration:  87%|████████▋ | 234/268 [00:42<00:25,  1.35it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:18,  1.78it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:13,  2.31it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:10,  2.90it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:08,  3.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:06,  4.19it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:05,  4.82it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  5.44it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:04,  5.91it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  6.22it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.55it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.96it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.01it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.29it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.43it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.42it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.27it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.32it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.39it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.26it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.30it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.70it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.60it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  6.95it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.51it/s][A04/21/2024 13:34:13 - INFO - trainer.trainer_mod - Epoch 12 finished. Took 46.85 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.72it/s]
Epoch:  13%|█▎        | 13/100 [10:15<1:09:02, 47.62s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.38it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.40it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.22it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.07it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.15it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.08it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.03it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.11it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.05it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 13:34:15,810 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:34:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:34:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:34:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:34:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 13:34:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:34:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2997128492131464, 'eval_loss': 1.3223032, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2511, 2501, 2534, 2480, 2356, 2264, 1879, 1668, 1409, 1305, 1115, 1198], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12, 4], 'pruned_params': 27982772, 'remaining_params': 57034828, 'pruned_model_sparsity': 0.3291409308190304, 'expected_sparsity': 0.33079, 'target_sparsity': 0.3805970149253732, 'step': 3500}


Iteration:   6%|▌         | 16/268 [00:04<03:08,  1.33it/s][A04/21/2024 13:34:17 - INFO - trainer.trainer_mod - v4 Global step: 3500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:21,  1.77it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:49,  2.29it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:27,  2.84it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:12,  3.43it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:01,  4.00it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:53,  4.58it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:47,  5.18it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:42,  5.70it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:39,  6.16it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.51it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:36,  6.61it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.78it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.91it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.07it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.19it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.30it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.36it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.44it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.46it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.47it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.32it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.10it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.13it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.16it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.11it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.19it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.25it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.14it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.08it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.96it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.04it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.04it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.03it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.01it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.10it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.13it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.25it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.19it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.31it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.44it/s][A[INFO|trainer.py:570] 2024-04-21 13:34:24,767 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:34:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:34:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:34:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:34:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:34:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:34:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.31587478054813495, 'eval_loss': 1.292543, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2500, 2491, 2526, 2473, 2346, 2253, 1864, 1650, 1386, 1295, 1099, 1087], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 12, 11, 10, 12, 4], 'pruned_params': 28572592, 'remaining_params': 56445008, 'pruned_model_sparsity': 0.3360785531466426, 'expected_sparsity': 0.33372, 'target_sparsity': 0.38619402985074625, 'step': 3550}


Iteration:  25%|██▍       | 66/268 [00:13<02:29,  1.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:52,  1.79it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:26,  2.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:08,  2.91it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:55,  3.55it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:47,  4.19it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:40,  4.78it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:36,  5.33it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:33,  5.81it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:30,  6.23it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.58it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.87it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.07it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.23it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.31it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.36it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.41it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.18it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.69it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.91it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.06it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.15it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.18it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.24it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.27it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.29it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.17it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.35it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.33it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.18it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.24it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.27it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.13it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.18it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.29it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.21it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.25it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.12it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.10it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.08it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.13it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 13:34:33,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:34:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:34:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:34:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:34:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 13:34:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:34:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.32915500143122983, 'eval_loss': 1.2910991, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2489, 2480, 2518, 2462, 2334, 2239, 1845, 1631, 1362, 1285, 1082, 983], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 12, 11, 10, 12, 4], 'pruned_params': 28796264, 'remaining_params': 56221336, 'pruned_model_sparsity': 0.3387094436916591, 'expected_sparsity': 0.33713, 'target_sparsity': 0.3917910447761194, 'step': 3600}


Iteration:  43%|████▎     | 116/268 [00:22<01:53,  1.34it/s][A04/21/2024 13:34:35 - INFO - trainer.trainer_mod - v4 Global step: 3600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:22<01:25,  1.77it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<01:05,  2.29it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:51,  2.89it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:41,  3.53it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:35,  4.18it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:30,  4.76it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:27,  5.21it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:25,  5.72it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:23,  6.10it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.61it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.89it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.20it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.33it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.53it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:17,  7.52it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:17,  7.53it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.50it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.39it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.43it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.43it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.28it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.03it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.14it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.09it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.07it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.13it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.10it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.46it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.17it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.21it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.05it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.13it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.20it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.13it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.21it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.25it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.14it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.31it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.25it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 13:34:42,587 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:34:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:34:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:34:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:34:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 13:34:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:34:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.33770593521082093, 'eval_loss': 1.2526916, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2476, 2466, 2507, 2451, 2320, 2223, 1820, 1608, 1332, 1274, 1062, 884], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 12, 11, 10, 12, 3], 'pruned_params': 29067428, 'remaining_params': 55950172, 'pruned_model_sparsity': 0.3418989479825354, 'expected_sparsity': 0.34114, 'target_sparsity': 0.39738805970149255, 'step': 3650}


Iteration:  62%|██████▏   | 166/268 [00:31<01:15,  1.34it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:57,  1.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:43,  2.28it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:34,  2.87it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:27,  3.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:22,  4.22it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:20,  4.74it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:17,  5.32it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:15,  5.92it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.32it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.64it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.91it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.08it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.18it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.40it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:10,  7.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.59it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.53it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.47it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.55it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.32it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.23it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.26it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.10it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.95it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.04it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  6.95it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.05it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.15it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.18it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.22it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.22it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.24it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.27it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 13:34:51,465 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:34:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:34:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:34:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:34:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 13:34:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:34:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3411498010721042, 'eval_loss': 1.0778505, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2464, 2456, 2498, 2440, 2308, 2211, 1801, 1587, 1307, 1262, 1043, 797], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 12, 11, 10, 12, 3], 'pruned_params': 29297228, 'remaining_params': 55720372, 'pruned_model_sparsity': 0.3446019177205661, 'expected_sparsity': 0.34463, 'target_sparsity': 0.40298507462686567, 'step': 3700}


Iteration:  81%|████████  | 216/268 [00:39<00:38,  1.34it/s][A04/21/2024 13:34:53 - INFO - trainer.trainer_mod - v4 Global step: 3700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:40<00:28,  1.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:21,  2.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:17,  2.87it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:13,  3.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:11,  4.21it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:09,  4.81it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:08,  5.26it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:07,  5.73it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:07,  6.09it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.44it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  6.84it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.01it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.16it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.29it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.35it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.44it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.42it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.54it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:03,  7.64it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.42it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.18it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.20it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.99it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.07it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.14it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.07it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.14it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.01it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.09it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.06it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.78it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.92it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.19it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.24it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.16it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.08it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.24it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.24it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.09it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.13it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 13:35:00,390 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:35:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:35:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:35:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:35:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:35:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:35:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35228130978517885, 'eval_loss': 1.1762702, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2450, 2442, 2487, 2429, 2293, 2194, 1781, 1562, 1281, 1248, 1023, 720], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 12, 11, 10, 12, 3], 'pruned_params': 29562264, 'remaining_params': 55455336, 'pruned_model_sparsity': 0.3477193428184282, 'expected_sparsity': 0.34864, 'target_sparsity': 0.4085820895522388, 'step': 3750}


Iteration:  99%|█████████▉| 266/268 [00:48<00:01,  1.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  1.78it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  2.36it/s][A04/21/2024 13:35:02 - INFO - trainer.trainer_mod - Epoch 13 finished. Took 49.07 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.46it/s]
Epoch:  14%|█▍        | 14/100 [11:05<1:08:52, 48.06s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.36it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.40it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.25it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.33it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.33it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.30it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.58it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.70it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.71it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.62it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.71it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.59it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.40it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.30it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.33it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.25it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.20it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.24it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.13it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.01it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  6.95it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  7.05it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.30it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.30it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.32it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.09it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.14it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.10it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.11it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.42it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.39it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:29,  7.48it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:29,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 13:35:09,218 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:35:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:35:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:35:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:35:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 13:35:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:35:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36884476499323265, 'eval_loss': 1.2800032, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2436, 2429, 2477, 2416, 2278, 2181, 1761, 1536, 1256, 1235, 1004, 650], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 12, 11, 10, 12, 2], 'pruned_params': 29819640, 'remaining_params': 55197960, 'pruned_model_sparsity': 0.3507466689250226, 'expected_sparsity': 0.35273, 'target_sparsity': 0.41417910447761197, 'step': 3800}


Iteration:  18%|█▊        | 48/268 [00:08<02:43,  1.35it/s][A04/21/2024 13:35:11 - INFO - trainer.trainer_mod - v4 Global step: 3800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<02:03,  1.77it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:35,  2.29it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:15,  2.89it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:01,  3.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:51,  4.18it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:44,  4.81it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:38,  5.50it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:35,  5.91it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:33,  6.23it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.78it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.01it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.18it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.35it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.22it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.20it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.54it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.59it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.51it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.27it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.26it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.08it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.13it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.12it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.09it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:25,  7.11it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.21it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.25it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.39it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.28it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.30it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.42it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:22,  7.53it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:22,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 13:35:18,048 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:35:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:35:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:35:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:35:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 13:35:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:35:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3655731737420248, 'eval_loss': 1.3638397, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2422, 2418, 2467, 2407, 2265, 2168, 1742, 1514, 1233, 1220, 986, 585], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 12, 11, 10, 12, 2], 'pruned_params': 30052504, 'remaining_params': 54965096, 'pruned_model_sparsity': 0.3534856782595604, 'expected_sparsity': 0.3567, 'target_sparsity': 0.41977611940298504, 'step': 3850}


Iteration:  37%|███▋      | 98/268 [00:17<02:06,  1.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:35,  1.78it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:13,  2.30it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:57,  2.88it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:47,  3.52it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:39,  4.14it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:34,  4.78it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:30,  5.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:28,  5.75it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:25,  6.20it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:24,  6.64it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:23,  6.87it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.06it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.21it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.19it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:19,  7.57it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.55it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.40it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.31it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.32it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:20,  7.05it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.16it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.00it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.34it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.36it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.40it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.37it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.37it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.37it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.28it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.31it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.33it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.23it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.18it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.21it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:17,  7.16it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:17,  7.22it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.24it/s][A
Iteration:  55%|█████▍    | 147/268 [00:24<00:16,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 13:35:26,935 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:35:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:35:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:35:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:35:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:35:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:35:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39217597803846416, 'eval_loss': 1.1359497, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2406, 2402, 2454, 2392, 2249, 2151, 1719, 1489, 1211, 1205, 968, 527], 'head_nums': [12, 10, 12, 12, 11, 12, 12, 12, 11, 9, 12, 2], 'pruned_params': 30721988, 'remaining_params': 54295612, 'pruned_model_sparsity': 0.36136033009635654, 'expected_sparsity': 0.36192, 'target_sparsity': 0.4253731343283582, 'step': 3900}


Iteration:  55%|█████▌    | 148/268 [00:26<01:30,  1.33it/s][A04/21/2024 13:35:28 - INFO - trainer.trainer_mod - v4 Global step: 3900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:26<01:07,  1.77it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:51,  2.29it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:41,  2.85it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:32,  3.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:27,  4.22it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:23,  4.79it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:21,  5.37it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:19,  5.65it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:19,  5.71it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:17,  6.16it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:17,  6.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:16,  6.70it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  6.91it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.08it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.19it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.35it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:14,  7.19it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.20it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.06it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.12it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:13,  7.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.14it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.37it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.11it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.29it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.27it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.31it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:12,  6.83it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.12it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.18it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.22it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:11,  7.22it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.24it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.27it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.06it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:10,  7.08it/s][A
Iteration:  73%|███████▎  | 196/268 [00:32<00:10,  7.15it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 13:35:35,919 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:35:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:35:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:35:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:35:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 13:35:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:35:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3279225732081363, 'eval_loss': 1.0905787, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2390, 2386, 2440, 2377, 2234, 2135, 1695, 1464, 1187, 1188, 947, 478], 'head_nums': [12, 10, 11, 12, 11, 12, 12, 12, 11, 9, 11, 2], 'pruned_params': 31399132, 'remaining_params': 53618468, 'pruned_model_sparsity': 0.36932508092442035, 'expected_sparsity': 0.36828, 'target_sparsity': 0.43097014925373134, 'step': 3950}


Iteration:  74%|███████▍  | 198/268 [00:35<00:52,  1.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:39,  1.76it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:29,  2.29it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:23,  2.90it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:18,  3.55it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:15,  4.20it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:13,  4.84it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:11,  5.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:10,  5.92it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.88it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  6.87it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.05it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.93it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.98it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.16it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.26it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.32it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.21it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.03it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.15it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.57it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.21it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.37it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.56it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.45it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.28it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.28it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.25it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:05,  7.14it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.17it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.04it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.10it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.07it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.17it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.10it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:04,  7.19it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.06it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.30it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.27it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.25it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.26it/s][A
Iteration:  91%|█████████▏| 245/268 [00:41<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 246/268 [00:41<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:35:44,798 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:35:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:35:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:35:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:35:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:35:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:35:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3471101004870147, 'eval_loss': 1.0294125, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2374, 2371, 2429, 2364, 2218, 2117, 1670, 1435, 1162, 1171, 924, 435], 'head_nums': [12, 10, 11, 12, 11, 12, 12, 12, 11, 8, 11, 2], 'pruned_params': 31887840, 'remaining_params': 53129760, 'pruned_model_sparsity': 0.375073396567299, 'expected_sparsity': 0.37419, 'target_sparsity': 0.4365671641791045, 'step': 4000}


Iteration:  93%|█████████▎| 248/268 [00:44<00:14,  1.35it/s][A04/21/2024 13:35:46 - INFO - trainer.trainer_mod - v4 Global step: 4000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:44<00:10,  1.78it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:07,  2.29it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:05,  2.88it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:04,  3.50it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:03,  4.16it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  4.73it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  5.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:02,  5.69it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.15it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  6.98it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.13it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.16it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.32it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.36it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.95it/s][A04/21/2024 13:35:49 - INFO - trainer.trainer_mod - Epoch 14 finished. Took 46.88 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.72it/s]
Epoch:  15%|█▌        | 15/100 [11:51<1:07:34, 47.70s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.93it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.12it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.19it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.24it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.18it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.23it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.15it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.19it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.04it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  7.03it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.91it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.18it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.24it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.13it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.10it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:35,  7.03it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.93it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.04it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.12it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.01it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.12it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.19it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.21it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 13:35:53,735 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:35:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:35:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:35:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:35:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:35:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:35:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.33268013542291797, 'eval_loss': 1.222094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2358, 2357, 2418, 2350, 2202, 2100, 1650, 1413, 1141, 1153, 901, 398], 'head_nums': [12, 10, 11, 12, 11, 12, 12, 12, 11, 8, 11, 2], 'pruned_params': 32154408, 'remaining_params': 52863192, 'pruned_model_sparsity': 0.37820884146341466, 'expected_sparsity': 0.37899, 'target_sparsity': 0.4421641791044776, 'step': 4050}


Iteration:  11%|█         | 30/268 [00:06<02:57,  1.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:13,  1.77it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:42,  2.31it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:20,  2.92it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:06,  3.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:55,  4.19it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:48,  4.82it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:43,  5.34it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:39,  5.86it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.28it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.63it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.78it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.90it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.90it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.22it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.20it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.30it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.38it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.39it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.52it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.29it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.12it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.82it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.99it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.01it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.09it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.20it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.11it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  6.86it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  7.00it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.08it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.08it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.31it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.31it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.31it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.10it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.20it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 13:36:02,640 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:36:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:36:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:36:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:36:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 13:36:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:36:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3431008904390327, 'eval_loss': 1.209993, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2341, 2341, 2406, 2335, 2186, 2082, 1624, 1383, 1117, 1133, 881, 370], 'head_nums': [12, 10, 11, 12, 11, 12, 12, 12, 11, 8, 11, 2], 'pruned_params': 32451616, 'remaining_params': 52565984, 'pruned_model_sparsity': 0.38170468232460103, 'expected_sparsity': 0.38419, 'target_sparsity': 0.44776119402985076, 'step': 4100}


Iteration:  30%|██▉       | 80/268 [00:15<02:19,  1.34it/s][A04/21/2024 13:36:04 - INFO - trainer.trainer_mod - v4 Global step: 4100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:15<01:45,  1.78it/s][A
Iteration:  31%|███       | 82/268 [00:15<01:20,  2.30it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:04,  2.87it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:52,  3.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:44,  4.16it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:37,  4.80it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:33,  5.39it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:30,  5.89it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:28,  6.24it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.59it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.84it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  7.00it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.14it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.28it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.22it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.14it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.10it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.45it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.41it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.36it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.38it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.33it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.35it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:20,  7.55it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.46it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.25it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.18it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.13it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.09it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.17it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.13it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.19it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.25it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.31it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.15it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.30it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.32it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.36it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.37it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 13:36:11,483 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:36:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:36:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:36:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:36:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:36:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:36:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3467430027609855, 'eval_loss': 1.245917, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2326, 2329, 2394, 2321, 2172, 2068, 1606, 1363, 1099, 1114, 860, 346], 'head_nums': [12, 10, 11, 12, 11, 11, 12, 12, 11, 8, 11, 2], 'pruned_params': 32889768, 'remaining_params': 52127832, 'pruned_model_sparsity': 0.3868583446251129, 'expected_sparsity': 0.38894, 'target_sparsity': 0.45335820895522383, 'step': 4150}


Iteration:  49%|████▊     | 130/268 [00:23<01:42,  1.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<01:16,  1.78it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:59,  2.30it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:46,  2.92it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:37,  3.56it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:31,  4.21it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:27,  4.85it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:24,  5.33it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:22,  5.69it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:21,  6.08it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.98it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.06it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.51it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:15,  7.63it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.38it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.53it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.34it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.32it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.30it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.34it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.34it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.21it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.38it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.26it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.18it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.22it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.27it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.06it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.12it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.07it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.13it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.19it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.32it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.35it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.28it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 13:36:20,343 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:36:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:36:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:36:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:36:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:36:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:36:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42811609314317156, 'eval_loss': 1.160511, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2310, 2314, 2380, 2309, 2157, 2052, 1586, 1343, 1078, 1094, 839, 327], 'head_nums': [12, 10, 11, 11, 11, 11, 12, 12, 10, 8, 10, 2], 'pruned_params': 33738496, 'remaining_params': 51279104, 'pruned_model_sparsity': 0.396841312857573, 'expected_sparsity': 0.39497, 'target_sparsity': 0.458955223880597, 'step': 4200}


Iteration:  67%|██████▋   | 180/268 [00:32<01:05,  1.35it/s][A04/21/2024 13:36:22 - INFO - trainer.trainer_mod - v4 Global step: 4200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:32<00:48,  1.78it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:37,  2.27it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:29,  2.88it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:23,  3.56it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:19,  4.19it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:17,  4.81it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:14,  5.46it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:13,  5.89it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:12,  6.21it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.87it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  6.97it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.11it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.23it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.31it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.39it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.32it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.18it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.23it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.21it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.11it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.13it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.03it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.14it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.20it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.25it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.30it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.23it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.24it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.25it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  6.91it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.02it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.29it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.43it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.38it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 13:36:29,257 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:36:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:36:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:36:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:36:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:36:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:36:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3530432199947466, 'eval_loss': 1.1216617, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2294, 2300, 2369, 2296, 2144, 2038, 1570, 1325, 1059, 1073, 819, 310], 'head_nums': [12, 10, 10, 11, 11, 11, 12, 12, 10, 8, 10, 2], 'pruned_params': 34170520, 'remaining_params': 50847080, 'pruned_model_sparsity': 0.40192289596507075, 'expected_sparsity': 0.40013, 'target_sparsity': 0.46455223880597013, 'step': 4250}


Iteration:  86%|████████▌ | 230/268 [00:41<00:28,  1.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:20,  1.77it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:15,  2.28it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:12,  2.87it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:09,  3.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:07,  4.15it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:06,  4.79it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:05,  5.31it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:05,  5.82it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.25it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.79it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.82it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.01it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.05it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.19it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.25it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.34it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.36it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.33it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.18it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.13it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.29it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.21it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.35it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.34it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.30it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.28it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.77it/s][A04/21/2024 13:36:36 - INFO - trainer.trainer_mod - Epoch 15 finished. Took 46.93 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.71it/s]
Epoch:  16%|█▌        | 16/100 [12:38<1:06:27, 47.47s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  7.00it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.84it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.46it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.41it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.37it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.12it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.91it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 13:36:38,156 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:36:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:36:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:36:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:36:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 13:36:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:36:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38402176493875145, 'eval_loss': 1.1035929, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2278, 2284, 2356, 2281, 2127, 2020, 1549, 1300, 1036, 1052, 798, 295], 'head_nums': [12, 10, 10, 11, 11, 11, 12, 12, 10, 8, 10, 1], 'pruned_params': 34453940, 'remaining_params': 50563660, 'pruned_model_sparsity': 0.4052565586419753, 'expected_sparsity': 0.40594, 'target_sparsity': 0.4701492537313433, 'step': 4300}


Iteration:   4%|▍         | 12/268 [00:03<03:14,  1.31it/s][A04/21/2024 13:36:40 - INFO - trainer.trainer_mod - v4 Global step: 4300, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:26,  1.74it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:51,  2.27it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:28,  2.87it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:11,  3.55it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:59,  4.19it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:52,  4.75it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:46,  5.40it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:42,  5.88it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:39,  6.23it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.67it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.79it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.88it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.08it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.10it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.00it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.19it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.13it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.31it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.31it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.23it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.14it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.19it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.16it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.12it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.20it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.25it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.28it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.31it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.38it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.58it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.48it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.54it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.52it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.36it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 13:36:47,000 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:36:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:36:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:36:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:36:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:36:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:36:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4283763421190625, 'eval_loss': 1.0541648, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2262, 2268, 2343, 2267, 2112, 2005, 1532, 1280, 1017, 1030, 779, 281], 'head_nums': [12, 10, 10, 11, 11, 11, 12, 12, 10, 8, 9, 1], 'pruned_params': 34901284, 'remaining_params': 50116316, 'pruned_model_sparsity': 0.4105183397320084, 'expected_sparsity': 0.41168, 'target_sparsity': 0.4757462686567164, 'step': 4350}


Iteration:  23%|██▎       | 62/268 [00:12<02:33,  1.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:55,  1.77it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:28,  2.31it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<01:09,  2.91it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:56,  3.56it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:47,  4.22it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:40,  4.91it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:36,  5.49it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:33,  5.99it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.28it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.63it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.00it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  7.16it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.18it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.28it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.54it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.55it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.57it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.54it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:24,  7.70it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:24,  7.58it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.25it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.26it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.15it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.19it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  7.15it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.21it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.16it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.21it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.32it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.33it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.34it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.12it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.39it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.27it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.27it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 13:36:55,787 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:36:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:36:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:36:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:36:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 13:36:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:36:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45899956308724216, 'eval_loss': 1.0120572, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2246, 2253, 2330, 2254, 2097, 1988, 1512, 1256, 998, 1007, 762, 268], 'head_nums': [12, 9, 10, 11, 11, 11, 12, 12, 10, 8, 8, 1], 'pruned_params': 35552384, 'remaining_params': 49465216, 'pruned_model_sparsity': 0.4181767539897621, 'expected_sparsity': 0.41768, 'target_sparsity': 0.48134328358208955, 'step': 4400}


Iteration:  42%|████▏     | 112/268 [00:21<01:55,  1.35it/s][A04/21/2024 13:36:57 - INFO - trainer.trainer_mod - v4 Global step: 4400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:21<01:27,  1.78it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<01:06,  2.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:52,  2.90it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:42,  3.56it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:36,  4.15it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:31,  4.79it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:27,  5.36it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:25,  5.84it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:23,  6.37it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.53it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  6.92it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.36it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.45it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.61it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.57it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.50it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.41it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.27it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.31it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.28it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.26it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.28it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.08it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.34it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.12it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  6.97it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  7.07it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.12it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.14it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.12it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.15it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  7.01it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.11it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.19it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.20it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.26it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.18it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.37it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 13:37:04,638 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:37:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:37:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:37:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:37:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 13:37:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:37:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43368079638717794, 'eval_loss': 1.059646, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2229, 2237, 2319, 2240, 2084, 1973, 1495, 1238, 981, 984, 745, 256], 'head_nums': [12, 9, 10, 11, 11, 11, 12, 12, 10, 8, 8, 1], 'pruned_params': 35789844, 'remaining_params': 49227756, 'pruned_model_sparsity': 0.4209698227190605, 'expected_sparsity': 0.42307, 'target_sparsity': 0.4869402985074627, 'step': 4450}


Iteration:  60%|██████    | 162/268 [00:30<01:19,  1.34it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:59,  1.77it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:45,  2.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:35,  2.88it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:28,  3.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:24,  4.20it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:20,  4.81it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:18,  5.26it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:16,  5.79it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:15,  6.23it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.58it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.72it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.04it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  7.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.38it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:11,  7.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.26it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.15it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.13it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.16it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.23it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.28it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.48it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.42it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.51it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.24it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.14it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.19it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.15it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.82it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.85it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.11it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.20it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.07it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  6.97it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.16it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.19it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  7.11it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.26it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.36it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.16it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:08,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 13:37:13,553 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:37:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:37:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:37:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:37:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 13:37:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:37:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45569507663230396, 'eval_loss': 1.0635217, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2213, 2222, 2308, 2228, 2070, 1960, 1480, 1222, 965, 961, 731, 245], 'head_nums': [12, 9, 10, 11, 11, 11, 12, 12, 10, 8, 7, 1], 'pruned_params': 36203484, 'remaining_params': 48814116, 'pruned_model_sparsity': 0.4258351682475158, 'expected_sparsity': 0.42901, 'target_sparsity': 0.4925373134328358, 'step': 4500}


Iteration:  79%|███████▉  | 212/268 [00:39<00:41,  1.35it/s][A04/21/2024 13:37:15 - INFO - trainer.trainer_mod - v4 Global step: 4500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:39<00:30,  1.78it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:23,  2.30it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:18,  2.87it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:14,  3.52it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:12,  4.16it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:10,  4.75it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:09,  5.32it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:08,  5.81it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:07,  6.43it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:07,  6.27it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.76it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.08it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.10it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.19it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.19it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.17it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.98it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  7.03it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.05it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.96it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.07it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.13it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  7.23it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.15it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.22it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.23it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.25it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.10it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.19it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.14it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.26it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.24it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.92it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.04it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.14it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.21it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.26it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.20it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 13:37:22,541 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:37:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:37:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:37:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:37:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:37:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:37:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42347249534818765, 'eval_loss': 1.1164842, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2196, 2205, 2293, 2212, 2055, 1942, 1459, 1199, 946, 938, 719, 237], 'head_nums': [11, 9, 9, 11, 11, 11, 12, 12, 10, 8, 6, 1], 'pruned_params': 37056808, 'remaining_params': 47960792, 'pruned_model_sparsity': 0.4358721958747365, 'expected_sparsity': 0.43713, 'target_sparsity': 0.4981343283582089, 'step': 4550}


Iteration:  98%|█████████▊| 262/268 [00:48<00:04,  1.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:02,  1.78it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  2.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:01,  2.88it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  3.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  4.20it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.05it/s][A04/21/2024 13:37:25 - INFO - trainer.trainer_mod - Epoch 16 finished. Took 48.88 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.48it/s]
Epoch:  17%|█▋        | 17/100 [13:27<1:06:15, 47.89s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.11it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.33it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.27it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.29it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.24it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.30it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.40it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.50it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.48it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.46it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.34it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.25it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.09it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.00it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.08it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.17it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.23it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.26it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.26it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.42it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.26it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.31it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.19it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.26it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.17it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.31it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.32it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.10it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.16it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.20it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 13:37:31,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:37:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:37:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:37:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:37:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:37:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:37:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41650989084940443, 'eval_loss': 1.2095609, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2180, 2191, 2281, 2199, 2042, 1930, 1446, 1185, 931, 917, 708, 228], 'head_nums': [11, 8, 9, 11, 11, 11, 12, 12, 10, 8, 5, 1], 'pruned_params': 37652756, 'remaining_params': 47364844, 'pruned_model_sparsity': 0.4428818973953628, 'expected_sparsity': 0.44351, 'target_sparsity': 0.503731343283582, 'step': 4600}


Iteration:  16%|█▋        | 44/268 [00:08<02:46,  1.34it/s][A04/21/2024 13:37:33 - INFO - trainer.trainer_mod - v4 Global step: 4600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:05,  1.78it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:36,  2.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:16,  2.88it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:02,  3.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:52,  4.20it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:44,  4.85it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:40,  5.39it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:36,  5.97it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.36it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.65it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.89it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.07it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.06it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:27,  7.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.17it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.32it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.24it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.20it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.14it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.04it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.16it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.20it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.24it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.16it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.23it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.18it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.11it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.30it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.30it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.32it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.29it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.31it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.32it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.34it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.35it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:24,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 13:37:40,270 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:37:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:37:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:37:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:37:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:37:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:37:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4149980349473221, 'eval_loss': 1.1528422, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2162, 2174, 2268, 2185, 2027, 1914, 1429, 1168, 915, 895, 699, 220], 'head_nums': [11, 8, 9, 11, 11, 11, 11, 12, 10, 8, 4, 1], 'pruned_params': 38277812, 'remaining_params': 46739788, 'pruned_model_sparsity': 0.4502339750828064, 'expected_sparsity': 0.45043, 'target_sparsity': 0.5093283582089552, 'step': 4650}


Iteration:  35%|███▌      | 94/268 [00:16<02:09,  1.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:36,  1.79it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<01:14,  2.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:59,  2.90it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:47,  3.56it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:40,  4.22it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:35,  4.79it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:31,  5.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:30,  5.52it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:27,  6.00it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:26,  6.28it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:24,  6.63it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  6.76it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.07it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.20it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.18it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.24it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.17it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.22it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.24it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.29it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.22it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.26it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.16it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.24it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.29it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:20,  7.20it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.26it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.27it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.29it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.23it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.38it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.38it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.40it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.27it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.28it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.42it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.33it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.10it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  7.15it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:18,  7.01it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.11it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 13:37:49,189 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:37:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:37:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:37:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:37:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:37:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:37:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4691968717259682, 'eval_loss': 1.0381218, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2145, 2159, 2257, 2174, 2015, 1902, 1417, 1154, 901, 873, 689, 214], 'head_nums': [11, 8, 9, 10, 11, 11, 11, 12, 10, 8, 4, 1], 'pruned_params': 38670004, 'remaining_params': 46347596, 'pruned_model_sparsity': 0.45484704343571214, 'expected_sparsity': 0.45604, 'target_sparsity': 0.5149253731343284, 'step': 4700}


Iteration:  54%|█████▎    | 144/268 [00:25<01:32,  1.34it/s][A04/21/2024 13:37:51 - INFO - trainer.trainer_mod - v4 Global step: 4700, Alignment: tensor([3, 7, 8, 9], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:25<01:09,  1.77it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:53,  2.27it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:42,  2.84it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:35,  3.40it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:29,  4.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:25,  4.71it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:22,  5.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:20,  5.66it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:19,  6.04it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:17,  6.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.71it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.92it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.09it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.21it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.23it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.28it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.32it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.12it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.19it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.22it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.14it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  7.04it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.11it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.28it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.32it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.16it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.19it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.06it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.14it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.19it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.37it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.34it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.23it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.27it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.30it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:11,  7.20it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.21it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.15it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.32it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.15it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 13:37:58,146 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:37:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:37:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:37:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:37:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:38:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:38:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42009716240486383, 'eval_loss': 1.0419105, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2129, 2143, 2244, 2161, 2000, 1887, 1402, 1138, 886, 852, 679, 207], 'head_nums': [11, 7, 8, 10, 10, 11, 11, 12, 10, 7, 4, 1], 'pruned_params': 39674996, 'remaining_params': 45342604, 'pruned_model_sparsity': 0.46666803109003313, 'expected_sparsity': 0.46202, 'target_sparsity': 0.5205223880597014, 'step': 4750}


Iteration:  72%|███████▏  | 194/268 [00:34<00:55,  1.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:41,  1.77it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:31,  2.27it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:24,  2.86it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:20,  3.48it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:16,  4.14it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:14,  4.78it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:12,  5.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:11,  5.86it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:10,  6.36it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.65it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.73it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  6.96it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.10it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.13it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.13it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.44it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.17it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.11it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.00it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.13it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.37it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.21it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.21it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.24it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.24it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.24it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.15it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.08it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.16it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.98it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.25it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.10it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.15it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.22it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.27it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.27it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.28it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.29it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 13:38:07,086 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:38:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:38:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:38:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:38:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.80it/s]04/21/2024 13:38:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:38:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4373192805786603, 'eval_loss': 1.1556922, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2110, 2126, 2231, 2147, 1985, 1874, 1387, 1121, 871, 830, 669, 201], 'head_nums': [11, 7, 8, 10, 10, 11, 11, 12, 10, 7, 4, 1], 'pruned_params': 39901732, 'remaining_params': 45115868, 'pruned_model_sparsity': 0.46933496123155677, 'expected_sparsity': 0.46768, 'target_sparsity': 0.5261194029850746, 'step': 4800}


Iteration:  91%|█████████ | 244/268 [00:43<00:17,  1.34it/s][A04/21/2024 13:38:09 - INFO - trainer.trainer_mod - v4 Global step: 4800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:43<00:12,  1.79it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:09,  2.31it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:07,  2.91it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:05,  3.57it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:04,  4.20it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:03,  4.89it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:03,  5.47it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  5.95it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.76it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.13it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.26it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.34it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.44it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.43it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.34it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.36it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.18it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.20it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.77it/s][A04/21/2024 13:38:12 - INFO - trainer.trainer_mod - Epoch 17 finished. Took 46.93 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.71it/s]
Epoch:  18%|█▊        | 18/100 [14:14<1:05:03, 47.61s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.32it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.28it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.24it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.25it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.28it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.26it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.26it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.75it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.92it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.04it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.14it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.19it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.21it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.18it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.13it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.18it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.05it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.13it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.35it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 13:38:15,885 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:38:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:38:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:38:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:38:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:38:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:38:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48304108757820724, 'eval_loss': 0.9912409, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2093, 2110, 2219, 2136, 1972, 1862, 1373, 1107, 857, 810, 658, 195], 'head_nums': [11, 7, 8, 10, 10, 11, 11, 12, 10, 7, 4, 1], 'pruned_params': 40107020, 'remaining_params': 44910580, 'pruned_model_sparsity': 0.47174961419753086, 'expected_sparsity': 0.4723, 'target_sparsity': 0.5317164179104478, 'step': 4850}


Iteration:  10%|▉         | 26/268 [00:05<02:59,  1.35it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:15,  1.78it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:44,  2.29it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:21,  2.92it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:07,  3.55it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:56,  4.22it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:48,  4.85it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:43,  5.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:39,  5.92it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:34,  6.67it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.79it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.86it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.04it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.17it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.28it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.26it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.19it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.04it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.03it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.94it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.96it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.95it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.99it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.13it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.14it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.09it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.08it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.17it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.00it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.08it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.02it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.11it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.18it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.23it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.17it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.11it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.16it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.11it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.14it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.81it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  6.93it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.94it/s][A[INFO|trainer.py:570] 2024-04-21 13:38:24,876 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:38:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:38:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:38:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:38:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:38:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:38:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4939105407308262, 'eval_loss': 0.755855, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2075, 2095, 2207, 2123, 1958, 1847, 1357, 1090, 842, 790, 646, 191], 'head_nums': [11, 7, 8, 10, 10, 11, 11, 12, 10, 7, 4, 1], 'pruned_params': 40332224, 'remaining_params': 44685376, 'pruned_model_sparsity': 0.47439852454080095, 'expected_sparsity': 0.47699, 'target_sparsity': 0.5373134328358209, 'step': 4900}


Iteration:  28%|██▊       | 76/268 [00:14<02:23,  1.34it/s][A04/21/2024 13:38:26 - INFO - trainer.trainer_mod - v4 Global step: 4900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:48,  1.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:22,  2.29it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:05,  2.90it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:53,  3.55it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:44,  4.21it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:39,  4.74it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:34,  5.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:30,  5.97it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.63it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.72it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.11it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.21it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.09it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.07it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.14it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.22it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.26it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.41it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.40it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.48it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.62it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.53it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.35it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.38it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.37it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.21it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.25it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.28it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.24it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.27it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.19it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.24it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.17it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.21it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.13it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.00it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 13:38:33,764 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:38:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:38:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:38:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:38:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:38:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:38:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46658630871955004, 'eval_loss': 1.0482994, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2058, 2078, 2195, 2112, 1947, 1835, 1347, 1079, 830, 771, 635, 187], 'head_nums': [11, 7, 8, 10, 10, 11, 11, 12, 10, 7, 3, 1], 'pruned_params': 40718288, 'remaining_params': 44299312, 'pruned_model_sparsity': 0.47893951370069254, 'expected_sparsity': 0.48113, 'target_sparsity': 0.542910447761194, 'step': 4950}


Iteration:  47%|████▋     | 126/268 [00:23<01:46,  1.34it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<01:20,  1.76it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<01:01,  2.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:48,  2.89it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:38,  3.54it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:32,  4.17it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:28,  4.76it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:25,  5.27it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:23,  5.77it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:21,  6.20it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.68it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  6.90it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  6.97it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.12it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.42it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.29it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.17it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.22it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.24it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.18it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.11it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.12it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.27it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.27it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.29it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.31it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.18it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.08it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.18it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  7.00it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.27it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  6.89it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.93it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.04it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  6.99it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.19it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 13:38:42,703 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:38:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:38:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:38:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:38:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:38:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:38:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38229409879901805, 'eval_loss': 1.1813464, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2043, 2063, 2183, 2101, 1934, 1820, 1332, 1062, 816, 752, 623, 184], 'head_nums': [11, 6, 8, 10, 10, 11, 11, 11, 10, 7, 3, 1], 'pruned_params': 41323428, 'remaining_params': 43694172, 'pruned_model_sparsity': 0.4860573340108401, 'expected_sparsity': 0.48575, 'target_sparsity': 0.5485074626865671, 'step': 5000}


Iteration:  66%|██████▌   | 176/268 [00:32<01:08,  1.34it/s][A04/21/2024 13:38:44 - INFO - trainer.trainer_mod - v4 Global step: 5000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:32<00:51,  1.77it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:39,  2.29it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:30,  2.87it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:24,  3.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:20,  4.19it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:17,  4.82it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:15,  5.33it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:14,  5.81it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:13,  6.23it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:12,  6.62it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.95it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.12it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  7.03it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.05it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.16it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.03it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.13it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.09it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.13it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.16it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.02it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  6.96it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.84it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.96it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.07it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.13it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.26it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.10it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.17it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.33it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.34it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.33it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.24it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.25it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.28it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.17it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.23it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 13:38:51,653 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:38:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:38:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:38:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:38:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:38:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:38:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.480402445933886, 'eval_loss': 0.9995485, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2026, 2049, 2171, 2090, 1923, 1809, 1321, 1049, 804, 733, 613, 180], 'head_nums': [11, 6, 8, 10, 10, 11, 11, 11, 10, 6, 3, 1], 'pruned_params': 41706428, 'remaining_params': 43311172, 'pruned_model_sparsity': 0.49056228357422466, 'expected_sparsity': 0.49036, 'target_sparsity': 0.5541044776119403, 'step': 5050}


Iteration:  84%|████████▍ | 226/268 [00:41<00:31,  1.34it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:23,  1.77it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:17,  2.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:13,  2.90it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:10,  3.50it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:08,  4.14it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:07,  4.78it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:06,  5.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  5.85it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.55it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.80it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.82it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.01it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.16it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.06it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.11it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.13it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.16it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.11it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.16it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.10it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.20it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.24it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.27it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.29it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.13it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.35it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.44it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.41it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.28it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.87it/s][A04/21/2024 13:38:59 - INFO - trainer.trainer_mod - Epoch 18 finished. Took 47.14 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  19%|█▉        | 19/100 [15:01<1:04:04, 47.46s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.47it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.33it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.30it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.18it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 13:39:00,530 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:39:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:39:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:39:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:39:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:39:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:39:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44482389645822606, 'eval_loss': 1.1634141, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2009, 2033, 2158, 2077, 1911, 1795, 1308, 1035, 791, 713, 603, 177], 'head_nums': [11, 6, 8, 9, 10, 11, 11, 11, 9, 6, 3, 1], 'pruned_params': 42305440, 'remaining_params': 42712160, 'pruned_model_sparsity': 0.497608024691358, 'expected_sparsity': 0.49541, 'target_sparsity': 0.5597014925373134, 'step': 5100}


Iteration:   3%|▎         | 8/268 [00:03<03:23,  1.28it/s][A04/21/2024 13:39:02 - INFO - trainer.trainer_mod - v4 Global step: 5100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:31,  1.71it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:55,  2.24it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:30,  2.85it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:13,  3.49it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:00,  4.20it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:51,  4.90it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:46,  5.47it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.92it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.29it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.32it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.65it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.88it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.16it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:33,  7.40it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.38it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:33,  7.35it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.17it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.10it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.12it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.28it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.28it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.10it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.31it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.48it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.27it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.26it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.14it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.07it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.26it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.35it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.33it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.47it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.31it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.30it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.42it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.39it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.10it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.17it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.23it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 13:39:09,381 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:39:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:39:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:39:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:39:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:39:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:39:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46936417904934724, 'eval_loss': 1.0260025, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1992, 2018, 2145, 2065, 1898, 1781, 1297, 1019, 777, 693, 594, 173], 'head_nums': [11, 6, 8, 9, 10, 11, 11, 11, 9, 6, 3, 1], 'pruned_params': 42510728, 'remaining_params': 42506872, 'pruned_model_sparsity': 0.5000226776573321, 'expected_sparsity': 0.50046, 'target_sparsity': 0.5652985074626865, 'step': 5150}


Iteration:  22%|██▏       | 58/268 [00:11<02:35,  1.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:57,  1.78it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:29,  2.32it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:10,  2.92it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:57,  3.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:48,  4.23it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:41,  4.86it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:37,  5.37it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:35,  5.76it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:32,  6.28it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:30,  6.61it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  6.86it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:28,  7.07it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.18it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.27it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.18it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.23it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.39it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.34it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.19it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.12it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.22it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.11it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.19it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.03it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  7.03it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  6.99it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.00it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.97it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.08it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.14it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.19it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.34it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.17it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.04it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.15it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.03it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  6.98it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.18it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:23,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 13:39:18,351 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:39:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:39:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:39:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:39:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:39:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:39:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4333248971712569, 'eval_loss': 1.0874184, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1976, 2001, 2133, 2052, 1884, 1767, 1285, 1006, 765, 672, 584, 169], 'head_nums': [10, 6, 8, 9, 10, 11, 11, 11, 9, 5, 3, 1], 'pruned_params': 43106676, 'remaining_params': 41910924, 'pruned_model_sparsity': 0.5070323791779584, 'expected_sparsity': 0.50468, 'target_sparsity': 0.5708955223880597, 'step': 5200}


Iteration:  40%|████      | 108/268 [00:20<02:00,  1.32it/s][A04/21/2024 13:39:20 - INFO - trainer.trainer_mod - v4 Global step: 5200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:21<01:30,  1.75it/s][A
Iteration:  41%|████      | 110/268 [00:21<01:10,  2.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:55,  2.85it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:44,  3.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:37,  4.15it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:32,  4.78it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:28,  5.29it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:26,  5.69it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.15it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.69it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.87it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.90it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.03it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  6.94it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  6.95it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.06it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.14it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.19it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.22it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.25it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.15it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.19it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.06it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.14it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.18it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.22it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.04it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.14it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.18it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.21it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.27it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.28it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.43it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.40it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.19it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.25it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  6.88it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.99it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.12it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 13:39:27,329 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:39:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:39:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:39:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:39:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:39:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:39:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40557188658430277, 'eval_loss': 1.1930453, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1958, 1985, 2119, 2037, 1869, 1752, 1272, 992, 754, 654, 576, 167], 'head_nums': [10, 6, 8, 9, 10, 11, 11, 11, 9, 5, 3, 1], 'pruned_params': 43319624, 'remaining_params': 41697976, 'pruned_model_sparsity': 0.5095371311352003, 'expected_sparsity': 0.5094, 'target_sparsity': 0.5764925373134328, 'step': 5250}


Iteration:  59%|█████▉    | 158/268 [00:29<01:22,  1.34it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<01:01,  1.77it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:46,  2.30it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:36,  2.90it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:29,  3.58it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:24,  4.21it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:21,  4.84it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:19,  5.41it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:17,  5.91it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:16,  6.18it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.92it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.03it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.13it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.21it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:12,  7.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.35it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.22it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.20it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.17it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.22it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.25it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.27it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.28it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.16it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.21it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.00it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.96it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.06it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.12it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.28it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.19it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.21it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.24it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.42it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.28it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.04it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.16it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 13:39:36,246 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:39:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:39:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:39:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:39:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:39:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:39:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4300679389836819, 'eval_loss': 1.1717454, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1943, 1970, 2107, 2026, 1857, 1742, 1263, 983, 743, 636, 568, 164], 'head_nums': [10, 6, 8, 9, 10, 11, 11, 11, 9, 5, 3, 1], 'pruned_params': 43491208, 'remaining_params': 41526392, 'pruned_model_sparsity': 0.5115553485395965, 'expected_sparsity': 0.51326, 'target_sparsity': 0.582089552238806, 'step': 5300}


Iteration:  78%|███████▊  | 208/268 [00:38<00:44,  1.34it/s][A04/21/2024 13:39:38 - INFO - trainer.trainer_mod - v4 Global step: 5300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:38<00:33,  1.78it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:25,  2.30it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:19,  2.92it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:15,  3.58it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:12,  4.25it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:11,  4.89it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:09,  5.34it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:08,  5.83it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:08,  6.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  6.95it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.97it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.07it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.15it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.10it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.08it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  7.00it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.13it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.98it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.03it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.11it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.06it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.12it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.18it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.27it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.20it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.39it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.15it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.11it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.93it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.15it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.18it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.20it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.02it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.93it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.03it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.26it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.08it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.12it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 13:39:45,198 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:39:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:39:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:39:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:39:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:39:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:39:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.49921989581653686, 'eval_loss': 0.8755212, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1926, 1955, 2094, 2014, 1844, 1730, 1253, 973, 733, 620, 561, 163], 'head_nums': [10, 6, 8, 8, 10, 11, 11, 11, 8, 5, 3, 1], 'pruned_params': 44065708, 'remaining_params': 40951892, 'pruned_model_sparsity': 0.5183127728846733, 'expected_sparsity': 0.51754, 'target_sparsity': 0.5876865671641791, 'step': 5350}


Iteration:  96%|█████████▋| 258/268 [00:47<00:07,  1.34it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:05,  1.78it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:03,  2.31it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:02,  2.87it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  3.52it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:01,  4.19it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  4.81it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  5.35it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  5.86it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.19it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  6.90it/s][A04/21/2024 13:39:48 - INFO - trainer.trainer_mod - Epoch 19 finished. Took 49.14 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.45it/s]
Epoch:  20%|██        | 20/100 [15:50<1:03:57, 47.97s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.47it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.41it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.31it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.30it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.22it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.26it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.16it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.03it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.07it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.25it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.29it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.28it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.18it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.38it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.18it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.22it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.24it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.25it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.33it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.22it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.08it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.10it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:34,  6.96it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.23it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.38it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.49it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 13:39:54,065 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:39:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:39:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:39:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:39:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:39:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:39:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4608699132150092, 'eval_loss': 1.0755596, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1910, 1940, 2083, 2003, 1833, 1720, 1244, 965, 723, 603, 551, 162], 'head_nums': [10, 6, 8, 8, 10, 11, 11, 11, 8, 5, 3, 1], 'pruned_params': 44235760, 'remaining_params': 40781840, 'pruned_model_sparsity': 0.520312970490816, 'expected_sparsity': 0.52167, 'target_sparsity': 0.5932835820895522, 'step': 5400}


Iteration:  15%|█▍        | 40/268 [00:07<02:49,  1.34it/s][A04/21/2024 13:39:56 - INFO - trainer.trainer_mod - v4 Global step: 5400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:07,  1.78it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:38,  2.30it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<01:17,  2.91it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:02,  3.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:52,  4.25it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:45,  4.89it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:40,  5.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:37,  5.87it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:34,  6.28it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:32,  6.61it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.84it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.97it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.10it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.09it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.97it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.98it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.09it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.21it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.26it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.20it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.36it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.28it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.27it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.21it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.05it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.12it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  7.07it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.06it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.15it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.08it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.19it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.39it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.34it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.34it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.32it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.31it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.32it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:26,  6.96it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.03it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.11it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  7.01it/s][A[INFO|trainer.py:570] 2024-04-21 13:40:02,988 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:40:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:40:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:40:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:40:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:40:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:40:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.438075505155209, 'eval_loss': 1.1225165, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1894, 1924, 2069, 1991, 1820, 1706, 1232, 951, 711, 588, 540, 161], 'head_nums': [10, 6, 7, 8, 10, 11, 11, 11, 8, 5, 3, 1], 'pruned_params': 44637144, 'remaining_params': 40380456, 'pruned_model_sparsity': 0.525034157633243, 'expected_sparsity': 0.52639, 'target_sparsity': 0.5988805970149254, 'step': 5450}


Iteration:  34%|███▎      | 90/268 [00:16<02:12,  1.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:40,  1.76it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:17,  2.28it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<01:00,  2.90it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:48,  3.56it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:41,  4.22it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:35,  4.86it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:31,  5.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:29,  5.80it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:27,  6.22it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:24,  6.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.94it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.07it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.16it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.12it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.12it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.17it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.16it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.09it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.03it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.07it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.03it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.90it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.14it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.17it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.21it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.15it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.19it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.19it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.08it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.11it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.17it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.16it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.19it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.12it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.29it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  7.02it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:19,  6.93it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.03it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.09it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.15it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.41it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 13:40:11,940 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:40:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:40:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:40:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:40:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:40:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:40:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4171132006626861, 'eval_loss': 1.1623503, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1878, 1909, 2057, 1981, 1809, 1695, 1224, 943, 702, 573, 530, 161], 'head_nums': [10, 5, 7, 8, 10, 11, 11, 10, 7, 5, 3, 1], 'pruned_params': 45393952, 'remaining_params': 39623648, 'pruned_model_sparsity': 0.5339359379704908, 'expected_sparsity': 0.53034, 'target_sparsity': 0.6, 'step': 5500}


Iteration:  52%|█████▏    | 140/268 [00:25<01:34,  1.35it/s][A04/21/2024 13:40:13 - INFO - trainer.trainer_mod - v4 Global step: 5500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:25<01:11,  1.78it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:54,  2.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:42,  2.91it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:34,  3.56it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:29,  4.22it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:25,  4.85it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:22,  5.42it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:20,  5.80it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:19,  6.13it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:18,  6.32it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:18,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:17,  6.71it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.88it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.93it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.96it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.08it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.09it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.14it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.18it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.25it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.30it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.32it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.32it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.45it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.68it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:14,  6.66it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:14,  6.75it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  6.90it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.12it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.15it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  6.96it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.07it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.24it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.15it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.11it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.18it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.28it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.33it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.21it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.00it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 13:40:20,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:40:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:40:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:40:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:40:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:40:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:40:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4706932444154383, 'eval_loss': 1.0181935, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1863, 1895, 2046, 1969, 1798, 1685, 1214, 933, 693, 559, 520, 160], 'head_nums': [10, 5, 7, 8, 10, 11, 11, 10, 7, 5, 3, 1], 'pruned_params': 45565536, 'remaining_params': 39452064, 'pruned_model_sparsity': 0.5359541553748871, 'expected_sparsity': 0.53475, 'target_sparsity': 0.6, 'step': 5550}


Iteration:  71%|███████   | 190/268 [00:34<00:58,  1.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:43,  1.78it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:33,  2.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:25,  2.90it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:20,  3.54it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:17,  4.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:15,  4.79it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:13,  5.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:11,  5.88it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:11,  6.13it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:10,  6.61it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  6.69it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.76it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.04it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.10it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.26it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.32it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.29it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.39it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.48it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.26it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.16it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.99it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.18it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.12it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  6.90it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.91it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.05it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.10it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.15it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.08it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.13it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.37it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.18it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.22it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.00it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.07it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 13:40:29,896 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:40:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:40:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:40:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:40:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:40:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:40:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44817708771808024, 'eval_loss': 0.94456583, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1848, 1880, 2034, 1957, 1787, 1673, 1205, 922, 684, 546, 512, 159], 'head_nums': [10, 5, 7, 8, 10, 11, 11, 10, 7, 5, 3, 1], 'pruned_params': 45740184, 'remaining_params': 39277416, 'pruned_model_sparsity': 0.5380084123757904, 'expected_sparsity': 0.53908, 'target_sparsity': 0.6, 'step': 5600}


Iteration:  90%|████████▉ | 240/268 [00:43<00:20,  1.34it/s][A04/21/2024 13:40:31 - INFO - trainer.trainer_mod - v4 Global step: 5600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:43<00:15,  1.76it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:11,  2.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:08,  2.89it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:06,  3.54it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:05,  4.16it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:04,  4.80it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  5.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  5.89it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.41it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.65it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.84it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.89it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.02it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.12it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.18it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.11it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.09it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.05it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.11it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.81it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.93it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.05it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.08it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.15it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.07it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.11it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.63it/s][A04/21/2024 13:40:35 - INFO - trainer.trainer_mod - Epoch 20 finished. Took 47.2 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  21%|██        | 21/100 [16:38<1:02:51, 47.74s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.36it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.50it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.19it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.24it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.25it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.25it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.18it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.11it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.35it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.48it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.30it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.10it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.94it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.96it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.03it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:35,  7.01it/s][A[INFO|trainer.py:570] 2024-04-21 13:40:38,836 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:40:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:40:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:40:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:40:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.80it/s]04/21/2024 13:40:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:40:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46628729107925104, 'eval_loss': 0.95037085, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1833, 1865, 2023, 1945, 1775, 1661, 1194, 911, 675, 534, 506, 158], 'head_nums': [10, 5, 7, 7, 10, 11, 11, 10, 7, 5, 3, 1], 'pruned_params': 46110928, 'remaining_params': 38906672, 'pruned_model_sparsity': 0.5423692035531467, 'expected_sparsity': 0.5434, 'target_sparsity': 0.6, 'step': 5650}


Iteration:   8%|▊         | 22/268 [00:05<03:03,  1.34it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:18,  1.77it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:46,  2.29it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:23,  2.89it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:08,  3.52it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:57,  4.16it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:50,  4.76it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:45,  5.28it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:41,  5.77it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.24it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.60it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.79it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.04it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.25it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.18it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.19it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.13it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.15it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.16it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.05it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.10it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.28it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.43it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.38it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.37it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.35it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.34it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.33it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.29it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.26it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.27it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.28it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.23it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.14it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.17it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.00it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.07it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.12it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 13:40:47,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:40:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:40:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:40:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:40:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 13:40:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:40:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45241874406120214, 'eval_loss': 1.0972139, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1819, 1851, 2012, 1934, 1765, 1650, 1186, 903, 668, 522, 502, 158], 'head_nums': [10, 5, 7, 7, 10, 11, 11, 9, 6, 5, 3, 1], 'pruned_params': 46653256, 'remaining_params': 38364344, 'pruned_model_sparsity': 0.5487482121348991, 'expected_sparsity': 0.54738, 'target_sparsity': 0.6, 'step': 5700}


Iteration:  27%|██▋       | 72/268 [00:13<02:26,  1.34it/s][A04/21/2024 13:40:49 - INFO - trainer.trainer_mod - v4 Global step: 5700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:14<01:50,  1.77it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<01:24,  2.29it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:06,  2.90it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:54,  3.54it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:45,  4.20it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:39,  4.83it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:35,  5.39it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:32,  5.85it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:29,  6.31it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:28,  6.42it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:27,  6.67it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  6.89it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.99it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.05it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.29it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.26it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.37it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.43it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.39it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.14it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.20it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.85it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.88it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.00it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.27it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.28it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.17it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.10it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.95it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.08it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.04it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.12it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.17it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.19it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.20it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.15it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 13:40:56,667 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:40:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:40:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:40:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:40:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:40:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:40:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4812305179480984, 'eval_loss': 0.9199255, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1804, 1836, 2001, 1924, 1755, 1640, 1178, 894, 662, 510, 497, 157], 'head_nums': [10, 5, 7, 7, 10, 11, 11, 9, 6, 5, 3, 1], 'pruned_params': 46804924, 'remaining_params': 38212676, 'pruned_model_sparsity': 0.5505321721619993, 'expected_sparsity': 0.55149, 'target_sparsity': 0.6, 'step': 5750}


Iteration:  46%|████▌     | 122/268 [00:22<01:48,  1.35it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<01:21,  1.79it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<01:02,  2.32it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:49,  2.90it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:39,  3.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:33,  4.26it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:29,  4.81it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:25,  5.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:23,  5.93it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.24it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.63it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.74it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.93it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.06it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  6.98it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.01it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.08it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.27it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.42it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.16it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.11it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  6.93it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.87it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.03it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  6.98it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.07it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.05it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.11it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.14it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.31it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.51it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.47it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.28it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.15it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.05it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.90it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  7.00it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.10it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.01it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  6.98it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:15,  6.55it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.75it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:14,  6.78it/s][A[INFO|trainer.py:570] 2024-04-21 13:41:05,653 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:41:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:41:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:41:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:41:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:41:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:41:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4863017578040948, 'eval_loss': 1.0030129, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1790, 1823, 1991, 1913, 1743, 1628, 1169, 885, 656, 498, 491, 156], 'head_nums': [10, 5, 7, 7, 10, 11, 11, 9, 6, 5, 3, 1], 'pruned_params': 46961188, 'remaining_params': 38056412, 'pruned_model_sparsity': 0.5523701915838602, 'expected_sparsity': 0.55559, 'target_sparsity': 0.6, 'step': 5800}


Iteration:  64%|██████▍   | 172/268 [00:31<01:11,  1.34it/s][A04/21/2024 13:41:07 - INFO - trainer.trainer_mod - v4 Global step: 5800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:32<00:53,  1.78it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:40,  2.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:31,  2.92it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:25,  3.58it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:21,  4.24it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:18,  4.88it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:16,  5.36it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:15,  5.84it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:14,  6.18it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.65it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  6.96it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  6.92it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.00it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.11it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.10it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.14it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.07it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.13it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.09it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.26it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.16it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.21it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.23it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.19it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.27it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.33it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.26it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.13it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.22it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.27it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.29it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.23it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.24it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.15it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.23it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.32it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  6.95it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 13:41:14,574 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:41:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:41:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:41:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:41:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.86it/s]04/21/2024 13:41:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:41:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4456190824541546, 'eval_loss': 1.0215191, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1778, 1810, 1980, 1902, 1733, 1616, 1160, 876, 649, 486, 486, 155], 'head_nums': [10, 5, 6, 7, 10, 11, 11, 9, 6, 5, 3, 1], 'pruned_params': 47308952, 'remaining_params': 37708648, 'pruned_model_sparsity': 0.5564606857874135, 'expected_sparsity': 0.55928, 'target_sparsity': 0.6, 'step': 5850}


Iteration:  83%|████████▎ | 222/268 [00:40<00:34,  1.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:25,  1.78it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:19,  2.28it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:15,  2.86it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:12,  3.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:09,  4.13it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:08,  4.68it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:07,  5.24it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:06,  5.76it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.24it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.62it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.63it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.96it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.07it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.17it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.25it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.29it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.40it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:02,  7.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.32it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.30it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.15it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.19it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.19it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.07it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.14it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.10it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.08it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.03it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.65it/s][A04/21/2024 13:41:22 - INFO - trainer.trainer_mod - Epoch 21 finished. Took 47.18 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  22%|██▏       | 22/100 [17:25<1:01:50, 47.57s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 13:41:23,510 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:41:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:41:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:41:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:41:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:41:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:41:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4486887614314647, 'eval_loss': 1.053213, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1764, 1798, 1971, 1893, 1723, 1606, 1150, 867, 642, 474, 481, 154], 'head_nums': [10, 5, 6, 7, 10, 11, 11, 9, 6, 4, 3, 1], 'pruned_params': 47650588, 'remaining_params': 37367012, 'pruned_model_sparsity': 0.5604791007979524, 'expected_sparsity': 0.56247, 'target_sparsity': 0.6, 'step': 5900}


Iteration:   1%|▏         | 4/268 [00:02<04:06,  1.07it/s][A04/21/2024 13:41:25 - INFO - trainer.trainer_mod - v4 Global step: 5900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:50,  1.55it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:03,  2.11it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:34,  2.76it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:15,  3.43it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:03,  4.09it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:54,  4.74it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:47,  5.42it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:43,  5.89it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:41,  6.12it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:39,  6.43it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:38,  6.64it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:36,  6.81it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.85it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  6.97it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:35,  7.06it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  7.03it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  6.95it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.05it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.95it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.89it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.02it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.08it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.96it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  7.03it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.09it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.15it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.00it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.10it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.14it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.19it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.10it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.07it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.94it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.94it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.85it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.87it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  6.99it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.07it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.15it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.18it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.06it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.43it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 13:41:32,512 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:41:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:41:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:41:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:41:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:41:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:41:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4775646295364916, 'eval_loss': 0.97330517, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1751, 1785, 1960, 1881, 1712, 1594, 1141, 857, 636, 464, 477, 154], 'head_nums': [10, 5, 6, 7, 10, 11, 10, 9, 6, 4, 3, 1], 'pruned_params': 48001416, 'remaining_params': 37016184, 'pruned_model_sparsity': 0.5646056345980126, 'expected_sparsity': 0.56603, 'target_sparsity': 0.6, 'step': 5950}


Iteration:  20%|██        | 54/268 [00:11<02:38,  1.35it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:58,  1.79it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:31,  2.32it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<01:12,  2.90it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:58,  3.56it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:48,  4.27it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:42,  4.88it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:38,  5.36it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:35,  5.83it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.23it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:29,  6.84it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:29,  6.91it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:27,  7.19it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:27,  7.20it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.11it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.25it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:27,  7.25it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:26,  7.28it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.29it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.32it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.24it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.29it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.28it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.22it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.14it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.39it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.22it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.29it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.15it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.18it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.20it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.23it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.26it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.27it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.33it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.01it/s][A[INFO|trainer.py:570] 2024-04-21 13:41:41,389 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:41:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:41:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:41:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:41:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:41:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:41:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4470196999095905, 'eval_loss': 1.0137005, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1738, 1772, 1949, 1872, 1702, 1584, 1133, 849, 630, 453, 473, 153], 'head_nums': [10, 4, 6, 7, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 48534552, 'remaining_params': 36483048, 'pruned_model_sparsity': 0.570876524390244, 'expected_sparsity': 0.56899, 'target_sparsity': 0.6, 'step': 6000}


Iteration:  39%|███▉      | 104/268 [00:20<02:02,  1.34it/s][A04/21/2024 13:41:43 - INFO - trainer.trainer_mod - v4 Global step: 6000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:20<01:32,  1.77it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<01:10,  2.29it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:56,  2.87it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:45,  3.50it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:38,  4.15it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:33,  4.77it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:29,  5.40it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:26,  5.97it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.32it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:22,  6.74it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.84it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:20,  7.15it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:20,  7.17it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:20,  7.24it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.41it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:19,  7.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.16it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.23it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.04it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.04it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.19it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.13it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.36it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.36it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.14it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.22it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.14it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.16it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.15it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.17it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.22it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.08it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  6.96it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.05it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.12it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.05it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.13it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.96it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.26it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.26it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.32it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 13:41:50,344 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:41:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:41:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:41:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:41:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:41:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:41:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4612449726432839, 'eval_loss': 1.0435477, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1726, 1760, 1940, 1864, 1695, 1577, 1126, 844, 625, 443, 469, 153], 'head_nums': [10, 4, 6, 7, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 48650984, 'remaining_params': 36366616, 'pruned_model_sparsity': 0.5722460290575128, 'expected_sparsity': 0.57133, 'target_sparsity': 0.6, 'step': 6050}


Iteration:  57%|█████▋    | 154/268 [00:29<01:24,  1.34it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<01:03,  1.78it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:48,  2.30it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:38,  2.88it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:31,  3.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:26,  4.18it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:22,  4.79it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:20,  5.33it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:19,  5.55it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:17,  5.91it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:16,  6.27it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.75it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.88it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  7.00it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:13,  7.08it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.14it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.18it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.16it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.17it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.22it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.22it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.33it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.27it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.25it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.26it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.19it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.22it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.22it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.24it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.27it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.28it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.28it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.12it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.37it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.36it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.35it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.18it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.23it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 13:41:59,305 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:41:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:41:59 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:41:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:41:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:42:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:42:01 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4779053188138537, 'eval_loss': 0.8595113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1714, 1748, 1930, 1855, 1685, 1569, 1118, 836, 618, 433, 466, 152], 'head_nums': [10, 4, 6, 7, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 48784268, 'remaining_params': 36233332, 'pruned_model_sparsity': 0.5738137515055706, 'expected_sparsity': 0.57398, 'target_sparsity': 0.6, 'step': 6100}


Iteration:  76%|███████▌  | 204/268 [00:38<00:47,  1.33it/s][A04/21/2024 13:42:01 - INFO - trainer.trainer_mod - v4 Global step: 6100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:38<00:35,  1.76it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:27,  2.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:21,  2.88it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:17,  3.50it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:14,  4.16it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:12,  4.78it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:10,  5.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:09,  5.90it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.26it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.53it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.75it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.69it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.86it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.99it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:06,  7.07it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.15it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.08it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.12it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.09it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.26it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.39it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.20it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.22it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.26it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.89it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.01it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.26it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.29it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.20it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.12it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.16it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.23it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.24it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.05it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.88it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.03it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.29it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.20it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.14it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.19it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 13:42:08,269 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:42:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:42:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:42:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:42:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:42:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:42:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4552830694257244, 'eval_loss': 0.96714735, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1701, 1736, 1921, 1847, 1677, 1560, 1111, 829, 612, 424, 463, 152], 'head_nums': [10, 4, 5, 7, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 49105988, 'remaining_params': 35911612, 'pruned_model_sparsity': 0.5775979091388136, 'expected_sparsity': 0.57668, 'target_sparsity': 0.6, 'step': 6150}


Iteration:  95%|█████████▍| 254/268 [00:47<00:10,  1.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:07,  1.77it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:05,  2.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:03,  2.88it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:02,  3.47it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:02,  4.11it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  4.73it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  5.29it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  5.78it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.13it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.78it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.83it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.92it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.54it/s][A04/21/2024 13:42:12 - INFO - trainer.trainer_mod - Epoch 22 finished. Took 49.25 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.44it/s]
Epoch:  23%|██▎       | 23/100 [18:14<1:01:41, 48.08s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.32it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.88it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.85it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.88it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.90it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  7.01it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.08it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.16it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.13it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.01it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.57it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.71it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.79it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.86it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.87it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.01it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.98it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:34,  7.18it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.20it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.11it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.29it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.28it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.17it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.10it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.17it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.22it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.25it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 13:42:17,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:42:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:42:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:42:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:42:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:42:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:42:19 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45296168452332813, 'eval_loss': 0.99223316, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1689, 1725, 1911, 1838, 1669, 1553, 1105, 823, 607, 415, 459, 151], 'head_nums': [9, 4, 5, 7, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 49421580, 'remaining_params': 35596020, 'pruned_model_sparsity': 0.5813099875790425, 'expected_sparsity': 0.57916, 'target_sparsity': 0.6, 'step': 6200}


Iteration:  13%|█▎        | 36/268 [00:07<02:52,  1.35it/s][A04/21/2024 13:42:19 - INFO - trainer.trainer_mod - v4 Global step: 6200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:09,  1.78it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:38,  2.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:17,  2.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:04,  3.56it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:53,  4.25it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:46,  4.86it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:41,  5.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:38,  5.76it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:35,  6.29it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.81it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.06it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  7.02it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.03it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.14it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.86it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.88it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.13it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.22it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.22it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.23it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.15it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.22it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:26,  7.52it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.32it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.20it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.20it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.25it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.29it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.32it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.33it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.25it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.07it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.11it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.21it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.21it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.04it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  7.11it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 13:42:26,170 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:42:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:42:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:42:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:42:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:42:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:42:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47204790240239586, 'eval_loss': 0.9404869, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1678, 1715, 1903, 1831, 1662, 1547, 1099, 817, 602, 405, 457, 151], 'head_nums': [9, 4, 5, 6, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 49721852, 'remaining_params': 35295748, 'pruned_model_sparsity': 0.5848418680367359, 'expected_sparsity': 0.58143, 'target_sparsity': 0.6, 'step': 6250}


Iteration:  32%|███▏      | 86/268 [00:15<02:14,  1.35it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:41,  1.79it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:17,  2.32it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<01:01,  2.92it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:49,  3.56it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:41,  4.22it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:36,  4.82it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:32,  5.43it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:29,  5.99it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:27,  6.26it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.61it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:25,  6.70it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.88it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.23it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.25it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.20it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.20it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.22it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.35it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.34it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.08it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.17it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.26it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.09it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.12it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.05it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.04it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.14it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.18it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.13it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.17it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.16it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.18it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.23it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.07it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  7.01it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.18it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.23it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:42:35,093 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:42:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:42:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:42:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:42:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:42:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:42:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.444277828441804, 'eval_loss': 1.0187085, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1667, 1704, 1894, 1824, 1654, 1539, 1092, 811, 596, 397, 455, 151], 'head_nums': [9, 4, 5, 6, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 49836752, 'remaining_params': 35180848, 'pruned_model_sparsity': 0.5861933529057513, 'expected_sparsity': 0.58366, 'target_sparsity': 0.6, 'step': 6300}


Iteration:  51%|█████     | 136/268 [00:24<01:37,  1.35it/s][A04/21/2024 13:42:37 - INFO - trainer.trainer_mod - v4 Global step: 6300, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:25<01:13,  1.79it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:56,  2.32it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:44,  2.89it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:36,  3.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:30,  4.17it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:26,  4.72it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:23,  5.27it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:21,  5.75it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:20,  6.13it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  6.84it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.77it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.83it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  6.97it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.23it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.24it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.27it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.10it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.35it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.23it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.24it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.38it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.39it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.12it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.22it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.51it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.58it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.31it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.08it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.17it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.20it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.36it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.27it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.28it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.46it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.41it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 13:42:43,963 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:42:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:42:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:42:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:42:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.86it/s]04/21/2024 13:42:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:42:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4610077931446121, 'eval_loss': 1.0391692, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1657, 1694, 1885, 1815, 1646, 1531, 1085, 805, 591, 389, 452, 151], 'head_nums': [9, 4, 5, 6, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 49951652, 'remaining_params': 35065948, 'pruned_model_sparsity': 0.5875448377747666, 'expected_sparsity': 0.58605, 'target_sparsity': 0.6, 'step': 6350}


Iteration:  69%|██████▉   | 186/268 [00:33<01:00,  1.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:45,  1.79it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:34,  2.33it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:26,  2.94it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:21,  3.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:18,  4.23it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:15,  4.83it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:13,  5.39it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:12,  5.70it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:12,  6.05it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:11,  6.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.62it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.72it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.67it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  6.85it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.00it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  6.88it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.99it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.07it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.12it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.16it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.06it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.11it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.05it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.95it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.03it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.25it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.27it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.28it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.13it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.15it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.01it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.08it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.04it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.02it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.02it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  6.98it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.19it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.19it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.34it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.31it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.17it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 13:42:52,951 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:42:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:42:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:42:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:42:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:42:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:42:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4905937147239641, 'eval_loss': 0.9631505, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1647, 1684, 1877, 1806, 1638, 1522, 1078, 799, 586, 381, 450, 151], 'head_nums': [9, 4, 5, 6, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 50065020, 'remaining_params': 34952580, 'pruned_model_sparsity': 0.5888783028455284, 'expected_sparsity': 0.58842, 'target_sparsity': 0.6, 'step': 6400}


Iteration:  88%|████████▊ | 236/268 [00:42<00:23,  1.35it/s][A04/21/2024 13:42:55 - INFO - trainer.trainer_mod - v4 Global step: 6400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:42<00:17,  1.78it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:13,  2.30it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:10,  2.90it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:07,  3.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:06,  4.16it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:05,  4.73it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  5.28it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:04,  5.77it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.17it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.45it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.79it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.07it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.27it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.06it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.04it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.13it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.18it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.27it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.43it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.37it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.36it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.26it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.29it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.28it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.29it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.55it/s][A04/21/2024 13:42:59 - INFO - trainer.trainer_mod - Epoch 23 finished. Took 47.15 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  24%|██▍       | 24/100 [19:01<1:00:32, 47.80s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.10it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.19it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.22it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.28it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.09it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.18it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.00it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.98it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.10it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.17it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.06it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.99it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.03it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 13:43:01,857 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:43:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:43:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:43:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:43:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:43:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:43:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4948269680739418, 'eval_loss': 0.98718345, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1637, 1674, 1869, 1798, 1630, 1515, 1072, 794, 581, 374, 448, 151], 'head_nums': [9, 4, 5, 6, 10, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 50170728, 'remaining_params': 34846872, 'pruned_model_sparsity': 0.5901216689250226, 'expected_sparsity': 0.59081, 'target_sparsity': 0.6, 'step': 6450}


Iteration:   7%|▋         | 18/268 [00:04<03:05,  1.35it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:19,  1.79it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:47,  2.32it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:25,  2.90it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:09,  3.54it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:58,  4.19it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:50,  4.81it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:44,  5.43it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:40,  5.90it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:38,  6.26it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:36,  6.65it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.64it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.62it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  6.97it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.05it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.13it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.19it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.23it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.38it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.37it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.50it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.27it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.43it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:29,  7.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.41it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.13it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.08it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.11it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.13it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.20it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.13it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.19it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.14it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.05it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.04it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.13it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.97it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.90it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  7.00it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.07it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.13it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.01it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.07it/s][A[INFO|trainer.py:570] 2024-04-21 13:43:10,795 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:43:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:43:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:43:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:43:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:43:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:43:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4856483967190665, 'eval_loss': 0.97384787, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1628, 1665, 1861, 1791, 1624, 1509, 1066, 789, 577, 367, 446, 151], 'head_nums': [9, 4, 5, 6, 9, 11, 10, 9, 6, 4, 2, 1], 'pruned_params': 50461808, 'remaining_params': 34555792, 'pruned_model_sparsity': 0.5935454305931949, 'expected_sparsity': 0.59269, 'target_sparsity': 0.6, 'step': 6500}


Iteration:  25%|██▌       | 68/268 [00:13<02:28,  1.35it/s][A04/21/2024 13:43:12 - INFO - trainer.trainer_mod - v4 Global step: 6500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:52,  1.77it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:26,  2.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:08,  2.89it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:55,  3.51it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:47,  4.13it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:41,  4.72it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:36,  5.27it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:33,  5.67it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:31,  6.09it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:29,  6.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.68it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.83it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.06it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.10it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.02it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.20it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.11it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.15it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.11it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.16it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.17it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.37it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.20it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.19it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.19it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.23it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.26it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.18it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.02it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.08it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.14it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.16it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.19it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.43it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.38it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.48it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.42it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.30it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.28it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:43:19,744 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:43:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:43:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:43:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:43:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.87it/s]04/21/2024 13:43:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:43:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41353994878095324, 'eval_loss': 1.158789, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1619, 1655, 1853, 1784, 1616, 1501, 1059, 783, 572, 361, 444, 151], 'head_nums': [9, 4, 5, 6, 9, 11, 9, 9, 6, 4, 2, 1], 'pruned_params': 50765144, 'remaining_params': 34252456, 'pruned_model_sparsity': 0.5971133506473953, 'expected_sparsity': 0.59489, 'target_sparsity': 0.6, 'step': 6550}


Iteration:  44%|████▍     | 118/268 [00:22<01:51,  1.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<01:23,  1.79it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<01:04,  2.31it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:50,  2.91it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:42,  3.42it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:35,  4.08it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:31,  4.63it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:27,  5.19it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:24,  5.71it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:22,  6.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.72it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.86it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.00it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  7.01it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.22it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.27it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.28it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.30it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.32it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.43it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.40it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.33it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.21it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.27it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.30it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.35it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.19it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.26it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.51it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.30it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.22it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.17it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.22it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  6.89it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  7.01it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  7.00it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.14it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.00it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 13:43:28,686 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:43:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:43:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:43:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:43:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:43:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:43:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45804529832950347, 'eval_loss': 0.89709246, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1609, 1646, 1846, 1776, 1610, 1493, 1054, 778, 568, 354, 442, 151], 'head_nums': [9, 4, 5, 6, 9, 11, 9, 9, 6, 4, 2, 1], 'pruned_params': 50863192, 'remaining_params': 34154408, 'pruned_model_sparsity': 0.5982666177356218, 'expected_sparsity': 0.59701, 'target_sparsity': 0.6, 'step': 6600}


Iteration:  63%|██████▎   | 168/268 [00:31<01:14,  1.35it/s][A04/21/2024 13:43:30 - INFO - trainer.trainer_mod - v4 Global step: 6600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:31<00:55,  1.79it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:42,  2.29it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:33,  2.91it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:26,  3.58it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:22,  4.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:19,  4.85it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:17,  5.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:16,  5.71it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:14,  6.11it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:14,  6.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.60it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.97it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.97it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.07it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.15it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.17it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.09it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.30it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.43it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.37it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.40it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.58it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.33it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.33it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.33it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.36it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.26it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.29it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.19it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.22it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.10it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.18it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.20it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.13it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.21it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.14it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.18it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 13:43:37,571 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:43:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:43:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:43:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:43:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:43:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:43:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4582069079338325, 'eval_loss': 1.0416746, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1601, 1637, 1838, 1769, 1603, 1486, 1049, 773, 563, 347, 440, 150], 'head_nums': [9, 4, 5, 6, 9, 11, 9, 9, 6, 4, 2, 1], 'pruned_params': 50959708, 'remaining_params': 34057892, 'pruned_model_sparsity': 0.5994018650255947, 'expected_sparsity': 0.59915, 'target_sparsity': 0.6, 'step': 6650}


Iteration:  81%|████████▏ | 218/268 [00:40<00:36,  1.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:27,  1.79it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:20,  2.32it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:16,  2.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:13,  3.53it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:10,  4.18it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:09,  4.84it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:08,  5.37it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:07,  5.59it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  5.93it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:06,  6.21it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:06,  6.48it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.62it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.69it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.08it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.97it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.97it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.06it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.15it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.04it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.10it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.13it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.02it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.08it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.13it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.17it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.03it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.99it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.90it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.03it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.00it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.06it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.12it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.18it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.97it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.09it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.22it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.14it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.19it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.23it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 13:43:46,572 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:43:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:43:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:43:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:43:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:43:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:43:48 - INFO - trainer.trainer_mod - Starting saving the best from epoch 25 and step 6700
04/21/2024 13:43:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4802035802321485, 'eval_loss': 0.9385241, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1592, 1629, 1831, 1762, 1596, 1479, 1043, 769, 558, 340, 439, 150], 'head_nums': [9, 4, 4, 6, 9, 11, 9, 9, 6, 4, 2, 1], 'pruned_params': 51249256, 'remaining_params': 33768344, 'pruned_model_sparsity': 0.6028076068955134, 'expected_sparsity': 0.60163, 'target_sparsity': 0.6, 'step': 6700}
04/21/2024 13:43:48 - INFO - trainer.trainer_mod - Saving the best model so far: [Epoch 25 | Step: 6700 | Model size: 33768344 | Score: 0.4802]

[INFO|configuration_utils.py:439] 2024-04-21 13:43:48,583 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-21 13:43:49,180 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration: 100%|██████████| 268/268 [00:49<00:00,  1.10it/s][A04/21/2024 13:43:49 - INFO - trainer.trainer_mod - Epoch 24 finished. Took 49.83 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.38it/s]
Epoch:  25%|██▌       | 25/100 [19:51<1:00:30, 48.41s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/21/2024 13:43:49 - INFO - trainer.trainer_mod - v4 Global step: 6700, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.13it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.19it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.01it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.11it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.37it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.11it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.36it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.27it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.31it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.28it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.18it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.19it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.16it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.21it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.89it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:36,  6.85it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.87it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.87it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.97it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.06it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.10it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.16it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.20it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.22it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.22it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.23it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.19it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.25it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.17it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.22it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.19it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.37it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.37it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.14it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.11it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:31,  7.20it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.25it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.30it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:30,  7.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:06<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:06<00:29,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 13:43:56,117 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:43:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:43:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:43:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:43:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.86it/s]04/21/2024 13:43:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:43:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44680434771969624, 'eval_loss': 1.0384759, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1583, 1621, 1824, 1755, 1589, 1472, 1038, 764, 554, 334, 438, 150], 'head_nums': [9, 4, 4, 6, 9, 11, 9, 9, 6, 4, 2, 1], 'pruned_params': 51341176, 'remaining_params': 33676424, 'pruned_model_sparsity': 0.6038887947907257, 'expected_sparsity': 0.60366, 'target_sparsity': 0.6, 'step': 6750}


Iteration:  19%|█▊        | 50/268 [00:08<02:40,  1.36it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:00,  1.80it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:32,  2.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:13,  2.93it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:59,  3.57it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:49,  4.26it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:43,  4.82it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:39,  5.33it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:36,  5.81it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:33,  6.21it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:32,  6.36it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.73it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.97it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.09it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.05it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.15it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.00it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.93it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  7.03it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.10it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.14it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.20it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.21it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.14it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:27,  7.00it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.10it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.19it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.22it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.38it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.37it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.36it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.12it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.36it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.23it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.28it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.12it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.30it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:23,  7.28it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 98/268 [00:15<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:15<00:23,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:44:05,046 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:44:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:44:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:44:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:44:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.86it/s]04/21/2024 13:44:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:44:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4440812070468994, 'eval_loss': 1.1166805, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1575, 1612, 1816, 1748, 1581, 1466, 1033, 760, 550, 327, 437, 150], 'head_nums': [8, 4, 4, 6, 9, 11, 9, 9, 6, 4, 2, 1], 'pruned_params': 51629192, 'remaining_params': 33388408, 'pruned_model_sparsity': 0.6072765168623908, 'expected_sparsity': 0.60591, 'target_sparsity': 0.6, 'step': 6800}


Iteration:  37%|███▋      | 100/268 [00:17<02:04,  1.35it/s][A04/21/2024 13:44:07 - INFO - trainer.trainer_mod - v4 Global step: 6800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:18<01:33,  1.79it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<01:11,  2.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:56,  2.93it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:45,  3.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:38,  4.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:33,  4.88it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:29,  5.42it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:26,  5.96it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:25,  6.22it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:24,  6.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:23,  6.74it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.88it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  6.98it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.06it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.13it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.15it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.20it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.40it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.25it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.34it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:20,  7.25it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.26it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.10it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.04it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.13it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  7.16it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.22it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.24it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.27it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.07it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.04it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.10it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.17it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.21it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:16,  7.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.27it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:16,  7.36it/s][A
Iteration:  54%|█████▍    | 146/268 [00:24<00:17,  7.07it/s][A
Iteration:  55%|█████▍    | 147/268 [00:24<00:16,  7.17it/s][A
Iteration:  55%|█████▌    | 148/268 [00:24<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 149/268 [00:24<00:16,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 13:44:13,925 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:44:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:44:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:44:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:44:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.87it/s]04/21/2024 13:44:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:44:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.49626557567073315, 'eval_loss': 0.8908854, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1567, 1603, 1808, 1741, 1575, 1460, 1028, 756, 546, 321, 435, 150], 'head_nums': [8, 4, 4, 6, 9, 11, 9, 8, 6, 4, 2, 1], 'pruned_params': 51915676, 'remaining_params': 33101924, 'pruned_model_sparsity': 0.6106462191358024, 'expected_sparsity': 0.6081, 'target_sparsity': 0.6, 'step': 6850}
04/21/2024 13:44:15 - INFO - trainer.trainer_mod - Saving the best model so far: [Epoch 25 | Step: 6850 | Model size: 33101924 | Score: 0.49627]

[INFO|configuration_utils.py:439] 2024-04-21 13:44:15,934 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-21 13:44:16,839 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  56%|█████▌    | 150/268 [00:27<01:59,  1.01s/it][A
Iteration:  56%|█████▋    | 151/268 [00:27<01:27,  1.33it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<01:05,  1.77it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:50,  2.28it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:39,  2.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:32,  3.49it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:27,  4.14it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:23,  4.72it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:21,  5.20it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:18,  5.81it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:17,  6.11it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.33it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.44it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.61it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.79it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.09it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  7.13it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.11it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.08it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.03it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.08it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.15it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  7.01it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.09it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.08it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.04it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.00it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  6.97it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.96it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.01it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.10it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.94it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.02it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.09it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.00it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.08it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.33it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.09it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.13it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.24it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.18it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.98it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  7.05it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.10it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  6.97it/s][A[INFO|trainer.py:570] 2024-04-21 13:44:23,889 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:44:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:44:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:44:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:44:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:44:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:44:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4556358612682346, 'eval_loss': 0.9450019, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1558, 1596, 1802, 1735, 1569, 1454, 1023, 752, 542, 316, 434, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 6, 4, 2, 1], 'pruned_params': 52194500, 'remaining_params': 32823100, 'pruned_model_sparsity': 0.6139258224179464, 'expected_sparsity': 0.61027, 'target_sparsity': 0.6, 'step': 6900}


Iteration:  75%|███████▍  | 200/268 [00:36<00:50,  1.34it/s][A04/21/2024 13:44:25 - INFO - trainer.trainer_mod - v4 Global step: 6900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:36<00:37,  1.78it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:28,  2.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:22,  2.89it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:18,  3.53it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:15,  3.99it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:13,  4.67it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:11,  5.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:10,  5.73it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:09,  6.12it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.53it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.93it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.95it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.19it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.25it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.17it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.16it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.08it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.14it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.12it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.46it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.41it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.34it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.33it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.33it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.19it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.18it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.44it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.14it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 13:44:32,780 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:44:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:44:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:44:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:44:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:44:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:44:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.458136114916564, 'eval_loss': 1.1085888, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1550, 1587, 1796, 1729, 1565, 1449, 1020, 749, 539, 310, 432, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 6, 4, 2, 1], 'pruned_params': 52269568, 'remaining_params': 32748032, 'pruned_model_sparsity': 0.6148087925323698, 'expected_sparsity': 0.61216, 'target_sparsity': 0.6, 'step': 6950}


Iteration:  93%|█████████▎| 250/268 [00:45<00:13,  1.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:09,  1.80it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:06,  2.34it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:05,  2.94it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:03,  3.56it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:03,  4.27it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:02,  4.88it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:02,  5.42it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  5.73it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.12it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.68it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.69it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  6.87it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.81it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  6.97it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.04it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.13it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.71it/s][A04/21/2024 13:44:37 - INFO - trainer.trainer_mod - Epoch 25 finished. Took 48.06 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.58it/s]
Epoch:  26%|██▌       | 26/100 [20:39<59:34, 48.30s/it]  
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.42it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.20it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.13it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.37it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.47it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.43it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.54it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.32it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.31it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.33it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.25it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.12it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.36it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.49it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.34it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.36it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.25it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.19it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.22it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.03it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.10it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.15it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.22it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.23it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.26it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 13:44:41,630 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:44:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:44:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:44:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:44:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.87it/s]04/21/2024 13:44:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:44:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48619808695768324, 'eval_loss': 0.8623495, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1542, 1579, 1789, 1722, 1559, 1442, 1015, 745, 536, 306, 430, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 6, 4, 2, 1], 'pruned_params': 52356892, 'remaining_params': 32660708, 'pruned_model_sparsity': 0.6158359210328215, 'expected_sparsity': 0.61414, 'target_sparsity': 0.6, 'step': 7000}


Iteration:  12%|█▏        | 32/268 [00:06<02:54,  1.35it/s][A04/21/2024 13:44:43 - INFO - trainer.trainer_mod - v4 Global step: 7000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:12,  1.78it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:42,  2.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:20,  2.88it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:05,  3.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:54,  4.25it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:48,  4.77it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:43,  5.32it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:39,  5.77it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:36,  6.14it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:34,  6.59it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.63it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.83it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.95it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.93it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.03it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.04it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.15it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.23it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.24it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.17it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.10it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.17it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.19it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.13it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.19it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.25it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.18it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.26it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.40it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.32it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.80it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.79it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:28,  6.81it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  6.86it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.18it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.10it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.29it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 13:44:50,582 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:44:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:44:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:44:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:44:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:44:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:44:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45980625479422976, 'eval_loss': 1.0360291, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1534, 1571, 1782, 1716, 1554, 1437, 1011, 742, 533, 301, 428, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 4, 2, 1], 'pruned_params': 52631120, 'remaining_params': 32386480, 'pruned_model_sparsity': 0.6190614649202048, 'expected_sparsity': 0.61581, 'target_sparsity': 0.6, 'step': 7050}


Iteration:  31%|███       | 82/268 [00:15<02:17,  1.35it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:43,  1.79it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:19,  2.31it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:03,  2.89it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:51,  3.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:42,  4.23it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:38,  4.73it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:33,  5.30it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:30,  5.87it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:29,  5.98it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.62it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.75it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.84it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.87it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.28it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.27it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.37it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.35it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.34it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.24it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.19it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.07it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.04it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.99it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.09it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.46it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.30it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.19it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.13it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.18it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.23it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.07it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.14it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.02it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.10it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.18it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.12it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.24it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.38it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.34it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 13:44:59,538 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:44:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:44:59 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:44:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:44:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.87it/s]04/21/2024 13:45:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:45:01 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.49127930626038135, 'eval_loss': 0.99797827, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1526, 1562, 1776, 1709, 1548, 1431, 1007, 738, 530, 297, 427, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 4, 2, 1], 'pruned_params': 52713848, 'remaining_params': 32303752, 'pruned_model_sparsity': 0.6200345340258958, 'expected_sparsity': 0.61758, 'target_sparsity': 0.6, 'step': 7100}


Iteration:  49%|████▉     | 132/268 [00:24<01:40,  1.35it/s][A04/21/2024 13:45:01 - INFO - trainer.trainer_mod - v4 Global step: 7100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:24<01:15,  1.79it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:58,  2.30it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:45,  2.90it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:37,  3.54it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:31,  4.19it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:26,  4.82it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:24,  5.37it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:21,  5.92it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:20,  6.28it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.77it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  6.91it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.04it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.23it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.08it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.45it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.51it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.43it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.37it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.47it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.17it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.07it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.31it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.29it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.29it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.25it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.27it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.17it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.25it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.13it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.18it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.18it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 13:45:08,373 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:45:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:45:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:45:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:45:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.87it/s]04/21/2024 13:45:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:45:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.458136114916564, 'eval_loss': 0.97675616, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1519, 1555, 1770, 1704, 1541, 1425, 1002, 735, 528, 292, 426, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 4, 2, 1], 'pruned_params': 52788916, 'remaining_params': 32228684, 'pruned_model_sparsity': 0.6209175041403192, 'expected_sparsity': 0.61938, 'target_sparsity': 0.6, 'step': 7150}


Iteration:  68%|██████▊   | 182/268 [00:33<01:03,  1.36it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:47,  1.78it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:36,  2.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:28,  2.88it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:23,  3.49it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:19,  4.13it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:16,  4.76it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:14,  5.27it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:13,  5.76it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:12,  6.24it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:11,  6.80it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  6.92it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.05it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.14it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.23it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.38it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.28it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.28it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.28it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.32it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.24it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.10it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.16it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.01it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.08it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.12it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.17it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.22it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.36it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.11it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.16it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.13it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.33it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.33it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.10it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.04it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.00it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.11it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.03it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  6.95it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  6.97it/s][A[INFO|trainer.py:570] 2024-04-21 13:45:17,317 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:45:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:45:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:45:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:45:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:45:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:45:19 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4412540944135295, 'eval_loss': 1.0115684, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1512, 1547, 1765, 1698, 1536, 1419, 998, 733, 525, 289, 425, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 4, 2, 1], 'pruned_params': 52860920, 'remaining_params': 32156680, 'pruned_model_sparsity': 0.6217644346582355, 'expected_sparsity': 0.62099, 'target_sparsity': 0.6, 'step': 7200}


Iteration:  87%|████████▋ | 232/268 [00:42<00:26,  1.34it/s][A04/21/2024 13:45:19 - INFO - trainer.trainer_mod - v4 Global step: 7200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:42<00:19,  1.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:14,  2.28it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:11,  2.87it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:09,  3.51it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:07,  4.03it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:06,  4.65it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:05,  5.23it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  5.71it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.12it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:04,  6.43it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.69it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.78it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.93it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.85it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.98it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.89it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.01it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.03it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.91it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.00it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.01it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.98it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.09it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.19it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.06it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.09it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.06it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.17it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.22it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.16it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.24it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.27it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.18it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.79it/s][A04/21/2024 13:45:24 - INFO - trainer.trainer_mod - Epoch 26 finished. Took 47.12 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  27%|██▋       | 27/100 [21:26<58:20, 47.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.40it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.32it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.21it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.26it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.29it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.05it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.12it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.18it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.14it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:45:26,301 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:45:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:45:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:45:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:45:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.87it/s]04/21/2024 13:45:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:45:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4497562563404004, 'eval_loss': 0.97126234, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1505, 1540, 1758, 1693, 1530, 1413, 994, 730, 522, 285, 424, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 4, 2, 1], 'pruned_params': 52935988, 'remaining_params': 32081612, 'pruned_model_sparsity': 0.6226474047726588, 'expected_sparsity': 0.62275, 'target_sparsity': 0.6, 'step': 7250}


Iteration:   5%|▌         | 14/268 [00:03<03:08,  1.34it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:21,  1.78it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:49,  2.30it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:25,  2.92it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:10,  3.56it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:59,  4.20it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:50,  4.87it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:44,  5.52it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.89it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.27it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.55it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.56it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.77it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.84it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.87it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.98it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.05it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.87it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  6.98it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.07it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.30it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.10it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.13it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.95it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.03it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.10it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.30it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.27it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.27it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.01it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.07it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.29it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.30it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.28it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.10it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.15it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.08it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.24it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.15it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.22it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.15it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.94it/s][A[INFO|trainer.py:570] 2024-04-21 13:45:35,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:45:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:45:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:45:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:45:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.87it/s]04/21/2024 13:45:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:45:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42119974255289644, 'eval_loss': 1.0611974, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1499, 1533, 1752, 1689, 1525, 1408, 989, 727, 519, 281, 422, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 3, 2, 1], 'pruned_params': 53202556, 'remaining_params': 31815044, 'pruned_model_sparsity': 0.6257828496687745, 'expected_sparsity': 0.62433, 'target_sparsity': 0.6, 'step': 7300}


Iteration:  24%|██▍       | 64/268 [00:12<02:31,  1.35it/s][A04/21/2024 13:45:37 - INFO - trainer.trainer_mod - v4 Global step: 7300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:13<01:53,  1.79it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:27,  2.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:09,  2.90it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:56,  3.54it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:47,  4.19it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:41,  4.76it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:37,  5.30it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:33,  5.86it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:31,  6.22it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:29,  6.50it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.65it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  6.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.95it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.05it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.25it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.25it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:24,  7.47it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.44it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.18it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.12it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.06it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.12it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  6.99it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.26it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.16it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.20it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.39it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.38it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.38it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.09it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.05it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.13it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.01it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  6.99it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.09it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.20it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.21it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.36it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.43it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 13:45:44,185 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:45:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:45:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:45:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:45:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:45:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:45:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4927793660353066, 'eval_loss': 0.9975864, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1492, 1526, 1746, 1684, 1520, 1403, 986, 724, 517, 278, 421, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 3, 2, 1], 'pruned_params': 53269964, 'remaining_params': 31747636, 'pruned_model_sparsity': 0.6265757207919301, 'expected_sparsity': 0.62589, 'target_sparsity': 0.6, 'step': 7350}


Iteration:  43%|████▎     | 114/268 [00:21<01:53,  1.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<01:25,  1.79it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<01:05,  2.32it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:52,  2.90it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:42,  3.53it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:35,  4.18it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:30,  4.85it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:27,  5.40it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:24,  5.85it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:23,  6.23it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.77it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.82it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.95it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.90it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.73it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.02it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.14it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  7.05it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.10it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.17it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.21it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.24it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.15it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.36it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.17it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.05it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.14it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.24it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.11it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.06it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  7.02it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.11it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.10it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.15it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.20it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.13it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.09it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  7.05it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.76it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.91it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.02it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.12it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.38it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.53it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 13:45:53,136 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:45:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:45:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:45:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:45:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:45:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:45:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4830533237831965, 'eval_loss': 0.9317114, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1486, 1519, 1740, 1678, 1515, 1398, 982, 720, 513, 275, 420, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 3, 2, 1], 'pruned_params': 53343500, 'remaining_params': 31674100, 'pruned_model_sparsity': 0.6274406711081, 'expected_sparsity': 0.62747, 'target_sparsity': 0.6, 'step': 7400}


Iteration:  61%|██████    | 164/268 [00:30<01:16,  1.36it/s][A04/21/2024 13:45:55 - INFO - trainer.trainer_mod - v4 Global step: 7400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:30<00:57,  1.80it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:43,  2.33it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:34,  2.95it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:28,  3.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:23,  4.21it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:20,  4.71it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:18,  5.26it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:16,  5.75it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:15,  6.15it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.46it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.60it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.79it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.76it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  6.93it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.00it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.13it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.20it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.24it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.26it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.28it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.27it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.25it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.26it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.19it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.30it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.30it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.28it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.13it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.08it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.12it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.16it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.07it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 13:46:02,059 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:46:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:46:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:46:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:46:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:46:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:46:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46674866212559013, 'eval_loss': 0.9638856, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1480, 1512, 1735, 1672, 1509, 1392, 978, 718, 511, 272, 419, 150], 'head_nums': [8, 4, 4, 5, 9, 11, 9, 8, 5, 3, 2, 1], 'pruned_params': 53412440, 'remaining_params': 31605160, 'pruned_model_sparsity': 0.6282515620295092, 'expected_sparsity': 0.62912, 'target_sparsity': 0.6, 'step': 7450}


Iteration:  80%|███████▉  | 214/268 [00:39<00:39,  1.35it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:29,  1.79it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:22,  2.32it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:17,  2.91it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:13,  3.59it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:11,  4.23it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:09,  4.84it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:09,  5.08it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:08,  5.57it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:07,  5.99it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:07,  6.26it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.69it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.78it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.93it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.02it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.21it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.28it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.10it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.06it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.22it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.36it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.33it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.23it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.18it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.39it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.25it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.28it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.33it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.24it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.10it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.21it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.88it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.03it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.12it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.05it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.25it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.31it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 13:46:11,018 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:46:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:46:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:46:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:46:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:46:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:46:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4691788626771537, 'eval_loss': 0.9396152, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1474, 1506, 1729, 1668, 1504, 1388, 974, 715, 508, 270, 418, 150], 'head_nums': [7, 4, 4, 5, 9, 11, 9, 8, 5, 3, 2, 1], 'pruned_params': 53672880, 'remaining_params': 31344720, 'pruned_model_sparsity': 0.6313149277326107, 'expected_sparsity': 0.63069, 'target_sparsity': 0.6, 'step': 7500}


Iteration:  99%|█████████▊| 264/268 [00:48<00:02,  1.35it/s][A04/21/2024 13:46:13 - INFO - trainer.trainer_mod - v4 Global step: 7500, Alignment: tensor([ 2,  7,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:48<00:01,  1.77it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  2.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  2.88it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  3.64it/s][A04/21/2024 13:46:13 - INFO - trainer.trainer_mod - Epoch 27 finished. Took 49.19 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.45it/s]
Epoch:  28%|██▊       | 28/100 [22:15<57:59, 48.32s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.07it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.19it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.24it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.25it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.17it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.97it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.09it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.13it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.29it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.30it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.33it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.34it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.78it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.91it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.08it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.79it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.97it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:35,  6.97it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.09it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.92it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.01it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.01it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.07it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.27it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.29it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.13it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.96it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.95it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.07it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  7.07it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.02it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:32,  7.07it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.10it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:31,  7.17it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.27it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:29,  7.44it/s][A[INFO|trainer.py:570] 2024-04-21 13:46:19,988 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:46:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:46:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:46:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:46:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.86it/s]04/21/2024 13:46:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:46:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44960521225224076, 'eval_loss': 0.8664099, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1467, 1500, 1724, 1664, 1500, 1384, 971, 713, 505, 267, 417, 150], 'head_nums': [7, 4, 4, 5, 9, 11, 9, 8, 5, 3, 2, 1], 'pruned_params': 53732628, 'remaining_params': 31284972, 'pruned_model_sparsity': 0.6320176998644986, 'expected_sparsity': 0.63207, 'target_sparsity': 0.6, 'step': 7550}


Iteration:  17%|█▋        | 46/268 [00:08<02:43,  1.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:04,  1.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:35,  2.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:16,  2.87it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:02,  3.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:52,  4.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:45,  4.78it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:40,  5.32it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:37,  5.78it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:34,  6.23it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:32,  6.49it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.02it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.09it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.33it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.13it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.12it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.09it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.14it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.05it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.02it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.18it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.20it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.21it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.25it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.44it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.20it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.23it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:26,  7.07it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:26,  6.94it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.26it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.17it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:25,  7.05it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.11it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.19it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:24,  7.20it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:23,  7.28it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:23,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 13:46:28,938 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:46:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:46:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:46:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:46:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.87it/s]04/21/2024 13:46:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:46:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4874630840410334, 'eval_loss': 0.86875147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1461, 1494, 1719, 1659, 1496, 1379, 968, 710, 503, 265, 416, 149], 'head_nums': [7, 4, 4, 5, 9, 11, 9, 8, 4, 3, 2, 1], 'pruned_params': 53990004, 'remaining_params': 31027596, 'pruned_model_sparsity': 0.635045025971093, 'expected_sparsity': 0.63344, 'target_sparsity': 0.6, 'step': 7600}


Iteration:  36%|███▌      | 96/268 [00:17<02:06,  1.36it/s][A04/21/2024 13:46:30 - INFO - trainer.trainer_mod - v4 Global step: 7600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:17<01:35,  1.79it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<01:12,  2.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:58,  2.91it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:47,  3.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:39,  4.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:34,  4.80it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:30,  5.42it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:27,  5.99it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:26,  6.15it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:24,  6.56it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:23,  6.93it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.03it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.03it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.16it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.18it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.30it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.32it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.24it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.28it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.29it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.28it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.29it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.32it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.30it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.16it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.10it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.19it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.20it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.24it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.29it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.31it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.33it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.33it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.36it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.33it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.15it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.31it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.21it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.22it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:16,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 13:46:37,779 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:46:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:46:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:46:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:46:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:46:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:46:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.430068851121999, 'eval_loss': 1.0128295, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1456, 1488, 1714, 1654, 1491, 1374, 965, 707, 501, 262, 415, 149], 'head_nums': [7, 4, 4, 5, 9, 11, 9, 8, 4, 3, 2, 1], 'pruned_params': 54051284, 'remaining_params': 30966316, 'pruned_model_sparsity': 0.6357658179012345, 'expected_sparsity': 0.63489, 'target_sparsity': 0.6, 'step': 7650}


Iteration:  54%|█████▍    | 146/268 [00:26<01:29,  1.36it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<01:07,  1.80it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:51,  2.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:40,  2.92it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:33,  3.56it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:27,  4.21it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:24,  4.79it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:21,  5.33it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:19,  5.74it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:18,  6.08it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:17,  6.29it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.59it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.86it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.99it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.01it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.21it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.26it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.28it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.15it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.22it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.28it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.42it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.27it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.29it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.15it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.21it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.22it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.22it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.34it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.35it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.21it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.14it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.09it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.14it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.17it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.23it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:09,  7.46it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:09,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 13:46:46,665 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:46:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:46:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:46:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:46:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:46:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:46:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4050293290258522, 'eval_loss': 1.0518816, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1451, 1483, 1709, 1649, 1488, 1370, 962, 704, 498, 260, 414, 149], 'head_nums': [7, 4, 4, 4, 9, 11, 9, 8, 4, 3, 2, 1], 'pruned_params': 54304064, 'remaining_params': 30713536, 'pruned_model_sparsity': 0.6387390846130684, 'expected_sparsity': 0.63615, 'target_sparsity': 0.6, 'step': 7700}


Iteration:  73%|███████▎  | 196/268 [00:35<00:53,  1.35it/s][A04/21/2024 13:46:48 - INFO - trainer.trainer_mod - v4 Global step: 7700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:35<00:39,  1.78it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:30,  2.30it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:23,  2.89it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:19,  3.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:16,  4.12it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:13,  4.74it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:12,  5.27it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:11,  5.65it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:10,  6.05it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.74it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.97it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.10it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.16it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.20it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.22it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.15it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.16it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.03it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.20it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.26it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.27it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.29it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.46it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.37it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.28it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.28it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.17it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.05it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.03it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.04it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.11it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.21it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.22it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.23it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.26it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.27it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.32it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.20it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:41<00:03,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 13:46:55,646 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:46:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:46:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:46:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:46:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.86it/s]04/21/2024 13:46:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:46:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4589926615963024, 'eval_loss': 1.0319707, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1446, 1478, 1704, 1644, 1484, 1366, 959, 701, 496, 259, 413, 149], 'head_nums': [7, 4, 4, 4, 9, 11, 9, 8, 4, 3, 2, 1], 'pruned_params': 54360748, 'remaining_params': 30656852, 'pruned_model_sparsity': 0.6394058171484492, 'expected_sparsity': 0.6374, 'target_sparsity': 0.6, 'step': 7750}


Iteration:  92%|█████████▏| 246/268 [00:44<00:16,  1.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:11,  1.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:08,  2.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:06,  2.89it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:05,  3.51it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:04,  4.16it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:03,  4.79it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  5.29it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  5.69it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  5.92it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.17it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.32it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.50it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.71it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.01it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.11it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.13it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.21it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.24it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.79it/s][A04/21/2024 13:47:00 - INFO - trainer.trainer_mod - Epoch 28 finished. Took 47.15 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  29%|██▉       | 29/100 [23:03<56:45, 47.97s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.08it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.11it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.35it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.37it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.14it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  7.01it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  7.00it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.11it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.16it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.18it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.23it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.26it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.39it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.37it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.34it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.15it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.32it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.32it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.32it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.42it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.36it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.30it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 13:47:04,560 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:47:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:47:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:47:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:47:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.85it/s]04/21/2024 13:47:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:47:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44144178736759865, 'eval_loss': 1.199632, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1441, 1473, 1699, 1640, 1481, 1362, 957, 700, 494, 257, 413, 149], 'head_nums': [7, 4, 4, 4, 9, 11, 9, 8, 4, 3, 2, 1], 'pruned_params': 54408240, 'remaining_params': 30609360, 'pruned_model_sparsity': 0.639964430894309, 'expected_sparsity': 0.63868, 'target_sparsity': 0.6, 'step': 7800}


Iteration:  10%|█         | 28/268 [00:05<02:56,  1.36it/s][A04/21/2024 13:47:06 - INFO - trainer.trainer_mod - v4 Global step: 7800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:14,  1.78it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:44,  2.28it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:22,  2.87it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:07,  3.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:56,  4.13it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:49,  4.73it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:44,  5.29it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:41,  5.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:38,  5.97it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:36,  6.32it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.73it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.90it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.98it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.91it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.02it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.21it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.11it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.14it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.11it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.17it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.09it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.91it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.91it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.04it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.96it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.09it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.22it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.06it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.13it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.19it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.19it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.09it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.16it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.23it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.16it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.22it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.17it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.08it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.12it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.17it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.27it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 13:47:13,567 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:47:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:47:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:47:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:47:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:47:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:47:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41872963209625924, 'eval_loss': 1.0389892, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1436, 1468, 1694, 1636, 1478, 1357, 954, 697, 492, 255, 413, 149], 'head_nums': [7, 4, 4, 4, 9, 11, 9, 8, 4, 3, 2, 1], 'pruned_params': 54461860, 'remaining_params': 30555740, 'pruned_model_sparsity': 0.6405951238331827, 'expected_sparsity': 0.64007, 'target_sparsity': 0.6, 'step': 7850}


Iteration:  29%|██▉       | 78/268 [00:14<02:20,  1.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:45,  1.79it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<01:21,  2.30it/s][A
Iteration:  30%|███       | 81/268 [00:15<01:04,  2.90it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:52,  3.54it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:44,  4.15it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:38,  4.77it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:33,  5.44it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:30,  5.88it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:28,  6.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:27,  6.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  6.94it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.93it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.95it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.08it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.16it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.12it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.86it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.01it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.12it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.23it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.23it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.12it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.18it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.27it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.41it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.39it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.12it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.17it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.41it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.24it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.37it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.32it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.28it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.41it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.39it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.43it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 13:47:22,431 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:47:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:47:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:47:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:47:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:47:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:47:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48147699187266596, 'eval_loss': 0.94493353, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1431, 1463, 1690, 1632, 1473, 1352, 950, 693, 489, 253, 412, 149], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 8, 4, 3, 2, 1], 'pruned_params': 54915332, 'remaining_params': 30102268, 'pruned_model_sparsity': 0.64592898411623, 'expected_sparsity': 0.64144, 'target_sparsity': 0.6, 'step': 7900}


Iteration:  48%|████▊     | 128/268 [00:23<01:42,  1.36it/s][A04/21/2024 13:47:24 - INFO - trainer.trainer_mod - v4 Global step: 7900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:17,  1.79it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:59,  2.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:46,  2.93it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:38,  3.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:32,  4.18it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:27,  4.80it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:25,  5.28it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:22,  5.78it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:21,  6.10it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.89it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.00it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.18it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.23it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.09it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.13it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.19it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.31it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.18it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.20it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.20it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  6.88it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.10it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.03it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.12it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.17it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.23it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.06it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  6.98it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.93it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.05it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.20it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.31it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.17it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.14it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:47:31,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:47:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:47:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:47:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:47:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.80it/s]04/21/2024 13:47:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:47:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.459498988262129, 'eval_loss': 1.0206444, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1426, 1459, 1685, 1627, 1469, 1348, 946, 689, 487, 252, 412, 149], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 8, 4, 3, 2, 1], 'pruned_params': 54972016, 'remaining_params': 30045584, 'pruned_model_sparsity': 0.646595716651611, 'expected_sparsity': 0.64266, 'target_sparsity': 0.6, 'step': 7950}


Iteration:  66%|██████▋   | 178/268 [00:32<01:06,  1.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:49,  1.79it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:37,  2.32it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:29,  2.95it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:23,  3.62it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:19,  4.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:17,  4.90it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:15,  5.45it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:13,  5.99it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:12,  6.34it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.50it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.84it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.99it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.04it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.12it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.18it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.23it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.27it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.33it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.24it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.26it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.28it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.16it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.23it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.26it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.17it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.03it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.11it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.15it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  6.96it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  6.88it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.10it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.06it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.94it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.97it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.04it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.11it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.20it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  6.74it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.89it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.07it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.01it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  6.93it/s][A[INFO|trainer.py:570] 2024-04-21 13:47:40,369 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:47:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:47:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:47:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:47:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:47:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:47:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.429931898675694, 'eval_loss': 1.0049666, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1422, 1454, 1682, 1623, 1466, 1344, 944, 686, 485, 250, 411, 149], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55215604, 'remaining_params': 29801996, 'pruned_model_sparsity': 0.6494608645739235, 'expected_sparsity': 0.64382, 'target_sparsity': 0.6, 'step': 8000}


Iteration:  85%|████████▌ | 228/268 [00:41<00:29,  1.34it/s][A04/21/2024 13:47:42 - INFO - trainer.trainer_mod - v4 Global step: 8000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:41<00:21,  1.77it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:16,  2.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:12,  2.89it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:10,  3.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:08,  4.17it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:07,  4.79it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:06,  5.34it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:05,  5.92it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.30it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.72it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.03it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.13it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.08it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.18it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.11it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.14it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.21it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.25it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.17it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.23it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.23it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.23it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.24it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.19it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.22it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.36it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.56it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.25it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.23it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.10it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.08it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.09it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.69it/s][A04/21/2024 13:47:47 - INFO - trainer.trainer_mod - Epoch 29 finished. Took 47.16 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  30%|███       | 30/100 [23:50<55:40, 47.73s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.98it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.84it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.05it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.53it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.37it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 13:47:49,229 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:47:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:47:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:47:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:47:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:47:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:47:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46916929434481164, 'eval_loss': 1.1117359, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1418, 1451, 1678, 1620, 1463, 1340, 941, 684, 483, 248, 411, 149], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55258500, 'remaining_params': 29759100, 'pruned_model_sparsity': 0.6499654189250226, 'expected_sparsity': 0.6448, 'target_sparsity': 0.6, 'step': 8050}


Iteration:   4%|▎         | 10/268 [00:03<03:14,  1.32it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:24,  1.77it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:51,  2.30it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:27,  2.91it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:11,  3.57it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:00,  4.19it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:51,  4.88it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:46,  5.40it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:42,  5.85it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.23it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.66it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:36,  6.84it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:35,  6.99it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.07it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.02it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.12it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.18it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.21it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.23it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.24it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.36it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.23it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.25it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.22it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.20it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.23it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.05it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:33,  6.75it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:33,  6.80it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.92it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.06it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.51it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.63it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.60it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.58it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.68it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 13:47:58,061 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:47:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:47:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:47:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:47:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:48:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:48:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.461657758221915, 'eval_loss': 0.985826, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1415, 1447, 1676, 1617, 1460, 1337, 939, 682, 481, 247, 410, 148], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55296800, 'remaining_params': 29720800, 'pruned_model_sparsity': 0.650415913881361, 'expected_sparsity': 0.64562, 'target_sparsity': 0.6, 'step': 8100}


Iteration:  22%|██▏       | 60/268 [00:12<02:33,  1.36it/s][A04/21/2024 13:48:00 - INFO - trainer.trainer_mod - v4 Global step: 8100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:55,  1.79it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:28,  2.33it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:10,  2.89it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:58,  3.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:48,  4.15it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:42,  4.76it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:37,  5.31it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:34,  5.79it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:32,  6.15it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:28,  6.95it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:27,  7.04it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  7.14it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.19it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.19it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.22it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.11it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.05it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.93it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.83it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.93it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.04it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  7.06it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.95it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.14it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.21it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.16it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.17it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.19it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.20it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.22it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.38it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.10it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.99it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.06it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.19it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.27it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.25it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.29it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.35it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.36it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 13:48:07,025 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:48:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:48:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:48:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:48:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:48:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:48:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46654885649873884, 'eval_loss': 0.9084887, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1412, 1444, 1672, 1613, 1457, 1335, 937, 680, 480, 245, 410, 148], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55333568, 'remaining_params': 29684032, 'pruned_model_sparsity': 0.650848389039446, 'expected_sparsity': 0.64638, 'target_sparsity': 0.6, 'step': 8150}


Iteration:  41%|████      | 110/268 [00:21<01:56,  1.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<01:27,  1.79it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<01:07,  2.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:52,  2.94it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:42,  3.61it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:35,  4.25it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:31,  4.82it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:28,  5.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:26,  5.72it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:24,  6.10it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.77it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.93it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.01it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.00it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.07it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.15it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.32it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.34it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.34it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.17it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.13it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.19it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.09it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.04it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.11it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.06it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.15it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.22it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.39it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.49it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.48it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.39it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.25it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.31it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:14,  7.70it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.59it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 13:48:15,840 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:48:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:48:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:48:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:48:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:48:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:48:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4062739343500811, 'eval_loss': 1.049428, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1411, 1441, 1669, 1610, 1454, 1332, 935, 677, 478, 244, 410, 148], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55368804, 'remaining_params': 29648796, 'pruned_model_sparsity': 0.6512628443992773, 'expected_sparsity': 0.64713, 'target_sparsity': 0.6, 'step': 8200}


Iteration:  60%|█████▉    | 160/268 [00:29<01:19,  1.36it/s][A04/21/2024 13:48:17 - INFO - trainer.trainer_mod - v4 Global step: 8200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:30<01:00,  1.78it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:46,  2.30it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:36,  2.88it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:29,  3.51it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:25,  4.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:22,  4.63it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:19,  5.23it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:17,  5.72it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:16,  6.13it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:15,  6.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.78it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.78it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.94it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.16it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.16it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.11it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.17it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.14it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.17it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.01it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.10it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.16it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.21it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.28it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.28it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.12it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.22it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.02it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.19it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.36it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.27it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.17it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.15it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.28it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.24it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.33it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.18it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.80it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.83it/s][A[INFO|trainer.py:570] 2024-04-21 13:48:24,848 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:48:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:48:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:48:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:48:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:48:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:48:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4325231818860751, 'eval_loss': 1.1196277, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1408, 1439, 1666, 1607, 1452, 1330, 934, 676, 477, 244, 409, 148], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55397912, 'remaining_params': 29619688, 'pruned_model_sparsity': 0.6516052205660946, 'expected_sparsity': 0.64785, 'target_sparsity': 0.6, 'step': 8250}


Iteration:  78%|███████▊  | 210/268 [00:38<00:43,  1.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:32,  1.78it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:24,  2.30it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:19,  2.89it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:15,  3.49it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:12,  4.13it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:11,  4.68it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:09,  5.19it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:08,  5.78it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.14it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.98it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.06it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.13it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.12it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.21it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.03it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.00it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.06it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.14it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.21it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.05it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.15it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.12it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.17it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.13it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.09it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.11it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.18it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.15it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.09it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.15it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.17it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.14it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.23it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.48it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.42it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.40it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.17it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 13:48:33,806 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:48:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:48:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:48:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:48:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:48:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:48:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4587117762521935, 'eval_loss': 1.1358502, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1404, 1436, 1664, 1606, 1451, 1329, 933, 676, 476, 242, 408, 148], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55420892, 'remaining_params': 29596708, 'pruned_model_sparsity': 0.6518755175398976, 'expected_sparsity': 0.64845, 'target_sparsity': 0.6, 'step': 8300}


Iteration:  97%|█████████▋| 260/268 [00:47<00:05,  1.35it/s][A04/21/2024 13:48:35 - INFO - trainer.trainer_mod - v4 Global step: 8300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:48<00:03,  1.79it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:02,  2.31it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:01,  2.88it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  3.52it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  4.18it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  4.76it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  5.32it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  6.15it/s][A04/21/2024 13:48:36 - INFO - trainer.trainer_mod - Epoch 30 finished. Took 49.03 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.47it/s]
Epoch:  31%|███       | 31/100 [24:39<55:20, 48.12s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  8.06it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.21it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.22it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.65it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.81it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  7.00it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.01it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.21it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.08it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.13it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  7.02it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.39it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.37it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.35it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.31it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.19it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.13it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.08it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.04it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.13it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.15it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.20it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.11it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.14it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.35it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.56it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:29,  7.76it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:29,  7.68it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:29,  7.69it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 13:48:42,658 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:48:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:48:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:48:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:48:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:48:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:48:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4608699132150092, 'eval_loss': 1.0048206, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1401, 1433, 1661, 1603, 1448, 1326, 931, 674, 475, 241, 408, 148], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55456128, 'remaining_params': 29561472, 'pruned_model_sparsity': 0.652289972899729, 'expected_sparsity': 0.64935, 'target_sparsity': 0.6, 'step': 8350}


Iteration:  16%|█▌        | 42/268 [00:07<02:46,  1.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:04,  1.80it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:36,  2.31it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:16,  2.91it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:02,  3.55it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:52,  4.18it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:45,  4.80it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:40,  5.34it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:37,  5.82it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:35,  6.13it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.58it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.79it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.81it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.13it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.18it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.22it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.38it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.36it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.44it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.36it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.11it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.19it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.25it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.17it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.99it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.22it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.20it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.22it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.38it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.06it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:27,  6.94it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.07it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.13it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.10it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.21it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.31it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.46it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.49it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:23,  7.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.50it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 13:48:51,526 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:48:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:48:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:48:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:48:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:48:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:48:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.459498988262129, 'eval_loss': 0.9779133, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1399, 1431, 1658, 1601, 1445, 1323, 929, 671, 473, 240, 408, 148], 'head_nums': [7, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55489832, 'remaining_params': 29527768, 'pruned_model_sparsity': 0.6526864084613069, 'expected_sparsity': 0.65011, 'target_sparsity': 0.6, 'step': 8400}


Iteration:  34%|███▍      | 92/268 [00:16<02:09,  1.36it/s][A04/21/2024 13:48:53 - INFO - trainer.trainer_mod - v4 Global step: 8400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:37,  1.80it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<01:14,  2.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:00,  2.88it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:48,  3.52it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:41,  4.16it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:35,  4.78it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:31,  5.34it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:28,  5.80it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:27,  6.12it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:26,  6.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:24,  6.66it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  6.87it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  6.96it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.07it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.17it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.21it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.22it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.23it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.25it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.07it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.15it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.13it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:21,  7.01it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.12it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.20it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.22it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.15it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.20it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:20,  7.21it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.26it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.30it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.13it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.19it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.26it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.19it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.22it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.28it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.37it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.29it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.47it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.49it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.47it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.47it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.49it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.53it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 13:49:00,434 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:49:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:49:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:49:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:49:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:49:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:49:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4529794977975582, 'eval_loss': 1.0978073, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1396, 1428, 1655, 1598, 1444, 1321, 927, 670, 472, 239, 407, 148], 'head_nums': [6, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55716568, 'remaining_params': 29301032, 'pruned_model_sparsity': 0.6553533386028305, 'expected_sparsity': 0.65079, 'target_sparsity': 0.6, 'step': 8450}


Iteration:  53%|█████▎    | 142/268 [00:25<01:33,  1.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<01:09,  1.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:53,  2.30it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:42,  2.90it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:34,  3.52it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:29,  4.16it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:25,  4.78it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:22,  5.33it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:20,  5.79it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:18,  6.17it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.95it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.07it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.04it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.10it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.15it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.96it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.09it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.14it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.31it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.12it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  6.95it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  6.95it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.17it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.19it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.21it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.26it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.25it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  6.91it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.02it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.22it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  7.05it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.25it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.29it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.33it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.17it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.29it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.62it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.46it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.50it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 13:49:09,350 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:49:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:49:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:49:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:49:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 13:49:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:49:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4664421689634896, 'eval_loss': 1.098438, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1394, 1426, 1652, 1596, 1442, 1319, 925, 668, 471, 238, 407, 148], 'head_nums': [6, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55744144, 'remaining_params': 29273456, 'pruned_model_sparsity': 0.6556776949713942, 'expected_sparsity': 0.65141, 'target_sparsity': 0.6, 'step': 8500}


Iteration:  72%|███████▏  | 192/268 [00:34<00:56,  1.35it/s][A04/21/2024 13:49:11 - INFO - trainer.trainer_mod - v4 Global step: 8500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:34<00:41,  1.79it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:32,  2.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:25,  2.88it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:20,  3.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:16,  4.18it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:14,  4.81it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:12,  5.36it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:11,  5.84it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:10,  6.21it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:10,  6.35it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.52it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.59it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  6.94it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.97it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.90it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.02it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.12it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.18it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.24it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.25it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.23it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.18it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.01it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  6.98it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.11it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.19it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.23it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.15it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.20it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.25it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.19it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.23it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.10it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.36it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.16it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.26it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.41it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:49:18,301 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:49:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:49:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:49:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:49:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:49:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:49:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4297412045484628, 'eval_loss': 1.1517153, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1391, 1423, 1650, 1594, 1440, 1316, 924, 666, 469, 237, 407, 148], 'head_nums': [6, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55774784, 'remaining_params': 29242816, 'pruned_model_sparsity': 0.6560380909364649, 'expected_sparsity': 0.65203, 'target_sparsity': 0.6, 'step': 8550}


Iteration:  90%|█████████ | 242/268 [00:43<00:19,  1.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:14,  1.77it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:10,  2.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:07,  2.89it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:06,  3.52it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:05,  4.16it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:04,  4.79it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:03,  5.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:03,  5.83it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.21it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.50it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.75it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.01it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.27it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.26it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.16it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.21it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.80it/s][A04/21/2024 13:49:23 - INFO - trainer.trainer_mod - Epoch 31 finished. Took 46.97 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.71it/s]
Epoch:  32%|███▏      | 32/100 [25:26<54:08, 47.77s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.95it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.12it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.00it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.07it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.10it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.14it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.19it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.24it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.18it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.24it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.23it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.29it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.26it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.39it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.56it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.58it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.34it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.29it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 13:49:27,158 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:49:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:49:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:49:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:49:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:49:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:49:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44791344231403457, 'eval_loss': 0.97931725, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1389, 1420, 1648, 1592, 1438, 1314, 923, 665, 469, 236, 406, 148], 'head_nums': [6, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55799296, 'remaining_params': 29218304, 'pruned_model_sparsity': 0.6563264077085216, 'expected_sparsity': 0.65279, 'target_sparsity': 0.6, 'step': 8600}


Iteration:   9%|▉         | 24/268 [00:05<03:00,  1.35it/s][A04/21/2024 13:49:29 - INFO - trainer.trainer_mod - v4 Global step: 8600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:15,  1.79it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:44,  2.31it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:23,  2.89it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:07,  3.53it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:57,  4.19it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:49,  4.85it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:44,  5.36it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:41,  5.74it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:38,  6.13it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:34,  6.68it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:33,  6.84it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.89it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.96it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.04it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.03it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.88it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.91it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.01it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.95it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.98it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.05it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.10it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.97it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.94it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.03it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.95it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.93it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.05it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.15it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.21it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.04it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.17it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.30it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.25it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.52it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.76it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.72it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.59it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:25,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 13:49:36,101 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:49:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:49:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:49:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:49:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:49:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:49:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41523521474065717, 'eval_loss': 1.0734341, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1387, 1419, 1647, 1591, 1436, 1313, 922, 664, 468, 236, 406, 148], 'head_nums': [6, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55816148, 'remaining_params': 29201452, 'pruned_model_sparsity': 0.6565246254893105, 'expected_sparsity': 0.65325, 'target_sparsity': 0.6, 'step': 8650}


Iteration:  28%|██▊       | 74/268 [00:14<02:23,  1.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:47,  1.79it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:23,  2.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:05,  2.91it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:54,  3.47it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:45,  4.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:39,  4.74it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:35,  5.29it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:32,  5.78it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.19it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.74it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.88it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.11it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.16it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.10it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.18it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.07it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.03it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.09it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.17it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.41it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.31it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.29it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.01it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.12it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.16it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.09it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.08it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.14it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.06it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.91it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.82it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  7.01it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.13it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.29it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.40it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.31it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 13:49:45,065 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:49:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:49:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:49:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:49:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:49:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:49:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4355040303603752, 'eval_loss': 1.2229767, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1385, 1416, 1645, 1590, 1436, 1312, 922, 664, 468, 235, 406, 148], 'head_nums': [6, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55829936, 'remaining_params': 29187664, 'pruned_model_sparsity': 0.6566868036735923, 'expected_sparsity': 0.65366, 'target_sparsity': 0.6, 'step': 8700}


Iteration:  46%|████▋     | 124/268 [00:23<01:46,  1.35it/s][A04/21/2024 13:49:47 - INFO - trainer.trainer_mod - v4 Global step: 8700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:23<01:19,  1.79it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<01:01,  2.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:48,  2.91it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:39,  3.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:33,  4.15it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:29,  4.66it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:26,  5.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:24,  5.67it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:22,  6.09it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.40it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.66it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.77it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.75it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.83it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  6.98it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.05it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:16,  7.30it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.33it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.51it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.32it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.15it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.31it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.32it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.24it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.26it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.31it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.45it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.38it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.19it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.25it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.36it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.31it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.36it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.28it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.18it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.28it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 13:49:53,964 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:49:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:49:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:49:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:49:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:49:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:49:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4695101101903524, 'eval_loss': 0.9921023, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1383, 1414, 1642, 1587, 1434, 1309, 919, 661, 467, 234, 406, 148], 'head_nums': [6, 3, 4, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 55863640, 'remaining_params': 29153960, 'pruned_model_sparsity': 0.6570832392351701, 'expected_sparsity': 0.65444, 'target_sparsity': 0.6, 'step': 8750}


Iteration:  65%|██████▍   | 174/268 [00:32<01:09,  1.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:51,  1.79it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:39,  2.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:32,  2.84it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:25,  3.47it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:21,  4.12it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:18,  4.73it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:16,  5.29it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:15,  5.66it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:14,  6.06it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:13,  6.39it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.63it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.79it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.95it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.06it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.26it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.25it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.19it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.30it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.08it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  7.03it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.09it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.27it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.28it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.27it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.09it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.17it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.23it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.22it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.22it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.39it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.35it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.36it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.59it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.55it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.95it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.87it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.06it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.10it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.14it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 13:50:02,911 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:50:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:50:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:50:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:50:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:50:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:50:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4587117762521935, 'eval_loss': 1.0567318, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1382, 1411, 1639, 1585, 1432, 1306, 917, 659, 465, 233, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56091908, 'remaining_params': 28925692, 'pruned_model_sparsity': 0.6597681891749473, 'expected_sparsity': 0.65504, 'target_sparsity': 0.6, 'step': 8800}


Iteration:  84%|████████▎ | 224/268 [00:41<00:32,  1.34it/s][A04/21/2024 13:50:04 - INFO - trainer.trainer_mod - v4 Global step: 8800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:41<00:24,  1.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:18,  2.30it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:14,  2.89it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:11,  3.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:09,  4.10it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:08,  4.68it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:07,  5.19it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:06,  5.76it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.23it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.52it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.92it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.04it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.12it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.05it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.14it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.20it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.24it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.27it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.26it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.28it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.13it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.16it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.20it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.39it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.48it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.34it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.42it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.47it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.40it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.30it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.90it/s][A04/21/2024 13:50:10 - INFO - trainer.trainer_mod - Epoch 32 finished. Took 47.06 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  33%|███▎      | 33/100 [26:13<53:06, 47.56s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.50it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.77it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.48it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.77it/s][A[INFO|trainer.py:570] 2024-04-21 13:50:11,712 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:50:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:50:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:50:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:50:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:50:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:50:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4610923588834867, 'eval_loss': 1.0819516, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1380, 1410, 1638, 1583, 1431, 1305, 916, 658, 465, 232, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56107228, 'remaining_params': 28910372, 'pruned_model_sparsity': 0.6599483871574827, 'expected_sparsity': 0.65547, 'target_sparsity': 0.6, 'step': 8850}


Iteration:   2%|▏         | 6/268 [00:02<03:33,  1.23it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:34,  1.68it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:56,  2.23it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:31,  2.84it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:13,  3.53it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:01,  4.15it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:53,  4.77it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:47,  5.32it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:43,  5.79it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:40,  6.18it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:38,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:37,  6.71it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:36,  6.88it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:35,  6.96it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.85it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  6.96it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:35,  6.97it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.08it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:33,  7.25it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.19it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.23it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.24it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.26it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.16it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.23it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.28it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.22it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.15it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.15it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.60it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.30it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.42it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.38it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 13:50:20,588 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:50:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:50:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:50:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:50:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:50:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:50:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4555180203379525, 'eval_loss': 1.0352609, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1377, 1408, 1635, 1580, 1429, 1302, 913, 655, 464, 232, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56142464, 'remaining_params': 28875136, 'pruned_model_sparsity': 0.660362842517314, 'expected_sparsity': 0.65601, 'target_sparsity': 0.6, 'step': 8900}


Iteration:  21%|██        | 56/268 [00:11<02:36,  1.35it/s][A04/21/2024 13:50:22 - INFO - trainer.trainer_mod - v4 Global step: 8900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:58,  1.79it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<01:31,  2.30it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:11,  2.91it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:58,  3.54it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:50,  4.11it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:43,  4.72it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:40,  5.09it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:36,  5.59it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:33,  6.02it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:30,  6.62it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:29,  6.80it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  7.06it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.15it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.20it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:27,  7.20it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.34it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.23it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.15it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.01it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  6.99it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.09it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.94it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.05it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  7.03it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.06it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.12it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.18it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.10it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.30it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.13it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.46it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.35it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.37it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.21it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.45it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.45it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:21,  7.60it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.47it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.69it/s][A[INFO|trainer.py:570] 2024-04-21 13:50:29,485 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:50:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:50:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:50:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:50:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:50:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:50:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44455763518973207, 'eval_loss': 0.95997536, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1376, 1407, 1634, 1579, 1427, 1300, 912, 653, 463, 231, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56160848, 'remaining_params': 28856752, 'pruned_model_sparsity': 0.6605790800963566, 'expected_sparsity': 0.65645, 'target_sparsity': 0.6, 'step': 8950}


Iteration:  40%|███▉      | 106/268 [00:20<01:58,  1.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:29,  1.80it/s][A
Iteration:  40%|████      | 108/268 [00:20<01:08,  2.34it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:54,  2.94it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:44,  3.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:37,  4.21it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:32,  4.83it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:28,  5.37it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:26,  5.84it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.63it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.74it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:21,  6.90it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  6.84it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.69it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.86it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.01it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.03it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.00it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.93it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.87it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.92it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.93it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.17it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.10it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.21it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.22it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.22it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.24it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.24it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.26it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.26it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.21it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.31it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.24it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.30it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.17it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.25it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.43it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.35it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.49it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 13:50:38,417 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:50:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:50:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:50:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:50:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:50:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:50:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.430068851121999, 'eval_loss': 1.100638, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1375, 1405, 1633, 1578, 1427, 1299, 912, 654, 464, 232, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56166976, 'remaining_params': 28850624, 'pruned_model_sparsity': 0.6606511592893707, 'expected_sparsity': 0.65659, 'target_sparsity': 0.6, 'step': 9000}


Iteration:  58%|█████▊    | 156/268 [00:29<01:22,  1.36it/s][A04/21/2024 13:50:40 - INFO - trainer.trainer_mod - v4 Global step: 9000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:29<01:01,  1.79it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:47,  2.30it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:37,  2.91it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:30,  3.56it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:25,  4.19it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:22,  4.79it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:19,  5.33it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:17,  5.88it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:16,  6.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.60it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.92it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  7.04it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.12it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.16it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.09it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.16it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.97it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  7.07it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.13it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.08it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.09it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.28it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.28it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.29it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.41it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:10,  7.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.32it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.20it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.32it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.11it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.15it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.44it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.24it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.24it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.30it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.21it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.20it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.32it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.53it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.35it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 13:50:47,296 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:50:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:50:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:50:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:50:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:50:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:50:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4509257189091659, 'eval_loss': 1.0667506, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1374, 1403, 1631, 1576, 1425, 1297, 909, 652, 462, 231, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56194552, 'remaining_params': 28823048, 'pruned_model_sparsity': 0.6609755156579343, 'expected_sparsity': 0.65694, 'target_sparsity': 0.6, 'step': 9050}


Iteration:  77%|███████▋  | 206/268 [00:38<00:45,  1.35it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:34,  1.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:26,  2.27it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:20,  2.86it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:16,  3.50it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:13,  4.18it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:11,  4.80it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:10,  5.42it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:09,  5.89it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:08,  6.15it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.72it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.88it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.66it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.84it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.96it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.97it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.10it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.06it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.05it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.14it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.20it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.21it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.09it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.14it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.97it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.03it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.04it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.21it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.15it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.11it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.12it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.22it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.34it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.37it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.60it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.58it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.77it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:01,  7.66it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 13:50:56,215 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:50:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:50:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:50:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:50:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:50:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:50:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47053580111209176, 'eval_loss': 1.0046666, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1373, 1402, 1630, 1575, 1424, 1294, 907, 650, 462, 231, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56212936, 'remaining_params': 28804664, 'pruned_model_sparsity': 0.6611917532369768, 'expected_sparsity': 0.65717, 'target_sparsity': 0.6, 'step': 9100}


Iteration:  96%|█████████▌| 256/268 [00:47<00:08,  1.36it/s][A04/21/2024 13:50:58 - INFO - trainer.trainer_mod - v4 Global step: 9100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:47<00:06,  1.80it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:04,  2.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:03,  2.91it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:02,  3.52it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  4.16it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  4.78it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  5.28it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  5.61it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.06it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.31it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.59it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.24it/s][A04/21/2024 13:50:59 - INFO - trainer.trainer_mod - Epoch 33 finished. Took 48.96 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.47it/s]
Epoch:  34%|███▍      | 34/100 [27:02<52:46, 47.98s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.69it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.05it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.21it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.28it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.28it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.26it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.26it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.23it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.33it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.12it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.01it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.11it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.07it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.04it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.11it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.14it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.16it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.21it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.04it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.04it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.27it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.34it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.29it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.36it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:31,  7.59it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.28it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.34it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 13:51:05,122 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:51:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:51:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:51:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:51:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:51:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:51:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4557726198308099, 'eval_loss': 1.1355109, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1372, 1401, 1629, 1574, 1423, 1292, 906, 649, 462, 230, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56226724, 'remaining_params': 28790876, 'pruned_model_sparsity': 0.6613539314212586, 'expected_sparsity': 0.65757, 'target_sparsity': 0.6, 'step': 9150}


Iteration:  14%|█▍        | 38/268 [00:07<02:50,  1.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:08,  1.78it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:39,  2.29it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:18,  2.91it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:04,  3.52it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:54,  4.16it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:46,  4.77it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:41,  5.34it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:37,  5.88it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:35,  6.26it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:32,  6.67it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.98it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.98it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.06it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.03it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.13it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.22it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.30it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.20it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.14it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.07it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.12it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.35it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.23it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:28,  7.02it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.13it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.29it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.37it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.32it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.44it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:24,  7.48it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.53it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.56it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.53it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.53it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 13:51:13,987 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:51:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:51:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:51:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:51:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:51:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:51:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42676403064167506, 'eval_loss': 1.1937852, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1371, 1400, 1627, 1575, 1423, 1293, 907, 649, 462, 229, 405, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56228256, 'remaining_params': 28789344, 'pruned_model_sparsity': 0.6613719512195122, 'expected_sparsity': 0.65804, 'target_sparsity': 0.6, 'step': 9200}


Iteration:  33%|███▎      | 88/268 [00:16<02:12,  1.36it/s][A04/21/2024 13:51:16 - INFO - trainer.trainer_mod - v4 Global step: 9200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:39,  1.80it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<01:16,  2.32it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:00,  2.92it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:49,  3.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:41,  4.23it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:36,  4.77it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:32,  5.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:29,  5.80it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:28,  6.05it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:25,  6.63it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  6.96it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.99it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.11it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.26it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.27it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.18it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.21it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.22it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.25it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.24it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.02it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.13it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.01it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.20it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.08it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.12it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.17it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.04it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:21,  6.92it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:20,  7.08it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.08it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:20,  6.77it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:20,  6.92it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.09it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.23it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.19it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.26it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:19,  6.95it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.25it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.28it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 13:51:22,960 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:51:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:51:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:51:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:51:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:51:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:51:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4608700525278083, 'eval_loss': 1.0626706, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1370, 1399, 1626, 1573, 1421, 1292, 905, 648, 461, 229, 404, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56248172, 'remaining_params': 28769428, 'pruned_model_sparsity': 0.6616062085968082, 'expected_sparsity': 0.65855, 'target_sparsity': 0.6, 'step': 9250}


Iteration:  51%|█████▏    | 138/268 [00:25<01:36,  1.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<01:12,  1.79it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:55,  2.31it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:44,  2.88it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:35,  3.51it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:30,  4.16it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:26,  4.73it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:23,  5.28it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:21,  5.73it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:19,  6.10it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:18,  6.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.76it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:17,  6.92it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  6.91it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.01it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.07it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.15it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.18it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.21it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.24it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.22it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.24it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.23it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.25it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.23it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  6.95it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.95it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:14,  6.92it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.10it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.35it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.51it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.37it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.42it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.59it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.36it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.25it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.31it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 13:51:31,876 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:51:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:51:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:51:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:51:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:51:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:51:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48453921534304883, 'eval_loss': 0.9178613, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1370, 1398, 1625, 1572, 1420, 1290, 905, 648, 461, 229, 404, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56257364, 'remaining_params': 28760236, 'pruned_model_sparsity': 0.6617143273863294, 'expected_sparsity': 0.6588, 'target_sparsity': 0.6, 'step': 9300}


Iteration:  70%|███████   | 188/268 [00:34<00:58,  1.36it/s][A04/21/2024 13:51:33 - INFO - trainer.trainer_mod - v4 Global step: 9300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:34<00:44,  1.79it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:33,  2.31it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:26,  2.90it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:21,  3.52it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:18,  4.16it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:15,  4.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:13,  5.36it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:12,  5.84it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:11,  6.20it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.06it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.12it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.20it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.22it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.25it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.29it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.06it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.18it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.14it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.19it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.23it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.31it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.33it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.31it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.32it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.14it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.27it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.33it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.29it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.33it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.41it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.22it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.33it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.19it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.19it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.24it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:51:40,750 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:51:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:51:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:51:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:51:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:51:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:51:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4590711382588545, 'eval_loss': 1.052196, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1369, 1397, 1623, 1570, 1419, 1288, 903, 647, 462, 229, 404, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56274216, 'remaining_params': 28743384, 'pruned_model_sparsity': 0.6619125451671183, 'expected_sparsity': 0.65927, 'target_sparsity': 0.6, 'step': 9350}


Iteration:  89%|████████▉ | 238/268 [00:42<00:22,  1.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:16,  1.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:12,  2.29it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:09,  2.86it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:07,  3.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:05,  4.18it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:05,  4.80it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:04,  5.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  5.80it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.16it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  6.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.67it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.75it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.93it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.16it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.19it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.24it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.30it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.12it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.21it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.12it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.35it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.32it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.44it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.40it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.38it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.34it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.37it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.89it/s][A04/21/2024 13:51:46 - INFO - trainer.trainer_mod - Epoch 34 finished. Took 46.98 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.70it/s]
Epoch:  35%|███▌      | 35/100 [27:49<51:39, 47.68s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.37it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.17it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.20it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.35it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.22it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.29it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.36it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.16it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.16it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.62it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.62it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.61it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.56it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.66it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.71it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 13:51:49,554 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:51:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:51:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:51:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:51:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.80it/s]04/21/2024 13:51:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:51:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43539171521562814, 'eval_loss': 1.2264726, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1369, 1396, 1623, 1569, 1418, 1287, 902, 645, 461, 229, 404, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56286472, 'remaining_params': 28731128, 'pruned_model_sparsity': 0.6620567035531466, 'expected_sparsity': 0.65945, 'target_sparsity': 0.6, 'step': 9400}


Iteration:   7%|▋         | 20/268 [00:04<03:02,  1.36it/s][A04/21/2024 13:51:51 - INFO - trainer.trainer_mod - v4 Global step: 9400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:17,  1.79it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:46,  2.32it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:24,  2.91it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:08,  3.54it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:58,  4.19it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:50,  4.78it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:45,  5.28it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:41,  5.75it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:38,  6.14it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.05it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.18it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.73it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.81it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.93it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  7.02it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.10it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.14it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.05it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.11it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.16it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.20it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.13it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.97it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.94it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.15it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.21it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.49it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.54it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.46it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.25it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.31it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.15it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.22it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:51:58,516 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:51:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:51:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:51:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:51:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:52:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:52:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4383405112894723, 'eval_loss': 1.0914209, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1370, 1396, 1622, 1570, 1418, 1286, 901, 645, 461, 229, 404, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56288004, 'remaining_params': 28729596, 'pruned_model_sparsity': 0.6620747233514002, 'expected_sparsity': 0.65958, 'target_sparsity': 0.6, 'step': 9450}


Iteration:  26%|██▌       | 70/268 [00:13<02:26,  1.35it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:50,  1.78it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<01:25,  2.30it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<01:07,  2.90it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:54,  3.54it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:45,  4.22it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:39,  4.84it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:36,  5.27it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:33,  5.74it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:31,  6.07it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:29,  6.40it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.58it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.79it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:27,  6.84it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  7.01it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.02it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.13it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.35it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.16it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.17it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.18it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.10it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.14it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.21it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.13it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.15it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.07it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  6.99it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.38it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.35it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.32it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.29it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.27it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.27it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.25it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.17it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:52:07,441 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:52:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:52:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:52:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:52:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:52:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:52:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44113488112476795, 'eval_loss': 1.0219263, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1369, 1395, 1621, 1568, 1416, 1284, 900, 643, 460, 229, 404, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56307920, 'remaining_params': 28709680, 'pruned_model_sparsity': 0.6623089807286962, 'expected_sparsity': 0.66005, 'target_sparsity': 0.6, 'step': 9500}


Iteration:  45%|████▍     | 120/268 [00:22<01:49,  1.35it/s][A04/21/2024 13:52:09 - INFO - trainer.trainer_mod - v4 Global step: 9500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:22<01:22,  1.78it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<01:03,  2.30it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:50,  2.90it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:41,  3.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:34,  4.17it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:30,  4.73it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:26,  5.36it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:24,  5.83it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:22,  6.19it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.68it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.76it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.83it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.09it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.15it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.38it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.37it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.19it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.19it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.32it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.31it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.21it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.21it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.26it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.17it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.09it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.10it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.17it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.42it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.48it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.51it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.64it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.61it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.53it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.57it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:13,  7.69it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.67it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.65it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.37it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 13:52:16,268 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:52:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:52:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:52:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:52:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:52:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:52:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4537159672261629, 'eval_loss': 1.1050854, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1370, 1395, 1621, 1568, 1415, 1283, 899, 642, 460, 229, 404, 147], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56312516, 'remaining_params': 28705084, 'pruned_model_sparsity': 0.6623630401234568, 'expected_sparsity': 0.66029, 'target_sparsity': 0.6, 'step': 9550}


Iteration:  63%|██████▎   | 170/268 [00:31<01:12,  1.35it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:54,  1.79it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:41,  2.30it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:33,  2.85it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:26,  3.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:22,  4.19it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:19,  4.72it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:17,  5.20it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:15,  5.69it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:14,  5.99it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.72it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.83it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.98it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.07it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.00it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.09it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.97it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.96it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.18it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.36it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.38it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.36it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.37it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.97it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  6.90it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.06it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.18it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.29it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.25it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.72it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.87it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.75it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.83it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.70it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.65it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.40it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.60it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 13:52:25,132 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:52:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:52:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:52:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:52:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 13:52:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:52:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45524607553321794, 'eval_loss': 1.1321489, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1370, 1394, 1620, 1567, 1415, 1284, 899, 642, 460, 229, 404, 148], 'head_nums': [6, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56315580, 'remaining_params': 28702020, 'pruned_model_sparsity': 0.6623990797199638, 'expected_sparsity': 0.66042, 'target_sparsity': 0.6, 'step': 9600}


Iteration:  82%|████████▏ | 220/268 [00:40<00:35,  1.34it/s][A04/21/2024 13:52:27 - INFO - trainer.trainer_mod - v4 Global step: 9600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:40<00:26,  1.78it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:19,  2.31it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:15,  2.89it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:12,  3.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:10,  4.19it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:08,  4.75it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:07,  5.32it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:06,  5.89it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:06,  6.25it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.67it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.84it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.88it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.94it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.08it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.23it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.30it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.29it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.32it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.10it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.17it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.23it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.28it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.37it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.19it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.09it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.21it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.64it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.44it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.28it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.82it/s][A04/21/2024 13:52:33 - INFO - trainer.trainer_mod - Epoch 35 finished. Took 46.83 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.72it/s]
Epoch:  36%|███▌      | 36/100 [28:36<50:35, 47.43s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 13:52:33,974 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:52:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:52:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:52:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:52:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 13:52:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:52:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41217715910488273, 'eval_loss': 0.9464515, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1369, 1393, 1620, 1566, 1414, 1284, 899, 641, 460, 229, 404, 148], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56519336, 'remaining_params': 28498264, 'pruned_model_sparsity': 0.6647957128876845, 'expected_sparsity': 0.66064, 'target_sparsity': 0.6, 'step': 9650}


Iteration:   1%|          | 2/268 [00:02<05:52,  1.33s/it][A
Iteration:   1%|          | 3/268 [00:02<03:28,  1.27it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:19,  1.89it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:42,  2.57it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:19,  3.30it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:04,  4.02it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:55,  4.68it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:49,  5.26it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:44,  5.75it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:41,  6.16it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:39,  6.49it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:38,  6.61it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:37,  6.77it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:36,  6.90it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:35,  7.02it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:35,  7.01it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  6.96it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:35,  7.03it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.14it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.09it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.14it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.32it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.15it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.16it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.20it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.14it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.11it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.93it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.06it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.02it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.13it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.21it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.23it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.56it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.54it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.50it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.25it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.46it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:29,  7.50it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.39it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.58it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 13:52:42,881 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:52:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:52:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:52:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:52:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:52:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:52:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4419038227281786, 'eval_loss': 1.1317198, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1369, 1392, 1619, 1566, 1414, 1283, 898, 640, 459, 230, 404, 147], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56528528, 'remaining_params': 28489072, 'pruned_model_sparsity': 0.6649038316772057, 'expected_sparsity': 0.66075, 'target_sparsity': 0.6, 'step': 9700}


Iteration:  19%|█▉        | 52/268 [00:11<02:40,  1.35it/s][A04/21/2024 13:52:44 - INFO - trainer.trainer_mod - v4 Global step: 9700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:00,  1.79it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:32,  2.31it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:13,  2.89it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:00,  3.49it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:51,  4.11it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:44,  4.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:39,  5.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:36,  5.71it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:34,  6.05it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:32,  6.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.40it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:30,  6.75it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:28,  7.01it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:28,  7.12it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:28,  7.08it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.36it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.78it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:28,  6.77it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  7.04it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:27,  7.06it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  7.03it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  7.00it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.09it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.04it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.12it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.10it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.21it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.36it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:23,  7.62it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:23,  7.58it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.60it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.57it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.75it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.68it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:22,  7.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:22,  7.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.39it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.27it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 13:52:51,792 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:52:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:52:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:52:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:52:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:52:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:52:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40967417350821667, 'eval_loss': 1.1857158, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1369, 1393, 1619, 1565, 1412, 1281, 897, 638, 459, 230, 405, 147], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56537720, 'remaining_params': 28479880, 'pruned_model_sparsity': 0.6650119504667269, 'expected_sparsity': 0.66088, 'target_sparsity': 0.6, 'step': 9750}


Iteration:  38%|███▊      | 102/268 [00:20<02:03,  1.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:32,  1.79it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<01:11,  2.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:56,  2.91it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:46,  3.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:38,  4.13it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:33,  4.73it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:30,  5.18it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:27,  5.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:26,  6.01it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.63it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.81it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:21,  6.98it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:21,  6.92it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.86it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:21,  6.88it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:20,  7.13it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:20,  7.20it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.20it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.05it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  7.23it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.27it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.32it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.28it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  6.94it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.01it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  6.98it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.92it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.11it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.25it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.23it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.22it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.33it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.51it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.52it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.19it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.24it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.06it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 13:53:00,743 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:53:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:53:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:53:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:53:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 13:53:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:53:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4557726198308099, 'eval_loss': 1.0579283, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1369, 1393, 1618, 1566, 1411, 1282, 897, 638, 459, 230, 405, 148], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56537720, 'remaining_params': 28479880, 'pruned_model_sparsity': 0.6650119504667269, 'expected_sparsity': 0.66094, 'target_sparsity': 0.6, 'step': 9800}


Iteration:  57%|█████▋    | 152/268 [00:29<01:26,  1.35it/s][A04/21/2024 13:53:02 - INFO - trainer.trainer_mod - v4 Global step: 9800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:29<01:04,  1.78it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:49,  2.29it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:39,  2.88it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:31,  3.54it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:26,  4.16it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:23,  4.76it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:20,  5.30it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:18,  5.85it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.22it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.52it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.72it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:14,  6.97it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.97it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.87it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  7.00it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:13,  7.08it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.15it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.19it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.20it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.21it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.22it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.02it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.08it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.05it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.24it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.26it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.32it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.34it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.30it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.27it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.18it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.21it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.14it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 13:53:09,693 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:53:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:53:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:53:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:53:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:53:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:53:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43825163224076547, 'eval_loss': 1.1622161, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1370, 1393, 1618, 1566, 1411, 1281, 897, 638, 459, 229, 405, 147], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56537720, 'remaining_params': 28479880, 'pruned_model_sparsity': 0.6650119504667269, 'expected_sparsity': 0.66109, 'target_sparsity': 0.6, 'step': 9850}


Iteration:  75%|███████▌  | 202/268 [00:38<00:49,  1.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:36,  1.77it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:28,  2.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:21,  2.87it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:17,  3.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:14,  4.14it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:12,  4.76it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:11,  5.30it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:10,  5.77it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:09,  6.15it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.78it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.83it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.96it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.84it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.86it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.88it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.84it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  6.87it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.08it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.14it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.15it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.33it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.44it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.52it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.39it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.50it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.40it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.28it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.12it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.26it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.39it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.34it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.20it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.27it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.21it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:53:18,588 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:53:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:53:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:53:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:53:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:53:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:53:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4335972500415117, 'eval_loss': 1.1514623, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1371, 1393, 1618, 1565, 1410, 1280, 896, 637, 459, 231, 405, 148], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56543848, 'remaining_params': 28473752, 'pruned_model_sparsity': 0.665084029659741, 'expected_sparsity': 0.6612, 'target_sparsity': 0.6, 'step': 9900}


Iteration:  94%|█████████▍| 252/268 [00:46<00:11,  1.35it/s][A04/21/2024 13:53:20 - INFO - trainer.trainer_mod - v4 Global step: 9900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:47<00:08,  1.78it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:06,  2.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:04,  2.89it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:03,  3.54it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:02,  4.14it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:02,  4.82it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  5.36it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  5.75it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.11it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.69it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.97it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.05it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.12it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.16it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.69it/s][A04/21/2024 13:53:22 - INFO - trainer.trainer_mod - Epoch 36 finished. Took 49.07 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.46it/s]
Epoch:  37%|███▋      | 37/100 [29:25<50:19, 47.92s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.32it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.65it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.28it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.21it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.11it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.96it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.17it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.38it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.48it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.46it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.47it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.50it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.51it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.52it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.52it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.45it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.37it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.41it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.46it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.51it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.61it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.46it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.51it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.22it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.23it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 13:53:27,394 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:53:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:53:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:53:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:53:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 13:53:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:53:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4125966670772873, 'eval_loss': 1.0120696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1372, 1394, 1618, 1566, 1409, 1280, 896, 636, 460, 232, 406, 148], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56539252, 'remaining_params': 28478348, 'pruned_model_sparsity': 0.6650299702649805, 'expected_sparsity': 0.66109, 'target_sparsity': 0.6, 'step': 9950}


Iteration:  13%|█▎        | 34/268 [00:06<02:53,  1.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:10,  1.78it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:41,  2.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:20,  2.88it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:05,  3.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:55,  4.14it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:47,  4.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:42,  5.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:40,  5.64it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:36,  6.13it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.85it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.93it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.16it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.10it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.14it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.21it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.24it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.24it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.09it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.03it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.14it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.06it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.35it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.45it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.34it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.39it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:26,  6.99it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.06it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.15it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 13:53:36,318 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:53:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:53:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:53:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:53:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 13:53:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:53:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40649809839684037, 'eval_loss': 1.127027, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1373, 1394, 1618, 1565, 1408, 1279, 895, 635, 461, 234, 407, 149], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56542316, 'remaining_params': 28475284, 'pruned_model_sparsity': 0.6650660098614875, 'expected_sparsity': 0.66121, 'target_sparsity': 0.6, 'step': 10000}


Iteration:  31%|███▏      | 84/268 [00:15<02:16,  1.34it/s][A04/21/2024 13:53:38 - INFO - trainer.trainer_mod - v4 Global step: 10000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:42,  1.78it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:19,  2.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:02,  2.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:50,  3.53it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:42,  4.17it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:37,  4.78it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:33,  5.34it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:30,  5.80it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:28,  6.11it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:27,  6.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:26,  6.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.84it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.08it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.06it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.15it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  6.98it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.19it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.21it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.11it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:23,  6.80it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.94it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.06it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.03it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.91it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.98it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.33it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.36it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.41it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.50it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.48it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.25it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.28it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.27it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.36it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 13:53:45,230 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:53:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:53:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:53:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:53:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 13:53:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:53:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42677882373463333, 'eval_loss': 1.1636825, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1374, 1394, 1618, 1565, 1408, 1279, 895, 636, 462, 237, 410, 153], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56533124, 'remaining_params': 28484476, 'pruned_model_sparsity': 0.6649578910719662, 'expected_sparsity': 0.66112, 'target_sparsity': 0.6, 'step': 10050}


Iteration:  50%|█████     | 134/268 [00:24<01:39,  1.35it/s][A
Iteration:  50%|█████     | 135/268 [00:24<01:14,  1.79it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:57,  2.30it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:45,  2.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:37,  3.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:31,  4.09it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:26,  4.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:24,  5.28it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:21,  5.83it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:20,  6.20it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:19,  6.41it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.50it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.71it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  6.90it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.13it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.20it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.28it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.06it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.12it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.16it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.07it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.03it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  6.96it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.02it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.99it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.13it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.20it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.21it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.28it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.40it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.43it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.29it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.35it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.18it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.30it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 13:53:54,147 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:53:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:53:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:53:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:53:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:53:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:53:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4276963144473042, 'eval_loss': 1.0628744, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1375, 1395, 1618, 1566, 1409, 1280, 895, 636, 465, 243, 415, 161], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 2, 1], 'pruned_params': 56513208, 'remaining_params': 28504392, 'pruned_model_sparsity': 0.6647236336946702, 'expected_sparsity': 0.66064, 'target_sparsity': 0.6, 'step': 10100}


Iteration:  69%|██████▊   | 184/268 [00:33<01:02,  1.35it/s][A04/21/2024 13:53:56 - INFO - trainer.trainer_mod - v4 Global step: 10100, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:33<00:46,  1.80it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:35,  2.32it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:27,  2.94it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:22,  3.56it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:18,  4.21it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:16,  4.71it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:14,  5.22it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:13,  5.59it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:12,  5.83it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:12,  6.10it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:11,  6.54it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.59it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.77it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.92it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.02it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.12it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.18it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.20it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.23it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.26it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.24it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.46it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:07,  7.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.28it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.48it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.26it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.35it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.42it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.57it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.55it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.76it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:05,  7.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:05,  7.77it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:05,  7.82it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.61it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.37it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.49it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.33it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  6.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:05,  6.97it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:05,  6.93it/s][A[INFO|trainer.py:570] 2024-04-21 13:54:03,039 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:54:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:54:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:54:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:54:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:54:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:54:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4329275215299443, 'eval_loss': 1.0568175, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1376, 1395, 1618, 1566, 1409, 1281, 896, 637, 467, 253, 424, 173], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 3, 1], 'pruned_params': 56294132, 'remaining_params': 28723468, 'pruned_model_sparsity': 0.6621468025444144, 'expected_sparsity': 0.66017, 'target_sparsity': 0.6, 'step': 10150}


Iteration:  87%|████████▋ | 234/268 [00:42<00:25,  1.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:18,  1.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:14,  2.27it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:10,  2.86it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:08,  3.49it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:07,  4.13it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:05,  4.75it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:05,  5.36it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:04,  5.88it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  6.15it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.67it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  6.85it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.13it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.02it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.08it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.34it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.12it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.16it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.22it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.29it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.30it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.26it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.21it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.54it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.08it/s][A04/21/2024 13:54:09 - INFO - trainer.trainer_mod - Epoch 37 finished. Took 46.91 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.71it/s]
Epoch:  38%|███▊      | 38/100 [30:12<49:12, 47.62s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:32,  8.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.85it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.91it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.76it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.84it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.86it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.68it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.60it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.57it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.37it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.33it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.33it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.50it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:34,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 13:54:11,808 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:54:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:54:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:54:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:54:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 13:54:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:54:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41523521474065717, 'eval_loss': 1.0881839, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1377, 1395, 1618, 1565, 1409, 1280, 896, 637, 471, 269, 435, 191], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 3, 1], 'pruned_params': 56272684, 'remaining_params': 28744916, 'pruned_model_sparsity': 0.6618945253688648, 'expected_sparsity': 0.65968, 'target_sparsity': 0.6, 'step': 10200}


Iteration:   6%|▌         | 16/268 [00:04<03:07,  1.35it/s][A04/21/2024 13:54:13 - INFO - trainer.trainer_mod - v4 Global step: 10200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:21,  1.77it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:48,  2.29it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:27,  2.85it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:11,  3.48it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:59,  4.14it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:51,  4.76it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:45,  5.36it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.89it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:38,  6.25it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.43it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:36,  6.57it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:36,  6.60it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:35,  6.77it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.82it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.94it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.03it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.86it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.95it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.96it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.07it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.02it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.15it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.12it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.08it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.17it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.04it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.16it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.33it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.51it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.64it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.61it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.17it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.23it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.30it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.37it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.44it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.32it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.95it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.19it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:30,  6.67it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.76it/s][A[INFO|trainer.py:570] 2024-04-21 13:54:20,819 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:54:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:54:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:54:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:54:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 13:54:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:54:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42720203489114567, 'eval_loss': 1.1463178, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1378, 1397, 1618, 1565, 1410, 1280, 896, 638, 475, 297, 452, 223], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 1], 'pruned_params': 56036756, 'remaining_params': 28980844, 'pruned_model_sparsity': 0.65911947643782, 'expected_sparsity': 0.65866, 'target_sparsity': 0.6, 'step': 10250}


Iteration:  25%|██▍       | 66/268 [00:13<02:31,  1.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:54,  1.76it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:27,  2.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:10,  2.84it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:57,  3.47it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:47,  4.12it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:41,  4.67it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:37,  5.23it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:33,  5.73it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:31,  6.15it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.48it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.90it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.00it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.06it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.12it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.13it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.17it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.15it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.01it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  6.96it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.07it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.10it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  7.07it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.16it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.25it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.14it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.11it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.19it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.30it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.42it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.36it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.48it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.29it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.32it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.32it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.31it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.44it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 13:54:29,728 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:54:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:54:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:54:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:54:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 13:54:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:54:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42677882373463333, 'eval_loss': 1.1228665, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1380, 1398, 1618, 1565, 1410, 1280, 897, 640, 481, 365, 475, 285], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 1], 'pruned_params': 55983136, 'remaining_params': 29034464, 'pruned_model_sparsity': 0.6584887834989461, 'expected_sparsity': 0.65719, 'target_sparsity': 0.6, 'step': 10300}


Iteration:  43%|████▎     | 116/268 [00:22<01:52,  1.35it/s][A04/21/2024 13:54:31 - INFO - trainer.trainer_mod - v4 Global step: 10300, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:22<01:24,  1.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<01:04,  2.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:51,  2.92it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:41,  3.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:34,  4.21it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:30,  4.77it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:26,  5.38it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:24,  5.79it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:23,  6.19it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.67it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.70it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.88it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  6.97it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.84it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.97it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.06it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.16it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.04it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.02it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  6.90it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.11it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.21it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.29it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.25it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.35it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.53it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.51it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.72it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:14,  7.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:14,  7.62it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:14,  7.57it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.51it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.33it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.28it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.28it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  7.06it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.09it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  6.99it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 13:54:38,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:54:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:54:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:54:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:54:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 13:54:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:54:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4182979471843555, 'eval_loss': 1.2471967, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1381, 1398, 1618, 1565, 1411, 1280, 897, 640, 488, 532, 510, 456], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 3], 'pruned_params': 55915728, 'remaining_params': 29101872, 'pruned_model_sparsity': 0.6576959123757904, 'expected_sparsity': 0.65378, 'target_sparsity': 0.6, 'step': 10350}


Iteration:  62%|██████▏   | 166/268 [00:30<01:15,  1.35it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:57,  1.77it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:43,  2.29it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:34,  2.88it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:28,  3.49it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:23,  4.19it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:19,  4.80it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:17,  5.34it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:16,  5.80it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.50it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.70it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.87it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.17it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.20it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.23it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.26it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.41it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.30it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.21it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.28it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.31it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.17it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.22it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.33it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.30it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.39it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.07it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.13it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.99it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.07it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.09it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 13:54:47,566 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:54:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:54:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:54:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:54:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 13:54:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:54:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47860504193113135, 'eval_loss': 1.0725802, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1382, 1400, 1618, 1565, 1412, 1281, 898, 642, 495, 699, 549, 1065], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 8], 'pruned_params': 54264232, 'remaining_params': 30753368, 'pruned_model_sparsity': 0.6382705698584764, 'expected_sparsity': 0.6344, 'target_sparsity': 0.6, 'step': 10400}


Iteration:  81%|████████  | 216/268 [00:39<00:38,  1.33it/s][A04/21/2024 13:54:49 - INFO - trainer.trainer_mod - v4 Global step: 10400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:40<00:28,  1.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:21,  2.29it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:17,  2.88it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:13,  3.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:11,  4.16it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:09,  4.77it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:08,  5.39it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:07,  5.84it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.21it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.66it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.80it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.85it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.07it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.13it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.19it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.23it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.23it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.06it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.96it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.05it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.09it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.15it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.20it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.24it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.32it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.26it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.32it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.20it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.27it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.19it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.15it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.01it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.09it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.13it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 13:54:56,507 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:54:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:54:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:54:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:54:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 13:54:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:54:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43119401522744577, 'eval_loss': 1.2421479, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1383, 1400, 1618, 1566, 1412, 1281, 898, 642, 497, 729, 555, 1360], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 53856720, 'remaining_params': 31160880, 'pruned_model_sparsity': 0.6334773035230352, 'expected_sparsity': 0.62503, 'target_sparsity': 0.6, 'step': 10450}


Iteration:  99%|█████████▉| 266/268 [00:48<00:01,  1.34it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  1.77it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  2.33it/s][A04/21/2024 13:54:58 - INFO - trainer.trainer_mod - Epoch 38 finished. Took 49.1 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.46it/s]
Epoch:  39%|███▉      | 39/100 [31:01<48:51, 48.06s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.70it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.43it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.24it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.07it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.09it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.19it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.32it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.07it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.12it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.95it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.05it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.16it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.00it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.98it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:35,  7.03it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.11it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.40it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.41it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.32it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.39it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.39it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.42it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:31,  7.48it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.59it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.21it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.28it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.29it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.27it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.28it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.29it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.29it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.20it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.23it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.26it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.29it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:30,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 13:55:05,409 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:55:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:55:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:55:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:55:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 13:55:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:55:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4531370540010336, 'eval_loss': 1.1681701, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1384, 1401, 1619, 1566, 1414, 1282, 899, 643, 498, 734, 554, 1410], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 54040560, 'remaining_params': 30977040, 'pruned_model_sparsity': 0.6356396793134598, 'expected_sparsity': 0.62445, 'target_sparsity': 0.6, 'step': 10500}


Iteration:  18%|█▊        | 48/268 [00:08<02:44,  1.34it/s][A04/21/2024 13:55:07 - INFO - trainer.trainer_mod - v4 Global step: 10500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<02:04,  1.76it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:35,  2.28it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:15,  2.89it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:00,  3.55it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:50,  4.24it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:44,  4.77it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:40,  5.32it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:37,  5.66it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:34,  6.04it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.71it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.70it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.83it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.85it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.95it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.06it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.98it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.07it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.12it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.18it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.08it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:30,  6.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:28,  6.98it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.14it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.35it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.66it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.61it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.30it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.36it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.41it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.48it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:23,  7.69it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.48it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.30it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.30it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.28it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.30it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:24,  7.28it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.27it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:24,  7.18it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:24,  7.09it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:24,  7.07it/s][A[INFO|trainer.py:570] 2024-04-21 13:55:14,350 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:55:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:55:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:55:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:55:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 13:55:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:55:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3977443881783629, 'eval_loss': 1.102224, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1384, 1400, 1618, 1565, 1413, 1280, 899, 642, 498, 740, 554, 1464], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 53855188, 'remaining_params': 31162412, 'pruned_model_sparsity': 0.6334592837247817, 'expected_sparsity': 0.6227, 'target_sparsity': 0.6, 'step': 10550}


Iteration:  37%|███▋      | 98/268 [00:17<02:07,  1.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:35,  1.77it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:13,  2.28it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:58,  2.87it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:47,  3.51it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:39,  4.16it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:34,  4.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:30,  5.29it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:28,  5.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:26,  6.03it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:25,  6.34it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:24,  6.60it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.80it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:23,  6.77it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:23,  6.56it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:22,  6.94it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.07it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.01it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.09it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  6.96it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.05it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.03it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.15it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.10it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.42it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.56it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.41it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.64it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.58it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.44it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.43it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.48it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.30it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.13it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.16it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.11it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.20it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.26it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:16,  7.47it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:16,  7.43it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:16,  7.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.36it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  7.13it/s][A
Iteration:  54%|█████▍    | 146/268 [00:24<00:17,  7.13it/s][A
Iteration:  55%|█████▍    | 147/268 [00:24<00:16,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 13:55:23,309 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:55:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:55:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:55:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:55:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 13:55:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:55:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45003782776384227, 'eval_loss': 1.0137368, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1384, 1400, 1617, 1564, 1413, 1277, 898, 641, 498, 748, 555, 1555], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 51678216, 'remaining_params': 33339384, 'pruned_model_sparsity': 0.6078531504065041, 'expected_sparsity': 0.62273, 'target_sparsity': 0.6, 'step': 10600}


Iteration:  55%|█████▌    | 148/268 [00:26<01:29,  1.34it/s][A04/21/2024 13:55:25 - INFO - trainer.trainer_mod - v4 Global step: 10600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:26<01:07,  1.77it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:51,  2.28it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:40,  2.87it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:33,  3.49it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:28,  4.10it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:24,  4.66it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:21,  5.20it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:20,  5.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:18,  5.96it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:17,  6.23it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:16,  6.54it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  6.75it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.89it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  7.00it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.10it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  6.96it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.06it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.13it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.23it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.30it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.13it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.24it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.50it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.28it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.29it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.25it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.31it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.43it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.26it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.42it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.34it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  6.93it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.01it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.12it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  7.20it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 13:55:32,265 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:55:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:55:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:55:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:55:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 13:55:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:55:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44134495180802813, 'eval_loss': 1.0112759, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1385, 1401, 1617, 1563, 1412, 1274, 897, 639, 498, 761, 556, 1665], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 51517356, 'remaining_params': 33500244, 'pruned_model_sparsity': 0.6059610715898825, 'expected_sparsity': 0.62044, 'target_sparsity': 0.6, 'step': 10650}


Iteration:  74%|███████▍  | 198/268 [00:35<00:52,  1.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:38,  1.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:29,  2.30it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:23,  2.89it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:18,  3.52it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:15,  4.15it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:13,  4.71it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:11,  5.32it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:10,  5.80it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.16it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:09,  6.45it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.78it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.89it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.99it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  6.98it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.09it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.27it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.25it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.34it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.26it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.22it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.32it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.26it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.38it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.31it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.31it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.22it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.11it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.17it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.09it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:41<00:03,  6.99it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 13:55:41,176 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:55:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:55:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:55:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:55:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:55:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:55:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47012447895058357, 'eval_loss': 0.98293144, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1385, 1401, 1617, 1563, 1412, 1274, 897, 639, 498, 772, 557, 1717], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 51436160, 'remaining_params': 33581440, 'pruned_model_sparsity': 0.605006022282445, 'expected_sparsity': 0.61892, 'target_sparsity': 0.6, 'step': 10700}


Iteration:  93%|█████████▎| 248/268 [00:44<00:14,  1.34it/s][A04/21/2024 13:55:43 - INFO - trainer.trainer_mod - v4 Global step: 10700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:44<00:10,  1.77it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:07,  2.28it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:05,  2.87it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:04,  3.53it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:03,  4.17it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  4.80it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  5.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:02,  5.89it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.25it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.72it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.88it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.99it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.03it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.12it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.01it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.17it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.11it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.48it/s][A04/21/2024 13:55:45 - INFO - trainer.trainer_mod - Epoch 39 finished. Took 47.16 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  40%|████      | 40/100 [31:48<47:47, 47.79s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.36it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.97it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.13it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.25it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.46it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.38it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.24it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.28it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.37it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.03it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.12it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.29it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.39it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.38it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.37it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.31it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.30it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.33it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.32it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 13:55:50,067 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:55:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:55:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:55:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:55:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 13:55:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:55:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45194005217306377, 'eval_loss': 1.0091964, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1385, 1401, 1617, 1564, 1413, 1275, 899, 640, 499, 784, 555, 1754], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 51371816, 'remaining_params': 33645784, 'pruned_model_sparsity': 0.6042491907557964, 'expected_sparsity': 0.61743, 'target_sparsity': 0.6, 'step': 10750}


Iteration:  11%|█         | 30/268 [00:06<02:57,  1.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:13,  1.78it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:43,  2.29it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:22,  2.85it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:07,  3.48it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:56,  4.16it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:48,  4.77it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:43,  5.27it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:39,  5.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:37,  6.04it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:36,  6.17it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:36,  6.30it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:34,  6.59it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:33,  6.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.02it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.22it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.15it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.18it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:32,  6.67it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.87it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.99it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.98it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.30it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.36it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.49it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.21it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.40it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.22it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.23it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.27it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.22it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.14it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.19it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.23it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.12it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.14it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.17it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  7.03it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.09it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 13:55:59,064 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:55:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:55:59 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:55:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:55:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 13:56:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:56:01 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45610100596076714, 'eval_loss': 0.9658248, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1387, 1401, 1617, 1564, 1413, 1276, 900, 641, 500, 793, 554, 1769], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 5, 4, 3, 9], 'pruned_params': 51145080, 'remaining_params': 33872520, 'pruned_model_sparsity': 0.6015822606142728, 'expected_sparsity': 0.61619, 'target_sparsity': 0.6, 'step': 10800}


Iteration:  30%|██▉       | 80/268 [00:15<02:20,  1.34it/s][A04/21/2024 13:56:01 - INFO - trainer.trainer_mod - v4 Global step: 10800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:15<01:45,  1.77it/s][A
Iteration:  31%|███       | 82/268 [00:15<01:21,  2.29it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:03,  2.91it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:52,  3.53it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:44,  4.15it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:38,  4.76it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:34,  5.20it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:32,  5.62it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:29,  6.03it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.69it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.76it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.88it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.00it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.07it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.15it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.06it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.22it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.84it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.97it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.13it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.22it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.32it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.28it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.31it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.16it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.22it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.20it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.22it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.36it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.29it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.28it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.29it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.18it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 13:56:08,021 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:56:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:56:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:56:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:56:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 13:56:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:56:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4535057217805826, 'eval_loss': 0.9808806, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1388, 1401, 1617, 1563, 1412, 1275, 900, 641, 500, 800, 552, 1764], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 5, 4, 3, 9], 'pruned_params': 51158868, 'remaining_params': 33858732, 'pruned_model_sparsity': 0.6017444387985547, 'expected_sparsity': 0.61511, 'target_sparsity': 0.6, 'step': 10850}


Iteration:  49%|████▊     | 130/268 [00:24<01:42,  1.34it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<01:17,  1.77it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:59,  2.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:47,  2.87it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:38,  3.50it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:32,  4.15it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:27,  4.81it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:24,  5.36it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:22,  5.74it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.20it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.45it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.68it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.85it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.95it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.02it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.27it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.47it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.20it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.36it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.47it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.48it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.49it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.47it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.50it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.39it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.30it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.25it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.22it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.13it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.19it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.24it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.16it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.17it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 13:56:16,906 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:56:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:56:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:56:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:56:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 13:56:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:56:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43010813266156883, 'eval_loss': 1.043748, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1388, 1400, 1618, 1563, 1413, 1275, 899, 641, 500, 806, 552, 1785], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 51322792, 'remaining_params': 33694808, 'pruned_model_sparsity': 0.6036725572116832, 'expected_sparsity': 0.61397, 'target_sparsity': 0.6, 'step': 10900}


Iteration:  67%|██████▋   | 180/268 [00:32<01:05,  1.34it/s][A04/21/2024 13:56:18 - INFO - trainer.trainer_mod - v4 Global step: 10900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:33<00:49,  1.77it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:37,  2.28it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:29,  2.88it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:23,  3.52it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:20,  4.13it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:17,  4.73it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:15,  5.29it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:13,  5.75it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:12,  6.20it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:12,  6.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.57it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.87it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.16it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.02it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.00it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  7.09it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.13it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.12it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.00it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.04it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.21it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.26it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.24it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.30it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.38it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.42it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.41it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.37it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.37it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.34it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.30it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.23it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.36it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.32it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.11it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.28it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.28it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.06it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 13:56:25,853 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:56:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:56:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:56:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:56:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 13:56:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:56:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.439472886967031, 'eval_loss': 0.93191415, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1389, 1400, 1616, 1562, 1412, 1273, 898, 639, 500, 813, 552, 1821], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 51279896, 'remaining_params': 33737704, 'pruned_model_sparsity': 0.6031680028605841, 'expected_sparsity': 0.61323, 'target_sparsity': 0.6, 'step': 10950}


Iteration:  86%|████████▌ | 230/268 [00:41<00:28,  1.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:20,  1.77it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:15,  2.27it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:12,  2.84it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:09,  3.48it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:07,  4.13it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:06,  4.65it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:05,  5.20it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:05,  5.67it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  5.99it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.31it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.69it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.85it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.08it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.07it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.09it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.07it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.09it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.15it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.49it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.25it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.95it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.22it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.31it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.49it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.42it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.44it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.24it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.72it/s][A04/21/2024 13:56:33 - INFO - trainer.trainer_mod - Epoch 40 finished. Took 47.17 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  41%|████      | 41/100 [32:35<46:48, 47.61s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.37it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.16it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.18it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.09it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.14it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.97it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.09it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.19it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 13:56:34,799 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:56:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:56:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:56:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:56:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 13:56:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:56:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4473721118724771, 'eval_loss': 0.9920432, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1390, 1400, 1616, 1561, 1412, 1273, 897, 638, 500, 823, 552, 1829], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50009868, 'remaining_params': 35007732, 'pruned_model_sparsity': 0.588229590108401, 'expected_sparsity': 0.6126, 'target_sparsity': 0.6, 'step': 11000}


Iteration:   4%|▍         | 12/268 [00:03<03:14,  1.32it/s][A04/21/2024 13:56:36 - INFO - trainer.trainer_mod - v4 Global step: 11000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:25,  1.75it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:52,  2.26it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:29,  2.83it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:12,  3.50it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:00,  4.14it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:52,  4.75it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:47,  5.28it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:43,  5.74it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:41,  5.94it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.26it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.39it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.59it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.73it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.83it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.97it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.94it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  7.02it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.08it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.13it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.41it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.41it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.49it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.60it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.65it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.59it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.38it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.41it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.34it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.34it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.30it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.07it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.09it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.91it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.11it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.07it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.97it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.23it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.25it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 13:56:43,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:56:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:56:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:56:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:56:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 13:56:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:56:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4598110939376626, 'eval_loss': 0.96733826, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1390, 1399, 1615, 1561, 1412, 1273, 898, 638, 500, 829, 551, 1850], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49971568, 'remaining_params': 35046032, 'pruned_model_sparsity': 0.5877790951520626, 'expected_sparsity': 0.61143, 'target_sparsity': 0.6, 'step': 11050}


Iteration:  23%|██▎       | 62/268 [00:12<02:34,  1.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:55,  1.78it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:29,  2.29it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<01:10,  2.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:57,  3.52it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:49,  4.10it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:42,  4.72it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:37,  5.33it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:34,  5.79it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:32,  6.02it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:30,  6.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:29,  6.65it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  6.87it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.14it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.15it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.07it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.25it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.25it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.31it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.35it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.43it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.25it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.22it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.20it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.72it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.81it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.74it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.80it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.03it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.22it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.14it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.24it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.26it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.15it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 13:56:52,771 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:56:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:56:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:56:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:56:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:56:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:56:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4703217961497291, 'eval_loss': 0.97536266, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1390, 1400, 1615, 1561, 1411, 1271, 896, 635, 500, 837, 551, 1841], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49983824, 'remaining_params': 35033776, 'pruned_model_sparsity': 0.5879232535380909, 'expected_sparsity': 0.61035, 'target_sparsity': 0.6, 'step': 11100}


Iteration:  42%|████▏     | 112/268 [00:21<01:56,  1.34it/s][A04/21/2024 13:56:54 - INFO - trainer.trainer_mod - v4 Global step: 11100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:21<01:27,  1.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<01:07,  2.27it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:53,  2.86it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:43,  3.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:36,  4.14it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:31,  4.75it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:28,  5.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:25,  5.76it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:24,  6.04it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.71it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.87it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.90it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.83it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.79it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  6.93it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.96it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.11it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.32it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.36it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.41it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:17,  7.42it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.17it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.18it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.30it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.27it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.21it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.22it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.26it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.19it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.24it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.14it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.20it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.11it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.14it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.17it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.11it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 13:57:01,751 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:57:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:57:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:57:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:57:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:57:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:57:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44394615350761574, 'eval_loss': 1.0195315, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1390, 1400, 1615, 1561, 1411, 1272, 896, 635, 500, 845, 550, 1842], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49970036, 'remaining_params': 35047564, 'pruned_model_sparsity': 0.5877610753538091, 'expected_sparsity': 0.60948, 'target_sparsity': 0.6, 'step': 11150}


Iteration:  60%|██████    | 162/268 [00:30<01:18,  1.34it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:59,  1.78it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:45,  2.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:35,  2.86it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:28,  3.53it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:24,  4.17it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:21,  4.73it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:18,  5.23it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:17,  5.65it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:15,  6.11it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:15,  6.33it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.56it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.86it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.99it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.97it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.08it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.92it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  6.93it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.01it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.20it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.30it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.38it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.44it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:10,  7.46it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.51it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.29it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.27it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.37it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.21it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.86it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.88it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  6.86it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  6.99it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  6.96it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.19it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.21it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.21it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.13it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.15it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 13:57:10,724 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:57:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:57:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:57:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:57:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 13:57:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:57:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4209578417145201, 'eval_loss': 1.1384759, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1390, 1400, 1614, 1560, 1411, 1271, 895, 633, 501, 851, 549, 1844], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49966972, 'remaining_params': 35050628, 'pruned_model_sparsity': 0.5877250357573021, 'expected_sparsity': 0.60936, 'target_sparsity': 0.6, 'step': 11200}


Iteration:  79%|███████▉  | 212/268 [00:39<00:41,  1.34it/s][A04/21/2024 13:57:12 - INFO - trainer.trainer_mod - v4 Global step: 11200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:39<00:31,  1.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:23,  2.28it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:18,  2.87it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:14,  3.50it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:12,  4.19it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:10,  4.79it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:09,  5.31it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:08,  5.63it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.04it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:07,  6.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.59it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.66it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.73it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.89it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.11it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.17it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  7.09it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.15it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.39it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.38it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.23it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.24it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.37it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.38it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.27it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.15it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  6.98it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.97it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.92it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.94it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.00it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.14it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 13:57:19,678 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:57:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:57:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:57:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:57:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]04/21/2024 13:57:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:57:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4854632779262472, 'eval_loss': 0.89059126, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1391, 1400, 1613, 1560, 1411, 1271, 895, 633, 502, 858, 548, 1848], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49950120, 'remaining_params': 35067480, 'pruned_model_sparsity': 0.5875268179765131, 'expected_sparsity': 0.60815, 'target_sparsity': 0.6, 'step': 11250}


Iteration:  98%|█████████▊| 262/268 [00:48<00:04,  1.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:02,  1.77it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  2.29it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:01,  2.87it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  3.49it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  4.11it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  4.91it/s][A04/21/2024 13:57:22 - INFO - trainer.trainer_mod - Epoch 41 finished. Took 49.41 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  42%|████▏     | 42/100 [33:24<46:32, 48.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.93it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  6.95it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.08it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.01it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.86it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.96it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.05it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.09it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.17it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.38it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.31it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.30it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.36it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.43it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.55it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.44it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.50it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.51it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:32,  7.47it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.60it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.42it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.41it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.36it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.30it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.31it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.18it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  7.12it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:32,  7.19it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.08it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.04it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.93it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.90it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:32,  7.01it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:32,  6.97it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.03it/s][A[INFO|trainer.py:570] 2024-04-21 13:57:28,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:57:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:57:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:57:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:57:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:57:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:57:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4355040303603752, 'eval_loss': 1.0754939, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1391, 1399, 1612, 1559, 1408, 1268, 894, 631, 501, 863, 546, 1845], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 3, 3, 9], 'pruned_params': 50166132, 'remaining_params': 34851468, 'pruned_model_sparsity': 0.5900676095302619, 'expected_sparsity': 0.6074, 'target_sparsity': 0.6, 'step': 11300}


Iteration:  16%|█▋        | 44/268 [00:08<02:48,  1.33it/s][A04/21/2024 13:57:30 - INFO - trainer.trainer_mod - v4 Global step: 11300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:06,  1.76it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:38,  2.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:17,  2.85it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:04,  3.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:53,  4.07it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:46,  4.68it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:41,  5.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:38,  5.59it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:36,  5.86it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:36,  5.83it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:34,  6.19it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:32,  6.45it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.76it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.83it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.12it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.34it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.49it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:26,  7.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.63it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.63it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.71it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.55it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.30it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.28it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.43it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.22it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.23it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.21it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.22it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.33it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:26,  6.87it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:25,  7.00it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:25,  7.06it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:25,  7.00it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:25,  6.86it/s][A[INFO|trainer.py:570] 2024-04-21 13:57:37,615 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:57:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:57:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:57:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:57:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 13:57:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:57:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43253354564201496, 'eval_loss': 1.0220094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1391, 1400, 1613, 1559, 1408, 1268, 894, 632, 502, 868, 544, 1848], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49954716, 'remaining_params': 35062884, 'pruned_model_sparsity': 0.5875808773712737, 'expected_sparsity': 0.60686, 'target_sparsity': 0.6, 'step': 11350}


Iteration:  35%|███▌      | 94/268 [00:17<02:10,  1.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:38,  1.76it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<01:15,  2.28it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:59,  2.86it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:48,  3.48it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:41,  4.08it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:35,  4.70it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:31,  5.27it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:29,  5.70it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:26,  6.17it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:26,  6.30it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:24,  6.66it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  6.95it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.37it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.28it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.49it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.62it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.55it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.50it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.14it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.16it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.07it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  7.13it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  7.06it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:19,  7.01it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:19,  6.89it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.09it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.11it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:19,  6.79it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  6.94it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:18,  7.05it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.13it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.08it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.05it/s][A[INFO|trainer.py:570] 2024-04-21 13:57:46,560 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:57:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:57:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:57:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:57:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]04/21/2024 13:57:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:57:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47200535411399097, 'eval_loss': 0.9291108, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1391, 1400, 1612, 1559, 1408, 1268, 894, 631, 503, 872, 541, 1843], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49962376, 'remaining_params': 35055224, 'pruned_model_sparsity': 0.5876709763625414, 'expected_sparsity': 0.60632, 'target_sparsity': 0.6, 'step': 11400}


Iteration:  54%|█████▎    | 144/268 [00:26<01:33,  1.33it/s][A04/21/2024 13:57:48 - INFO - trainer.trainer_mod - v4 Global step: 11400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:26<01:10,  1.75it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:53,  2.27it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:42,  2.85it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:34,  3.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:29,  4.08it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:24,  4.74it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:21,  5.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:20,  5.71it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:18,  6.09it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:17,  6.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:17,  6.55it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.73it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.89it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.99it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.15it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.25it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.33it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.38it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.11it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  6.97it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.12it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.37it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.30it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.30it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.19it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.13it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.21it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.21it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.19it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.40it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.37it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.33it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.28it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 13:57:55,505 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:57:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:57:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:57:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:57:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 13:57:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:57:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46092680367239824, 'eval_loss': 0.95664394, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1392, 1401, 1612, 1558, 1407, 1267, 894, 631, 503, 885, 540, 1826], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49971568, 'remaining_params': 35046032, 'pruned_model_sparsity': 0.5877790951520626, 'expected_sparsity': 0.60596, 'target_sparsity': 0.6, 'step': 11450}


Iteration:  72%|███████▏  | 194/268 [00:35<00:55,  1.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:41,  1.76it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:31,  2.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:24,  2.88it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:20,  3.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:17,  4.03it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:14,  4.58it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:12,  5.16it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:11,  5.66it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:10,  5.91it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:10,  6.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.48it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.52it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.70it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.92it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.07it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.19it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.29it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.32it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.22it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.28it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.47it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.45it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.23it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.23it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.24it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.26it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.29it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.31it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.07it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.26it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.28it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.29it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.34it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 13:58:04,463 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:58:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:58:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:58:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:58:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:58:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:58:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4524266002945997, 'eval_loss': 1.062875, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1393, 1401, 1612, 1557, 1408, 1268, 894, 632, 504, 892, 539, 1812], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49977696, 'remaining_params': 35039904, 'pruned_model_sparsity': 0.5878511743450768, 'expected_sparsity': 0.60543, 'target_sparsity': 0.6, 'step': 11500}


Iteration:  91%|█████████ | 244/268 [00:43<00:17,  1.34it/s][A04/21/2024 13:58:06 - INFO - trainer.trainer_mod - v4 Global step: 11500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:44<00:13,  1.77it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:09,  2.28it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:07,  2.89it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:05,  3.53it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:04,  4.13it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:03,  4.69it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:03,  5.18it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  5.67it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.06it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  6.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.67it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.85it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.91it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.13it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.39it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.41it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.46it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  8.03it/s][A04/21/2024 13:58:09 - INFO - trainer.trainer_mod - Epoch 42 finished. Took 47.25 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  43%|████▎     | 43/100 [34:12<45:29, 47.88s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.27it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.36it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.32it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.05it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.12it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.04it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.29it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.32it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.18it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.20it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.21it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.17it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.96it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.22it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.23it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.12it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.08it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.21it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 13:58:13,390 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:58:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:58:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:58:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:58:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 13:58:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:58:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48419799152198045, 'eval_loss': 1.0008156, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1392, 1401, 1612, 1558, 1409, 1268, 895, 632, 505, 895, 537, 1810], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49974632, 'remaining_params': 35042968, 'pruned_model_sparsity': 0.5878151347485697, 'expected_sparsity': 0.60448, 'target_sparsity': 0.6, 'step': 11550}


Iteration:  10%|▉         | 26/268 [00:05<03:01,  1.33it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:16,  1.77it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:44,  2.29it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:23,  2.88it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:08,  3.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:57,  4.13it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:52,  4.50it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:46,  5.03it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:43,  5.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:40,  5.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.17it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.62it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.80it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.00it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.13it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.07it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.96it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.23it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.14it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.34it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.45it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.58it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.50it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.53it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.25it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.39it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.32it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.31it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.31it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.33it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.28it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.39it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 13:58:22,347 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:58:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:58:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:58:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:58:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 13:58:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:58:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4441749676827355, 'eval_loss': 1.0376387, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1393, 1401, 1612, 1557, 1408, 1267, 895, 632, 505, 900, 536, 1797], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49991484, 'remaining_params': 35026116, 'pruned_model_sparsity': 0.5880133525293586, 'expected_sparsity': 0.60447, 'target_sparsity': 0.6, 'step': 11600}


Iteration:  28%|██▊       | 76/268 [00:14<02:23,  1.34it/s][A04/21/2024 13:58:24 - INFO - trainer.trainer_mod - v4 Global step: 11600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:48,  1.76it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:23,  2.29it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:05,  2.90it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:53,  3.54it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:44,  4.18it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:38,  4.79it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:34,  5.33it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:31,  5.80it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:29,  6.17it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.62it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:27,  6.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.70it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  7.07it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.30it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.21it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.20it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.06it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.06it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  6.96it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.13it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.19it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.32it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.34it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.12it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.27it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.29it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.42it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.21it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.20it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.13it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.19it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.05it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.19it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.21it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.41it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 13:58:31,292 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:58:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:58:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:58:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:58:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]04/21/2024 13:58:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:58:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42394124237403846, 'eval_loss': 1.1133406, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1393, 1401, 1612, 1557, 1408, 1266, 895, 631, 506, 906, 535, 1801], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49979228, 'remaining_params': 35038372, 'pruned_model_sparsity': 0.5878691941433303, 'expected_sparsity': 0.60433, 'target_sparsity': 0.6, 'step': 11650}


Iteration:  47%|████▋     | 126/268 [00:23<01:45,  1.34it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<01:19,  1.78it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<01:01,  2.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:48,  2.87it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:39,  3.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:33,  4.08it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:29,  4.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:25,  5.22it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:23,  5.70it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:21,  6.11it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:20,  6.39it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.43it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.67it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  6.98it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  7.09it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.41it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.42it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.20it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.19it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.41it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.37it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.23it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.27it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.24it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.26it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.27it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.21it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.40it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.25it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.37it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.33it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.18it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.21it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.11it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.12it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.13it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.13it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.16it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.19it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.19it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.21it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.26it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 13:58:40,250 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:58:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:58:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:58:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:58:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:58:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:58:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4636527046306878, 'eval_loss': 0.9791052, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1393, 1400, 1612, 1556, 1407, 1265, 893, 630, 506, 913, 534, 1802], 'head_nums': [5, 3, 3, 4, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 49979228, 'remaining_params': 35038372, 'pruned_model_sparsity': 0.5878691941433303, 'expected_sparsity': 0.60379, 'target_sparsity': 0.6, 'step': 11700}


Iteration:  66%|██████▌   | 176/268 [00:32<01:08,  1.34it/s][A04/21/2024 13:58:42 - INFO - trainer.trainer_mod - v4 Global step: 11700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:32<00:51,  1.77it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:39,  2.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:31,  2.85it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:25,  3.48it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:21,  4.12it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:18,  4.65it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:16,  5.20it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:14,  5.66it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:13,  6.08it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.38it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.51it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.74it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.00it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.13it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.13it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.23it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.18it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.04it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.01it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.17it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.13it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.10it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.17it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.24it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.21it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.26it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.30it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.30it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.14it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.10it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.05it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.12it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.12it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.17it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.21it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.00it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.07it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.11it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.13it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.93it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.90it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  6.99it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.05it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.47it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.22it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 13:58:49,261 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:58:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:58:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:58:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:58:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:58:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:58:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44397286177085654, 'eval_loss': 1.0352136, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1393, 1400, 1610, 1555, 1407, 1267, 893, 630, 507, 917, 533, 1803], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 5, 4, 3, 9], 'pruned_params': 49973100, 'remaining_params': 35044500, 'pruned_model_sparsity': 0.5877971149503162, 'expected_sparsity': 0.6032, 'target_sparsity': 0.6, 'step': 11750}


Iteration:  84%|████████▍ | 226/268 [00:41<00:31,  1.34it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:23,  1.78it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:17,  2.28it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:13,  2.87it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:10,  3.53it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:08,  4.17it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:07,  4.74it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:06,  5.24it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:06,  5.64it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:05,  6.04it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:05,  6.31it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.59it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.83it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.02it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.12it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.11it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.19it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.39it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.55it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:02,  7.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.27it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.29it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.37it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.28it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.32it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.29it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.48it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.22it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.19it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.09it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.15it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.19it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.14it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.06it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.64it/s][A04/21/2024 13:58:57 - INFO - trainer.trainer_mod - Epoch 43 finished. Took 47.28 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  44%|████▍     | 44/100 [34:59<44:31, 47.70s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.39it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.30it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.30it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 13:58:58,190 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:58:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:58:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:58:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:58:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:59:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:59:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4267597149395727, 'eval_loss': 1.0696465, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1394, 1400, 1610, 1555, 1408, 1267, 895, 631, 508, 919, 530, 1802], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 5, 4, 3, 9], 'pruned_params': 49966972, 'remaining_params': 35050628, 'pruned_model_sparsity': 0.5877250357573021, 'expected_sparsity': 0.60281, 'target_sparsity': 0.6, 'step': 11800}


Iteration:   3%|▎         | 8/268 [00:03<03:26,  1.26it/s][A04/21/2024 13:59:00 - INFO - trainer.trainer_mod - v4 Global step: 11800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:33,  1.69it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:56,  2.21it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:31,  2.81it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:13,  3.48it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:01,  4.12it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:54,  4.70it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:48,  5.26it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:45,  5.51it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:42,  5.93it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.25it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.53it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.70it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:36,  6.82it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.10it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.09it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.17it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.28it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.35it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.35it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.51it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:30,  7.75it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:30,  7.70it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.52it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.43it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.24it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.27it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.39it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.31it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.43it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.34it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.30it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.15it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.15it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.18it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.19it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.21it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.14it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.04it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.08it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 13:59:07,102 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:59:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:59:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:59:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:59:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:59:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:59:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4682662585067061, 'eval_loss': 0.89758116, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1394, 1399, 1609, 1555, 1408, 1268, 895, 631, 509, 923, 530, 1791], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 5, 4, 3, 9], 'pruned_params': 49977696, 'remaining_params': 35039904, 'pruned_model_sparsity': 0.5878511743450768, 'expected_sparsity': 0.60297, 'target_sparsity': 0.6, 'step': 11850}


Iteration:  22%|██▏       | 58/268 [00:12<02:37,  1.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:57,  1.78it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:30,  2.31it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:10,  2.93it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:57,  3.56it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:48,  4.20it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:43,  4.70it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:38,  5.24it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:35,  5.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:33,  6.06it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:30,  6.46it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:29,  6.68it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.81it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:28,  6.85it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.18it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.34it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.34it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.19it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.14it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.03it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.26it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.14it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.23it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.28it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.18it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.00it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  7.00it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.99it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.95it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.08it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.01it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.19it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.21it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.12it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.19it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.01it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  6.98it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.88it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.96it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.07it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.24it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.08it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:23,  6.89it/s][A[INFO|trainer.py:570] 2024-04-21 13:59:16,117 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:59:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:59:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:59:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:59:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 13:59:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:59:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4326292784366391, 'eval_loss': 1.020934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1394, 1398, 1608, 1554, 1408, 1268, 895, 630, 509, 928, 529, 1799], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50161536, 'remaining_params': 34856064, 'pruned_model_sparsity': 0.5900135501355014, 'expected_sparsity': 0.60259, 'target_sparsity': 0.6, 'step': 11900}


Iteration:  40%|████      | 108/268 [00:21<02:00,  1.33it/s][A04/21/2024 13:59:18 - INFO - trainer.trainer_mod - v4 Global step: 11900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:21<01:30,  1.75it/s][A
Iteration:  41%|████      | 110/268 [00:21<01:09,  2.26it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:54,  2.87it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:44,  3.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:37,  4.13it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:32,  4.76it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:28,  5.30it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:26,  5.77it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.14it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.46it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.71it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.91it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.97it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:20,  7.12it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  7.20it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.58it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.24it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.31it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.26it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.31it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.32it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.23it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.28it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.29it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.11it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.16it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  7.05it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.11it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.06it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.15it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.21it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.21it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.21it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.34it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.33it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.28it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.26it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.26it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.21it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 13:59:25,023 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:59:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:59:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:59:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:59:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 13:59:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:59:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4325679591343375, 'eval_loss': 0.9861638, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1395, 1398, 1608, 1554, 1407, 1267, 894, 629, 510, 931, 528, 1793], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 5, 4, 3, 9], 'pruned_params': 49974632, 'remaining_params': 35042968, 'pruned_model_sparsity': 0.5878151347485697, 'expected_sparsity': 0.60239, 'target_sparsity': 0.6, 'step': 11950}


Iteration:  59%|█████▉    | 158/268 [00:29<01:22,  1.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<01:01,  1.76it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:47,  2.27it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:37,  2.86it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:30,  3.52it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:25,  4.16it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:21,  4.78it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:19,  5.22it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:17,  5.70it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:17,  5.93it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.25it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.77it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  6.95it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.97it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  7.11it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.11it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  7.04it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.98it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.97it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  6.98it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.13it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.41it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.41it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.34it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.32it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.31it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.27it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.26it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.27it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.16it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.14it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.18it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.18it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.20it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.23it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.15it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.06it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.10it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.10it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.15it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.21it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.37it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 13:59:33,993 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:59:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:59:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:59:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:59:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:59:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:59:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.49007739162498226, 'eval_loss': 0.8713902, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1396, 1399, 1609, 1554, 1407, 1267, 894, 629, 511, 936, 528, 1785], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50169196, 'remaining_params': 34848404, 'pruned_model_sparsity': 0.590103649126769, 'expected_sparsity': 0.60239, 'target_sparsity': 0.6, 'step': 12000}


Iteration:  78%|███████▊  | 208/268 [00:38<00:44,  1.34it/s][A04/21/2024 13:59:36 - INFO - trainer.trainer_mod - v4 Global step: 12000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:39<00:33,  1.77it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:25,  2.29it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:19,  2.89it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:15,  3.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:13,  4.10it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:11,  4.72it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:10,  5.19it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:09,  5.70it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:08,  6.02it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:08,  6.17it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.31it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.94it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.01it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.16it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.26it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.50it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.37it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.26it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.30it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.18it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.32it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.23it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.25it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.18it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.38it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.97it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.95it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.02it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.94it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.04it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.10it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.27it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.11it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.28it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.27it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.10it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.04it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.09it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.92it/s][A[INFO|trainer.py:570] 2024-04-21 13:59:42,985 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:59:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:59:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:59:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:59:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 13:59:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:59:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45927670499276396, 'eval_loss': 1.0446836, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1396, 1398, 1609, 1554, 1407, 1267, 894, 629, 512, 939, 527, 1804], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 5, 4, 3, 9], 'pruned_params': 49940928, 'remaining_params': 35076672, 'pruned_model_sparsity': 0.5874186991869919, 'expected_sparsity': 0.60204, 'target_sparsity': 0.6, 'step': 12050}


Iteration:  96%|█████████▋| 258/268 [00:47<00:07,  1.34it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:05,  1.76it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:03,  2.29it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:02,  2.86it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  3.46it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:01,  4.11it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  4.67it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  5.22it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  5.69it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.07it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  6.76it/s][A04/21/2024 13:59:46 - INFO - trainer.trainer_mod - Epoch 44 finished. Took 49.34 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.43it/s]
Epoch:  45%|████▌     | 45/100 [35:48<44:10, 48.19s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.32it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.24it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.47it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.49it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.51it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.61it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.85it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  6.94it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.07it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.01it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.13it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.18it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.34it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.34it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.33it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.35it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.29it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.16it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.09it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.07it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:34,  7.04it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.14it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.83it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.87it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.82it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.94it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.81it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.74it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.65it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.75it/s][A[INFO|trainer.py:570] 2024-04-21 13:59:52,035 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 13:59:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 13:59:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 13:59:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 13:59:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 13:59:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 13:59:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4439671239872752, 'eval_loss': 0.99660146, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1397, 1398, 1609, 1554, 1408, 1267, 895, 630, 514, 942, 525, 1814], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50110980, 'remaining_params': 34906620, 'pruned_model_sparsity': 0.5894188967931346, 'expected_sparsity': 0.60172, 'target_sparsity': 0.6, 'step': 12100}


Iteration:  15%|█▍        | 40/268 [00:07<02:51,  1.33it/s][A04/21/2024 13:59:54 - INFO - trainer.trainer_mod - v4 Global step: 12100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:09,  1.76it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:39,  2.27it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:18,  2.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:04,  3.49it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:53,  4.13it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:47,  4.71it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:42,  5.21it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:38,  5.70it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:36,  6.00it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.73it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.84it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.03it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.16it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.10it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.04it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.04it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.18it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.07it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.40it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.36it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.11it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.04it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.10it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  7.03it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:28,  7.03it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.11it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.14it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.16it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.22it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.16it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.15it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.00it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.08it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.04it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  6.99it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.08it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.16it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:25,  7.08it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.22it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:00:01,039 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:00:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:00:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:00:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:00:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:00:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:00:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4524543085893371, 'eval_loss': 0.96609455, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1397, 1398, 1608, 1555, 1410, 1269, 897, 632, 516, 945, 523, 1813], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50095660, 'remaining_params': 34921940, 'pruned_model_sparsity': 0.5892386988105992, 'expected_sparsity': 0.60135, 'target_sparsity': 0.6, 'step': 12150}


Iteration:  34%|███▎      | 90/268 [00:16<02:13,  1.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:39,  1.78it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:16,  2.29it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<01:00,  2.88it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:49,  3.52it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:41,  4.16it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:36,  4.77it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:32,  5.32it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:29,  5.77it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:27,  6.16it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:26,  6.40it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.76it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.94it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.08it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.23it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.29it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.40it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.37it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.23it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.27it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.19it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.23it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.23it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.42it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.32it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.20it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.21it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.10it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.10it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.01it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  7.04it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  7.10it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.26it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.28it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.26it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.40it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 14:00:09,947 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:00:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:00:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:00:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:00:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 14:00:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:00:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4556358612682346, 'eval_loss': 0.96113396, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1397, 1397, 1608, 1554, 1410, 1269, 897, 632, 516, 947, 521, 1814], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50097192, 'remaining_params': 34920408, 'pruned_model_sparsity': 0.5892567186088528, 'expected_sparsity': 0.60114, 'target_sparsity': 0.6, 'step': 12200}


Iteration:  52%|█████▏    | 140/268 [00:25<01:35,  1.34it/s][A04/21/2024 14:00:12 - INFO - trainer.trainer_mod - v4 Global step: 12200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:25<01:11,  1.77it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:54,  2.29it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:43,  2.88it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:35,  3.54it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:29,  4.15it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:26,  4.68it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:23,  5.12it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:21,  5.62it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:19,  5.97it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:18,  6.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.71it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.95it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.20it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.29it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.17it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.14it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.21it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.43it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.58it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.54it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:13,  7.70it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.57it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.40it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.23it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.12it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.34it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.31it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.08it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.12it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.27it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.17it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  7.06it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.10it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.03it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.10it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.27it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.35it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.31it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.17it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.30it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.46it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.40it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 14:00:18,839 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:00:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:00:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:00:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:00:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:00:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:00:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47215908305734, 'eval_loss': 0.9452997, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1398, 1398, 1609, 1555, 1411, 1269, 897, 632, 518, 950, 521, 1808], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50091064, 'remaining_params': 34926536, 'pruned_model_sparsity': 0.5891846394158387, 'expected_sparsity': 0.60102, 'target_sparsity': 0.6, 'step': 12250}


Iteration:  71%|███████   | 190/268 [00:34<00:57,  1.35it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:43,  1.78it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:32,  2.31it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:25,  2.91it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:20,  3.54it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:17,  4.17it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:15,  4.78it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:13,  5.33it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:12,  5.79it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:11,  6.20it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  6.79it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.00it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.22it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.18it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.07it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.19it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.09it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.08it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.18it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.28it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.23it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.28it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.24it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.24it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.26it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.25it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.07it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.25it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.16it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.21it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.08it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.04it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.00it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  6.95it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.08it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.13it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.07it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.04it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.15it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.20it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.18it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 14:00:27,787 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:00:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:00:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:00:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:00:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:00:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:00:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46640535253485477, 'eval_loss': 1.001659, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1398, 1398, 1608, 1556, 1412, 1270, 898, 632, 518, 951, 518, 1812], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50083404, 'remaining_params': 34934196, 'pruned_model_sparsity': 0.5890945404245709, 'expected_sparsity': 0.60082, 'target_sparsity': 0.6, 'step': 12300}


Iteration:  90%|████████▉ | 240/268 [00:43<00:20,  1.34it/s][A04/21/2024 14:00:29 - INFO - trainer.trainer_mod - v4 Global step: 12300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:43<00:15,  1.78it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:11,  2.31it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:08,  2.91it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:06,  3.54it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:05,  4.14it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:04,  4.75it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:04,  5.24it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  5.67it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:03,  6.11it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.61it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.87it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.15it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.12it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.21it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.16it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.74it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.98it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.43it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.39it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.26it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.26it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.74it/s][A04/21/2024 14:00:33 - INFO - trainer.trainer_mod - Epoch 45 finished. Took 47.23 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  46%|████▌     | 46/100 [36:36<43:06, 47.90s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.19it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.01it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.27it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.29it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.18it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.21it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.26it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.26it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.24it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.24it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.07it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.11it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.07it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.18it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.19it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 14:00:36,691 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:00:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:00:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:00:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:00:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:00:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:00:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47207235269458875, 'eval_loss': 0.99772525, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1398, 1397, 1608, 1555, 1412, 1269, 897, 632, 519, 953, 516, 1809], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50092596, 'remaining_params': 34925004, 'pruned_model_sparsity': 0.5892026592140921, 'expected_sparsity': 0.60075, 'target_sparsity': 0.6, 'step': 12350}


Iteration:   8%|▊         | 22/268 [00:05<03:03,  1.34it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:17,  1.78it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:46,  2.29it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:24,  2.89it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:08,  3.51it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:58,  4.13it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:50,  4.73it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:45,  5.26it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:40,  5.81it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.20it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:37,  6.35it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.63it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.78it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.98it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.93it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.21it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.96it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.23it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.30it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.27it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.52it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:29,  7.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.48it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.44it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.41it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.38it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.26it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.27it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.28it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.25it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.22it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.10it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.00it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.07it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.13it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.11it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.07it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.89it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.10it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.01it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.86it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.90it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.01it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.93it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  6.83it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:28,  6.87it/s][A[INFO|trainer.py:570] 2024-04-21 14:00:45,706 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:00:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:00:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:00:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:00:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:00:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:00:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4608700525278083, 'eval_loss': 0.9833807, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1399, 1396, 1608, 1552, 1409, 1266, 895, 628, 519, 955, 518, 1816], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50098724, 'remaining_params': 34918876, 'pruned_model_sparsity': 0.5892747384071063, 'expected_sparsity': 0.60116, 'target_sparsity': 0.6, 'step': 12400}


Iteration:  27%|██▋       | 72/268 [00:14<02:27,  1.33it/s][A04/21/2024 14:00:47 - INFO - trainer.trainer_mod - v4 Global step: 12400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:14<01:51,  1.76it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<01:25,  2.27it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:08,  2.83it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:54,  3.49it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:46,  4.14it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:40,  4.69it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:36,  5.25it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:32,  5.73it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:30,  6.09it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:28,  6.53it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:27,  6.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:24,  7.35it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.33it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.28it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.13it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.25it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.30it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.43it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.28it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.19it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.21it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.26it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.07it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.14it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.16it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.03it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.09it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.12it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.16it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.06it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.09it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.05it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.01it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.09it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.14it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.14it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:21,  7.04it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:00:54,659 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:00:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:00:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:00:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:00:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:00:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:00:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48297992492083974, 'eval_loss': 0.8670193, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1399, 1396, 1607, 1551, 1408, 1265, 894, 628, 520, 957, 518, 1815], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50103320, 'remaining_params': 34914280, 'pruned_model_sparsity': 0.5893287978018669, 'expected_sparsity': 0.60089, 'target_sparsity': 0.6, 'step': 12450}


Iteration:  46%|████▌     | 122/268 [00:23<01:49,  1.33it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<01:22,  1.76it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<01:03,  2.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:50,  2.84it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:40,  3.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:34,  4.11it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:29,  4.78it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:26,  5.34it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:23,  5.82it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.26it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.80it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.11it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.98it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.23it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.34it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.49it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.50it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.34it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.28it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:16,  7.30it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.28it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.25it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.14it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.28it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.16it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.12it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.14it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  7.02it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.09it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.11it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.15it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.15it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.10it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.14it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.17it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.17it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.32it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.19it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.10it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.17it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.18it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.22it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:01:03,599 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:01:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:01:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:01:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:01:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:01:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:01:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48788927532356746, 'eval_loss': 0.9294826, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1400, 1396, 1606, 1549, 1408, 1264, 893, 627, 521, 958, 518, 1835], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50077276, 'remaining_params': 34940324, 'pruned_model_sparsity': 0.5890224612315568, 'expected_sparsity': 0.60076, 'target_sparsity': 0.6, 'step': 12500}


Iteration:  64%|██████▍   | 172/268 [00:32<01:12,  1.33it/s][A04/21/2024 14:01:05 - INFO - trainer.trainer_mod - v4 Global step: 12500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:32<00:54,  1.75it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:41,  2.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:32,  2.85it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:26,  3.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:22,  4.10it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:19,  4.70it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:17,  5.21it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:15,  5.83it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:14,  6.13it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.75it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.97it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.28it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.34it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.45it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.46it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.34it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.28it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.31it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.34it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.77it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.82it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.97it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.10it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.15it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.20it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.10it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.16it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.09it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.02it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.11it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.02it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.05it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.12it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.16it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.30it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.29it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.30it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.31it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.30it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.07it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.03it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  6.93it/s][A[INFO|trainer.py:570] 2024-04-21 14:01:12,595 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:01:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:01:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:01:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:01:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:01:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:01:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4764873250102919, 'eval_loss': 0.9749983, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1399, 1395, 1606, 1549, 1408, 1263, 893, 627, 522, 964, 518, 1837], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50068084, 'remaining_params': 34949516, 'pruned_model_sparsity': 0.5889143424420356, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 12550}


Iteration:  83%|████████▎ | 222/268 [00:40<00:34,  1.33it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:25,  1.75it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:19,  2.27it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:15,  2.83it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:12,  3.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:09,  4.12it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:08,  4.70it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:07,  5.24it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:06,  5.83it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.23it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.97it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.22it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.10it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.21it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.44it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.29it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:02,  7.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.43it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.33it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.32it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.36it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.47it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.54it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.61it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.24it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.27it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.81it/s][A04/21/2024 14:01:20 - INFO - trainer.trainer_mod - Epoch 46 finished. Took 47.22 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  47%|████▋     | 47/100 [37:23<42:08, 47.70s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.03it/s][A[INFO|trainer.py:570] 2024-04-21 14:01:21,419 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:01:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:01:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:01:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:01:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:01:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:01:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.5047288311874955, 'eval_loss': 0.80687493, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1400, 1396, 1606, 1549, 1408, 1263, 894, 627, 523, 966, 516, 1840], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50057360, 'remaining_params': 34960240, 'pruned_model_sparsity': 0.5887882038542608, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 12600}
04/21/2024 14:01:23 - INFO - trainer.trainer_mod - Saving the best model so far: [Epoch 47 | Step: 12600 | Model size: 34960240 | Score: 0.50473]

[INFO|configuration_utils.py:439] 2024-04-21 14:01:23,534 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-21 14:01:24,799 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:   1%|▏         | 4/268 [00:03<06:30,  1.48s/it][A04/21/2024 14:01:24 - INFO - trainer.trainer_mod - v4 Global step: 12600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:04<04:21,  1.01it/s][A
Iteration:   2%|▏         | 6/268 [00:04<03:04,  1.42it/s][A
Iteration:   3%|▎         | 7/268 [00:04<02:15,  1.93it/s][A
Iteration:   3%|▎         | 8/268 [00:04<01:43,  2.50it/s][A
Iteration:   3%|▎         | 9/268 [00:04<01:21,  3.17it/s][A
Iteration:   4%|▎         | 10/268 [00:04<01:06,  3.86it/s][A
Iteration:   4%|▍         | 11/268 [00:04<00:56,  4.52it/s][A
Iteration:   4%|▍         | 12/268 [00:05<00:50,  5.10it/s][A
Iteration:   5%|▍         | 13/268 [00:05<00:45,  5.59it/s][A
Iteration:   5%|▌         | 14/268 [00:05<00:42,  5.98it/s][A
Iteration:   6%|▌         | 15/268 [00:05<00:40,  6.31it/s][A
Iteration:   6%|▌         | 16/268 [00:05<00:39,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:05<00:37,  6.62it/s][A
Iteration:   7%|▋         | 18/268 [00:05<00:36,  6.76it/s][A
Iteration:   7%|▋         | 19/268 [00:06<00:36,  6.83it/s][A
Iteration:   7%|▋         | 20/268 [00:06<00:34,  7.14it/s][A
Iteration:   8%|▊         | 21/268 [00:06<00:35,  7.04it/s][A
Iteration:   8%|▊         | 22/268 [00:06<00:34,  7.06it/s][A
Iteration:   9%|▊         | 23/268 [00:06<00:34,  7.21it/s][A
Iteration:   9%|▉         | 24/268 [00:06<00:33,  7.28it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:32,  7.54it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:32,  7.53it/s][A
Iteration:  10%|█         | 27/268 [00:07<00:31,  7.66it/s][A
Iteration:  10%|█         | 28/268 [00:07<00:30,  7.75it/s][A
Iteration:  11%|█         | 29/268 [00:07<00:31,  7.67it/s][A
Iteration:  11%|█         | 30/268 [00:07<00:31,  7.59it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:34,  6.96it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:33,  6.99it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:33,  7.10it/s][A
Iteration:  13%|█▎        | 34/268 [00:08<00:32,  7.20it/s][A
Iteration:  13%|█▎        | 35/268 [00:08<00:32,  7.23it/s][A
Iteration:  13%|█▎        | 36/268 [00:08<00:32,  7.06it/s][A
Iteration:  14%|█▍        | 37/268 [00:08<00:32,  7.13it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:31,  7.19it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:31,  7.33it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:32,  7.10it/s][A
Iteration:  15%|█▌        | 41/268 [00:09<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 42/268 [00:09<00:31,  7.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:09<00:31,  7.20it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:30,  7.23it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:30,  7.27it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:30,  7.13it/s][A
Iteration:  18%|█▊        | 48/268 [00:10<00:30,  7.19it/s][A
Iteration:  18%|█▊        | 49/268 [00:10<00:30,  7.25it/s][A
Iteration:  19%|█▊        | 50/268 [00:10<00:29,  7.27it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:29,  7.46it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:29,  7.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:29,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 14:01:31,694 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:01:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:01:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:01:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:01:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:01:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:01:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4636216536931484, 'eval_loss': 1.023971, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1400, 1395, 1605, 1547, 1408, 1263, 893, 627, 524, 967, 515, 1839], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50065020, 'remaining_params': 34952580, 'pruned_model_sparsity': 0.5888783028455284, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 12650}


Iteration:  20%|██        | 54/268 [00:12<02:40,  1.34it/s][A
Iteration:  21%|██        | 55/268 [00:13<02:00,  1.77it/s][A
Iteration:  21%|██        | 56/268 [00:13<01:32,  2.29it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<01:13,  2.88it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:59,  3.51it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:50,  4.15it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:43,  4.74it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:39,  5.24it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:36,  5.69it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:33,  6.08it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:32,  6.35it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:30,  6.60it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:30,  6.68it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:29,  6.87it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:28,  7.03it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:27,  7.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:27,  7.27it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:27,  7.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:27,  7.22it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:27,  7.06it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:26,  7.17it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:26,  7.16it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:25,  7.41it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:25,  7.43it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:25,  7.32it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:25,  7.36it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:24,  7.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:25,  7.22it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:25,  7.01it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:25,  7.13it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:24,  7.20it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  7.10it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:23,  7.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:24,  7.21it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:24,  7.14it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:24,  7.11it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:23,  7.20it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:23,  7.22it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:23,  7.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:23,  7.28it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:23,  7.22it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:22,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:01:40,640 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:01:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:01:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:01:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:01:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:01:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:01:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4774387906343933, 'eval_loss': 0.96267503, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1400, 1394, 1605, 1547, 1407, 1263, 893, 628, 524, 969, 513, 1831], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50078808, 'remaining_params': 34938792, 'pruned_model_sparsity': 0.5890404810298103, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 12700}


Iteration:  39%|███▉      | 104/268 [00:21<02:03,  1.33it/s][A04/21/2024 14:01:42 - INFO - trainer.trainer_mod - v4 Global step: 12700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:21<01:32,  1.77it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<01:10,  2.28it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<00:56,  2.87it/s][A
Iteration:  40%|████      | 108/268 [00:22<00:45,  3.48it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:38,  4.11it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:34,  4.65it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:30,  5.20it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:27,  5.69it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:25,  6.09it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:23,  6.59it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:22,  6.69it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:21,  6.87it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:22,  6.81it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:21,  6.99it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:21,  7.03it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:20,  7.18it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:20,  7.26it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:20,  7.23it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:19,  7.20it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:20,  7.05it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:19,  7.14it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:19,  7.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:19,  7.26it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:18,  7.33it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:18,  7.37it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:18,  7.38it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  6.99it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.96it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:19,  6.93it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:18,  7.21it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:18,  7.22it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:18,  7.12it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  7.16it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  7.10it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:17,  7.09it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:17,  7.03it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:17,  7.01it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.90it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  7.05it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:16,  7.21it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:16,  7.13it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:16,  7.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:16,  7.11it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:16,  7.25it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:15,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 14:01:49,656 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:01:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:01:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:01:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:01:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]04/21/2024 14:01:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:01:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4693139472583124, 'eval_loss': 0.94101995, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1399, 1394, 1605, 1547, 1407, 1262, 894, 626, 525, 966, 511, 1827], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50095660, 'remaining_params': 34921940, 'pruned_model_sparsity': 0.5892386988105992, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 12750}


Iteration:  57%|█████▋    | 154/268 [00:30<01:25,  1.34it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<01:03,  1.77it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:49,  2.28it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:38,  2.87it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:31,  3.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:26,  4.11it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:22,  4.73it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:20,  5.27it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:18,  5.73it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:17,  6.12it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.74it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:14,  6.93it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:14,  6.98it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:13,  7.24it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:13,  7.44it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:12,  7.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:13,  7.27it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  7.09it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:12,  7.18it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:12,  7.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:12,  7.19it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:12,  7.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  7.13it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:11,  7.16it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:11,  7.03it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:11,  7.11it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.77it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.00it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.99it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  7.02it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:10,  7.19it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:10,  7.17it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:10,  7.22it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  7.23it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  7.04it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.09it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:09,  7.15it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:09,  7.17it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  7.17it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.18it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.10it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 14:01:58,667 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:01:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:01:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:01:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:01:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:02:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:02:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4524266002945997, 'eval_loss': 1.0402104, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1400, 1395, 1605, 1548, 1407, 1261, 895, 627, 527, 969, 510, 1830], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50078808, 'remaining_params': 34938792, 'pruned_model_sparsity': 0.5890404810298103, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 12800}


Iteration:  76%|███████▌  | 204/268 [00:39<00:48,  1.33it/s][A04/21/2024 14:02:00 - INFO - trainer.trainer_mod - v4 Global step: 12800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:39<00:35,  1.76it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:27,  2.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:21,  2.86it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:17,  3.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:14,  4.13it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:12,  4.73it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:10,  5.22it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:09,  5.64it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:09,  6.05it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.36it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.59it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.78it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.97it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  7.14it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:06,  7.30it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  7.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  7.39it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  7.42it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:05,  7.44it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:05,  7.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  7.29it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  7.46it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  7.23it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  7.23it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:04,  7.24it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:04,  7.44it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  7.39it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  7.39it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.51it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:03,  7.39it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  7.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.17it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.11it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  7.06it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.12it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.17it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.16it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  7.21it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 14:02:07,585 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:02:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:02:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:02:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:02:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:02:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:02:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48576752772248133, 'eval_loss': 0.94021034, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1400, 1395, 1606, 1548, 1407, 1262, 895, 628, 527, 971, 507, 1822], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50088000, 'remaining_params': 34929600, 'pruned_model_sparsity': 0.5891485998193315, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 12850}


Iteration:  95%|█████████▍| 254/268 [00:48<00:10,  1.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:07,  1.75it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:05,  2.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:03,  2.88it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:02,  3.49it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:02,  4.10it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  4.71it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  5.24it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:01,  5.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.11it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.51it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.73it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.94it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.55it/s][A04/21/2024 14:02:11 - INFO - trainer.trainer_mod - Epoch 47 finished. Took 50.68 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.29it/s]
Epoch:  48%|████▊     | 48/100 [38:13<42:06, 48.59s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.40it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.44it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.19it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.34it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.26it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.22it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.16it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.46it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.31it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.28it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.29it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.18it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.21it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.23it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.24it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.20it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.05it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.07it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.13it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.07it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.10it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.10it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.03it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  7.12it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:02:16,514 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:02:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:02:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:02:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:02:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]04/21/2024 14:02:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:02:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4856483967190665, 'eval_loss': 0.85098195, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1399, 1393, 1605, 1546, 1406, 1260, 894, 626, 527, 970, 505, 1811], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50127832, 'remaining_params': 34889768, 'pruned_model_sparsity': 0.5896171145739235, 'expected_sparsity': 0.60051, 'target_sparsity': 0.6, 'step': 12900}


Iteration:  13%|█▎        | 36/268 [00:07<02:53,  1.33it/s][A04/21/2024 14:02:18 - INFO - trainer.trainer_mod - v4 Global step: 12900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:10,  1.77it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:40,  2.28it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:19,  2.89it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:05,  3.49it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:55,  4.12it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:48,  4.67it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:42,  5.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:38,  5.80it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:36,  6.14it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:35,  6.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:33,  6.66it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.87it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.97it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.02it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.14it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.06it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.21it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:27,  7.56it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.56it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.74it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.80it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.77it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.27it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.09it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.27it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.27it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.26it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.25it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.25it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.05it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.17it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.21it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.24it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.22it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.22it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.68it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:27,  6.84it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  6.95it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:26,  6.95it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:26,  7.03it/s][A[INFO|trainer.py:570] 2024-04-21 14:02:25,489 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:02:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:02:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:02:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:02:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:02:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:02:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4787503565559171, 'eval_loss': 0.9880098, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1401, 1393, 1605, 1546, 1407, 1260, 893, 627, 529, 974, 504, 1823], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50097192, 'remaining_params': 34920408, 'pruned_model_sparsity': 0.5892567186088528, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 12950}


Iteration:  32%|███▏      | 86/268 [00:15<02:16,  1.33it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:42,  1.76it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:19,  2.28it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<01:02,  2.86it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:50,  3.54it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:42,  4.13it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:37,  4.74it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:33,  5.29it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:30,  5.77it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:28,  6.16it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:27,  6.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:26,  6.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  6.93it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.97it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.06it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.19it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.30it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.48it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.39it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:20,  7.70it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.66it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.51it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.48it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.46it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.18it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.19it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.18it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.08it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  6.92it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  7.03it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.10it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.18it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.21it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.23it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.25it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.45it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.45it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.31it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  7.10it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  7.05it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:19,  6.73it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:19,  6.89it/s][A[INFO|trainer.py:570] 2024-04-21 14:02:34,425 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:02:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:02:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:02:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:02:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:02:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:02:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4774387906343933, 'eval_loss': 0.9201706, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1400, 1394, 1605, 1545, 1406, 1259, 893, 626, 529, 977, 503, 1823], 'head_nums': [5, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50100256, 'remaining_params': 34917344, 'pruned_model_sparsity': 0.5892927582053599, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 13000}


Iteration:  51%|█████     | 136/268 [00:24<01:39,  1.33it/s][A04/21/2024 14:02:36 - INFO - trainer.trainer_mod - v4 Global step: 13000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:25<01:15,  1.74it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:57,  2.26it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:45,  2.85it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:36,  3.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:30,  4.16it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:26,  4.72it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:23,  5.34it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:21,  5.79it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.17it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:19,  6.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  6.81it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  7.03it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.15it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.20it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.12it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.23it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.27it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.33it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.40it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.45it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.49it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.49it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.48it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.41it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.42it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.28it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.04it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  6.93it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.91it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.00it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.05it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.13it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.01it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.19it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  7.05it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:13,  6.98it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:13,  6.91it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.04it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.22it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.15it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.19it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.23it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 14:02:43,359 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:02:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:02:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:02:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:02:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:02:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:02:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.458136114916564, 'eval_loss': 1.0203801, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1400, 1394, 1605, 1545, 1406, 1259, 892, 625, 530, 978, 502, 1805], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 9], 'pruned_params': 50325460, 'remaining_params': 34692140, 'pruned_model_sparsity': 0.59194166854863, 'expected_sparsity': 0.60038, 'target_sparsity': 0.6, 'step': 13050}


Iteration:  69%|██████▉   | 186/268 [00:33<01:01,  1.34it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:45,  1.78it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:35,  2.28it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:27,  2.86it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:22,  3.50it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:18,  4.13it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:16,  4.73it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:14,  5.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:12,  5.79it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:11,  6.29it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.99it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.97it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.08it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.18it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.36it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.42it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.07it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.55it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.46it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.30it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.26it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.27it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.28it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.36it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.11it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.14it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.10it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.17it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.21it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.14it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.18it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.17it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.17it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.10it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.15it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.14it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.18it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.03it/s][A[INFO|trainer.py:570] 2024-04-21 14:02:52,296 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:02:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:02:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:02:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:02:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:02:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:02:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4637769793053727, 'eval_loss': 0.8953978, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1401, 1393, 1605, 1545, 1405, 1257, 891, 624, 530, 977, 500, 1812], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 9], 'pruned_params': 50523088, 'remaining_params': 34494512, 'pruned_model_sparsity': 0.5942662225233364, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 13100}


Iteration:  88%|████████▊ | 236/268 [00:42<00:24,  1.33it/s][A04/21/2024 14:02:54 - INFO - trainer.trainer_mod - v4 Global step: 13100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:42<00:17,  1.76it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:13,  2.28it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:10,  2.86it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:08,  3.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:06,  4.16it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:05,  4.77it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  5.31it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:04,  5.84it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.21it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.46it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.75it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.86it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.14it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.20it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.27it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.23it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.19it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.06it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.94it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.05it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.14it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.11it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.17it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.15it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.22it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.78it/s][A04/21/2024 14:02:58 - INFO - trainer.trainer_mod - Epoch 48 finished. Took 47.18 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  49%|████▉     | 49/100 [39:01<40:56, 48.17s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.12it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.32it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.43it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.40it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.38it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.36it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.15it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.21it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.12it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.99it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.97it/s][A[INFO|trainer.py:570] 2024-04-21 14:03:01,221 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:03:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:03:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:03:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:03:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:03:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:03:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4892344546051281, 'eval_loss': 1.001539, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1401, 1393, 1604, 1544, 1405, 1256, 890, 622, 531, 979, 500, 1817], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 9], 'pruned_params': 50520024, 'remaining_params': 34497576, 'pruned_model_sparsity': 0.5942301829268293, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 13150}


Iteration:   7%|▋         | 18/268 [00:04<03:08,  1.33it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:21,  1.76it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:49,  2.27it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:27,  2.83it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:11,  3.43it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:00,  4.07it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:53,  4.59it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:47,  5.16it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:43,  5.58it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:40,  5.96it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:37,  6.32it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.53it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.68it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.08it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.22it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.28it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.20it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.35it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.14it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.30it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.39it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.37it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.47it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.34it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.34it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.29it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.19it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.22it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.24it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.18it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.21it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.13it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 14:03:10,196 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:03:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:03:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:03:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:03:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:03:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:03:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4609982129120627, 'eval_loss': 1.0373025, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1401, 1392, 1602, 1541, 1403, 1253, 888, 619, 533, 982, 501, 1819], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 9], 'pruned_params': 50532280, 'remaining_params': 34485320, 'pruned_model_sparsity': 0.5943743413128576, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 13200}


Iteration:  25%|██▌       | 68/268 [00:13<02:30,  1.33it/s][A04/21/2024 14:03:12 - INFO - trainer.trainer_mod - v4 Global step: 13200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:53,  1.75it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:26,  2.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:08,  2.87it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:56,  3.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:47,  4.12it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:40,  4.74it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:36,  5.30it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:33,  5.79it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.22it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.69it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.69it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.92it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.21it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.28it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.23it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.43it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.25it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.09it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.17it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.22it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.20it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.14it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.17it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.08it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.13it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.16it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.18it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.06it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.10it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.26it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.11it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.20it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.01it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.24it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.22it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.11it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.14it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.07it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.15it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.19it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:03:19,159 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:03:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:03:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:03:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:03:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:03:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:03:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4496664370323995, 'eval_loss': 0.9540605, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1401, 1392, 1600, 1539, 1402, 1251, 887, 618, 534, 985, 501, 1821], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 9], 'pruned_params': 50536876, 'remaining_params': 34480724, 'pruned_model_sparsity': 0.5944284007076182, 'expected_sparsity': 0.60046, 'target_sparsity': 0.6, 'step': 13250}


Iteration:  44%|████▍     | 118/268 [00:22<01:52,  1.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<01:24,  1.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<01:05,  2.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:51,  2.86it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:42,  3.46it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:35,  4.11it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:30,  4.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:27,  5.18it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:24,  5.69it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.13it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.40it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.69it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  6.91it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.98it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.05it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.17it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.07it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.08it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.20it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.33it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.40it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.40it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.29it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.29it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.25it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.27it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.25it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.37it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.20it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.24it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.25it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.17it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.10it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.12it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.64it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.80it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.91it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.01it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.11it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.32it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:13,  7.37it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.23it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:03:28,148 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:03:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:03:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:03:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:03:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:03:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:03:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46133824119384026, 'eval_loss': 1.0079827, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1401, 1392, 1601, 1539, 1402, 1251, 887, 618, 536, 986, 500, 1822], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50334652, 'remaining_params': 34682948, 'pruned_model_sparsity': 0.5920497873381512, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 13300}


Iteration:  63%|██████▎   | 168/268 [00:31<01:14,  1.34it/s][A04/21/2024 14:03:30 - INFO - trainer.trainer_mod - v4 Global step: 13300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:31<00:56,  1.75it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:43,  2.28it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:33,  2.87it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:27,  3.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:22,  4.18it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:19,  4.80it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:17,  5.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:15,  5.76it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:14,  6.19it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.96it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.91it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.00it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.29it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.44it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:10,  7.44it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.47it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.49it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.34it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.28it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.27it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.93it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.01it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  7.06it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.12it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.07it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.09it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.05it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.13it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.09it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.14it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.20it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.24it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.24it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.36it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.32it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.33it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.07it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.00it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 14:03:37,098 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:03:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:03:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:03:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:03:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:03:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:03:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4664784054861729, 'eval_loss': 0.96825755, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1402, 1391, 1600, 1537, 1400, 1251, 887, 617, 538, 989, 500, 1824], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50333120, 'remaining_params': 34684480, 'pruned_model_sparsity': 0.5920317675398976, 'expected_sparsity': 0.60015, 'target_sparsity': 0.6, 'step': 13350}


Iteration:  81%|████████▏ | 218/268 [00:40<00:37,  1.33it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:27,  1.75it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:21,  2.27it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:16,  2.85it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:13,  3.46it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:10,  4.10it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:09,  4.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:08,  5.21it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:07,  5.75it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.15it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:06,  6.48it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.64it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.87it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.01it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.01it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.16it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.29it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.46it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.27it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.15it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.20it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.34it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.13it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.04it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.05it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.95it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.22it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.21it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.44it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.22it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.87it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.91it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.00it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.96it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.05it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 14:03:46,027 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:03:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:03:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:03:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:03:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:03:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:03:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4746858840589354, 'eval_loss': 1.0218452, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1402, 1392, 1601, 1539, 1402, 1254, 890, 621, 541, 991, 498, 1828], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50297884, 'remaining_params': 34719716, 'pruned_model_sparsity': 0.5916173121800662, 'expected_sparsity': 0.59968, 'target_sparsity': 0.6, 'step': 13400}


Iteration: 100%|██████████| 268/268 [00:49<00:00,  1.35it/s][A04/21/2024 14:03:48 - INFO - trainer.trainer_mod - Epoch 49 finished. Took 49.34 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.43it/s]
Epoch:  50%|█████     | 50/100 [39:50<40:26, 48.52s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/21/2024 14:03:48 - INFO - trainer.trainer_mod - v4 Global step: 13400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:38,  6.90it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.11it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.11it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.15it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.05it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.11it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.19it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.07it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.18it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.29it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.34it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.53it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.38it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.38it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.39it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.23it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.30it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.37it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.31it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.26it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.27it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.14it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.17it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.67it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.77it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.90it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.12it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.05it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.12it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.22it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.18it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.20it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.12it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.33it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.14it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:31,  7.18it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.21it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:32,  6.90it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:06<00:30,  7.10it/s][A
Iteration:  18%|█▊        | 49/268 [00:06<00:30,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 14:03:55,020 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:03:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:03:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:03:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:03:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:03:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:03:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48566773145039716, 'eval_loss': 0.88137496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1403, 1392, 1601, 1539, 1403, 1254, 891, 622, 542, 990, 497, 1809], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50322396, 'remaining_params': 34695204, 'pruned_model_sparsity': 0.5919056289521228, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 13450}


Iteration:  19%|█▊        | 50/268 [00:08<02:43,  1.33it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:02,  1.77it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:34,  2.28it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:14,  2.87it/s][A
Iteration:  20%|██        | 54/268 [00:09<01:01,  3.50it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:51,  4.16it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:44,  4.78it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:39,  5.34it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:36,  5.70it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:34,  6.13it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:32,  6.48it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.72it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.04it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.15it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.13it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.22it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.13it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.24it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.21it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.28it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.18it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.10it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.15it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.13it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.14it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:27,  6.99it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.16it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.12it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.29it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.25it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  7.07it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.05it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.02it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.09it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.15it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.19it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.20it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.22it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.23it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:24,  7.25it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:24,  7.15it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:23,  7.20it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:23,  7.20it/s][A
Iteration:  37%|███▋      | 98/268 [00:15<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 99/268 [00:15<00:24,  6.98it/s][A[INFO|trainer.py:570] 2024-04-21 14:04:04,013 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:04:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:04:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:04:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:04:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:04:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:04:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48061177250450887, 'eval_loss': 1.0211668, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1403, 1391, 1601, 1538, 1402, 1252, 890, 622, 543, 990, 496, 1812], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50326992, 'remaining_params': 34690608, 'pruned_model_sparsity': 0.5919596883468835, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 13500}


Iteration:  37%|███▋      | 100/268 [00:17<02:06,  1.33it/s][A04/21/2024 14:04:06 - INFO - trainer.trainer_mod - v4 Global step: 13500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:18<01:34,  1.76it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<01:12,  2.28it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:57,  2.87it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:46,  3.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:39,  4.13it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:34,  4.74it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:30,  5.30it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:27,  5.79it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:25,  6.23it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:24,  6.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.91it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.03it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.13it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.28it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.48it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.47it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.40it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.51it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.11it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.15it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.17it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.21it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  6.98it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.96it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.06it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  6.90it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  7.10it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:19,  7.05it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.10it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.25it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.25it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.02it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  7.09it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:18,  6.96it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:18,  7.03it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.01it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.09it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:17,  7.03it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  7.02it/s][A
Iteration:  54%|█████▍    | 146/268 [00:24<00:17,  7.14it/s][A
Iteration:  55%|█████▍    | 147/268 [00:24<00:16,  7.20it/s][A
Iteration:  55%|█████▌    | 148/268 [00:24<00:16,  7.26it/s][A
Iteration:  56%|█████▌    | 149/268 [00:24<00:16,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 14:04:12,958 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:04:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:04:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:04:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:04:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:04:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:04:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48291834934449523, 'eval_loss': 0.934679, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1403, 1391, 1601, 1538, 1403, 1252, 890, 622, 544, 990, 495, 1802], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50340780, 'remaining_params': 34676820, 'pruned_model_sparsity': 0.5921218665311653, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 13550}


Iteration:  56%|█████▌    | 150/268 [00:26<01:28,  1.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<01:05,  1.77it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:50,  2.29it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:40,  2.86it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:32,  3.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:27,  4.10it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:23,  4.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:21,  5.26it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:19,  5.76it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:17,  6.20it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:16,  6.50it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  6.78it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.95it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  6.99it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.12it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.35it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.39it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:12,  7.65it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:12,  7.61it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.50it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.35it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.10it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.10it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  7.06it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.05it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  6.97it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.18it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.32it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.25it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.19it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.21it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.12it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.05it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.27it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.12it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:11,  7.04it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.17it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.03it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  6.99it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  6.96it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  7.17it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.42it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:33<00:09,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 14:04:21,908 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:04:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:04:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:04:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:04:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:04:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:04:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4664421689634896, 'eval_loss': 1.0487748, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1403, 1391, 1600, 1538, 1402, 1252, 890, 622, 546, 992, 494, 1801], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50340780, 'remaining_params': 34676820, 'pruned_model_sparsity': 0.5921218665311653, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 13600}


Iteration:  75%|███████▍  | 200/268 [00:35<00:50,  1.34it/s][A04/21/2024 14:04:23 - INFO - trainer.trainer_mod - v4 Global step: 13600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:36<00:37,  1.78it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:28,  2.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:22,  2.91it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:18,  3.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:15,  4.18it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:12,  4.78it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:11,  5.14it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:10,  5.68it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:09,  6.13it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:09,  6.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.87it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.93it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  6.91it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.08it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.17it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.30it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.34it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.37it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.32it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.18it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.01it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.10it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.13it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.21it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.24it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.27it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.03it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.13it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.28it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.28it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.31it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.21it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.18it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.08it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.16it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.16it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.19it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 14:04:30,833 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:04:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:04:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:04:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:04:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:04:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:04:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4636597773604369, 'eval_loss': 0.9591754, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1404, 1391, 1601, 1539, 1403, 1253, 890, 623, 547, 993, 493, 1795], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50339248, 'remaining_params': 34678352, 'pruned_model_sparsity': 0.5921038467329117, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 13650}


Iteration:  93%|█████████▎| 250/268 [00:44<00:13,  1.35it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:09,  1.78it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:07,  2.28it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:05,  2.90it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:03,  3.54it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:03,  4.14it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:02,  4.76it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:02,  5.32it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  5.75it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.19it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.79it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.11it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.21it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.06it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.96it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.01it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.92it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.53it/s][A04/21/2024 14:04:35 - INFO - trainer.trainer_mod - Epoch 50 finished. Took 47.27 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  51%|█████     | 51/100 [40:37<39:19, 48.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.91it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.90it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.98it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.08it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  6.98it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.10it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.94it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.03it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.98it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.98it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.97it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.07it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.11it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.16it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.24it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.27it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.11it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.17it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.23it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.28it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.29it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.33it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.32it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.43it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.28it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.24it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 14:04:39,792 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:04:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:04:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:04:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:04:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:04:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:04:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4496077935780946, 'eval_loss': 0.9989304, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1403, 1389, 1599, 1536, 1400, 1250, 888, 620, 549, 995, 494, 1790], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50368356, 'remaining_params': 34649244, 'pruned_model_sparsity': 0.592446222899729, 'expected_sparsity': 0.60037, 'target_sparsity': 0.6, 'step': 13700}


Iteration:  12%|█▏        | 32/268 [00:06<02:56,  1.34it/s][A04/21/2024 14:04:41 - INFO - trainer.trainer_mod - v4 Global step: 13700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:13,  1.77it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:42,  2.28it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:20,  2.89it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:05,  3.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:57,  3.99it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:50,  4.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:44,  5.12it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:40,  5.66it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:37,  6.12it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:34,  6.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.96it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.10it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.47it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.68it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.60it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.56it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.40it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.40it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.34it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.23it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.05it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.05it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.21it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.19it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.20it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.20it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.20it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.18it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.09it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.17it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.03it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.90it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.04it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  7.07it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:27,  7.01it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.08it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.13it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 14:04:48,738 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:04:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:04:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:04:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:04:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:04:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:04:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.466399008874559, 'eval_loss': 0.98090947, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1403, 1388, 1598, 1535, 1399, 1248, 887, 619, 551, 998, 493, 1794], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50368356, 'remaining_params': 34649244, 'pruned_model_sparsity': 0.592446222899729, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 13750}


Iteration:  31%|███       | 82/268 [00:15<02:18,  1.34it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:44,  1.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:20,  2.29it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:03,  2.87it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:51,  3.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:44,  4.09it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:38,  4.72it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:33,  5.29it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:30,  5.78it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:29,  6.08it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:28,  6.27it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.84it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.00it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.16it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.39it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.43it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.56it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.68it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:21,  7.74it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:21,  7.63it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.43it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.32it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.32it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.32it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.23it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.18it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.29it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.27it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.16it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.13it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.14it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.07it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.10it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.16it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.20it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.11it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.16it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 14:04:57,656 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:04:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:04:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:04:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:04:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:04:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:04:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.455237562733625, 'eval_loss': 0.96787107, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1403, 1387, 1598, 1533, 1398, 1247, 887, 618, 554, 1001, 493, 1791], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50372952, 'remaining_params': 34644648, 'pruned_model_sparsity': 0.5925002822944896, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 13800}


Iteration:  49%|████▉     | 132/268 [00:24<01:41,  1.33it/s][A04/21/2024 14:04:59 - INFO - trainer.trainer_mod - v4 Global step: 13800, Alignment: tensor([ 2,  3,  8, 10], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:24<01:16,  1.77it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:58,  2.28it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:45,  2.89it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:37,  3.50it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:31,  4.11it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:26,  4.82it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:23,  5.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:21,  5.89it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:20,  6.28it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.75it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.05it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.97it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.27it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.38it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.32it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.19it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.14it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.94it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.07it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.20it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.22it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.26it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.25it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.27it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.43it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.27it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  6.90it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  7.00it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.07it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.13it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.19it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.05it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.04it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.13it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.18it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.12it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.09it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.15it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.22it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 14:05:06,608 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:05:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:05:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:05:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:05:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:05:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:05:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.488445640649576, 'eval_loss': 1.0682255, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1404, 1387, 1598, 1533, 1399, 1248, 888, 619, 555, 1002, 492, 1790], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50365292, 'remaining_params': 34652308, 'pruned_model_sparsity': 0.5924101833032219, 'expected_sparsity': 0.59964, 'target_sparsity': 0.6, 'step': 13850}


Iteration:  68%|██████▊   | 182/268 [00:33<01:04,  1.33it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:48,  1.76it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:37,  2.27it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:29,  2.86it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:23,  3.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:19,  4.10it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:17,  4.68it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:14,  5.27it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:13,  5.67it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:12,  6.13it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  6.83it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.02it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.16it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.44it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.36it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.33it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.12it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.20it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.22it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.09it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.17it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.10it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.15it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.21it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.13it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.18it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.21it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.13it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.07it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.21it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.23it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.22it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.25it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.15it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.11it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.17it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.37it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 14:05:15,567 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:05:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:05:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:05:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:05:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:05:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:05:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4747587637452304, 'eval_loss': 1.0077522, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1404, 1387, 1598, 1533, 1400, 1249, 889, 620, 556, 1003, 491, 1776], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50379080, 'remaining_params': 34638520, 'pruned_model_sparsity': 0.5925723614875038, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 13900}


Iteration:  87%|████████▋ | 232/268 [00:42<00:27,  1.33it/s][A04/21/2024 14:05:17 - INFO - trainer.trainer_mod - v4 Global step: 13900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:42<00:19,  1.75it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:15,  2.24it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:11,  2.83it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:09,  3.42it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:07,  4.13it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:06,  4.77it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:05,  5.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  5.83it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.32it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.60it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.82it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.17it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.03it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.20it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.40it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.33it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.30it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.32it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.07it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.13it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.18it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.19it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.22it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.25it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.26it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.26it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.83it/s][A04/21/2024 14:05:22 - INFO - trainer.trainer_mod - Epoch 51 finished. Took 47.2 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  52%|█████▏    | 52/100 [41:24<38:17, 47.86s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.67it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.10it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.13it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.17it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.60it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.91it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.03it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.10it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.28it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.07it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:05:24,512 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:05:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:05:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:05:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:05:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:05:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:05:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48619808695768324, 'eval_loss': 0.9555442, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1404, 1387, 1599, 1534, 1400, 1249, 890, 622, 557, 1004, 490, 1770], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 50182984, 'remaining_params': 34834616, 'pruned_model_sparsity': 0.5902658273110509, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 13950}


Iteration:   5%|▌         | 14/268 [00:04<03:11,  1.33it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:23,  1.76it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:50,  2.28it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:28,  2.84it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:11,  3.48it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:59,  4.19it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:50,  4.87it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:45,  5.41it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.91it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.29it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.61it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.87it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.03it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.06it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  7.00it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.95it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.98it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.77it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.13it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.13it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.23it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.28it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.05it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.02it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.22it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.23it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.07it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.15it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.11it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.15it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.07it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.92it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.81it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.05it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.10it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.10it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.04it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.09it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.12it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.08it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.12it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.05it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.10it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.04it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.09it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 14:05:33,517 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:05:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:05:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:05:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:05:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:05:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:05:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.458212452857688, 'eval_loss': 1.0142353, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1405, 1387, 1599, 1534, 1400, 1249, 891, 622, 558, 1006, 489, 1765], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 50184516, 'remaining_params': 34833084, 'pruned_model_sparsity': 0.5902838471093044, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 14000}


Iteration:  24%|██▍       | 64/268 [00:13<02:32,  1.33it/s][A04/21/2024 14:05:35 - INFO - trainer.trainer_mod - v4 Global step: 14000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:13<01:55,  1.77it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:28,  2.28it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:09,  2.87it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:57,  3.51it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:47,  4.16it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:40,  4.84it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:36,  5.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:33,  5.78it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:31,  6.12it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.67it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  6.92it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.09it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.21it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.10it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.13it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.22it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:24,  7.50it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.32it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:24,  7.35it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.33it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.19it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  6.98it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.89it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.99it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.95it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.07it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.01it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.08it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.13it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.48it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.32it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.41it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.45it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.43it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.38it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.29it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:05:42,416 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:05:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:05:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:05:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:05:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:05:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:05:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44981213983430696, 'eval_loss': 1.0568674, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1405, 1387, 1600, 1533, 1400, 1249, 891, 620, 560, 1008, 488, 1764], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50380612, 'remaining_params': 34636988, 'pruned_model_sparsity': 0.5925903812857573, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 14050}


Iteration:  43%|████▎     | 114/268 [00:21<01:54,  1.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<01:26,  1.77it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<01:06,  2.29it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:52,  2.88it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:42,  3.51it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:36,  4.13it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:30,  4.82it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:27,  5.38it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:24,  5.94it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.73it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.05it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.19it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.19it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.06it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.36it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:18,  7.36it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.28it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.30it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.44it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.38it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.27it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.28it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.28it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.29it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.10it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.17it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.84it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  6.97it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.09it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.16it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.24it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.23it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.25it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.13it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.17it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  7.05it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.09it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.02it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.00it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.93it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.06it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.16it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.19it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 14:05:51,343 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:05:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:05:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:05:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:05:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:05:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:05:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46404096692342206, 'eval_loss': 0.9904152, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1386, 1599, 1532, 1399, 1247, 889, 619, 562, 1009, 488, 1756], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50400528, 'remaining_params': 34617072, 'pruned_model_sparsity': 0.5928246386630533, 'expected_sparsity': 0.60015, 'target_sparsity': 0.6, 'step': 14100}


Iteration:  61%|██████    | 164/268 [00:30<01:17,  1.34it/s][A04/21/2024 14:05:53 - INFO - trainer.trainer_mod - v4 Global step: 14100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:30<00:58,  1.77it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:44,  2.30it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:34,  2.90it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:28,  3.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:23,  4.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:20,  4.74it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:18,  5.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:16,  5.87it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:15,  6.28it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.59it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.83it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.04it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.24it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:11,  7.34it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.40it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.35it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.31it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.31it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.30it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.19it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.11it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.17it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.16it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.17it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.02it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.09it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.97it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.95it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.96it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.86it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.99it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.06it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.04it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.08it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.16it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.09it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.04it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.20it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.10it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.25it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:06:00,310 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:06:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:06:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:06:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:06:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:06:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:06:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45250562782676435, 'eval_loss': 0.98953825, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1385, 1598, 1531, 1398, 1246, 888, 617, 564, 1012, 488, 1757], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50403592, 'remaining_params': 34614008, 'pruned_model_sparsity': 0.5928606782595603, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 14150}


Iteration:  80%|███████▉  | 214/268 [00:39<00:40,  1.34it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:30,  1.77it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:22,  2.28it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:17,  2.87it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:14,  3.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:11,  4.16it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:10,  4.76it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:08,  5.25it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:07,  5.78it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:07,  6.19it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.67it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.88it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.14it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.24it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.17it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.23it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.33it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.19it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.09it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.02it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.01it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.00it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.87it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.84it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.93it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.04it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.27it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.28it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.28it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.18it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.12it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.16it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.29it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.16it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.22it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:06:09,262 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:06:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:06:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:06:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:06:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:06:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:06:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4780170126266128, 'eval_loss': 0.9458837, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1386, 1599, 1530, 1398, 1247, 889, 619, 566, 1013, 487, 1760], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50386740, 'remaining_params': 34630860, 'pruned_model_sparsity': 0.5926624604787715, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 14200}


Iteration:  99%|█████████▊| 264/268 [00:48<00:02,  1.34it/s][A04/21/2024 14:06:11 - INFO - trainer.trainer_mod - v4 Global step: 14200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:48<00:01,  1.77it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  2.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  2.88it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  3.63it/s][A04/21/2024 14:06:11 - INFO - trainer.trainer_mod - Epoch 52 finished. Took 49.29 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.44it/s]
Epoch:  53%|█████▎    | 53/100 [42:14<37:49, 48.29s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.38it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.63it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.53it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.53it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.45it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.60it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.57it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.48it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.24it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.24it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.17it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.23it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.43it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.38it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:34,  7.21it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.23it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.37it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.33it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.45it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.38it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.18it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.21it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.23it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:32,  7.24it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.25it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.14it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.14it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:32,  7.12it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.15it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:32,  7.04it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.09it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:31,  7.02it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:32,  6.93it/s][A[INFO|trainer.py:570] 2024-04-21 14:06:18,142 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:06:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:06:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:06:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:06:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:06:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:06:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43907744261562187, 'eval_loss': 1.0200094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1387, 1599, 1531, 1399, 1247, 889, 619, 567, 1016, 486, 1751], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 50195240, 'remaining_params': 34822360, 'pruned_model_sparsity': 0.5904099856970791, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 14250}


Iteration:  17%|█▋        | 46/268 [00:08<02:47,  1.33it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:06,  1.75it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:37,  2.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:17,  2.84it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:02,  3.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:52,  4.12it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:45,  4.71it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:40,  5.29it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:36,  5.79it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:34,  6.20it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:32,  6.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.98it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.12it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.25it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.20it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.23it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.23it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.40it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.36it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.32it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.29it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.29it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.28it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.25it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.03it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.10it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.15it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.16it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.20it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.43it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.39it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.33it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.04it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  7.10it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.14it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:26,  6.80it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:25,  7.00it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:25,  6.87it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:24,  7.00it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:24,  6.99it/s][A[INFO|trainer.py:570] 2024-04-21 14:06:27,118 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:06:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:06:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:06:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:06:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:06:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:06:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47101239092612274, 'eval_loss': 0.9648854, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1386, 1598, 1530, 1398, 1245, 888, 618, 568, 1018, 485, 1743], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50411252, 'remaining_params': 34606348, 'pruned_model_sparsity': 0.592950777250828, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 14300}


Iteration:  36%|███▌      | 96/268 [00:17<02:09,  1.33it/s][A04/21/2024 14:06:29 - INFO - trainer.trainer_mod - v4 Global step: 14300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:17<01:37,  1.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<01:14,  2.27it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:58,  2.88it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:47,  3.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:40,  4.16it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:34,  4.80it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:30,  5.36it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:28,  5.85it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:26,  6.25it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:23,  6.83it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.92it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.00it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.11it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.18it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.09it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:22,  6.79it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.95it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.96it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  6.95it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  6.95it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:21,  6.97it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.16it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  6.99it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.06it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.18it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.26it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.29it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.19it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.23it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.24it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.22it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.16it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.23it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.25it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.26it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.28it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.17it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.32it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.26it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:17,  7.24it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:06:36,072 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:06:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:06:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:06:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:06:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:06:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:06:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44680285011520593, 'eval_loss': 1.0650376, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1386, 1598, 1529, 1398, 1246, 887, 618, 569, 1018, 484, 1736], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50425040, 'remaining_params': 34592560, 'pruned_model_sparsity': 0.5931129554351099, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 14350}


Iteration:  54%|█████▍    | 146/268 [00:26<01:31,  1.33it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<01:09,  1.75it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:52,  2.27it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:41,  2.87it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:33,  3.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:28,  4.17it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:24,  4.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:21,  5.41it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:19,  5.84it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:18,  6.14it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:17,  6.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.73it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  6.95it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.10it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.20it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.14it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  7.05it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.17it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.18it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.19it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.20it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.24it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.10it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.16it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  6.85it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:13,  6.94it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.05it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.12it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.20it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:12,  6.99it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:12,  6.96it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.14it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.17it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.21it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.12it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:11,  6.99it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  6.96it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.07it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.01it/s][A[INFO|trainer.py:570] 2024-04-21 14:06:45,097 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:06:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:06:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:06:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:06:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:06:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:06:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44110773079251625, 'eval_loss': 1.0938247, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1385, 1596, 1526, 1397, 1243, 885, 616, 571, 1020, 485, 1734], 'head_nums': [4, 3, 3, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50443424, 'remaining_params': 34574176, 'pruned_model_sparsity': 0.5933291930141523, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 14400}


Iteration:  73%|███████▎  | 196/268 [00:35<00:54,  1.33it/s][A04/21/2024 14:06:47 - INFO - trainer.trainer_mod - v4 Global step: 14400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:35<00:40,  1.76it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:30,  2.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:24,  2.87it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:19,  3.51it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:16,  4.17it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:13,  4.82it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:12,  5.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:10,  5.84it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:10,  6.17it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  6.87it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.02it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.19it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.17it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.29it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.24it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.30it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.20it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.22it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.07it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.15it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.06it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.15it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.30it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.28it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.29it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.17it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.24it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.24it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.23it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.26it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.29it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.29it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.17it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  6.99it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  6.93it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.03it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.06it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.24it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.16it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 14:06:54,040 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:06:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:06:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:06:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:06:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:06:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:06:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4387542271408056, 'eval_loss': 1.1063764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1385, 1596, 1526, 1397, 1243, 885, 616, 573, 1021, 485, 1736], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50631860, 'remaining_params': 34385740, 'pruned_model_sparsity': 0.5955456281993375, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 14450}


Iteration:  92%|█████████▏| 246/268 [00:44<00:16,  1.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:11,  1.76it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:08,  2.29it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:06,  2.92it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:04,  3.60it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:04,  4.23it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:03,  4.77it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  5.36it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  5.86it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  6.06it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.41it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.69it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.73it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.73it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.84it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.01it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.14it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.37it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.25it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.80it/s][A04/21/2024 14:06:59 - INFO - trainer.trainer_mod - Epoch 53 finished. Took 47.24 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  54%|█████▍    | 54/100 [43:01<36:46, 47.97s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.14it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.17it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.21it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.06it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.89it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.02it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.10it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.00it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.07it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.11it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.18it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.16it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.15it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.20it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.34it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:32,  7.51it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.41it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.38it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.35it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.28it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:07:02,961 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:07:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:07:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:07:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:07:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:07:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:07:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44722803398940786, 'eval_loss': 1.015107, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1386, 1596, 1526, 1397, 1243, 886, 617, 575, 1024, 484, 1736], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50619604, 'remaining_params': 34397996, 'pruned_model_sparsity': 0.5954014698133092, 'expected_sparsity': 0.5996, 'target_sparsity': 0.6, 'step': 14500}


Iteration:  10%|█         | 28/268 [00:05<03:00,  1.33it/s][A04/21/2024 14:07:05 - INFO - trainer.trainer_mod - v4 Global step: 14500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:15,  1.76it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:44,  2.28it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:23,  2.84it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:07,  3.49it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:57,  4.12it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:48,  4.80it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:43,  5.39it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:39,  5.88it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.27it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.59it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.82it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.99it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.10it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.06it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.38it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.06it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.11it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.17it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.19it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.17it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.21it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.24it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.11it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.09it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.14it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.13it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.20it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.20it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.22it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.15it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.33it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:28,  6.97it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.05it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.96it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.00it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.98it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.05it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  7.02it/s][A[INFO|trainer.py:570] 2024-04-21 14:07:11,929 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:07:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:07:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:07:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:07:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:07:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:07:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41804062172932693, 'eval_loss': 1.1286582, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1385, 1596, 1526, 1397, 1243, 885, 617, 575, 1025, 483, 1729], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50633392, 'remaining_params': 34384208, 'pruned_model_sparsity': 0.5955636479975911, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 14550}


Iteration:  29%|██▉       | 78/268 [00:14<02:22,  1.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:47,  1.76it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<01:22,  2.28it/s][A
Iteration:  30%|███       | 81/268 [00:15<01:04,  2.88it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:53,  3.51it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:44,  4.14it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:38,  4.79it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:34,  5.36it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:31,  5.79it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:29,  6.22it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.58it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.75it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.88it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.06it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.25it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.27it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.10it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.15it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.24it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.28it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.27it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.18it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.42it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.31it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.28it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.17it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.20it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:19,  7.53it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.18it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.19it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.10it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.05it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.08it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.18it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 14:07:20,869 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:07:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:07:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:07:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:07:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:07:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:07:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44887349757367434, 'eval_loss': 0.9632018, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1386, 1596, 1525, 1397, 1242, 885, 617, 576, 1025, 483, 1719], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50647180, 'remaining_params': 34370420, 'pruned_model_sparsity': 0.595725826181873, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 14600}


Iteration:  48%|████▊     | 128/268 [00:23<01:44,  1.33it/s][A04/21/2024 14:07:22 - INFO - trainer.trainer_mod - v4 Global step: 14600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:18,  1.77it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<01:00,  2.28it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:47,  2.87it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:38,  3.54it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:32,  4.20it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:27,  4.84it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:24,  5.33it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:22,  5.83it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:21,  6.21it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.64it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  6.95it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  7.09it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.03it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  6.96it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.10it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.33it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.13it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.00it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.08it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.17it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.08it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.13it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  7.02it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.11it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.15it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.18it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.32it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.43it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.36it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.08it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.35it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.13it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.09it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.15it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.03it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.11it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.07it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  7.07it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:07:29,821 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:07:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:07:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:07:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:07:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 14:07:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:07:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43262718467553657, 'eval_loss': 1.0306405, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1385, 1595, 1524, 1397, 1241, 885, 617, 578, 1026, 483, 1713], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50657904, 'remaining_params': 34359696, 'pruned_model_sparsity': 0.5958519647696477, 'expected_sparsity': 0.60035, 'target_sparsity': 0.6, 'step': 14650}


Iteration:  66%|██████▋   | 178/268 [00:32<01:07,  1.34it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:50,  1.76it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:38,  2.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:29,  2.92it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:24,  3.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:20,  4.22it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:17,  4.91it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:15,  5.47it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:13,  6.03it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:12,  6.39it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.58it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.72it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.91it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.15it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.14it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.19it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.12it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.08it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.12it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.18it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.20it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.22it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.21it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.11it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.13it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.15it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.94it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.04it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.12it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.16it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.17it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.30it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.16it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.20it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.09it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.23it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.21it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.23it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:07:38,753 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:07:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:07:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:07:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:07:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:07:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:07:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4413232484146929, 'eval_loss': 1.1070399, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1383, 1594, 1524, 1396, 1241, 884, 616, 580, 1029, 483, 1711], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50660968, 'remaining_params': 34356632, 'pruned_model_sparsity': 0.5958880043661547, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 14700}


Iteration:  85%|████████▌ | 228/268 [00:41<00:29,  1.33it/s][A04/21/2024 14:07:40 - INFO - trainer.trainer_mod - v4 Global step: 14700, Alignment: tensor([ 2,  3,  8, 10], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:41<00:22,  1.76it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:16,  2.28it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:13,  2.84it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:10,  3.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:08,  4.15it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:07,  4.75it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:06,  5.32it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:05,  5.77it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:05,  6.08it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.61it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.99it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.14it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.35it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.51it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:02,  7.38it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.27it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.16it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.31it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.29it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  6.76it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.93it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.94it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.86it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.98it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.05it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.11it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.06it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.15it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.08it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.16it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.21it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.13it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.70it/s][A04/21/2024 14:07:46 - INFO - trainer.trainer_mod - Epoch 54 finished. Took 47.27 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  55%|█████▌    | 55/100 [43:48<35:49, 47.76s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.98it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.18it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.19it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.20it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.21it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.04it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.23it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.12it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 14:07:47,735 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:07:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:07:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:07:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:07:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]04/21/2024 14:07:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:07:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4569650899096484, 'eval_loss': 1.0049374, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1382, 1592, 1522, 1395, 1239, 883, 615, 582, 1029, 483, 1705], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50683948, 'remaining_params': 34333652, 'pruned_model_sparsity': 0.5961583013399578, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 14750}


Iteration:   4%|▎         | 10/268 [00:03<03:18,  1.30it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:28,  1.73it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:52,  2.27it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:30,  2.82it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:13,  3.47it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:01,  4.12it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:54,  4.59it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:48,  5.13it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:44,  5.66it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:40,  6.10it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:38,  6.43it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:36,  6.75it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:35,  6.96it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.21it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.42it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.35it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.47it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.32it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.32it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:32,  7.32it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.08it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  6.96it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.95it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  7.00it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.07it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.11it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.02it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.09it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.10it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.11it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.09it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.05it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.28it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.43it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.30it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.17it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.09it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.03it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.08it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.04it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.11it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 14:07:56,720 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:07:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:07:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:07:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:07:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:07:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:07:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.458212452857688, 'eval_loss': 0.95559233, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1381, 1592, 1520, 1394, 1238, 882, 613, 586, 1033, 484, 1708], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50676288, 'remaining_params': 34341312, 'pruned_model_sparsity': 0.5960682023486902, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 14800}


Iteration:  22%|██▏       | 60/268 [00:12<02:35,  1.34it/s][A04/21/2024 14:07:58 - INFO - trainer.trainer_mod - v4 Global step: 14800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:56,  1.77it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:29,  2.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:10,  2.91it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:57,  3.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:48,  4.20it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:41,  4.83it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:38,  5.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:34,  5.78it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.24it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:29,  6.67it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.90it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:27,  7.19it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.16it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.25it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.36it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.18it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.10it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.32it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.11it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.07it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.15it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.00it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.09it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:27,  6.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.76it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  6.90it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.79it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.93it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.04it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.09it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.26it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.27it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.17it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.40it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.00it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.07it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.09it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.12it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.01it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.06it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.00it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.21it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:08:05,689 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:08:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:08:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:08:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:08:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:08:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:08:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45808021085661066, 'eval_loss': 1.0656418, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1381, 1593, 1520, 1394, 1238, 883, 614, 588, 1033, 484, 1713], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50659436, 'remaining_params': 34358164, 'pruned_model_sparsity': 0.5958699845679012, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 14850}


Iteration:  41%|████      | 110/268 [00:21<01:58,  1.34it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<01:28,  1.77it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<01:07,  2.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:53,  2.89it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:43,  3.55it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:36,  4.25it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:31,  4.82it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:27,  5.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:25,  5.95it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.27it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.56it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.83it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  7.05it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.10it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.04it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  7.03it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.12it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.98it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.20it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.21it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.12it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.18it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.13it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.07it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.15it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.17it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.21it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.33it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.06it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.12it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.16it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.16it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.19it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  7.00it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.11it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.07it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.04it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.13it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.08it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  7.05it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.15it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 14:08:14,626 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:08:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:08:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:08:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:08:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:08:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:08:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43566147276776424, 'eval_loss': 1.0885724, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1380, 1593, 1519, 1394, 1238, 884, 615, 589, 1034, 485, 1712], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50656372, 'remaining_params': 34361228, 'pruned_model_sparsity': 0.5958339449713942, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 14900}


Iteration:  60%|█████▉    | 160/268 [00:30<01:20,  1.34it/s][A04/21/2024 14:08:16 - INFO - trainer.trainer_mod - v4 Global step: 14900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:30<01:00,  1.77it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:46,  2.29it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:36,  2.90it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:29,  3.55it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:24,  4.21it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:21,  4.84it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:18,  5.42it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:16,  5.91it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.32it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.63it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.84it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.94it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.09it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  7.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.14it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.01it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.92it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.98it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.15it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.17it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.12it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.18it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.33it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.29it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.08it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.15it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.18it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.19it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.34it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.23it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.14it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.27it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.17it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.20it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.23it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.12it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.30it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:08,  7.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.45it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.37it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.56it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.00it/s][A[INFO|trainer.py:570] 2024-04-21 14:08:23,566 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:08:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:08:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:08:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:08:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:08:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:08:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4636056179816202, 'eval_loss': 1.0517302, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1381, 1592, 1519, 1393, 1238, 884, 614, 592, 1036, 484, 1718], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50644116, 'remaining_params': 34373484, 'pruned_model_sparsity': 0.5956897865853659, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 14950}


Iteration:  78%|███████▊  | 210/268 [00:39<00:43,  1.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:32,  1.77it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:24,  2.30it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:19,  2.89it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:15,  3.52it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:12,  4.13it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:10,  4.77it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:09,  5.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:08,  5.81it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.22it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.79it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.96it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.09it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.22it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.10it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.09it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.14it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.94it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.07it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.92it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.01it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.09it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.96it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.95it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.11it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.16it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.17it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.09it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.00it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.07it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.12it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.34it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.30it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.29it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.10it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.98it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.05it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.09it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.12it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.04it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.10it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.13it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.07it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.11it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.12it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:08:32,568 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:08:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:08:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:08:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:08:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:08:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:08:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45272024342354794, 'eval_loss': 1.065895, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1380, 1592, 1518, 1393, 1238, 885, 614, 594, 1038, 484, 1709], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50654840, 'remaining_params': 34362760, 'pruned_model_sparsity': 0.5958159251731406, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 15000}


Iteration:  97%|█████████▋| 260/268 [00:48<00:05,  1.34it/s][A04/21/2024 14:08:34 - INFO - trainer.trainer_mod - v4 Global step: 15000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:48<00:03,  1.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:02,  2.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:01,  2.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  3.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  4.22it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  4.91it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  5.39it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  6.20it/s][A04/21/2024 14:08:35 - INFO - trainer.trainer_mod - Epoch 55 finished. Took 49.31 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.43it/s]
Epoch:  56%|█████▌    | 56/100 [44:38<35:22, 48.23s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.98it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.31it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.47it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.07it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.11it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.16it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.13it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.06it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.25it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.24it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.25it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.30it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.31it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.32it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.30it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.40it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.34it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.29it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.30it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.31it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.42it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.38it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.12it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.06it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.15it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 14:08:41,435 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:08:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:08:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:08:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:08:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:08:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:08:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4664421689634896, 'eval_loss': 0.9986803, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1380, 1592, 1520, 1394, 1238, 886, 615, 596, 1040, 484, 1705], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50647180, 'remaining_params': 34370420, 'pruned_model_sparsity': 0.595725826181873, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 15050}


Iteration:  16%|█▌        | 42/268 [00:07<02:48,  1.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:07,  1.77it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:38,  2.28it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:16,  2.91it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:02,  3.56it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:53,  4.16it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:45,  4.79it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:40,  5.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:36,  5.92it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:34,  6.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.86it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.93it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.00it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.11it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.17it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.23it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.17it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.20it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.41it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.20it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.19it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.20it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.01it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.19it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.14it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.18it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.20it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.04it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.14it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.30it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.18it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.20it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.84it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  6.95it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:25,  7.03it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:25,  6.98it/s][A[INFO|trainer.py:570] 2024-04-21 14:08:50,387 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:08:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:08:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:08:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:08:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:08:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:08:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.449682615733785, 'eval_loss': 0.9314522, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1380, 1593, 1520, 1395, 1238, 885, 615, 598, 1040, 484, 1706], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50641052, 'remaining_params': 34376548, 'pruned_model_sparsity': 0.5956537469888588, 'expected_sparsity': 0.59962, 'target_sparsity': 0.6, 'step': 15100}


Iteration:  34%|███▍      | 92/268 [00:16<02:12,  1.32it/s][A04/21/2024 14:08:52 - INFO - trainer.trainer_mod - v4 Global step: 15100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:39,  1.75it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<01:16,  2.27it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:00,  2.87it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:48,  3.52it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:40,  4.17it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:36,  4.72it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:31,  5.29it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:28,  5.87it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:26,  6.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.69it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.90it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  6.95it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  7.02it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.03it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.90it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.01it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.12it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.17it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.22it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  7.02it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.01it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.11it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.28it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.17it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.03it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.99it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.06it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  6.95it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:20,  7.05it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.14it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.18it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.02it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.20it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.22it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.38it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.25it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.27it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.25it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.23it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.14it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  7.02it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:18,  7.08it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 14:08:59,370 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:08:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:08:59 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:08:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:08:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:09:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:09:01 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46718843812774224, 'eval_loss': 0.9419222, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1379, 1592, 1519, 1394, 1237, 884, 614, 599, 1041, 483, 1702], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50656372, 'remaining_params': 34361228, 'pruned_model_sparsity': 0.5958339449713942, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 15150}


Iteration:  53%|█████▎    | 142/268 [00:25<01:33,  1.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<01:10,  1.78it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:54,  2.29it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:42,  2.88it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:34,  3.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:28,  4.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:24,  4.81it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:21,  5.49it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:19,  5.97it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:17,  6.80it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  6.91it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.18it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.10it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.11it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.21it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.22it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.17it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:16,  6.66it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.83it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  6.95it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:15,  6.84it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:15,  6.62it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  6.79it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.09it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.14it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.19it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.21it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.24it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.00it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.08it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  6.93it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.02it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.12it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.29it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.28it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.12it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:12,  6.94it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.15it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.28it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.14it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.14it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 14:09:08,370 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:09:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:09:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:09:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:09:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:09:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:09:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41511377999074933, 'eval_loss': 1.1538404, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1379, 1592, 1520, 1394, 1237, 884, 614, 601, 1042, 483, 1697], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50659436, 'remaining_params': 34358164, 'pruned_model_sparsity': 0.5958699845679012, 'expected_sparsity': 0.60083, 'target_sparsity': 0.6, 'step': 15200}


Iteration:  72%|███████▏  | 192/268 [00:34<00:56,  1.34it/s][A04/21/2024 14:09:10 - INFO - trainer.trainer_mod - v4 Global step: 15200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:34<00:42,  1.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:32,  2.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:25,  2.89it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:20,  3.51it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:17,  4.16it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:14,  4.85it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:12,  5.41it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:11,  5.96it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:10,  6.25it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:10,  6.57it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.85it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.92it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  6.93it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  6.92it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.00it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.07it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.13it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.17it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.14it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.29it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.38it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.20it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.10it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.04it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.11it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  6.98it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:06,  6.89it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  6.91it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.01it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  6.97it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.04it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.10it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.14it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.22it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.22it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.25it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.15it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.31it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:09:17,345 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:09:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:09:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:09:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:09:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:09:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:09:19 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4559278202620904, 'eval_loss': 0.9976684, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1377, 1591, 1519, 1394, 1236, 883, 614, 604, 1047, 485, 1704], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50644116, 'remaining_params': 34373484, 'pruned_model_sparsity': 0.5956897865853659, 'expected_sparsity': 0.60073, 'target_sparsity': 0.6, 'step': 15250}


Iteration:  90%|█████████ | 242/268 [00:43<00:19,  1.34it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:14,  1.77it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:10,  2.29it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:07,  2.91it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:06,  3.54it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:04,  4.20it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:04,  4.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:03,  5.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:03,  5.87it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.27it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  6.56it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.73it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.92it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.04it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.05it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.26it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.19it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.29it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.16it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.18it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.10it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.60it/s][A04/21/2024 14:09:22 - INFO - trainer.trainer_mod - Epoch 56 finished. Took 47.27 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  57%|█████▋    | 57/100 [45:25<34:21, 47.94s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.91it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.02it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.94it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.04it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.09it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.97it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.08it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.07it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.15it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.06it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.05it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.91it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.01it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.08it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.25it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.37it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.45it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.42it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.21it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:09:26,275 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:09:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:09:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:09:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:09:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:09:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:09:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4726938037416079, 'eval_loss': 1.0215713, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1376, 1590, 1518, 1394, 1235, 883, 614, 609, 1052, 487, 1711], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50621136, 'remaining_params': 34396464, 'pruned_model_sparsity': 0.5954194896115628, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 15300}


Iteration:   9%|▉         | 24/268 [00:05<03:01,  1.34it/s][A04/21/2024 14:09:28 - INFO - trainer.trainer_mod - v4 Global step: 15300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:16,  1.78it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:46,  2.28it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:24,  2.86it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:08,  3.51it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:57,  4.16it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:49,  4.84it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:43,  5.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:40,  5.87it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.26it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:36,  6.47it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.81it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.94it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.90it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.03it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.21it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:30,  7.32it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.29it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.39it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.12it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.12it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.15it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.18it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.20it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.21it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.12it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.03it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.11it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.26it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.23it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.23it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.03it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.11it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.20it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.17it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.10it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.15it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.17it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.25it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.28it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:09:35,233 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:09:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:09:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:09:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:09:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:09:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:09:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44113488112476795, 'eval_loss': 0.9804191, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1376, 1589, 1517, 1394, 1235, 883, 614, 612, 1057, 488, 1719], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50598156, 'remaining_params': 34419444, 'pruned_model_sparsity': 0.5951491926377597, 'expected_sparsity': 0.59966, 'target_sparsity': 0.6, 'step': 15350}


Iteration:  28%|██▊       | 74/268 [00:14<02:24,  1.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:48,  1.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:23,  2.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:05,  2.90it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:53,  3.55it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:44,  4.27it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:38,  4.89it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:34,  5.44it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:31,  5.92it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:30,  6.12it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.61it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.84it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.00it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.06it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.00it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.10it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  7.07it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  7.02it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.88it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.01it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.11it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.05it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.11it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.13it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.08it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.05it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.10it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.13it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.17it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.43it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.39it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.31it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.08it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.15it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.19it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.20it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.03it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.06it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.09it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.14it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.07it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  6.97it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.02it/s][A[INFO|trainer.py:570] 2024-04-21 14:09:44,221 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:09:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:09:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:09:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:09:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:09:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:09:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4524543085893371, 'eval_loss': 1.0715973, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1375, 1589, 1517, 1394, 1236, 883, 614, 615, 1061, 489, 1719], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50585900, 'remaining_params': 34431700, 'pruned_model_sparsity': 0.5950050342517315, 'expected_sparsity': 0.59933, 'target_sparsity': 0.6, 'step': 15400}


Iteration:  46%|████▋     | 124/268 [00:23<01:47,  1.33it/s][A04/21/2024 14:09:46 - INFO - trainer.trainer_mod - v4 Global step: 15400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:23<01:21,  1.76it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<01:01,  2.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:48,  2.89it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:40,  3.49it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:33,  4.18it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:28,  4.76it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:25,  5.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:22,  5.99it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.15it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.47it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.64it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.35it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.60it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.72it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.77it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.93it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  7.02it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.12it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.17it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.10it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.06it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.14it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.19it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.32it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.15it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.24it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.10it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.14it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.21it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.22it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.23it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.24it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.25it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.26it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.26it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.98it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.07it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.30it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.44it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 14:09:53,212 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:09:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:09:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:09:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:09:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:09:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:09:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4703217961497291, 'eval_loss': 0.97724146, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1375, 1590, 1518, 1394, 1237, 884, 615, 616, 1062, 487, 1718], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50579772, 'remaining_params': 34437828, 'pruned_model_sparsity': 0.5949329550587172, 'expected_sparsity': 0.59912, 'target_sparsity': 0.6, 'step': 15450}


Iteration:  65%|██████▍   | 174/268 [00:32<01:10,  1.34it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:52,  1.76it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:40,  2.27it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:31,  2.87it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:25,  3.49it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:21,  4.08it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:19,  4.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:17,  5.10it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:15,  5.70it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:13,  6.23it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.57it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.72it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  6.87it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  6.99it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.06it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.30it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.19it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.13it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.18it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.09it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.11it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.33it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.16it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.27it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.23it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.08it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.29it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.39it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.33it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.30it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.27it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.29it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.28it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.25it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.23it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.28it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.23it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.20it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.14it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:10:02,159 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:10:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:10:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:10:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:10:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:10:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:10:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48380345391488866, 'eval_loss': 0.99482995, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1375, 1591, 1517, 1394, 1237, 885, 615, 617, 1067, 486, 1706], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 50391336, 'remaining_params': 34626264, 'pruned_model_sparsity': 0.592716519873532, 'expected_sparsity': 0.59942, 'target_sparsity': 0.6, 'step': 15500}


Iteration:  84%|████████▎ | 224/268 [00:41<00:32,  1.34it/s][A04/21/2024 14:10:04 - INFO - trainer.trainer_mod - v4 Global step: 15500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:41<00:24,  1.79it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:18,  2.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:14,  2.91it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:11,  3.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:09,  4.26it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:07,  4.88it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:06,  5.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:06,  5.93it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.61it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.89it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.98it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.97it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.08it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.06it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.22it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.23it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.24it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.25it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.15it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.16it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.24it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.06it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.13it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.11it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.17it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.17it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.12it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.08it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.95it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.84it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.07it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.97it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  6.87it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.13it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.18it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.23it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.82it/s][A04/21/2024 14:10:10 - INFO - trainer.trainer_mod - Epoch 57 finished. Took 47.33 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  58%|█████▊    | 58/100 [46:12<33:25, 47.76s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.22it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.01it/s][A[INFO|trainer.py:570] 2024-04-21 14:10:11,080 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:10:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:10:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:10:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:10:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:10:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:10:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4636527046306878, 'eval_loss': 1.1035099, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1374, 1591, 1517, 1394, 1236, 884, 614, 618, 1069, 486, 1702], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 50398996, 'remaining_params': 34618604, 'pruned_model_sparsity': 0.5928066188647998, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 15550}


Iteration:   2%|▏         | 6/268 [00:02<03:37,  1.21it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:37,  1.66it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:58,  2.20it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:30,  2.85it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:13,  3.53it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:01,  4.16it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:53,  4.80it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:47,  5.37it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:44,  5.72it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:41,  6.17it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:38,  6.49it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:37,  6.68it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:36,  6.76it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:35,  6.95it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  6.98it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  7.04it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.07it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.01it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.00it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.18it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.40it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.39it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.37it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:32,  7.30it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.14it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.14it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.18it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.19it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.23it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.20it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.11it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.16it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.07it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.05it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  7.01it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.98it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.98it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.07it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.06it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.12it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.22it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.17it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.91it/s][A[INFO|trainer.py:570] 2024-04-21 14:10:20,058 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:10:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:10:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:10:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:10:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:10:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:10:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4241202758215723, 'eval_loss': 1.0527456, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1373, 1589, 1515, 1392, 1233, 882, 613, 620, 1071, 486, 1697], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 50420444, 'remaining_params': 34597156, 'pruned_model_sparsity': 0.5930588960403493, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 15600}


Iteration:  21%|██        | 56/268 [00:11<02:39,  1.33it/s][A04/21/2024 14:10:22 - INFO - trainer.trainer_mod - v4 Global step: 15600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:59,  1.77it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:31,  2.29it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:12,  2.90it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:58,  3.53it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:49,  4.19it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:43,  4.75it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:38,  5.32it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:35,  5.83it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:32,  6.24it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:30,  6.57it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:29,  6.80it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:28,  6.92it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  7.01it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.09it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.15it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:26,  7.31it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:26,  7.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.27it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.29it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.42it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.37it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.30it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.32it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  7.04it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.76it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.83it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  6.95it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.74it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.89it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.84it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.97it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.04it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.03it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.03it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.10it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.10it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.16it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.11it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.03it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.11it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.13it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.06it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:10:29,052 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:10:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:10:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:10:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:10:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:10:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:10:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43828878348379097, 'eval_loss': 1.0697567, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1373, 1589, 1516, 1392, 1233, 883, 613, 621, 1073, 486, 1697], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 50412784, 'remaining_params': 34604816, 'pruned_model_sparsity': 0.5929687970490816, 'expected_sparsity': 0.60032, 'target_sparsity': 0.6, 'step': 15650}


Iteration:  40%|███▉      | 106/268 [00:20<02:01,  1.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:30,  1.78it/s][A
Iteration:  40%|████      | 108/268 [00:21<01:09,  2.31it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:54,  2.92it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:45,  3.46it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:38,  4.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:33,  4.65it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:30,  5.16it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:27,  5.58it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:25,  6.03it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.41it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.58it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.68it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  6.86it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.90it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.03it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:20,  7.09it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:19,  7.27it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.17it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.17it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.11it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.18it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.08it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.10it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.15it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.16it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.21it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.24it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.26it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.37it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.38it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.34it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.35it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.31it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.27it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.10it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.18it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.24it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.30it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.24it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.24it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.20it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:10:38,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:10:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:10:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:10:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:10:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:10:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:10:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4440867985315811, 'eval_loss': 1.0428659, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1372, 1589, 1515, 1391, 1232, 881, 612, 624, 1075, 486, 1705], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50598156, 'remaining_params': 34419444, 'pruned_model_sparsity': 0.5951491926377597, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 15700}


Iteration:  58%|█████▊    | 156/268 [00:29<01:23,  1.34it/s][A04/21/2024 14:10:40 - INFO - trainer.trainer_mod - v4 Global step: 15700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:29<01:02,  1.77it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:48,  2.28it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:37,  2.87it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:30,  3.49it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:26,  4.11it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:22,  4.74it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:19,  5.32it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:17,  5.82it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.22it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.55it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.90it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  7.00it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.99it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.08it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:13,  7.10it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  7.12it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.06it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  7.02it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  7.07it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.03it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.08it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.12it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.17it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.16it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.21it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.32it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.26it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.23it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.23it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.22it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.22it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.20it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.04it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.11it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.06it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.15it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.12it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:10:46,995 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:10:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:10:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:10:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:10:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]04/21/2024 14:10:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:10:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4650296992137444, 'eval_loss': 1.0702846, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1372, 1590, 1514, 1391, 1232, 882, 613, 626, 1079, 486, 1709], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 3, 10], 'pruned_params': 50383676, 'remaining_params': 34633924, 'pruned_model_sparsity': 0.5926264208822644, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 15750}


Iteration:  77%|███████▋  | 206/268 [00:38<00:46,  1.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:34,  1.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:25,  2.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:20,  2.92it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:16,  3.53it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:13,  4.19it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:11,  4.77it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:10,  5.24it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:09,  5.87it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.21it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.52it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.70it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.87it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.98it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.23it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.23it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.15it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.18it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.17it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.30it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.24it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.24it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.12it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.94it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.05it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.05it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.08it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.19it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.34it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.31it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.39it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.15it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.10it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.05it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.28it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.26it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.23it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.27it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 14:10:55,918 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:10:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:10:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:10:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:10:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:10:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:10:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4756138930857138, 'eval_loss': 0.999449, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1371, 1589, 1513, 1391, 1233, 882, 613, 628, 1082, 486, 1708], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50575176, 'remaining_params': 34442424, 'pruned_model_sparsity': 0.5948788956639567, 'expected_sparsity': 0.59968, 'target_sparsity': 0.6, 'step': 15800}


Iteration:  96%|█████████▌| 256/268 [00:47<00:08,  1.34it/s][A04/21/2024 14:10:57 - INFO - trainer.trainer_mod - v4 Global step: 15800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:47<00:06,  1.78it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:04,  2.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:03,  2.88it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:02,  3.50it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  4.16it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  4.70it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  5.30it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  5.69it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.12it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.00it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.35it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.05it/s][A04/21/2024 14:10:59 - INFO - trainer.trainer_mod - Epoch 58 finished. Took 49.37 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.43it/s]
Epoch:  59%|█████▉    | 59/100 [47:01<32:57, 48.24s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.15it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.41it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.38it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.23it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.15it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.29it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.29it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.45it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.39it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.31it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.32it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.29it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.15it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.98it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.24it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.27it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:32,  7.46it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.42it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.39it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.09it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.95it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.91it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:34,  6.92it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  7.02it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.01it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.05it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  7.03it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  7.07it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.08it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:32,  7.23it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:11:04,877 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:11:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:11:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:11:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:11:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:11:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:11:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4584243142844763, 'eval_loss': 1.0881989, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1371, 1588, 1513, 1392, 1233, 882, 612, 630, 1085, 485, 1699], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50585900, 'remaining_params': 34431700, 'pruned_model_sparsity': 0.5950050342517315, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 15850}


Iteration:  14%|█▍        | 38/268 [00:07<02:51,  1.34it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:09,  1.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:39,  2.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:18,  2.90it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:03,  3.55it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:53,  4.22it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:46,  4.86it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:41,  5.42it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:38,  5.79it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:35,  6.30it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:32,  6.75it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.91it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.98it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.31it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.28it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.37it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.51it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.33it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.14it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.07it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.07it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.21it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.21it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.23it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.21it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.11it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.16it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.17it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.19it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.90it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.04it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  6.99it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.04it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.10it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.14it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.19it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.24it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.22it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.22it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:11:13,843 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:11:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:11:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:11:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:11:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:11:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:11:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47775581719103866, 'eval_loss': 1.0329459, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1371, 1588, 1513, 1391, 1233, 881, 611, 632, 1086, 484, 1691], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50599688, 'remaining_params': 34417912, 'pruned_model_sparsity': 0.5951672124360132, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 15900}


Iteration:  33%|███▎      | 88/268 [00:16<02:15,  1.33it/s][A04/21/2024 14:11:15 - INFO - trainer.trainer_mod - v4 Global step: 15900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:41,  1.76it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<01:18,  2.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:01,  2.87it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:49,  3.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:41,  4.19it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:36,  4.77it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:32,  5.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:29,  5.81it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:27,  6.15it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:25,  6.66it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.02it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.08it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.13it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.20it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.09it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.07it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.99it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.06it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.12it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.14it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:22,  6.98it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.07it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.00it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.07it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.12it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:21,  6.81it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.03it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.10it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.05it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.10it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.01it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.13it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:20,  6.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.06it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.17it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.04it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  6.97it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.19it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.23it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.41it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.26it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 14:11:22,844 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:11:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:11:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:11:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:11:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:11:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:11:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4694023927257154, 'eval_loss': 0.94553727, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1371, 1588, 1511, 1391, 1232, 881, 611, 634, 1089, 484, 1686], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50604284, 'remaining_params': 34413316, 'pruned_model_sparsity': 0.5952212718307739, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 15950}


Iteration:  51%|█████▏    | 138/268 [00:25<01:37,  1.33it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<01:13,  1.76it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:55,  2.30it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:43,  2.90it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:35,  3.57it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:29,  4.24it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:25,  4.82it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:22,  5.40it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:20,  5.83it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:19,  6.21it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:18,  6.49it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:18,  6.60it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:17,  6.68it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.70it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.89it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.11it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.11it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.06it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.12it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.35it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.34it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.21it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.23it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.30it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.21it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.18it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.34it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.13it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:14,  6.63it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:14,  6.62it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  6.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  6.93it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:13,  6.82it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  6.96it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.09it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.19it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.39it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.54it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.33it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.32it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 14:11:31,827 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:11:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:11:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:11:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:11:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:11:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:11:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.49678228082965264, 'eval_loss': 0.94370025, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1370, 1587, 1509, 1389, 1231, 880, 610, 637, 1092, 484, 1695], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50595092, 'remaining_params': 34422508, 'pruned_model_sparsity': 0.5951131530412527, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 16000}


Iteration:  70%|███████   | 188/268 [00:34<00:59,  1.34it/s][A04/21/2024 14:11:33 - INFO - trainer.trainer_mod - v4 Global step: 16000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:34<00:44,  1.78it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:34,  2.29it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:26,  2.87it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:21,  3.52it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:18,  4.15it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:15,  4.78it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:13,  5.30it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:12,  5.87it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:11,  6.19it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.64it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  6.82it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  6.95it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.05it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.11it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.13it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.28it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.25it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.01it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.08it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.04it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.10it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.27it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.18it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.19it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.03it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.10it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.09it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.05it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.09it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.25it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.27it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.25it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.22it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.23it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.12it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.16it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.17it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.12it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:05,  6.99it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 14:11:40,804 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:11:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:11:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:11:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:11:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:11:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:11:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.49678228082965264, 'eval_loss': 1.020469, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1369, 1586, 1509, 1388, 1229, 879, 609, 640, 1096, 484, 1698], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50592028, 'remaining_params': 34425572, 'pruned_model_sparsity': 0.5950771134447456, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 16050}


Iteration:  89%|████████▉ | 238/268 [00:43<00:22,  1.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:16,  1.78it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:12,  2.31it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:09,  2.90it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:07,  3.55it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:06,  4.15it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:05,  4.78it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:04,  5.34it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  5.78it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  5.98it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.72it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  6.87it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.00it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.08it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.17it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.17it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.08it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.19it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.09it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.14it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.16it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.12it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.29it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.78it/s][A04/21/2024 14:11:46 - INFO - trainer.trainer_mod - Epoch 59 finished. Took 47.35 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  60%|██████    | 60/100 [47:49<31:58, 47.97s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.13it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.24it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.65it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.83it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.84it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.82it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.96it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.03it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.09it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.31it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.29it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.19it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.20it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.24it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.16it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 14:11:49,782 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:11:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:11:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:11:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:11:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:11:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:11:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44680285011520593, 'eval_loss': 1.0357709, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1367, 1584, 1508, 1388, 1228, 879, 609, 643, 1098, 484, 1702], 'head_nums': [4, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50588964, 'remaining_params': 34428636, 'pruned_model_sparsity': 0.5950410738482385, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 16100}


Iteration:   7%|▋         | 20/268 [00:04<03:05,  1.34it/s][A04/21/2024 14:11:51 - INFO - trainer.trainer_mod - v4 Global step: 16100, Alignment: tensor([2, 3, 7, 8], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:19,  1.78it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:47,  2.29it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:25,  2.88it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:09,  3.53it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:58,  4.13it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:50,  4.76it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:44,  5.39it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:40,  5.86it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.16it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.76it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.00it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.05it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.11it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.13it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.17it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.28it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.26it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.27it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.26it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.23it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.24it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.36it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.33it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.20it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.35it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.29it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.29it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.21it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.15it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.36it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.23it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.14it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.19it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.12it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:11:58,707 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:11:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:11:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:11:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:11:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:12:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:12:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47207235269458875, 'eval_loss': 0.986199, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1368, 1585, 1509, 1389, 1230, 880, 610, 645, 1102, 484, 1702], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50762080, 'remaining_params': 34255520, 'pruned_model_sparsity': 0.5970773110508882, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 16150}


Iteration:  26%|██▌       | 70/268 [00:13<02:28,  1.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:51,  1.77it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<01:25,  2.30it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<01:07,  2.90it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:54,  3.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:46,  4.14it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:40,  4.72it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:36,  5.22it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:33,  5.72it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:31,  6.06it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:29,  6.37it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.61it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.76it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  6.89it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  7.01it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.22it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.42it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.37it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.15it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.23it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.27it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.21it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.13it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.16it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.30it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.30it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.11it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.19it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.13it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.17it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.97it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.00it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.10it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.20it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.21it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.22it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:12:07,662 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:12:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:12:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:12:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:12:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:12:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:12:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47527800562657263, 'eval_loss': 0.95243645, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1368, 1584, 1509, 1390, 1230, 881, 611, 647, 1105, 485, 1705], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50745228, 'remaining_params': 34272372, 'pruned_model_sparsity': 0.5968790932700994, 'expected_sparsity': 0.59966, 'target_sparsity': 0.6, 'step': 16200}


Iteration:  45%|████▍     | 120/268 [00:22<01:50,  1.34it/s][A04/21/2024 14:12:09 - INFO - trainer.trainer_mod - v4 Global step: 16200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:22<01:23,  1.77it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<01:03,  2.29it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:50,  2.85it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:41,  3.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:34,  4.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:29,  4.74it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:26,  5.28it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:24,  5.78it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:22,  6.16it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  6.83it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  7.04it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.13it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.06it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.12it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.15it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.19it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.10it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  7.00it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.09it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.17it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.19it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.12it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.03it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.27it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.16it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.20it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.17it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.04it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.06it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.12it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.14it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.16it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.10it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.13it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.17it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.98it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.06it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.10it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.10it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.13it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.25it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.25it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:12:16,654 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:12:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:12:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:12:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:12:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:12:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:12:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4944765036297336, 'eval_loss': 0.9498341, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1368, 1583, 1508, 1389, 1229, 880, 610, 649, 1108, 485, 1701], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50752888, 'remaining_params': 34264712, 'pruned_model_sparsity': 0.596969192261367, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 16250}


Iteration:  63%|██████▎   | 170/268 [00:31<01:13,  1.34it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:55,  1.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:42,  2.28it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:33,  2.85it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:27,  3.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:22,  4.11it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:19,  4.67it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:17,  5.19it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:15,  5.75it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:14,  6.25it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.75it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.79it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.82it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.82it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  6.94it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.06it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.05it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.07it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.13it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.79it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.91it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  6.98it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.08it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.91it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.12it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.33it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.18it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.22it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.07it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.10it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.18it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.05it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.00it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.10it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.93it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  6.86it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  6.77it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  6.90it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  6.89it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.89it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.00it/s][A[INFO|trainer.py:570] 2024-04-21 14:12:25,762 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:12:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:12:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:12:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:12:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:12:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:12:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.5046864656256237, 'eval_loss': 1.0103765, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1366, 1582, 1506, 1387, 1227, 879, 608, 650, 1111, 484, 1702], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 10], 'pruned_params': 50766676, 'remaining_params': 34250924, 'pruned_model_sparsity': 0.5971313704456489, 'expected_sparsity': 0.60031, 'target_sparsity': 0.6, 'step': 16300}


Iteration:  82%|████████▏ | 220/268 [00:40<00:36,  1.33it/s][A04/21/2024 14:12:27 - INFO - trainer.trainer_mod - v4 Global step: 16300, Alignment: tensor([ 2,  3,  8, 10], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:40<00:26,  1.76it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:20,  2.29it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:15,  2.89it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:12,  3.52it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:10,  4.11it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:08,  4.70it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:07,  5.27it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:06,  5.76it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:06,  6.12it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.36it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.66it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.72it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.92it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  7.03it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.04it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.11it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.14it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.05it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.31it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.32it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.32it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.31it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.16it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.17it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.19it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.11it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.18it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.20it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.33it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.07it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.90it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.03it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.10it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.08it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.17it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.31it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.85it/s][A04/21/2024 14:12:34 - INFO - trainer.trainer_mod - Epoch 60 finished. Took 47.47 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.65it/s]
Epoch:  61%|██████    | 61/100 [48:36<31:05, 47.82s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 14:12:34,705 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:12:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:12:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:12:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:12:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:12:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:12:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47756950398908987, 'eval_loss': 1.116651, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1365, 1581, 1505, 1386, 1228, 879, 608, 653, 1115, 485, 1703], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50562920, 'remaining_params': 34454680, 'pruned_model_sparsity': 0.5947347372779284, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 16350}


Iteration:   1%|          | 2/268 [00:02<05:52,  1.33s/it][A
Iteration:   1%|          | 3/268 [00:02<03:27,  1.28it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:20,  1.88it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:42,  2.57it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:18,  3.34it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:03,  4.08it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:54,  4.76it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:47,  5.44it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:44,  5.81it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:41,  6.18it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:39,  6.48it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:37,  6.80it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:36,  6.93it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:36,  6.88it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:36,  6.97it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:35,  6.99it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  7.07it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:35,  7.10it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.19it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.23it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.04it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.99it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.04it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.02it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.13it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.19it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.21it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.14it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.01it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.09it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.01it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.07it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.19it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.18it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.22it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.24it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.01it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.08it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  7.03it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.99it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  6.98it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.97it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.93it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.03it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.11it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.07it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 14:12:43,714 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:12:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:12:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:12:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:12:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:12:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:12:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4608700525278083, 'eval_loss': 1.0496805, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1365, 1582, 1504, 1386, 1227, 877, 607, 656, 1120, 486, 1711], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50543004, 'remaining_params': 34474596, 'pruned_model_sparsity': 0.5945004799006324, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 16400}


Iteration:  19%|█▉        | 52/268 [00:11<02:41,  1.34it/s][A04/21/2024 14:12:45 - INFO - trainer.trainer_mod - v4 Global step: 16400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:01,  1.76it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:33,  2.29it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:13,  2.89it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:00,  3.51it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:50,  4.18it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:43,  4.81it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:39,  5.29it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:37,  5.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:34,  5.94it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:32,  6.29it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:31,  6.57it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.76it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:29,  6.89it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:29,  6.89it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:29,  6.87it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:28,  6.99it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  7.02it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:28,  6.86it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.89it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:27,  7.04it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.28it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:27,  7.09it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  7.06it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.25it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.18it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.22it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.26it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.38it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.38it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:24,  7.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.34it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:23,  7.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.15it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.82it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  6.96it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.19it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.20it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.04it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.12it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 14:12:52,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:12:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:12:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:12:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:12:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:12:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:12:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4524543085893371, 'eval_loss': 0.99129283, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1365, 1582, 1504, 1385, 1228, 877, 608, 659, 1123, 486, 1704], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50541472, 'remaining_params': 34476128, 'pruned_model_sparsity': 0.5944824601023788, 'expected_sparsity': 0.59929, 'target_sparsity': 0.6, 'step': 16450}


Iteration:  38%|███▊      | 102/268 [00:20<02:03,  1.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:33,  1.77it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<01:11,  2.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:55,  2.91it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:45,  3.53it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:38,  4.20it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:33,  4.78it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:30,  5.30it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:27,  5.73it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.09it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.25it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.45it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.61it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:22,  6.82it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:21,  6.95it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:21,  7.05it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:21,  7.14it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:20,  7.19it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:20,  7.21it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.15it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:20,  7.21it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  7.22it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.01it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.15it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.18it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.21it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.26it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.19it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.24it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.26it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.27it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.26it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.28it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.15it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.15it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.18it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.20it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.11it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.16it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.11it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.10it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.94it/s][A[INFO|trainer.py:570] 2024-04-21 14:13:01,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:13:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:13:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:13:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:13:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:13:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:13:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4694118952751528, 'eval_loss': 0.8955566, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1364, 1582, 1504, 1385, 1229, 878, 608, 659, 1124, 484, 1697], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50552196, 'remaining_params': 34465404, 'pruned_model_sparsity': 0.5946085986901536, 'expected_sparsity': 0.59983, 'target_sparsity': 0.6, 'step': 16500}


Iteration:  57%|█████▋    | 152/268 [00:29<01:27,  1.33it/s][A04/21/2024 14:13:03 - INFO - trainer.trainer_mod - v4 Global step: 16500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:29<01:05,  1.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:50,  2.28it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:39,  2.88it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:32,  3.49it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:26,  4.13it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:23,  4.75it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:20,  5.31it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:19,  5.65it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.05it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.49it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.71it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.88it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.81it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  7.09it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:13,  7.34it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.10it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  6.95it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:13,  7.03it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  7.02it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.95it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.95it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  7.03it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.99it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.08it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:11,  7.36it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.21it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.13it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.16it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.28it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.27it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.31it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.28it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.17it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.03it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.12it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.17it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.26it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.15it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  6.96it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 14:13:10,700 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:13:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:13:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:13:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:13:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:13:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:13:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.49419533040588925, 'eval_loss': 1.0218928, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1364, 1581, 1504, 1384, 1227, 877, 608, 659, 1125, 483, 1698], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50558324, 'remaining_params': 34459276, 'pruned_model_sparsity': 0.5946806778831677, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 16550}


Iteration:  75%|███████▌  | 202/268 [00:38<00:49,  1.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:36,  1.76it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:27,  2.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:21,  2.89it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:17,  3.54it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:14,  4.20it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:12,  4.82it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:10,  5.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:09,  5.83it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:09,  6.20it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.60it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.96it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  7.04it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  7.03it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.96it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.92it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.00it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.96it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  7.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.09it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.07it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.13it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.08it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.15it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  7.27it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.28it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.19it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.20it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.02it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.21it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  7.34it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.10it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.20it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.28it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.11it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.15it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.04it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.13it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 14:13:19,654 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:13:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:13:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:13:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:13:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:13:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:13:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4779281382373973, 'eval_loss': 0.9876659, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1364, 1580, 1502, 1384, 1227, 878, 608, 661, 1127, 484, 1686], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50768208, 'remaining_params': 34249392, 'pruned_model_sparsity': 0.5971493902439025, 'expected_sparsity': 0.60067, 'target_sparsity': 0.6, 'step': 16600}


Iteration:  94%|█████████▍| 252/268 [00:47<00:11,  1.34it/s][A04/21/2024 14:13:21 - INFO - trainer.trainer_mod - v4 Global step: 16600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:47<00:08,  1.78it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:06,  2.29it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:04,  2.89it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:03,  3.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:02,  4.20it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:02,  4.77it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  5.32it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  5.77it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.14it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.42it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.81it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.95it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.71it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.87it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.44it/s][A04/21/2024 14:13:23 - INFO - trainer.trainer_mod - Epoch 61 finished. Took 49.45 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  62%|██████▏   | 62/100 [49:26<30:35, 48.31s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.13it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.95it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.16it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.21it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.10it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.13it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.28it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.16it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.16it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.18it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.05it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.11it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.03it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.08it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.10it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.17it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.22it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.15it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.21it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.23it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.12it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.17it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.07it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.11it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:32,  7.29it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.77it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  6.93it/s][A[INFO|trainer.py:570] 2024-04-21 14:13:28,667 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:13:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:13:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:13:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:13:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:13:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:13:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4505173993303405, 'eval_loss': 0.99264514, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1364, 1580, 1503, 1385, 1228, 878, 610, 663, 1131, 485, 1688], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50748292, 'remaining_params': 34269308, 'pruned_model_sparsity': 0.5969151328666065, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 16650}


Iteration:  13%|█▎        | 34/268 [00:06<02:55,  1.33it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:12,  1.76it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:42,  2.27it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:20,  2.88it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:05,  3.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:54,  4.17it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:47,  4.77it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:43,  5.20it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:39,  5.69it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:37,  5.94it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.35it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.60it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.79it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.91it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.02it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.02it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.04it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.11it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.09it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.12it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.12it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.33it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.27it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.88it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.97it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.15it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  7.00it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.08it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.18it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.20it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.12it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.33it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.44it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.35it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.31it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.17it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.14it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.18it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.08it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.09it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 14:13:37,662 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:13:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:13:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:13:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:13:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:13:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:13:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4537159672261629, 'eval_loss': 0.93871, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1364, 1580, 1503, 1385, 1228, 878, 609, 665, 1132, 485, 1696], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50732972, 'remaining_params': 34284628, 'pruned_model_sparsity': 0.596734934884071, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 16700}


Iteration:  31%|███▏      | 84/268 [00:15<02:17,  1.34it/s][A04/21/2024 14:13:39 - INFO - trainer.trainer_mod - v4 Global step: 16700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:43,  1.77it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<01:19,  2.29it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:02,  2.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:50,  3.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:43,  4.15it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:37,  4.73it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:33,  5.29it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:30,  5.77it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:27,  6.30it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.74it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.00it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.04it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.12it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  7.02it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.13it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.14it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.17it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.20it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.20it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.20it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.21it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.20it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.05it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.96it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.02it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.10it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.13it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.95it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.02it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  7.09it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.15it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.14it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.16it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.04it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.10it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.04it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.17it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.29it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.26it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.14it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.19it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:13:46,636 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:13:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:13:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:13:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:13:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]04/21/2024 14:13:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:13:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4382589402952836, 'eval_loss': 1.1713858, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1363, 1580, 1502, 1385, 1228, 879, 609, 666, 1132, 484, 1698], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50731440, 'remaining_params': 34286160, 'pruned_model_sparsity': 0.5967169150858175, 'expected_sparsity': 0.59949, 'target_sparsity': 0.6, 'step': 16750}


Iteration:  50%|█████     | 134/268 [00:24<01:40,  1.34it/s][A
Iteration:  50%|█████     | 135/268 [00:24<01:15,  1.77it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:57,  2.29it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:45,  2.91it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:36,  3.55it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:30,  4.17it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:26,  4.80it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:24,  5.28it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:22,  5.63it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:20,  6.03it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.26it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.74it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  6.90it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.93it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.02it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.22it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.22it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.15it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.19it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.99it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.07it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.90it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.94it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.04it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  6.73it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.89it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  6.90it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.19it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.22it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.23it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.14it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.07it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.06it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.12it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.15it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  7.03it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:13,  6.98it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:13,  6.91it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.91it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  6.91it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.19it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:13:55,679 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:13:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:13:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:13:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:13:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:13:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:13:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4585588335759275, 'eval_loss': 0.96997553, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1363, 1580, 1502, 1385, 1228, 879, 610, 667, 1132, 483, 1681], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50755952, 'remaining_params': 34261648, 'pruned_model_sparsity': 0.5970052318578741, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 16800}


Iteration:  69%|██████▊   | 184/268 [00:33<01:02,  1.34it/s][A04/21/2024 14:13:57 - INFO - trainer.trainer_mod - v4 Global step: 16800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:33<00:46,  1.77it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:35,  2.29it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:28,  2.89it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:22,  3.53it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:19,  4.15it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:16,  4.76it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:14,  5.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:13,  5.76it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:12,  6.15it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.90it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.18it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.12it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.14it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.29it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:08,  7.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.30it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.32it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.43it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:07,  7.54it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.64it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.37it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.24it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.33it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.23it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.07it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.05it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.08it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.12it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.33it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.36it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.08it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.98it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.06it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.08it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.14it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.19it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.19it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.03it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.00it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.05it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:14:04,590 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:14:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:14:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:14:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:14:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:14:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:14:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45115517656589194, 'eval_loss': 1.0269256, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1363, 1579, 1500, 1383, 1226, 879, 608, 667, 1133, 482, 1672], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50783528, 'remaining_params': 34234072, 'pruned_model_sparsity': 0.5973295882264378, 'expected_sparsity': 0.60038, 'target_sparsity': 0.6, 'step': 16850}


Iteration:  87%|████████▋ | 234/268 [00:42<00:25,  1.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:18,  1.76it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:13,  2.29it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:10,  2.88it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:08,  3.52it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:06,  4.14it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:05,  4.76it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:05,  5.33it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:04,  5.74it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  6.14it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.68it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.84it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.89it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.11it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.16it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.17it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  6.98it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.06it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.08it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.91it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.79it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.92it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.20it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.14it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.18it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.22it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.21it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.14it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.14it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.09it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.67it/s][A04/21/2024 14:14:11 - INFO - trainer.trainer_mod - Epoch 62 finished. Took 47.45 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.65it/s]
Epoch:  63%|██████▎   | 63/100 [50:13<29:37, 48.05s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.14it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.20it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.18it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.18it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.19it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.19it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.25it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.25it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.38it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.26it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:14:13,547 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:14:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:14:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:14:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:14:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:14:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:14:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4809059900216985, 'eval_loss': 0.8852886, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1405, 1363, 1579, 1500, 1384, 1227, 879, 609, 668, 1134, 482, 1670], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50780464, 'remaining_params': 34237136, 'pruned_model_sparsity': 0.5972935486299308, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 16900}


Iteration:   6%|▌         | 16/268 [00:04<03:08,  1.33it/s][A04/21/2024 14:14:15 - INFO - trainer.trainer_mod - v4 Global step: 16900, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:21,  1.77it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:48,  2.29it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:26,  2.88it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:10,  3.53it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:59,  4.18it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:51,  4.78it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:46,  5.27it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:42,  5.68it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:40,  5.96it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:39,  6.15it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:37,  6.45it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:36,  6.59it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.79it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.93it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.04it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.09it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.22it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.33it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.29it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.13it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.18it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.13it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.22it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.25it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.16it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.16it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.20it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.04it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.23it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.25it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.36it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.31it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.24it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.10it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.05it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.21it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.31it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.18it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.11it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.16it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 14:14:22,539 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:14:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:14:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:14:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:14:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:14:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:14:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4497290185542299, 'eval_loss': 1.0446664, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1364, 1579, 1500, 1384, 1228, 879, 609, 670, 1137, 482, 1673], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50565984, 'remaining_params': 34451616, 'pruned_model_sparsity': 0.5947707768744354, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 16950}


Iteration:  25%|██▍       | 66/268 [00:13<02:30,  1.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:53,  1.77it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:27,  2.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:09,  2.88it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:55,  3.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:46,  4.21it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:40,  4.81it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:36,  5.29it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:33,  5.83it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:31,  6.19it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.47it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.69it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.81it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.84it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  6.95it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.05it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.00it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  7.04it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.09it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:25,  7.16it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  6.97it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  6.96it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.03it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.11it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.12it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.16it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.19it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.22it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.22it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.21it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.22it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.22it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.15it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.16it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.16it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.18it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.11it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.17it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.20it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.22it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.99it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  6.83it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.92it/s][A[INFO|trainer.py:570] 2024-04-21 14:14:31,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:14:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:14:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:14:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:14:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:14:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:14:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4646104718707002, 'eval_loss': 0.9690628, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1364, 1579, 1501, 1384, 1227, 878, 608, 671, 1139, 482, 1674], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50759016, 'remaining_params': 34258584, 'pruned_model_sparsity': 0.5970412714543812, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 17000}


Iteration:  43%|████▎     | 116/268 [00:22<01:54,  1.33it/s][A04/21/2024 14:14:33 - INFO - trainer.trainer_mod - v4 Global step: 17000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:22<01:25,  1.77it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<01:05,  2.28it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:51,  2.90it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:41,  3.54it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:35,  4.18it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:31,  4.71it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:27,  5.25it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:25,  5.74it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:23,  5.99it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.32it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.55it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.66it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.67it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.69it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.77it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  6.91it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  7.00it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.74it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.80it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  6.97it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.09it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  6.99it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.07it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.23it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:16,  7.45it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.45it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.15it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.97it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.08it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.16it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.03it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.07it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.08it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.13it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.89it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.96it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.02it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.09it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.99it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.07it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.85it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 14:14:40,635 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:14:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:14:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:14:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:14:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:14:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:14:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4810794261012942, 'eval_loss': 1.0242018, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1364, 1578, 1501, 1383, 1225, 877, 607, 673, 1141, 481, 1674], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50763612, 'remaining_params': 34253988, 'pruned_model_sparsity': 0.5970953308491418, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 17050}


Iteration:  62%|██████▏   | 166/268 [00:31<01:16,  1.33it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:57,  1.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:43,  2.28it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:34,  2.87it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:28,  3.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:23,  4.12it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:20,  4.73it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:17,  5.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:16,  5.77it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:15,  6.13it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.35it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.77it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  6.88it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.29it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.19it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.32it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.28it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.27it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.25it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.08it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.11it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.16it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  6.98it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  6.97it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.04it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.07it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.13it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.13it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.14it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.15it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  7.15it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.09it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.30it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.29it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.21it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.25it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.27it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.09it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  6.97it/s][A[INFO|trainer.py:570] 2024-04-21 14:14:49,627 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:14:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:14:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:14:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:14:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:14:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:14:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.49419533040588925, 'eval_loss': 0.9380245, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1363, 1577, 1499, 1382, 1223, 875, 607, 676, 1144, 482, 1674], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50569048, 'remaining_params': 34448552, 'pruned_model_sparsity': 0.5948068164709425, 'expected_sparsity': 0.60065, 'target_sparsity': 0.6, 'step': 17100}


Iteration:  81%|████████  | 216/268 [00:40<00:39,  1.33it/s][A04/21/2024 14:14:51 - INFO - trainer.trainer_mod - v4 Global step: 17100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:40<00:28,  1.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:21,  2.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:17,  2.87it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:13,  3.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:11,  4.13it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:09,  4.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:08,  5.34it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:07,  5.81it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.20it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.59it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.77it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.88it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.99it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.05it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.09it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.15it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.05it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.12it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.61it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.78it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.84it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.95it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  6.89it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.66it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.94it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.91it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.13it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.20it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 250/268 [00:45<00:02,  7.12it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.21it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.22it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.00it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.21it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:01,  7.15it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.23it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.24it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  7.04it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 14:14:58,660 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:14:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:14:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:14:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:14:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:15:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:15:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45523070208567706, 'eval_loss': 1.0969952, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1362, 1575, 1497, 1380, 1221, 874, 605, 680, 1151, 483, 1695], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50536876, 'remaining_params': 34480724, 'pruned_model_sparsity': 0.5944284007076182, 'expected_sparsity': 0.60051, 'target_sparsity': 0.6, 'step': 17150}


Iteration:  99%|█████████▉| 266/268 [00:49<00:01,  1.34it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  1.77it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  2.33it/s][A04/21/2024 14:15:00 - INFO - trainer.trainer_mod - Epoch 63 finished. Took 49.61 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.40it/s]
Epoch:  64%|██████▍   | 64/100 [51:03<29:06, 48.52s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.22it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.21it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.22it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.24it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.27it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.23it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.27it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.28it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.30it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.32it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  6.87it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.99it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.04it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.03it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.10it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.17it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.20it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.23it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.23it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.25it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.41it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.30it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.29it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.07it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.93it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.04it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.13it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.07it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.12it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.02it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.06it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.12it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.19it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.35it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.33it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:29,  7.47it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.31it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:30,  7.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:30,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:15:07,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:15:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:15:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:15:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:15:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:15:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:15:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4496077935780946, 'eval_loss': 1.0353394, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1362, 1574, 1496, 1380, 1221, 873, 604, 684, 1156, 485, 1716], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50492448, 'remaining_params': 34525152, 'pruned_model_sparsity': 0.5939058265582656, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 17200}


Iteration:  18%|█▊        | 48/268 [00:08<02:44,  1.34it/s][A04/21/2024 14:15:09 - INFO - trainer.trainer_mod - v4 Global step: 17200, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<02:04,  1.77it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:35,  2.28it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:15,  2.87it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:01,  3.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:52,  4.13it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:45,  4.71it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:40,  5.26it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:37,  5.68it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:34,  6.10it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:33,  6.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.58it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.74it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.99it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  7.04it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.11it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.29it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.14it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.19it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.08it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.96it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  7.03it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:28,  6.99it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.08it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.32it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.19it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.18it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:28,  6.65it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.81it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  6.94it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  7.00it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.32it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.35it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.21it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.12it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:24,  7.15it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:24,  6.97it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:23,  7.23it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:23,  7.23it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:23,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 14:15:16,622 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:15:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:15:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:15:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:15:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:15:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:15:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4325231818860751, 'eval_loss': 1.0777779, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1362, 1575, 1494, 1380, 1220, 873, 605, 688, 1161, 486, 1734], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50449552, 'remaining_params': 34568048, 'pruned_model_sparsity': 0.5934012722071665, 'expected_sparsity': 0.59946, 'target_sparsity': 0.6, 'step': 17250}


Iteration:  37%|███▋      | 98/268 [00:17<02:05,  1.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:34,  1.80it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:12,  2.32it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:57,  2.91it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:46,  3.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:38,  4.24it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:34,  4.77it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:30,  5.32it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:27,  5.79it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:26,  6.17it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:24,  6.48it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.66it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.74it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:23,  6.81it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.92it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  7.01it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.10it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.15it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.00it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.08it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  6.89it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.10it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:21,  6.99it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.08it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.90it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.14it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.20it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.16it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.19it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.14it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.20it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.30it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.29it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.43it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.38it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.35it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.30it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.13it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.06it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:17,  7.11it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  7.13it/s][A
Iteration:  54%|█████▍    | 146/268 [00:24<00:17,  7.16it/s][A
Iteration:  55%|█████▍    | 147/268 [00:24<00:16,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:15:25,600 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:15:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:15:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:15:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:15:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:15:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:15:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4682662585067061, 'eval_loss': 0.96125233, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1361, 1574, 1494, 1381, 1221, 875, 606, 689, 1163, 486, 1737], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 4, 3, 11], 'pruned_params': 50438828, 'remaining_params': 34578772, 'pruned_model_sparsity': 0.5932751336193918, 'expected_sparsity': 0.59929, 'target_sparsity': 0.6, 'step': 17300}


Iteration:  55%|█████▌    | 148/268 [00:26<01:29,  1.34it/s][A04/21/2024 14:15:27 - INFO - trainer.trainer_mod - v4 Global step: 17300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:26<01:07,  1.77it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:51,  2.30it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:40,  2.88it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:33,  3.49it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:28,  4.09it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:24,  4.71it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:21,  5.37it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:18,  5.92it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:17,  6.26it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.72it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.87it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.01it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.10it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.04it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.32it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.11it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.05it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.10it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.02it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.07it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.12it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.15it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.20it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.16it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.12it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.14it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.04it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.11it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.17it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.18it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.20it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.14it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.17it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.11it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.09it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.07it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.03it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.09it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.17it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 14:15:34,577 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:15:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:15:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:15:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:15:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:15:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:15:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.475807613606693, 'eval_loss': 0.95025325, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1362, 1574, 1494, 1381, 1221, 875, 606, 689, 1163, 484, 1731], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 4, 3, 11], 'pruned_params': 50251924, 'remaining_params': 34765676, 'pruned_model_sparsity': 0.5910767182324601, 'expected_sparsity': 0.5996, 'target_sparsity': 0.6, 'step': 17350}


Iteration:  74%|███████▍  | 198/268 [00:35<00:51,  1.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:38,  1.77it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:30,  2.27it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:23,  2.83it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:19,  3.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:15,  4.14it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:13,  4.75it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:11,  5.29it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:10,  5.74it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.13it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.72it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.85it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.98it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.94it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.07it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.15it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.15it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.18it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.21it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.20it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.26it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.26it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.41it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.33it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.29it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.29it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.13it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.17it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.31it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.92it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.02it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.00it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  6.98it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  6.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  6.98it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.06it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.13it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  6.91it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  6.85it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.00it/s][A[INFO|trainer.py:570] 2024-04-21 14:15:43,582 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:15:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:15:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:15:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:15:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:15:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:15:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4357053256431942, 'eval_loss': 1.027776, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1360, 1572, 1492, 1379, 1217, 873, 604, 690, 1164, 483, 1720], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50487852, 'remaining_params': 34529748, 'pruned_model_sparsity': 0.593851767163505, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 17400}


Iteration:  93%|█████████▎| 248/268 [00:44<00:14,  1.33it/s][A04/21/2024 14:15:45 - INFO - trainer.trainer_mod - v4 Global step: 17400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:44<00:10,  1.77it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:07,  2.28it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:06,  2.83it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:04,  3.47it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:03,  4.07it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  4.75it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  5.32it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:02,  5.75it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.13it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  6.29it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.53it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.88it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.95it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.16it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.11it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.19it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.77it/s][A04/21/2024 14:15:48 - INFO - trainer.trainer_mod - Epoch 64 finished. Took 47.43 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.65it/s]
Epoch:  65%|██████▌   | 65/100 [51:50<28:06, 48.19s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.13it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.20it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.37it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.09it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.13it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.16it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.23it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.15it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.20it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.20it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.02it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.27it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.36it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.19it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.20it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.41it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.27it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.16it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.18it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.13it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 14:15:52,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:15:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:15:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:15:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:15:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 14:15:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:15:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.429653299261269, 'eval_loss': 1.0514712, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1360, 1571, 1491, 1378, 1218, 872, 604, 693, 1165, 484, 1715], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50492448, 'remaining_params': 34525152, 'pruned_model_sparsity': 0.5939058265582656, 'expected_sparsity': 0.60075, 'target_sparsity': 0.6, 'step': 17450}


Iteration:  11%|█         | 30/268 [00:06<02:56,  1.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:13,  1.78it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:41,  2.32it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:20,  2.92it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:05,  3.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:55,  4.20it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:48,  4.80it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:44,  5.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:40,  5.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:37,  6.09it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:35,  6.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:33,  6.75it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.89it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.01it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.07it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.16it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.17it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.22it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.19it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.20it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.12it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.92it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.92it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.95it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  7.00it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.99it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.10it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.16it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.21it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.30it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.19it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.30it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.30it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.18it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.21it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.22it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.23it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.10it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.25it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 14:16:01,479 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:16:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:16:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:16:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:16:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:16:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:16:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48363151084768286, 'eval_loss': 1.0233958, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1360, 1572, 1492, 1380, 1218, 873, 605, 695, 1171, 485, 1727], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50647180, 'remaining_params': 34370420, 'pruned_model_sparsity': 0.595725826181873, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 17500}


Iteration:  30%|██▉       | 80/268 [00:15<02:19,  1.34it/s][A04/21/2024 14:16:03 - INFO - trainer.trainer_mod - v4 Global step: 17500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:15<01:45,  1.78it/s][A
Iteration:  31%|███       | 82/268 [00:15<01:20,  2.30it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:04,  2.85it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:52,  3.48it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:44,  4.12it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:38,  4.72it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:33,  5.36it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:31,  5.75it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:29,  6.15it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.67it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.82it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.12it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.15it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.14it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.18it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.19it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.06it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.75it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.99it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.06it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.13it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.09it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.06it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.24it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.25it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.11it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.17it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.19it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.22it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.13it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.05it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.11it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.13it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.08it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.14it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.08it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.05it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.10it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:20,  7.03it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.06it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.01it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  6.97it/s][A[INFO|trainer.py:570] 2024-04-21 14:16:10,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:16:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:16:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:16:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:16:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:16:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:16:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46092393422967476, 'eval_loss': 0.9965762, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1359, 1572, 1492, 1379, 1218, 872, 605, 697, 1174, 487, 1741], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50621136, 'remaining_params': 34396464, 'pruned_model_sparsity': 0.5954194896115628, 'expected_sparsity': 0.59967, 'target_sparsity': 0.6, 'step': 17550}


Iteration:  49%|████▊     | 130/268 [00:24<01:42,  1.34it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<01:17,  1.78it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:59,  2.29it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:46,  2.88it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:38,  3.52it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:31,  4.17it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:27,  4.84it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:24,  5.37it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:22,  5.83it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:21,  6.03it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:20,  6.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.62it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.82it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.93it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.94it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.15it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.14it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.16it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.16it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.17it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.16it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.12it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.18it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.83it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.86it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  6.85it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.92it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  6.92it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:15,  6.80it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.96it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.94it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.02it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.11it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.18it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.15it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.14it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.06it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.12it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  6.97it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  6.99it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  6.93it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.04it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:13,  6.89it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.98it/s][A[INFO|trainer.py:570] 2024-04-21 14:16:19,584 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:16:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:16:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:16:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:16:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:16:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:16:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4524543085893371, 'eval_loss': 1.098079, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1358, 1572, 1492, 1380, 1218, 873, 605, 699, 1176, 487, 1750], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50599688, 'remaining_params': 34417912, 'pruned_model_sparsity': 0.5951672124360132, 'expected_sparsity': 0.59938, 'target_sparsity': 0.6, 'step': 17600}


Iteration:  67%|██████▋   | 180/268 [00:33<01:06,  1.33it/s][A04/21/2024 14:16:21 - INFO - trainer.trainer_mod - v4 Global step: 17600, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:33<00:49,  1.76it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:37,  2.27it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:29,  2.86it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:24,  3.49it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:20,  4.15it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:17,  4.72it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:15,  5.26it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:13,  5.73it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:12,  6.14it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:12,  6.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.70it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  6.89it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  6.91it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.89it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.00it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.88it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.90it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:10,  6.68it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  6.76it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  6.90it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.00it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.11it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.16it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.14it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.11it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.14it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.30it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.25it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.26it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.05it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.23it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.42it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.55it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.47it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.18it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.10it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.15it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:16:28,604 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:16:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:16:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:16:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:16:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:16:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:16:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47745692156806036, 'eval_loss': 0.9657995, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1357, 1572, 1492, 1381, 1219, 874, 606, 700, 1175, 486, 1738], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50615008, 'remaining_params': 34402592, 'pruned_model_sparsity': 0.5953474104185487, 'expected_sparsity': 0.5995, 'target_sparsity': 0.6, 'step': 17650}


Iteration:  86%|████████▌ | 230/268 [00:42<00:28,  1.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:20,  1.77it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:15,  2.28it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:12,  2.85it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:09,  3.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:08,  4.10it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:06,  4.71it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:06,  5.16it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:05,  5.63it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.04it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.61it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.71it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  6.75it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.82it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.05it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.22it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.14it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:45<00:02,  7.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.30it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.39it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.33it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.22it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.33it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:01,  7.31it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.27it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.40it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.16it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.19it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.23it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.36it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.89it/s][A04/21/2024 14:16:35 - INFO - trainer.trainer_mod - Epoch 65 finished. Took 47.49 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.64it/s]
Epoch:  66%|██████▌   | 66/100 [52:38<27:11, 47.98s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.13it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.05it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.32it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.30it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.28it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.15it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.17it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.19it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.04it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:16:37,526 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:16:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:16:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:16:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:16:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:16:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:16:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4691630965296861, 'eval_loss': 1.0800167, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1356, 1571, 1492, 1380, 1219, 874, 605, 700, 1174, 484, 1724], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50451084, 'remaining_params': 34566516, 'pruned_model_sparsity': 0.5934192920054201, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 17700}


Iteration:   4%|▍         | 12/268 [00:03<03:12,  1.33it/s][A04/21/2024 14:16:39 - INFO - trainer.trainer_mod - v4 Global step: 17700, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:24,  1.77it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:50,  2.30it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:27,  2.88it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:12,  3.48it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:00,  4.13it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:52,  4.73it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:48,  5.15it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:43,  5.65it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:40,  6.05it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.51it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.71it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.78it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  6.94it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.06it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.10it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.27it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:32,  7.28it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.92it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.90it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.93it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.03it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.09it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.07it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  7.03it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.06it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.94it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.01it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.07it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.09it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.13it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.06it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.22it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.25it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.39it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.33it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.33it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.29it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.25it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.27it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.15it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.10it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.09it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.12it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.31it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:16:46,526 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:16:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:16:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:16:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:16:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:16:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:16:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45808021085661066, 'eval_loss': 1.0836234, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1355, 1571, 1490, 1380, 1218, 873, 604, 700, 1174, 483, 1706], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50685480, 'remaining_params': 34332120, 'pruned_model_sparsity': 0.5961763211382114, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 17750}


Iteration:  23%|██▎       | 62/268 [00:12<02:33,  1.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:55,  1.77it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:29,  2.29it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<01:10,  2.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:57,  3.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:49,  4.08it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:43,  4.60it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:38,  5.22it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:35,  5.60it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:33,  5.93it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:31,  6.30it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.74it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  6.94it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  6.97it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.16it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.16it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.21it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.16it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.23it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.25it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.16it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.18it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.23it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.26it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.47it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.39it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.21it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:23,  7.34it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.25it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.05it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.11it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.15it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.35it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.22it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.06it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.00it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.01it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.11it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.09it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.13it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.18it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 14:16:55,520 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:16:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:16:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:16:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:16:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:16:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:16:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4553410961810576, 'eval_loss': 1.0434008, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1354, 1571, 1489, 1379, 1218, 873, 605, 702, 1175, 483, 1701], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50691608, 'remaining_params': 34325992, 'pruned_model_sparsity': 0.5962484003312255, 'expected_sparsity': 0.60092, 'target_sparsity': 0.6, 'step': 17800}


Iteration:  42%|████▏     | 112/268 [00:21<01:55,  1.35it/s][A04/21/2024 14:16:57 - INFO - trainer.trainer_mod - v4 Global step: 17800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:21<01:27,  1.78it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<01:07,  2.29it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:53,  2.88it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:43,  3.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:36,  4.18it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:31,  4.75it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:28,  5.24it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:26,  5.67it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:23,  6.16it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.67it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.82it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  6.85it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.84it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.06it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.11it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.06it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.04it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.24it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.25it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.26it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.27it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.37it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.20it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.23it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.02it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.94it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.94it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.94it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.03it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.00it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.18it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.20it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.24it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.27it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.09it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.16it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.08it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.14it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.82it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.95it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.85it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 14:17:04,529 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:17:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:17:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:17:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:17:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:17:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:17:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4827499680048533, 'eval_loss': 0.9432581, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1353, 1571, 1489, 1380, 1218, 873, 606, 705, 1178, 486, 1717], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50651776, 'remaining_params': 34365824, 'pruned_model_sparsity': 0.5957798855766335, 'expected_sparsity': 0.60051, 'target_sparsity': 0.6, 'step': 17850}


Iteration:  60%|██████    | 162/268 [00:30<01:18,  1.35it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:58,  1.78it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:45,  2.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:35,  2.90it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:28,  3.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:24,  4.11it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:20,  4.79it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:18,  5.28it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:17,  5.60it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:16,  6.01it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:15,  6.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.65it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.80it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.96it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.07it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.04it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.13it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.06it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.26it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.05it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.13it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.15it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.18it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.20it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.26it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.45it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.33it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.73it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.87it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.99it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  7.10it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.28it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.26it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.26it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.24it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.27it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.13it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.95it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.07it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:17:13,522 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:17:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:17:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:17:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:17:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:17:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:17:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.458212452857688, 'eval_loss': 1.0231764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1353, 1571, 1489, 1381, 1218, 875, 607, 709, 1184, 489, 1743], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50585900, 'remaining_params': 34431700, 'pruned_model_sparsity': 0.5950050342517315, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 17900}


Iteration:  79%|███████▉  | 212/268 [00:39<00:41,  1.34it/s][A04/21/2024 14:17:15 - INFO - trainer.trainer_mod - v4 Global step: 17900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:39<00:31,  1.77it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:23,  2.28it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:18,  2.86it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:14,  3.49it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:12,  4.20it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:10,  4.73it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:09,  5.21it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:08,  5.69it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.00it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:07,  6.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:07,  6.30it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.60it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.82it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  6.94it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.01it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  7.06it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.07it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.03it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.03it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.12it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.06it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  7.11it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.05it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.24it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.24it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.23it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.32it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  7.30it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.16it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.00it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.05it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.14it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.99it/s][A
Iteration:  93%|█████████▎| 250/268 [00:45<00:02,  6.97it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.06it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.23it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.14it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.16it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.09it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.15it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:01,  7.16it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 14:17:22,545 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:17:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:17:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:17:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:17:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:17:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:17:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48846822697102815, 'eval_loss': 0.9232957, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1353, 1571, 1490, 1382, 1219, 875, 608, 711, 1187, 491, 1764], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50536876, 'remaining_params': 34480724, 'pruned_model_sparsity': 0.5944284007076182, 'expected_sparsity': 0.59887, 'target_sparsity': 0.6, 'step': 17950}


Iteration:  98%|█████████▊| 262/268 [00:48<00:04,  1.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:02,  1.78it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  2.29it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:01,  2.89it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  3.53it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  4.17it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  4.98it/s][A04/21/2024 14:17:25 - INFO - trainer.trainer_mod - Epoch 66 finished. Took 49.52 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.41it/s]
Epoch:  67%|██████▋   | 67/100 [53:27<26:38, 48.44s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.27it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.25it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.23it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.15it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.07it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.15it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  6.99it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.94it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.01it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.06it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.13it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.20it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.24it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.26it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.36it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.29it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.07it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.14it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.17it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.69it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.87it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.98it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.09it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.12it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.19it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.09it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.11it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.14it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.00it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.13it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:32,  7.08it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.11it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.18it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:31,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:17:31,545 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:17:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:17:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:17:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:17:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:17:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:17:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4695101101903524, 'eval_loss': 1.0106912, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1352, 1570, 1488, 1381, 1216, 874, 607, 711, 1187, 490, 1757], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50762080, 'remaining_params': 34255520, 'pruned_model_sparsity': 0.5970773110508882, 'expected_sparsity': 0.5996, 'target_sparsity': 0.6, 'step': 18000}


Iteration:  16%|█▋        | 44/268 [00:08<02:47,  1.34it/s][A04/21/2024 14:17:33 - INFO - trainer.trainer_mod - v4 Global step: 18000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:06,  1.77it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:37,  2.28it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:16,  2.90it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:02,  3.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:53,  4.11it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:46,  4.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:41,  5.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:38,  5.68it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:35,  6.01it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:33,  6.33it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:34,  6.26it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:32,  6.55it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.96it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.06it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.04it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.98it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.88it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.99it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.07it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.95it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.15it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.15it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.20it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.15it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.23it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.22it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.25it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.09it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.06it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  6.92it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  7.05it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.15it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.19it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.34it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.20it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.07it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  7.07it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:25,  7.18it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.11it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.19it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:25,  7.08it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:25,  7.08it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.10it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:24,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:17:40,609 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:17:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:17:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:17:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:17:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:17:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:17:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4655142362608243, 'eval_loss': 0.93417084, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1350, 1569, 1488, 1381, 1216, 874, 607, 711, 1184, 488, 1735], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50613476, 'remaining_params': 34404124, 'pruned_model_sparsity': 0.5953293906202951, 'expected_sparsity': 0.60034, 'target_sparsity': 0.6, 'step': 18050}


Iteration:  35%|███▌      | 94/268 [00:17<02:09,  1.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:37,  1.77it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<01:15,  2.29it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:59,  2.88it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:48,  3.52it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:40,  4.15it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:34,  4.82it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:31,  5.37it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:28,  5.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:26,  6.20it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:24,  6.68it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  7.02it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  7.00it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  6.96it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.04it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.11it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.14it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.05it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:21,  7.15it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.24it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.26it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  6.93it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  7.03it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.10it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.11it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.15it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.19it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.12it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.14it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.09it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:20,  6.95it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.02it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.08it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.19it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  7.08it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.13it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.34it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.22it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  6.98it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.05it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  7.11it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.15it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:18,  7.00it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.11it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 14:17:49,610 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:17:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:17:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:17:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:17:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:17:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:17:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4584243142844763, 'eval_loss': 0.9655962, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1350, 1568, 1488, 1381, 1215, 874, 607, 713, 1185, 488, 1732], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50616540, 'remaining_params': 34401060, 'pruned_model_sparsity': 0.5953654302168022, 'expected_sparsity': 0.60039, 'target_sparsity': 0.6, 'step': 18100}


Iteration:  54%|█████▎    | 144/268 [00:26<01:32,  1.34it/s][A04/21/2024 14:17:51 - INFO - trainer.trainer_mod - v4 Global step: 18100, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:26<01:09,  1.78it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:52,  2.30it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:42,  2.88it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:34,  3.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:28,  4.16it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:24,  4.78it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:22,  5.30it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:20,  5.70it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:19,  5.94it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:18,  6.20it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.75it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.07it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.14it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.20it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.41it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.36it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.33it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.12it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.10it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.96it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.01it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.11it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.18it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.09it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.17it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.13it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.18it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.20it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.03it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.08it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.94it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  6.97it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.06it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.10it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.06it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.05it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.13it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.17it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.23it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.26it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.15it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.02it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  6.98it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 14:17:58,622 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:17:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:17:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:17:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:17:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:18:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:18:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45629173856554045, 'eval_loss': 1.059945, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1348, 1567, 1486, 1380, 1215, 876, 607, 715, 1186, 488, 1737], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50806508, 'remaining_params': 34211092, 'pruned_model_sparsity': 0.5975998852002409, 'expected_sparsity': 0.60032, 'target_sparsity': 0.6, 'step': 18150}


Iteration:  72%|███████▏  | 194/268 [00:35<00:55,  1.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:41,  1.77it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:31,  2.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:24,  2.88it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:19,  3.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:16,  4.14it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:14,  4.67it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:12,  5.17it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:11,  5.65it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:10,  5.97it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:10,  6.32it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.84it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.98it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.02it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.13it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.21it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.12it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.15it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.17it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.21it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.37it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.36it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.30it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.32it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.28it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.38it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.35it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.07it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.03it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.21it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.29it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.47it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.46it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 14:18:07,546 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:18:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:18:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:18:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:18:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:18:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:18:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46411094322127294, 'eval_loss': 0.9334917, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1347, 1564, 1484, 1379, 1213, 875, 606, 717, 1190, 489, 1747], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50601220, 'remaining_params': 34416380, 'pruned_model_sparsity': 0.5951852322342668, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 18200}


Iteration:  91%|█████████ | 244/268 [00:44<00:17,  1.35it/s][A04/21/2024 14:18:09 - INFO - trainer.trainer_mod - v4 Global step: 18200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:44<00:12,  1.78it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:09,  2.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:07,  2.89it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:05,  3.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:04,  4.16it/s][A
Iteration:  93%|█████████▎| 250/268 [00:45<00:03,  4.84it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:03,  5.38it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  5.81it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.15it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.68it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.94it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  6.84it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.97it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.05it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.03it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.08it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.12it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.15it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.15it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  6.94it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.03it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.55it/s][A04/21/2024 14:18:12 - INFO - trainer.trainer_mod - Epoch 67 finished. Took 47.51 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.64it/s]
Epoch:  68%|██████▊   | 68/100 [54:15<25:41, 48.16s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.16it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.19it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.20it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.22it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.09it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.16it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.16it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.23it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.24it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.23it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.23it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.24it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.37it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.26it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.15it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.16it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.19it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.27it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.39it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.39it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:18:16,487 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:18:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:18:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:18:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:18:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:18:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:18:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47053580111209176, 'eval_loss': 1.0943055, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1347, 1565, 1485, 1379, 1214, 876, 607, 719, 1193, 491, 1769], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50743696, 'remaining_params': 34273904, 'pruned_model_sparsity': 0.5968610734718458, 'expected_sparsity': 0.59966, 'target_sparsity': 0.6, 'step': 18250}


Iteration:  10%|▉         | 26/268 [00:05<03:00,  1.34it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:15,  1.78it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:44,  2.29it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:23,  2.87it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:07,  3.51it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:57,  4.15it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:49,  4.77it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:44,  5.32it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:40,  5.76it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:37,  6.15it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.69it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.84it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.93it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.01it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.20it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.23it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.19it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.21it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.24it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.16it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.20it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.24it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.07it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.29it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.18it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.68it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.86it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.90it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  6.99it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.05it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.12it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.10it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  7.04it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.14it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.19it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.15it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 14:18:25,475 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:18:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:18:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:18:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:18:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:18:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:18:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.458212452857688, 'eval_loss': 1.0849442, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1347, 1565, 1485, 1379, 1214, 876, 607, 720, 1196, 492, 1768], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50737568, 'remaining_params': 34280032, 'pruned_model_sparsity': 0.5967889942788317, 'expected_sparsity': 0.59953, 'target_sparsity': 0.6, 'step': 18300}


Iteration:  28%|██▊       | 76/268 [00:14<02:23,  1.34it/s][A04/21/2024 14:18:27 - INFO - trainer.trainer_mod - v4 Global step: 18300, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:47,  1.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:23,  2.27it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:06,  2.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:53,  3.49it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:45,  4.11it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:39,  4.69it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:35,  5.26it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:32,  5.66it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:29,  6.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.79it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.73it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.90it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  6.94it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.92it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  7.00it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.98it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.08it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.15it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.99it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.08it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  6.97it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.06it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.13it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.22it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.15it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.03it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.24it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.27it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.27it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.39it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.97it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.08it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.97it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.09it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.24it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.31it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.34it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:19,  7.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.39it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:18,  7.61it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:18,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 14:18:34,432 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:18:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:18:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:18:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:18:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:18:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:18:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45272024342354794, 'eval_loss': 0.98626924, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1346, 1565, 1484, 1379, 1214, 875, 606, 720, 1195, 491, 1759], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50760548, 'remaining_params': 34257052, 'pruned_model_sparsity': 0.5970592912526348, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 18350}


Iteration:  47%|████▋     | 126/268 [00:23<01:45,  1.35it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<01:18,  1.79it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<01:00,  2.31it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:48,  2.88it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:39,  3.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:33,  4.13it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:28,  4.78it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:25,  5.29it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:23,  5.63it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:22,  6.03it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:20,  6.35it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.59it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.68it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  6.84it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  7.07it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  7.02it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.09it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  6.97it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.18it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.04it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.11it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.15it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.10it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.28it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.15it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  6.98it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.00it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.06it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.07it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.24it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.23it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.17it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.19it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.23it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.26it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.20it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.04it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.09it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.18it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.39it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.52it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 14:18:43,415 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:18:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:18:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:18:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:18:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:18:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:18:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44985503774934166, 'eval_loss': 1.0880716, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1345, 1563, 1483, 1378, 1214, 875, 606, 720, 1193, 491, 1748], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50789656, 'remaining_params': 34227944, 'pruned_model_sparsity': 0.597401667419452, 'expected_sparsity': 0.60037, 'target_sparsity': 0.6, 'step': 18400}


Iteration:  66%|██████▌   | 176/268 [00:32<01:08,  1.35it/s][A04/21/2024 14:18:45 - INFO - trainer.trainer_mod - v4 Global step: 18400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:32<00:51,  1.78it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:39,  2.30it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:30,  2.89it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:24,  3.53it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:20,  4.16it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:18,  4.76it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:16,  5.20it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:14,  5.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:13,  6.01it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:13,  6.24it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.51it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.72it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.88it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  7.00it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.08it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.14it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.07it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  6.90it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.99it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.99it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  7.02it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.09it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.15it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.17it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.09it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.15it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.18it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.17it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.11it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.18it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.10it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.33it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.19it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.33it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.31it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.22it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.14it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.26it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.49it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:18:52,391 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:18:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:18:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:18:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:18:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:18:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:18:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4503393755428836, 'eval_loss': 1.0063536, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1345, 1563, 1484, 1378, 1215, 875, 606, 722, 1196, 491, 1743], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50785060, 'remaining_params': 34232540, 'pruned_model_sparsity': 0.5973476080246913, 'expected_sparsity': 0.60015, 'target_sparsity': 0.6, 'step': 18450}


Iteration:  84%|████████▍ | 226/268 [00:41<00:31,  1.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:22,  1.79it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:17,  2.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:13,  2.90it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:10,  3.54it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:08,  4.18it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:07,  4.79it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:06,  5.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  5.77it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:05,  6.14it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.57it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.76it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.88it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.00it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.10it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.11it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.18it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.16it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.16it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.85it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.08it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.13it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.05it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.14it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.17it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.19it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.07it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.31it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.19it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.28it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.04it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.09it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.14it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.02it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.57it/s][A04/21/2024 14:19:00 - INFO - trainer.trainer_mod - Epoch 68 finished. Took 47.33 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  69%|██████▉   | 69/100 [55:02<24:45, 47.91s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.20it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.46it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.46it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.62it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.44it/s][A[INFO|trainer.py:570] 2024-04-21 14:19:01,301 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:19:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:19:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:19:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:19:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:19:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:19:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4417358245552677, 'eval_loss': 0.9223461, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1344, 1563, 1484, 1378, 1215, 876, 607, 723, 1199, 490, 1752], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50765144, 'remaining_params': 34252456, 'pruned_model_sparsity': 0.5971133506473953, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 18500}


Iteration:   3%|▎         | 8/268 [00:03<03:22,  1.29it/s][A04/21/2024 14:19:03 - INFO - trainer.trainer_mod - v4 Global step: 18500, Alignment: tensor([1, 2, 3, 9], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:29,  1.73it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:53,  2.27it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:30,  2.86it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:13,  3.50it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:01,  4.13it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:53,  4.71it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:48,  5.26it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:44,  5.65it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:41,  6.06it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.30it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.49it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.83it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:36,  6.86it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:35,  6.95it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.83it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  6.99it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.87it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.89it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.98it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.07it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.15it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.09it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.14it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.33it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.30it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.34it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.33it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.32it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.15it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.31it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.11it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.03it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.10it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.03it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.04it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.17it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.16it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.87it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.93it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.99it/s][A[INFO|trainer.py:570] 2024-04-21 14:19:10,312 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:19:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:19:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:19:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:19:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:19:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:19:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43577816963420296, 'eval_loss': 1.1871667, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1343, 1563, 1484, 1379, 1215, 876, 608, 725, 1201, 490, 1752], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50559856, 'remaining_params': 34457744, 'pruned_model_sparsity': 0.5946986976814213, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 18550}


Iteration:  22%|██▏       | 58/268 [00:12<02:36,  1.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:58,  1.77it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:30,  2.29it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:11,  2.88it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:58,  3.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:48,  4.21it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:42,  4.74it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:38,  5.31it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:35,  5.77it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:32,  6.13it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:31,  6.45it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:29,  6.67it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:29,  6.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.97it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:27,  7.03it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  7.18it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  7.10it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.17it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.07it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.13it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  6.98it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.16it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.17it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.20it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.08it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.13it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.97it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.09it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.16it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.18it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.08it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.06it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.14it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.16it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.18it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.09it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  6.98it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 14:19:19,297 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:19:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:19:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:19:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:19:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 14:19:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:19:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4525387680200729, 'eval_loss': 1.0571054, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1344, 1563, 1485, 1380, 1218, 878, 609, 726, 1203, 491, 1748], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50938260, 'remaining_params': 34079340, 'pruned_model_sparsity': 0.5991495878500451, 'expected_sparsity': 0.59984, 'target_sparsity': 0.6, 'step': 18600}


Iteration:  40%|████      | 108/268 [00:21<01:59,  1.34it/s][A04/21/2024 14:19:21 - INFO - trainer.trainer_mod - v4 Global step: 18600, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:21<01:29,  1.78it/s][A
Iteration:  41%|████      | 110/268 [00:21<01:08,  2.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:53,  2.92it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:43,  3.56it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:37,  4.16it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:32,  4.73it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:28,  5.28it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:26,  5.70it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.13it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.61it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.41it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.65it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.84it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  6.94it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.02it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.93it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.10it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.00it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.07it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.38it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.26it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.25it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.02it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.01it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.09it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.12it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  7.09it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.13it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.19it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.20it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.20it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.24it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:15,  7.35it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.14it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.24it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.21it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.28it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.16it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:19:28,294 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:19:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:19:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:19:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:19:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 14:19:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:19:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4392663684224782, 'eval_loss': 1.0142685, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1343, 1563, 1486, 1380, 1219, 879, 611, 728, 1202, 492, 1746], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50933664, 'remaining_params': 34083936, 'pruned_model_sparsity': 0.5990955284552846, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 18650}


Iteration:  59%|█████▉    | 158/268 [00:30<01:21,  1.35it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<01:01,  1.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:46,  2.31it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:36,  2.92it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:30,  3.53it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:25,  4.17it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:21,  4.77it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:19,  5.32it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:17,  5.78it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:16,  6.22it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.60it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.77it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.75it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.89it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.10it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  7.13it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  7.07it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.11it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  6.94it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  6.91it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.99it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.07it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.13it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.15it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.97it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.02it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.09it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.02it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.10it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.05it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  7.08it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.13it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.46it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.24it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.27it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.41it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.20it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.21it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.12it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.14it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.18it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.96it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.11it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 14:19:37,285 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:19:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:19:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:19:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:19:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 14:19:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:19:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45242182586361623, 'eval_loss': 1.0604123, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1343, 1562, 1485, 1381, 1219, 879, 611, 729, 1202, 492, 1741], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 3, 11], 'pruned_params': 50938260, 'remaining_params': 34079340, 'pruned_model_sparsity': 0.5991495878500451, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 18700}


Iteration:  78%|███████▊  | 208/268 [00:39<00:44,  1.35it/s][A04/21/2024 14:19:39 - INFO - trainer.trainer_mod - v4 Global step: 18700, Alignment: tensor([2, 3, 7, 8], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:39<00:33,  1.78it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:25,  2.29it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:19,  2.88it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:15,  3.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:13,  4.12it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:11,  4.78it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:09,  5.32it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:09,  5.71it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:08,  6.09it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.27it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.68it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.86it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.98it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.09it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.18it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.14it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.28it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  7.18it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.21it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.02it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.08it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.12it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.04it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.95it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  7.06it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.24it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.28it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.17it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.19it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.04it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.07it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.17it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.18it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.17it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.21it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.12it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.08it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.11it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.15it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.09it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.07it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.18it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.27it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.34it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 14:19:46,268 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:19:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:19:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:19:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:19:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:19:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:19:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4531370540010336, 'eval_loss': 1.0683413, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1343, 1562, 1486, 1381, 1219, 879, 612, 729, 1202, 491, 1740], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51134356, 'remaining_params': 33883244, 'pruned_model_sparsity': 0.601456122026498, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 18750}


Iteration:  96%|█████████▋| 258/268 [00:48<00:07,  1.34it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:05,  1.77it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:03,  2.27it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:02,  2.86it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  3.49it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:01,  4.14it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  4.75it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  5.31it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  5.72it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.12it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  6.84it/s][A04/21/2024 14:19:49 - INFO - trainer.trainer_mod - Epoch 69 finished. Took 49.45 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  70%|███████   | 70/100 [55:52<24:11, 48.37s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.08it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.14it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.21it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.10it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.15it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.12it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.17it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.18it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.39it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.35it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.33it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.21it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.19it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.08it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.17it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.23it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.44it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.06it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.14it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.96it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.21it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.19it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.12it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.06it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.11it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.13it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.29it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.17it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.19it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.27it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 14:19:55,229 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:19:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:19:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:19:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:19:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:19:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:19:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.449682615733785, 'eval_loss': 1.0981348, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1343, 1562, 1486, 1381, 1220, 879, 613, 730, 1202, 490, 1736], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51137420, 'remaining_params': 33880180, 'pruned_model_sparsity': 0.6014921616230051, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 18800}


Iteration:  15%|█▍        | 40/268 [00:07<02:48,  1.35it/s][A04/21/2024 14:19:57 - INFO - trainer.trainer_mod - v4 Global step: 18800, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:06,  1.79it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:38,  2.30it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<01:17,  2.91it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:02,  3.56it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:53,  4.17it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:46,  4.73it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:41,  5.29it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:38,  5.75it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:36,  6.04it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.79it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.93it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.03it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.11it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.06it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.94it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.06it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.04it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.11it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.18it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.11it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:30,  6.63it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.93it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.01it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  7.07it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.12it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.13it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.25it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.22it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.24it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  6.98it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.09it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.16it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.19it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.33it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 14:20:04,204 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:20:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:20:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:20:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:20:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:20:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:20:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45331260928311407, 'eval_loss': 1.0762955, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1342, 1562, 1486, 1381, 1219, 879, 613, 731, 1204, 491, 1741], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51126696, 'remaining_params': 33890904, 'pruned_model_sparsity': 0.6013660230352303, 'expected_sparsity': 0.6005, 'target_sparsity': 0.6, 'step': 18850}


Iteration:  34%|███▎      | 90/268 [00:16<02:11,  1.35it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:39,  1.79it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:16,  2.29it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<01:01,  2.84it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:50,  3.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:42,  4.11it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:36,  4.73it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:31,  5.36it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:29,  5.83it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:27,  6.18it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:25,  6.46it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.68it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.93it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.06it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.00it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  6.94it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.16it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.06it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.04it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.10it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.04it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.11it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.02it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.10it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.14it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.30it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.36it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.36it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.35it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.31it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.21it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.13it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.02it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  6.90it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:20,  7.02it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:20,  7.00it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:20,  6.91it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.03it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.36it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.39it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.61it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.29it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 14:20:13,149 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:20:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:20:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:20:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:20:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 14:20:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:20:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4597376022777596, 'eval_loss': 1.0097078, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1342, 1561, 1485, 1380, 1218, 879, 612, 734, 1207, 493, 1758], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51096056, 'remaining_params': 33921544, 'pruned_model_sparsity': 0.6010056270701596, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 18900}


Iteration:  52%|█████▏    | 140/268 [00:25<01:34,  1.35it/s][A04/21/2024 14:20:15 - INFO - trainer.trainer_mod - v4 Global step: 18900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:25<01:10,  1.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:54,  2.31it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:42,  2.93it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:34,  3.57it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:29,  4.18it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:25,  4.74it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:22,  5.34it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:20,  5.80it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:19,  6.15it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:18,  6.44it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.74it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.09it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.17it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.18it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.22it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.17it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  6.98it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  6.94it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.04it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.14it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.22it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.26it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.38it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.26it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.10it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.16it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.25it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.20it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.23it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.27it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.31it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.28it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.36it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 14:20:22,091 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:20:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:20:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:20:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:20:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:20:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:20:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4544455053417749, 'eval_loss': 1.0218273, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1341, 1560, 1484, 1379, 1218, 879, 612, 736, 1211, 495, 1764], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51082268, 'remaining_params': 33935332, 'pruned_model_sparsity': 0.6008434488858777, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 18950}


Iteration:  71%|███████   | 190/268 [00:34<00:57,  1.35it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:42,  1.80it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:32,  2.34it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:25,  2.93it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:20,  3.54it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:17,  4.18it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:15,  4.79it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:13,  5.33it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:12,  5.81it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:11,  6.18it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:10,  6.39it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:10,  6.62it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  6.72it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.67it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.78it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.83it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  6.97it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.16it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.19it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.10it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.07it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.10it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.14it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  6.98it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.06it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.25it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.23it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.25it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.24it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.27it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.26it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.16it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.25it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.03it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.20it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.23it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.28it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.20it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.28it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.24it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 14:20:31,046 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:20:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:20:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:20:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:20:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:20:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:20:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4440867985315811, 'eval_loss': 1.0490849, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1340, 1560, 1483, 1379, 1218, 879, 613, 738, 1213, 495, 1763], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51079204, 'remaining_params': 33938396, 'pruned_model_sparsity': 0.6008074092893707, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 19000}


Iteration:  90%|████████▉ | 240/268 [00:43<00:20,  1.35it/s][A04/21/2024 14:20:33 - INFO - trainer.trainer_mod - v4 Global step: 19000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:43<00:15,  1.77it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:11,  2.31it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:08,  2.88it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:06,  3.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:05,  4.15it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:04,  4.78it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:04,  5.25it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  5.71it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:03,  6.09it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.40it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.61it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  6.70it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.84it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.96it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.03it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.05it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.02it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.29it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.26it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.10it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.97it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  6.98it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.85it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  6.89it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.99it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.58it/s][A04/21/2024 14:20:36 - INFO - trainer.trainer_mod - Epoch 70 finished. Took 47.31 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  71%|███████   | 71/100 [56:39<23:13, 48.05s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.01it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.05it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.14it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.19it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.44it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.41it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.12it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.14it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.04it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.00it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.99it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.08it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.14it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.20it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.08it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  6.96it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.00it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.03it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:35,  7.03it/s][A[INFO|trainer.py:570] 2024-04-21 14:20:40,100 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:20:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:20:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:20:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:20:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:20:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:20:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45242182586361623, 'eval_loss': 1.0851479, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1341, 1559, 1483, 1379, 1217, 878, 612, 738, 1213, 494, 1763], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51085332, 'remaining_params': 33932268, 'pruned_model_sparsity': 0.6008794884823848, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 19050}


Iteration:   8%|▊         | 22/268 [00:05<03:05,  1.33it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:20,  1.75it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:47,  2.26it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:24,  2.87it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:09,  3.46it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:58,  4.14it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:51,  4.67it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:45,  5.23it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:41,  5.71it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.10it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.68it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.96it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.87it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  6.97it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.04it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.94it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.01it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.08it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.13it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.14it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.20it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.19it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.23it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.37it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.46it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:29,  7.40it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.24it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.25it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.01it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.06it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.88it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.97it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.97it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.87it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.90it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.95it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.06it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.26it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.03it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.12it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.22it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.18it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.26it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 14:20:49,109 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:20:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:20:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:20:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:20:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:20:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:20:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45927670499276396, 'eval_loss': 0.9853551, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1340, 1559, 1484, 1377, 1216, 878, 611, 739, 1213, 493, 1756], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50513896, 'remaining_params': 34503704, 'pruned_model_sparsity': 0.5941581037338152, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 19100}


Iteration:  27%|██▋       | 72/268 [00:14<02:25,  1.35it/s][A04/21/2024 14:20:51 - INFO - trainer.trainer_mod - v4 Global step: 19100, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:14<01:49,  1.78it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<01:24,  2.29it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:06,  2.89it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:54,  3.50it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:45,  4.20it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:39,  4.79it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:35,  5.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:31,  5.88it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:29,  6.25it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:28,  6.54it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:27,  6.74it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  6.89it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  7.00it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.05it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.15it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.17it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.20it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.20it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.20it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.17it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.24it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.23it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.27it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.28it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.19it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.19it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.07it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.15it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.11it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.43it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.37it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.45it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.29it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.34it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.50it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:19,  7.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.03it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.18it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.17it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:20:58,014 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:20:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:20:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:20:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:20:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:21:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:21:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4467807407096838, 'eval_loss': 1.0778247, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1340, 1559, 1484, 1378, 1216, 878, 611, 740, 1211, 492, 1747], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50922940, 'remaining_params': 34094660, 'pruned_model_sparsity': 0.5989693898675098, 'expected_sparsity': 0.60021, 'target_sparsity': 0.6, 'step': 19150}


Iteration:  46%|████▌     | 122/268 [00:23<01:48,  1.34it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<01:21,  1.77it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<01:02,  2.29it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:49,  2.88it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:40,  3.54it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:33,  4.18it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:29,  4.73it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:26,  5.22it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:23,  5.78it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:22,  6.02it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.26it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.47it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.77it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.82it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.04it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.03it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  6.86it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.97it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  7.05it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.10it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.25it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.25it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.24it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.18it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.09it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.10it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.15it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.20it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.24it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.16it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.28it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.25it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.27it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.41it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.51it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.51it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:13,  7.49it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.37it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.41it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.34it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 14:21:06,954 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:21:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:21:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:21:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:21:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 14:21:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:21:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43591443951045983, 'eval_loss': 1.1085938, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1339, 1558, 1483, 1377, 1216, 877, 610, 741, 1210, 491, 1744], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50938260, 'remaining_params': 34079340, 'pruned_model_sparsity': 0.5991495878500451, 'expected_sparsity': 0.60053, 'target_sparsity': 0.6, 'step': 19200}


Iteration:  64%|██████▍   | 172/268 [00:31<01:10,  1.36it/s][A04/21/2024 14:21:09 - INFO - trainer.trainer_mod - v4 Global step: 19200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:32<00:53,  1.79it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:40,  2.31it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:31,  2.93it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:26,  3.53it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:21,  4.19it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:18,  4.80it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:16,  5.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:15,  5.80it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:14,  6.11it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.63it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.79it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  6.93it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.15it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.09it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.13it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.18it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.20it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.34it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.19it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.33it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.33it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.33it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.39it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.10it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.18it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.27it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.31it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.13it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.08it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.00it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.07it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.11it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.99it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.01it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  6.96it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.09it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.23it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.42it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 14:21:15,873 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:21:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:21:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:21:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:21:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:21:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:21:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47053580111209176, 'eval_loss': 0.9155594, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1339, 1558, 1481, 1376, 1214, 876, 609, 742, 1212, 492, 1756], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 4, 2, 11], 'pruned_params': 50926004, 'remaining_params': 34091596, 'pruned_model_sparsity': 0.5990054294640169, 'expected_sparsity': 0.60038, 'target_sparsity': 0.6, 'step': 19250}


Iteration:  83%|████████▎ | 222/268 [00:40<00:34,  1.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:25,  1.78it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:19,  2.29it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:15,  2.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:12,  3.45it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:10,  4.05it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:08,  4.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:07,  5.22it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:06,  5.71it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:06,  6.08it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.32it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.73it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.00it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.10it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.17it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.18it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.20it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.11it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.15it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.17it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.17it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.29it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.31it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.02it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.91it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.01it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  6.97it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.05it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.07it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.32it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.40it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.36it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.37it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.43it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.12it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.07it/s][A04/21/2024 14:21:24 - INFO - trainer.trainer_mod - Epoch 71 finished. Took 47.31 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  72%|███████▏  | 72/100 [57:26<22:19, 47.83s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:32,  8.14it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.70it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 14:21:24,826 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:21:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:21:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:21:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:21:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:21:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:21:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4778772791689758, 'eval_loss': 1.0369109, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1338, 1558, 1481, 1376, 1214, 875, 609, 746, 1218, 494, 1772], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50690076, 'remaining_params': 34327524, 'pruned_model_sparsity': 0.596230380532972, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 19300}


Iteration:   1%|▏         | 4/268 [00:02<04:06,  1.07it/s][A04/21/2024 14:21:26 - INFO - trainer.trainer_mod - v4 Global step: 19300, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:50,  1.54it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:04,  2.11it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:35,  2.74it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:16,  3.40it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:04,  4.05it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:55,  4.61it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:50,  5.07it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:45,  5.59it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:42,  6.00it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:40,  6.31it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:38,  6.57it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:37,  6.67it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:37,  6.71it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:36,  6.86it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:36,  6.85it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  6.89it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  6.97it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.07it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.12it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.15it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.10it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.07it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.17it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.16it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.21it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.21it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.34it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.32it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.31it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.27it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.17it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.19it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.22it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.10it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.96it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  7.04it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.11it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.20it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.17it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.03it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.15it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.33it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.48it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 14:21:33,831 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:21:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:21:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:21:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:21:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:21:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:21:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46481173360635625, 'eval_loss': 1.0386615, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1337, 1557, 1480, 1375, 1214, 874, 609, 748, 1224, 497, 1792], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51042436, 'remaining_params': 33975164, 'pruned_model_sparsity': 0.6003749341312857, 'expected_sparsity': 0.59943, 'target_sparsity': 0.6, 'step': 19350}


Iteration:  20%|██        | 54/268 [00:11<02:39,  1.34it/s][A
Iteration:  21%|██        | 55/268 [00:11<02:00,  1.77it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:32,  2.29it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<01:13,  2.88it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:59,  3.51it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:49,  4.20it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:43,  4.81it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:39,  5.30it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:34,  5.90it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.25it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.43it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:30,  6.65it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:29,  6.84it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:29,  6.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  7.00it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.10it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.98it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:27,  7.05it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.12it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  7.09it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:27,  7.03it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  6.87it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.11it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.06it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.02it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.08it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.04it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.09it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.14it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  6.99it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:25,  7.00it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.07it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.01it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.10it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.12it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.16it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.09it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.12it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.21it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.29it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.32it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.40it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.42it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.50it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 14:21:42,812 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:21:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:21:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:21:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:21:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:21:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:21:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4556358612682346, 'eval_loss': 1.0542605, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1406, 1337, 1557, 1480, 1374, 1213, 873, 609, 748, 1224, 497, 1783], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51060820, 'remaining_params': 33956780, 'pruned_model_sparsity': 0.6005911717103282, 'expected_sparsity': 0.5996, 'target_sparsity': 0.6, 'step': 19400}


Iteration:  39%|███▉      | 104/268 [00:20<02:01,  1.35it/s][A04/21/2024 14:21:44 - INFO - trainer.trainer_mod - v4 Global step: 19400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:20<01:31,  1.78it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<01:10,  2.29it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:55,  2.89it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:44,  3.57it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:37,  4.22it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:33,  4.72it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:29,  5.27it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:27,  5.74it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:25,  6.14it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.29it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.50it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:22,  6.82it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:21,  7.04it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:20,  7.15it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  7.00it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  7.00it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.99it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:20,  6.99it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  7.21it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.25it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.19it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.19it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.24it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:18,  7.28it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.92it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  6.92it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  7.03it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  7.02it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.01it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.11it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.06it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.58it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.74it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.87it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.94it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.97it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.24it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.29it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.39it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.42it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.64it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.61it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.31it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.25it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.44it/s][A[INFO|trainer.py:570] 2024-04-21 14:21:51,801 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:21:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:21:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:21:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:21:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:21:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:21:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4614890222842552, 'eval_loss': 1.1086614, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1407, 1337, 1556, 1479, 1374, 1213, 874, 609, 748, 1220, 494, 1757], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51111376, 'remaining_params': 33906224, 'pruned_model_sparsity': 0.601185825052695, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 19450}


Iteration:  57%|█████▋    | 154/268 [00:29<01:24,  1.35it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<01:02,  1.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:48,  2.32it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:38,  2.91it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:31,  3.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:26,  4.18it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:22,  4.80it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:19,  5.35it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:18,  5.81it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:17,  6.18it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:16,  6.46it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.80it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.92it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  7.00it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:13,  7.08it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.12it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.16it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:13,  7.17it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.08it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  7.06it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.94it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.94it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:11,  7.34it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.13it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.20it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.12it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.15it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.37it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:10,  7.36it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.32it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.26it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.29it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.24it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.18it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.34it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.35it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.37it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.43it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.05it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.17it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.28it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 14:22:00,722 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:22:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:22:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:22:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:22:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:22:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:22:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46737059485660304, 'eval_loss': 1.0635824, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1336, 1556, 1479, 1375, 1213, 874, 609, 747, 1217, 493, 1733], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50762080, 'remaining_params': 34255520, 'pruned_model_sparsity': 0.5970773110508882, 'expected_sparsity': 0.60044, 'target_sparsity': 0.6, 'step': 19500}


Iteration:  76%|███████▌  | 204/268 [00:38<00:47,  1.34it/s][A04/21/2024 14:22:02 - INFO - trainer.trainer_mod - v4 Global step: 19500, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:38<00:35,  1.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:26,  2.30it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:21,  2.90it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:17,  3.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:14,  4.13it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:12,  4.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:10,  5.39it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:09,  5.85it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.23it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.51it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.71it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.95it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  7.03it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:06,  7.23it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.20it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.21it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.19it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.23it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.27it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.16it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.17it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.07it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.11it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.16it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.16it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.31it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.31it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.11it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.18it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.09it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.05it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.96it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.06it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.23it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.17it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.26it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.34it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:02,  7.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.40it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.43it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.47it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.29it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:22:09,636 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:22:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:22:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:22:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:22:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:22:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:22:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4556358612682346, 'eval_loss': 0.96812725, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1336, 1556, 1479, 1376, 1213, 874, 608, 748, 1217, 493, 1729], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50766676, 'remaining_params': 34250924, 'pruned_model_sparsity': 0.5971313704456489, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 19550}


Iteration:  95%|█████████▍| 254/268 [00:47<00:10,  1.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:07,  1.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:05,  2.32it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:03,  2.90it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:02,  3.51it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:02,  4.09it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  4.70it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  5.14it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  5.63it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  5.97it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.78it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.35it/s][A04/21/2024 14:22:13 - INFO - trainer.trainer_mod - Epoch 72 finished. Took 49.33 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.43it/s]
Epoch:  73%|███████▎  | 73/100 [58:15<21:43, 48.28s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  7.00it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  6.98it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.02it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.10it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.04it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.09it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.16it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.08it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.05it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.10it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.04it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.08it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.66it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.74it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.82it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.84it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.93it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.01it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:34,  7.08it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.04it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.02it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.11it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.10it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.21it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.40it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.32it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:32,  7.40it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 14:22:18,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:22:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:22:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:22:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:22:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 14:22:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:22:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4297412045484628, 'eval_loss': 1.077529, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1335, 1555, 1477, 1375, 1212, 872, 608, 749, 1221, 494, 1752], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51126696, 'remaining_params': 33890904, 'pruned_model_sparsity': 0.6013660230352303, 'expected_sparsity': 0.6002, 'target_sparsity': 0.6, 'step': 19600}


Iteration:  13%|█▎        | 36/268 [00:07<02:52,  1.35it/s][A04/21/2024 14:22:20 - INFO - trainer.trainer_mod - v4 Global step: 19600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:09,  1.78it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:39,  2.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:19,  2.87it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:05,  3.51it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:54,  4.14it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:47,  4.73it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:42,  5.27it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:38,  5.82it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:36,  6.11it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:35,  6.31it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.94it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  7.01it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.08it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.01it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.05it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.09it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.06it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.92it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.17it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.14it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.97it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.08it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  7.05it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.07it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.13it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.18it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.18it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.30it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.26it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.23it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.23it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.28it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.50it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:24,  7.59it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:24,  7.55it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:24,  7.64it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.50it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.31it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.17it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:22:27,623 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:22:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:22:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:22:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:22:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:22:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:22:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47457826936261016, 'eval_loss': 0.9412003, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1334, 1555, 1477, 1376, 1213, 873, 609, 752, 1227, 497, 1782], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51057756, 'remaining_params': 33959844, 'pruned_model_sparsity': 0.6005551321138212, 'expected_sparsity': 0.5991, 'target_sparsity': 0.6, 'step': 19650}


Iteration:  32%|███▏      | 86/268 [00:16<02:15,  1.35it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:41,  1.78it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:18,  2.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<01:02,  2.87it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:50,  3.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:42,  4.14it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:37,  4.71it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:33,  5.26it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:29,  5.86it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:27,  6.23it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  6.80it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.85it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.80it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.92it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.05it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.12it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.27it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.29it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.08it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.25it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.24it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.15it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.26it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.23it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.36it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.15it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.17it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.16it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.12it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.12it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.29it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.40it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.23it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  7.14it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.24it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.29it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 14:22:36,557 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:22:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:22:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:22:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:22:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:22:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:22:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46026235307744706, 'eval_loss': 0.960989, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1333, 1555, 1477, 1376, 1214, 873, 609, 753, 1226, 495, 1779], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50673224, 'remaining_params': 34344376, 'pruned_model_sparsity': 0.5960321627521831, 'expected_sparsity': 0.59903, 'target_sparsity': 0.6, 'step': 19700}


Iteration:  51%|█████     | 136/268 [00:24<01:37,  1.35it/s][A04/21/2024 14:22:38 - INFO - trainer.trainer_mod - v4 Global step: 19700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:25<01:13,  1.78it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:56,  2.30it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:45,  2.86it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:36,  3.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:30,  4.12it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:26,  4.72it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:23,  5.27it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:22,  5.59it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:20,  6.03it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:19,  6.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:18,  6.63it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.69it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.88it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.01it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.12it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.14it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.17it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.22it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.08it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.13it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.16it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.20it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.24it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.18it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.09it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.45it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.31it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.30it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.27it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.07it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.16it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.06it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.18it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.27it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.60it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.42it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 14:22:45,480 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:22:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:22:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:22:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:22:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:22:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:22:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44229349485124575, 'eval_loss': 1.0067497, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1333, 1555, 1477, 1376, 1214, 874, 609, 751, 1218, 490, 1732], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50766676, 'remaining_params': 34250924, 'pruned_model_sparsity': 0.5971313704456489, 'expected_sparsity': 0.60052, 'target_sparsity': 0.6, 'step': 19750}


Iteration:  69%|██████▉   | 186/268 [00:33<01:00,  1.35it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:45,  1.78it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:34,  2.30it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:27,  2.85it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:22,  3.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:18,  4.10it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:16,  4.72it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:14,  5.28it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:12,  5.74it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:11,  6.14it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:11,  6.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.64it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.80it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.90it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.18it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.27it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.26it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.06it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.13it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  6.79it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.00it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.07it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.03it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.98it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.04it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.08it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.07it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.15it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.15it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.16it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.10it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.15it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.20it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.30it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.36it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.18it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.27it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.22it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 14:22:54,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:22:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:22:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:22:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:22:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:22:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:22:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4453249733137911, 'eval_loss': 1.0500008, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1332, 1555, 1477, 1377, 1215, 875, 608, 749, 1214, 488, 1700], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50824892, 'remaining_params': 34192708, 'pruned_model_sparsity': 0.5978161227792833, 'expected_sparsity': 0.60158, 'target_sparsity': 0.6, 'step': 19800}


Iteration:  88%|████████▊ | 236/268 [00:42<00:23,  1.34it/s][A04/21/2024 14:22:56 - INFO - trainer.trainer_mod - v4 Global step: 19800, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:43<00:17,  1.76it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:13,  2.28it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:10,  2.89it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:07,  3.53it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:06,  4.18it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:05,  4.80it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  5.34it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:04,  5.88it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.10it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.23it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.49it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  6.66it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.95it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.84it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  6.64it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.72it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.89it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.00it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.99it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.17it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.08it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.09it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.03it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.11it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.28it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.13it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.01it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.02it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.10it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.16it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.69it/s][A04/21/2024 14:23:00 - INFO - trainer.trainer_mod - Epoch 73 finished. Took 47.34 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  74%|███████▍  | 74/100 [59:03<20:47, 48.00s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.83it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.34it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.21it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.28it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.33it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.36it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.59it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.45it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.37it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.38it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.41it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 14:23:03,392 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:23:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:23:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:23:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:23:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:23:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:23:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46425965709454886, 'eval_loss': 0.9890743, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1331, 1553, 1475, 1375, 1213, 874, 608, 752, 1221, 492, 1722], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51178784, 'remaining_params': 33838816, 'pruned_model_sparsity': 0.6019786961758506, 'expected_sparsity': 0.6011, 'target_sparsity': 0.6, 'step': 19850}


Iteration:   7%|▋         | 18/268 [00:04<03:05,  1.35it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:19,  1.78it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:48,  2.29it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:26,  2.87it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:10,  3.48it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:59,  4.11it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:51,  4.74it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:45,  5.29it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:41,  5.77it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:39,  6.15it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:37,  6.48it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:35,  6.69it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.85it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  6.99it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.09it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.95it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.88it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:33,  6.99it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.07it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.31it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.28it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.29it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.32it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.43it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.53it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.47it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.40it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.35it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.33it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.49it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.68it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.63it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.87it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.06it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.96it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.10it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.28it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.23it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 14:23:12,320 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:23:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:23:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:23:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:23:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:23:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:23:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44134495180802813, 'eval_loss': 1.0462937, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1330, 1551, 1474, 1376, 1214, 874, 609, 758, 1235, 500, 1791], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51031712, 'remaining_params': 33985888, 'pruned_model_sparsity': 0.600248795543511, 'expected_sparsity': 0.59883, 'target_sparsity': 0.6, 'step': 19900}


Iteration:  25%|██▌       | 68/268 [00:13<02:28,  1.34it/s][A04/21/2024 14:23:14 - INFO - trainer.trainer_mod - v4 Global step: 19900, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:51,  1.78it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:25,  2.31it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:07,  2.92it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:56,  3.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:47,  4.14it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:40,  4.77it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:36,  5.32it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:33,  5.72it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:31,  6.11it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.83it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.92it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.03it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  6.97it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  7.05it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.93it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.01it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.07it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.13it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.13it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  7.06it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.30it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.36it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.22it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.28it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.29it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.15it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.19it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.14it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.18it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.24it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.31it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.20it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.18it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.37it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.50it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.48it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.41it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:23:21,247 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:23:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:23:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:23:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:23:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 14:23:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:23:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44722803398940786, 'eval_loss': 1.1025791, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1330, 1551, 1474, 1376, 1215, 875, 610, 761, 1243, 504, 1823], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50953580, 'remaining_params': 34064020, 'pruned_model_sparsity': 0.5993297858325806, 'expected_sparsity': 0.59788, 'target_sparsity': 0.6, 'step': 19950}


Iteration:  44%|████▍     | 118/268 [00:22<01:51,  1.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<01:23,  1.78it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<01:04,  2.30it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:51,  2.87it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:41,  3.54it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:34,  4.18it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:29,  4.80it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:26,  5.36it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:24,  5.84it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:23,  6.12it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:22,  6.25it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.75it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.08it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.03it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.99it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.08it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.26it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.16it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.16it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.19it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.24it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.26it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.19it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.12it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.17it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.33it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.02it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.10it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.15it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.19it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.15it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.23it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.13it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.03it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.02it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.77it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  6.90it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.98it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.15it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.14it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.21it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:23:30,235 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:23:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:23:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:23:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:23:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:23:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:23:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42682064874774595, 'eval_loss': 1.1530567, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1330, 1552, 1475, 1376, 1216, 876, 610, 759, 1235, 496, 1783], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51036308, 'remaining_params': 33981292, 'pruned_model_sparsity': 0.6003028549382716, 'expected_sparsity': 0.59919, 'target_sparsity': 0.6, 'step': 20000}


Iteration:  63%|██████▎   | 168/268 [00:31<01:14,  1.34it/s][A04/21/2024 14:23:32 - INFO - trainer.trainer_mod - v4 Global step: 20000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:31<00:56,  1.77it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:42,  2.29it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:33,  2.89it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:27,  3.55it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:22,  4.20it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:19,  4.80it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:17,  5.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:16,  5.73it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:14,  6.10it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:14,  6.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.65it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.98it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.25it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.39it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.61it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.41it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.40it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.36it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.12it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.14it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.09it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.13it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.09it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.36it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.35it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.20it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.05it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.19it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.31it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.25it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.05it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.16it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.24it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.21it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.32it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 14:23:39,124 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:23:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:23:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:23:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:23:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:23:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:23:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4326292784366391, 'eval_loss': 1.0546671, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1329, 1552, 1475, 1376, 1215, 875, 608, 754, 1221, 489, 1710], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51195636, 'remaining_params': 33821964, 'pruned_model_sparsity': 0.6021769139566395, 'expected_sparsity': 0.60149, 'target_sparsity': 0.6, 'step': 20050}


Iteration:  81%|████████▏ | 218/268 [00:40<00:37,  1.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:27,  1.78it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:21,  2.28it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:16,  2.90it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:12,  3.54it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:10,  4.17it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:09,  4.74it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:08,  5.22it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:07,  5.65it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.03it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:06,  6.34it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.74it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.74it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.03it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.10it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.17it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.19it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.18it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.19it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.13it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.17it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.02it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.95it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.93it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.00it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.06it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.90it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.15it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.23it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.24it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.23it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.42it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.42it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.36it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.53it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.52it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.52it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.53it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.56it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.75it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 14:23:48,053 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:23:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:23:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:23:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:23:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:23:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:23:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4354344418941058, 'eval_loss': 1.0607426, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1328, 1551, 1473, 1374, 1213, 874, 605, 752, 1217, 487, 1684], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51266108, 'remaining_params': 33751492, 'pruned_model_sparsity': 0.6030058246763024, 'expected_sparsity': 0.60258, 'target_sparsity': 0.6, 'step': 20100}


Iteration: 100%|██████████| 268/268 [00:49<00:00,  1.36it/s][A04/21/2024 14:23:50 - INFO - trainer.trainer_mod - Epoch 74 finished. Took 49.13 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.46it/s]
Epoch:  75%|███████▌  | 75/100 [59:52<20:08, 48.34s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/21/2024 14:23:50 - INFO - trainer.trainer_mod - v4 Global step: 20100, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:37,  7.20it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.85it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.03it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.92it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.06it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.14it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.13it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.62it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.77it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.92it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.20it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.35it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.34it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.45it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.39it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.26it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.27it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.41it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:32,  7.52it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.46it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.40it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.31it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.33it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.26it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.25it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  7.01it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.05it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.09it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  7.07it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.20it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.18it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.13it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.05it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.13it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.13it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.22it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.32it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.38it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.24it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:30,  7.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 48/268 [00:06<00:30,  7.11it/s][A
Iteration:  18%|█▊        | 49/268 [00:06<00:30,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:23:57,034 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:23:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:23:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:23:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:23:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:23:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:23:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4552830694257244, 'eval_loss': 1.0814388, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1327, 1549, 1472, 1373, 1212, 873, 605, 756, 1226, 493, 1732], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51175720, 'remaining_params': 33841880, 'pruned_model_sparsity': 0.6019426565793435, 'expected_sparsity': 0.60117, 'target_sparsity': 0.6, 'step': 20150}


Iteration:  19%|█▊        | 50/268 [00:08<02:42,  1.34it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:02,  1.77it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:34,  2.29it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:14,  2.91it/s][A
Iteration:  20%|██        | 54/268 [00:09<01:00,  3.54it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:51,  4.17it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:44,  4.79it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:39,  5.34it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:36,  5.80it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:34,  6.07it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:33,  6.25it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.79it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.92it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  7.02it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.08it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.10it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.12it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.91it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.00it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.09it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:28,  7.02it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.01it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.26it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.09it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.16it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.17it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.12it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.19it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.19it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.06it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  6.99it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.07it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.12it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.28it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.32it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.22it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.29it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.22it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.39it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:23,  7.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:23,  7.31it/s][A
Iteration:  37%|███▋      | 98/268 [00:15<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:15<00:22,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 14:24:05,989 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:24:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:24:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:24:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:24:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:24:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:24:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4726938037416079, 'eval_loss': 1.0121193, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1328, 1550, 1472, 1374, 1212, 874, 607, 763, 1242, 503, 1808], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50999540, 'remaining_params': 34018060, 'pruned_model_sparsity': 0.5998703797801866, 'expected_sparsity': 0.59876, 'target_sparsity': 0.6, 'step': 20200}


Iteration:  37%|███▋      | 100/268 [00:17<02:04,  1.34it/s][A04/21/2024 14:24:08 - INFO - trainer.trainer_mod - v4 Global step: 20200, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:18<01:33,  1.79it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<01:11,  2.31it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:57,  2.89it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:46,  3.53it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:39,  4.15it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:34,  4.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:30,  5.26it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:27,  5.73it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:26,  6.12it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:24,  6.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:23,  6.59it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.82it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  6.90it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.04it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.02it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.98it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.07it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  6.95it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  7.08it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.13it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:21,  6.97it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.08it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.94it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  6.91it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  6.81it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:20,  6.93it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:20,  6.92it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.15it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.02it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.98it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.10it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  7.15it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.32it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.08it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.15it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.22it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:16,  7.44it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.24it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 146/268 [00:24<00:16,  7.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:24<00:16,  7.34it/s][A
Iteration:  55%|█████▌    | 148/268 [00:24<00:16,  7.40it/s][A
Iteration:  56%|█████▌    | 149/268 [00:24<00:16,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 14:24:14,964 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:24:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:24:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:24:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:24:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:24:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:24:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4412540944135295, 'eval_loss': 1.0811121, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1327, 1549, 1473, 1374, 1212, 874, 608, 768, 1251, 508, 1845], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 5, 3, 2, 12], 'pruned_params': 50521556, 'remaining_params': 34496044, 'pruned_model_sparsity': 0.5942482027250828, 'expected_sparsity': 0.59732, 'target_sparsity': 0.6, 'step': 20250}


Iteration:  56%|█████▌    | 150/268 [00:26<01:27,  1.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<01:05,  1.79it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:50,  2.31it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:39,  2.88it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:32,  3.54it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:27,  4.18it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:23,  4.78it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:20,  5.33it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:18,  5.81it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:18,  6.03it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:17,  6.28it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:16,  6.56it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.78it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.03it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.11it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.81it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.94it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.16it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.32it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.14it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.02it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.10it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.16it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.10it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.26it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.28it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.25it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.14it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.37it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.39it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.44it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.44it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.47it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.48it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.48it/s][A
Iteration:  74%|███████▍  | 199/268 [00:33<00:09,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 14:24:23,858 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:24:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:24:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:24:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:24:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:24:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:24:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4608700525278083, 'eval_loss': 1.1057386, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1326, 1548, 1471, 1374, 1211, 874, 607, 767, 1246, 502, 1820], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50979624, 'remaining_params': 34037976, 'pruned_model_sparsity': 0.5996361224028907, 'expected_sparsity': 0.59894, 'target_sparsity': 0.6, 'step': 20300}


Iteration:  75%|███████▍  | 200/268 [00:35<00:50,  1.34it/s][A04/21/2024 14:24:25 - INFO - trainer.trainer_mod - v4 Global step: 20300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:35<00:37,  1.78it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:28,  2.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:22,  2.88it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:18,  3.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:15,  4.15it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:13,  4.73it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:11,  5.34it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:10,  5.73it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:09,  6.12it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.63it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.95it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  6.91it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  6.82it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  6.93it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  6.84it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.06it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.11it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.06it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.31it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.29it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.33it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.45it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.41it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.46it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.34it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.21it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.23it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.07it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.18it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.36it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.37it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.43it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.38it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.55it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.51it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.50it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 14:24:32,742 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:24:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:24:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:24:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:24:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:24:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:24:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4555180203379525, 'eval_loss': 1.0588146, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1326, 1548, 1471, 1374, 1211, 875, 607, 764, 1236, 493, 1761], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51102184, 'remaining_params': 33915416, 'pruned_model_sparsity': 0.6010777062631737, 'expected_sparsity': 0.60066, 'target_sparsity': 0.6, 'step': 20350}


Iteration:  93%|█████████▎| 250/268 [00:44<00:13,  1.35it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:09,  1.79it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:06,  2.30it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:05,  2.89it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:03,  3.51it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:03,  4.16it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:02,  4.76it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:02,  5.19it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  5.68it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.20it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.39it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.62it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.68it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  6.84it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  6.77it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.90it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.51it/s][A04/21/2024 14:24:37 - INFO - trainer.trainer_mod - Epoch 75 finished. Took 47.2 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  76%|███████▌  | 76/100 [1:00:39<19:11, 48.00s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.10it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.14it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.96it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.27it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.16it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.93it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.02it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.03it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.04it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.91it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.02it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.01it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.08it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.09it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.34it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.37it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.38it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.48it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.48it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:32,  7.62it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.44it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.33it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.53it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.44it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.67it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.38it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.41it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 14:24:41,678 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:24:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:24:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:24:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:24:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:24:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:24:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4383405112894723, 'eval_loss': 1.054247, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1325, 1547, 1470, 1373, 1210, 874, 605, 762, 1228, 489, 1730], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51183380, 'remaining_params': 33834220, 'pruned_model_sparsity': 0.6020327555706113, 'expected_sparsity': 0.60186, 'target_sparsity': 0.6, 'step': 20400}


Iteration:  12%|█▏        | 32/268 [00:06<02:54,  1.35it/s][A04/21/2024 14:24:43 - INFO - trainer.trainer_mod - v4 Global step: 20400, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:11,  1.78it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:42,  2.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:21,  2.86it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:06,  3.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:55,  4.15it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:48,  4.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:43,  5.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:39,  5.74it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:37,  6.01it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:35,  6.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:34,  6.62it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.79it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.95it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.05it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.02it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  7.03it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.23it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.21it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.20it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.35it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.35it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.51it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.27it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.16it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.10it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  7.04it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  7.01it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.00it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.19it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.25it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.36it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.41it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.41it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.54it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.51it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:24,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 14:24:50,555 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:24:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:24:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:24:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:24:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:24:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:24:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43828878348379097, 'eval_loss': 1.0746427, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1408, 1325, 1546, 1471, 1372, 1210, 874, 605, 764, 1229, 490, 1736], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51169592, 'remaining_params': 33848008, 'pruned_model_sparsity': 0.6018705773863294, 'expected_sparsity': 0.60172, 'target_sparsity': 0.6, 'step': 20450}


Iteration:  31%|███       | 82/268 [00:15<02:17,  1.35it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:43,  1.79it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:20,  2.29it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:03,  2.89it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:51,  3.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:44,  4.11it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:38,  4.71it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:33,  5.27it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:30,  5.81it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:28,  6.18it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.56it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.89it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.92it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  6.95it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.85it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.88it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  6.99it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.05it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.96it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.87it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  6.88it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  7.01it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.09it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.26it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.25it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.27it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.10it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.19it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.28it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  7.07it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.21it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.20it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.26it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.32it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.41it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.25it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 14:24:59,549 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:24:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:24:59 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:24:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:24:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:25:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:25:01 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4555180203379525, 'eval_loss': 1.0768654, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1325, 1547, 1470, 1373, 1211, 874, 607, 769, 1240, 496, 1780], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51060820, 'remaining_params': 33956780, 'pruned_model_sparsity': 0.6005911717103282, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 20500}


Iteration:  49%|████▉     | 132/268 [00:24<01:41,  1.34it/s][A04/21/2024 14:25:01 - INFO - trainer.trainer_mod - v4 Global step: 20500, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:24<01:15,  1.78it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:58,  2.30it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:46,  2.87it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:37,  3.51it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:31,  4.21it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:27,  4.81it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:24,  5.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:21,  5.91it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.62it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.81it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.07it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.14it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.25it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.25it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  6.98it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.03it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.09it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:17,  6.62it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.92it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.03it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.08it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.14it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.18it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.32it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.33it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.32it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.15it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.32it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.17it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.14it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.24it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.21it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.42it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.22it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.10it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.31it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.29it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.26it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:25:08,465 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:25:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:25:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:25:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:25:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:25:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:25:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4685300819946657, 'eval_loss': 0.9843132, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1323, 1545, 1469, 1373, 1210, 874, 608, 773, 1251, 503, 1822], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 50970432, 'remaining_params': 34047168, 'pruned_model_sparsity': 0.5995280036133694, 'expected_sparsity': 0.59913, 'target_sparsity': 0.6, 'step': 20550}


Iteration:  68%|██████▊   | 182/268 [00:33<01:03,  1.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:47,  1.78it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:36,  2.31it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:28,  2.90it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:23,  3.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:19,  4.14it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:16,  4.80it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:14,  5.35it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:13,  5.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:12,  6.19it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  6.81it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.94it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.01it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.23it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.16it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.17it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.20it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.25it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.08it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  6.97it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.06it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.19it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.14it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.09it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.04it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.10it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.15it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.25it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.28it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.32it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.57it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.56it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.48it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.42it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.51it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 14:25:17,352 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:25:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:25:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:25:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:25:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:25:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:25:19 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44134495180802813, 'eval_loss': 1.0388143, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1409, 1322, 1543, 1469, 1373, 1209, 873, 608, 776, 1257, 506, 1842], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50929068, 'remaining_params': 34088532, 'pruned_model_sparsity': 0.5990414690605239, 'expected_sparsity': 0.59875, 'target_sparsity': 0.6, 'step': 20600}


Iteration:  87%|████████▋ | 232/268 [00:42<00:26,  1.34it/s][A04/21/2024 14:25:19 - INFO - trainer.trainer_mod - v4 Global step: 20600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:42<00:19,  1.77it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:14,  2.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:11,  2.87it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:09,  3.49it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:07,  4.10it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:06,  4.63it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:05,  5.20it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  5.69it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.00it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:04,  6.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.90it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.85it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.97it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.07it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.11it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.04it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.11it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.14it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.97it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.05it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.19it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.15it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.11it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.07it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.02it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.09it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.97it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.97it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.06it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.14it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.19it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.24it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.86it/s][A04/21/2024 14:25:24 - INFO - trainer.trainer_mod - Epoch 76 finished. Took 47.12 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  77%|███████▋  | 77/100 [1:01:26<18:17, 47.73s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.40it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.28it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.39it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.42it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.45it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.16it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.23it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 14:25:26,314 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:25:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:25:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:25:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:25:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:25:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:25:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44441091037773406, 'eval_loss': 1.0577215, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1322, 1542, 1468, 1374, 1209, 874, 608, 776, 1255, 503, 1834], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50947452, 'remaining_params': 34070148, 'pruned_model_sparsity': 0.5992577066395663, 'expected_sparsity': 0.599, 'target_sparsity': 0.6, 'step': 20650}


Iteration:   5%|▌         | 14/268 [00:03<03:10,  1.33it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:23,  1.76it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:50,  2.28it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:27,  2.85it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:12,  3.46it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:00,  4.09it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:52,  4.71it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:46,  5.27it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:43,  5.63it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:40,  5.98it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.45it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.68it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.83it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.86it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.97it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.09it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.06it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.09it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.11it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.32it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.34it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.35it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.21it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.05it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.99it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.30it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.08it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.12it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.60it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.57it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.43it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.36it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.40it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.26it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.34it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.38it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.25it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.28it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.44it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 14:25:35,243 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:25:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:25:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:25:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:25:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:25:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:25:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46425965709454886, 'eval_loss': 1.0131843, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1321, 1541, 1467, 1373, 1208, 874, 607, 775, 1247, 499, 1803], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51024052, 'remaining_params': 33993548, 'pruned_model_sparsity': 0.6001586965522433, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 20700}


Iteration:  24%|██▍       | 64/268 [00:12<02:31,  1.35it/s][A04/21/2024 14:25:37 - INFO - trainer.trainer_mod - v4 Global step: 20700, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:12<01:53,  1.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:27,  2.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:09,  2.89it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:56,  3.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:47,  4.17it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:41,  4.79it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:36,  5.33it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:33,  5.78it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:32,  5.99it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.76it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  6.91it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.95it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.01it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.74it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.90it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.92it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.02it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.15it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.02it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.01it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.05it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.11it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  7.04it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.10it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.15it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.20it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.36it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.27it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.39it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.29it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.30it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.37it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.38it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.40it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.45it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.48it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.34it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.52it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.39it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.36it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 14:25:44,172 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:25:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:25:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:25:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:25:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:25:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:25:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.48565013588256684, 'eval_loss': 1.0592024, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1321, 1542, 1467, 1373, 1208, 874, 607, 773, 1241, 495, 1776], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51080736, 'remaining_params': 33936864, 'pruned_model_sparsity': 0.6008254290876243, 'expected_sparsity': 0.60064, 'target_sparsity': 0.6, 'step': 20750}


Iteration:  43%|████▎     | 114/268 [00:21<01:54,  1.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<01:26,  1.78it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<01:06,  2.30it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:52,  2.87it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:42,  3.50it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:36,  4.13it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:31,  4.70it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:27,  5.32it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:25,  5.79it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:23,  6.19it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.30it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.53it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.64it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.67it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.85it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.88it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  6.84it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.93it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.87it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.98it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.79it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  6.92it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.13it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.16it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.15it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.64it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.82it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.90it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.02it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.15it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.23it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.31it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.27it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.33it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.43it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.48it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.47it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.51it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.46it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.33it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.28it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:25:53,202 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:25:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:25:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:25:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:25:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:25:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:25:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45247851615567836, 'eval_loss': 1.1001387, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1321, 1541, 1467, 1373, 1207, 874, 607, 773, 1238, 493, 1761], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51115972, 'remaining_params': 33901628, 'pruned_model_sparsity': 0.6012398844474556, 'expected_sparsity': 0.60103, 'target_sparsity': 0.6, 'step': 20800}


Iteration:  61%|██████    | 164/268 [00:30<01:17,  1.34it/s][A04/21/2024 14:25:55 - INFO - trainer.trainer_mod - v4 Global step: 20800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:30<00:57,  1.78it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:44,  2.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:34,  2.89it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:28,  3.51it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:23,  4.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:20,  4.75it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:18,  5.30it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:17,  5.62it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:15,  5.97it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:15,  6.23it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.69it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.97it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.21it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.20it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.19it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.99it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  7.06it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.09it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.06it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.13it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.17it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.16it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.10it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.15it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.05it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.12it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.37it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.49it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.33it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.37it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.42it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.43it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.32it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:07,  7.54it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:07,  7.39it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.30it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.19it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:26:02,137 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:26:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:26:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:26:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:26:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:26:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:26:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44113488112476795, 'eval_loss': 1.0970784, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1322, 1541, 1466, 1372, 1206, 873, 607, 774, 1242, 496, 1766], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51099120, 'remaining_params': 33918480, 'pruned_model_sparsity': 0.6010416666666667, 'expected_sparsity': 0.60092, 'target_sparsity': 0.6, 'step': 20850}


Iteration:  80%|███████▉  | 214/268 [00:39<00:40,  1.34it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:29,  1.77it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:22,  2.29it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:17,  2.88it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:14,  3.54it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:12,  4.06it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:10,  4.64it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:09,  5.15it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:08,  5.63it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:07,  5.98it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.33it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.60it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.63it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.80it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.92it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.83it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.04it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.11it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.11it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.23it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.08it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.25it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.25it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.27it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.05it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.99it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.31it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.42it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.46it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.30it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.22it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.43it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.27it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.41it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 14:26:11,091 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:26:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:26:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:26:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:26:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:26:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:26:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4354890215398521, 'eval_loss': 1.0876735, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1321, 1540, 1466, 1371, 1205, 873, 608, 777, 1249, 501, 1791], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50846340, 'remaining_params': 34171260, 'pruned_model_sparsity': 0.5980683999548329, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 20900}


Iteration:  99%|█████████▊| 264/268 [00:48<00:02,  1.35it/s][A04/21/2024 14:26:13 - INFO - trainer.trainer_mod - v4 Global step: 20900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:48<00:01,  1.78it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  2.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  2.87it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  3.63it/s][A04/21/2024 14:26:13 - INFO - trainer.trainer_mod - Epoch 77 finished. Took 49.25 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.44it/s]
Epoch:  78%|███████▊  | 78/100 [1:02:16<17:40, 48.19s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.20it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.09it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.13it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.33it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.33it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.17it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.19it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.18it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.26it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.15it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.10it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.09it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.19it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.25it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.21it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.22it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.52it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.31it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.31it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.23it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:34,  6.94it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.99it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.02it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:30,  7.49it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.64it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.59it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.39it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.18it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:26:19,981 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:26:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:26:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:26:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:26:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:26:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:26:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4340396426791047, 'eval_loss': 1.0513015, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1319, 1539, 1464, 1370, 1204, 872, 608, 781, 1256, 507, 1827], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51365688, 'remaining_params': 33651912, 'pruned_model_sparsity': 0.6041771115627823, 'expected_sparsity': 0.59945, 'target_sparsity': 0.6, 'step': 20950}


Iteration:  17%|█▋        | 46/268 [00:08<02:45,  1.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:04,  1.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:35,  2.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:15,  2.89it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:02,  3.50it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:54,  4.02it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:47,  4.59it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:41,  5.16it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:37,  5.72it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:34,  6.10it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:33,  6.39it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:31,  6.61it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.91it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.89it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.98it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.07it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.05it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.10it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.16it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.19it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.09it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.13it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.21it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.15it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  7.02it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.12it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.18it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.08it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.28it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.17it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.40it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.40it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.19it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.20it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.27it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.28it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.49it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:23,  7.52it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.48it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.59it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.31it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:24,  7.11it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:24,  7.17it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:24,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 14:26:28,933 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:26:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:26:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:26:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:26:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 14:26:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:26:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45194005217306377, 'eval_loss': 1.1246895, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1318, 1539, 1463, 1369, 1203, 871, 608, 784, 1261, 509, 1851], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51321260, 'remaining_params': 33696340, 'pruned_model_sparsity': 0.6036545374134297, 'expected_sparsity': 0.59893, 'target_sparsity': 0.6, 'step': 21000}


Iteration:  36%|███▌      | 96/268 [00:17<02:07,  1.35it/s][A04/21/2024 14:26:30 - INFO - trainer.trainer_mod - v4 Global step: 21000, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:17<01:36,  1.78it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<01:14,  2.28it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:58,  2.88it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:47,  3.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:39,  4.18it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:34,  4.75it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:31,  5.19it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:29,  5.64it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:27,  5.99it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:26,  6.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:24,  6.53it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.77it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  6.94it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.07it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.45it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.28it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.33it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.31it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.32it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.31it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.20it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.11it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.16it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.18it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.11it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.17it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.27it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.35it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.45it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:17,  7.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:17,  7.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.42it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.33it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.53it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.50it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.51it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.64it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.21it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:18,  6.70it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:18,  6.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:17,  7.10it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 14:26:37,838 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:26:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:26:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:26:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:26:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:26:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:26:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44944855113368687, 'eval_loss': 1.0250175, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1318, 1538, 1461, 1367, 1202, 869, 607, 784, 1259, 509, 1834], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51362624, 'remaining_params': 33654976, 'pruned_model_sparsity': 0.6041410719662752, 'expected_sparsity': 0.59942, 'target_sparsity': 0.6, 'step': 21050}


Iteration:  54%|█████▍    | 146/268 [00:26<01:30,  1.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<01:07,  1.79it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:52,  2.31it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:41,  2.90it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:33,  3.52it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:27,  4.20it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:24,  4.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:21,  5.23it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:19,  5.71it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:18,  6.19it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:17,  6.47it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.61it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:16,  6.71it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.90it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.03it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.25it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.25it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.33it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.07it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.09it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  7.02it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.08it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.03it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.10it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.04it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.12it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  6.99it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.09it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.17it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.09it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.18it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.39it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.43it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.47it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.35it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.29it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.22it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:10,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:26:46,774 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:26:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:26:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:26:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:26:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:26:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:26:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4614890222842552, 'eval_loss': 1.0214951, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1317, 1538, 1461, 1366, 1201, 870, 607, 784, 1253, 506, 1813], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51411648, 'remaining_params': 33605952, 'pruned_model_sparsity': 0.6047177055103884, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 21100}


Iteration:  73%|███████▎  | 196/268 [00:35<00:53,  1.33it/s][A04/21/2024 14:26:48 - INFO - trainer.trainer_mod - v4 Global step: 21100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:35<00:40,  1.77it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:30,  2.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:24,  2.83it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:19,  3.46it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:16,  4.07it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:14,  4.69it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:12,  5.25it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:11,  5.82it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:10,  6.12it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.51it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.72it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.97it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.06it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.25it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.08it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.15it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.14it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.13it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.18it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.10it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.13it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.14it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.10it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.09it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.18it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.24it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.18it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.32it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.28it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.27it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.37it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.57it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.53it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.17it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.25it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.28it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.31it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.37it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.16it/s][A
Iteration:  91%|█████████▏| 245/268 [00:41<00:03,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 14:26:55,719 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:26:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:26:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:26:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:26:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:26:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:26:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4655142362608243, 'eval_loss': 1.051685, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1318, 1538, 1462, 1366, 1201, 870, 607, 783, 1248, 501, 1798], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.60048, 'target_sparsity': 0.6, 'step': 21150}


Iteration:  92%|█████████▏| 246/268 [00:44<00:16,  1.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:11,  1.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:08,  2.29it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:06,  2.90it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:05,  3.55it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:04,  4.25it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:03,  4.85it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  5.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  5.81it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  6.28it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.73it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.01it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.95it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.07it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.12it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.14it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.36it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.23it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.32it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.80it/s][A04/21/2024 14:27:00 - INFO - trainer.trainer_mod - Epoch 78 finished. Took 47.06 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  79%|███████▉  | 79/100 [1:03:03<16:44, 47.85s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  7.00it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.07it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.01it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.97it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.92it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  7.03it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.95it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.96it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.35it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.82it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.01it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.01it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.99it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.26it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.34it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.62it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.63it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.57it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.40it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.57it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.52it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.42it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.37it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 14:27:04,589 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:27:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:27:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:27:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:27:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:27:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:27:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4537159672261629, 'eval_loss': 1.022362, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1317, 1538, 1461, 1366, 1200, 871, 608, 783, 1247, 501, 1785], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51471396, 'remaining_params': 33546204, 'pruned_model_sparsity': 0.6054204776422765, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 21200}


Iteration:  10%|█         | 28/268 [00:05<02:58,  1.34it/s][A04/21/2024 14:27:06 - INFO - trainer.trainer_mod - v4 Global step: 21200, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:14,  1.78it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:43,  2.30it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:22,  2.87it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:07,  3.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:56,  4.15it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:49,  4.72it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:43,  5.33it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:40,  5.79it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.16it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.56it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.74it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.78it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.94it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  7.02it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.05it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.08it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.11it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.15it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.16it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.13it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.17it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.20it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.14it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.30it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.32it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.30it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.25it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.27it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.50it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.35it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  6.98it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.10it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.21it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.22it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.30it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.34it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.51it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.27it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.39it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 14:27:13,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:27:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:27:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:27:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:27:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 14:27:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:27:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44791344231403457, 'eval_loss': 1.0404861, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1317, 1538, 1459, 1366, 1200, 871, 608, 785, 1250, 503, 1803], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51437692, 'remaining_params': 33579908, 'pruned_model_sparsity': 0.6050240420806986, 'expected_sparsity': 0.60037, 'target_sparsity': 0.6, 'step': 21250}


Iteration:  29%|██▉       | 78/268 [00:14<02:21,  1.34it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:46,  1.78it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<01:22,  2.28it/s][A
Iteration:  30%|███       | 81/268 [00:15<01:05,  2.87it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:53,  3.50it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:45,  4.09it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:39,  4.70it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:36,  5.07it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:33,  5.45it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:30,  5.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:28,  6.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.71it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  7.00it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.87it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.91it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.02it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.93it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.02it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.09it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.04it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.87it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.90it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.02it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.15it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.16it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.27it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.18it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.18it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.14it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.15it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.25it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.38it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.40it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.38it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.34it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.35it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 14:27:22,524 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:27:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:27:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:27:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:27:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 14:27:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:27:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46699299055618154, 'eval_loss': 1.0388882, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1316, 1537, 1459, 1366, 1200, 872, 610, 790, 1256, 507, 1826], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51379476, 'remaining_params': 33638124, 'pruned_model_sparsity': 0.6043392897470642, 'expected_sparsity': 0.59936, 'target_sparsity': 0.6, 'step': 21300}


Iteration:  48%|████▊     | 128/268 [00:23<01:44,  1.34it/s][A04/21/2024 14:27:24 - INFO - trainer.trainer_mod - v4 Global step: 21300, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:18,  1.77it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<01:00,  2.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:47,  2.86it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:38,  3.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:32,  4.16it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:28,  4.77it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:25,  5.30it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:22,  5.79it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:21,  6.17it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.70it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.73it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.72it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.98it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.05it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.08it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.01it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.06it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.13it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.19it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.20it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.24it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.23it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.24it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.26it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.26it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.28it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.28it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.11it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.20it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.24it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.14it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.24it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.23it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.28it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.37it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.46it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.31it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.21it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.24it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.14it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.17it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.00it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.08it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 14:27:31,482 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:27:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:27:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:27:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:27:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 14:27:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:27:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.475807613606693, 'eval_loss': 1.0466317, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1410, 1316, 1537, 1460, 1368, 1202, 874, 611, 792, 1259, 507, 1825], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51361092, 'remaining_params': 33656508, 'pruned_model_sparsity': 0.6041230521680216, 'expected_sparsity': 0.59895, 'target_sparsity': 0.6, 'step': 21350}


Iteration:  66%|██████▋   | 178/268 [00:32<01:07,  1.34it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:50,  1.76it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:38,  2.28it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:30,  2.87it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:24,  3.53it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:20,  4.17it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:17,  4.77it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:15,  5.33it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:14,  5.74it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:13,  6.05it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.37it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.60it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.82it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.86it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  6.95it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  6.96it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.03it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.09it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.35it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:08,  7.43it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.26it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.33it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.48it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.30it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.26it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.19it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.28it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.32it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.39it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.43it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.45it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.41it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.23it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.24it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.25it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:27:40,350 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:27:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:27:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:27:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:27:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 14:27:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:27:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4529794977975582, 'eval_loss': 0.9522759, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1315, 1536, 1458, 1368, 1201, 872, 610, 791, 1254, 504, 1794], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51433096, 'remaining_params': 33584504, 'pruned_model_sparsity': 0.6049699826859379, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 21400}


Iteration:  85%|████████▌ | 228/268 [00:41<00:29,  1.35it/s][A04/21/2024 14:27:42 - INFO - trainer.trainer_mod - v4 Global step: 21400, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:41<00:21,  1.78it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:16,  2.32it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:12,  2.91it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:10,  3.52it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:08,  4.16it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:07,  4.70it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:06,  5.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:05,  5.64it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:05,  5.98it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.32it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.58it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.73it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.67it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.61it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.97it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.99it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.05it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.04it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.11it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.15it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.19it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.25it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.16it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.01it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.61it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.46it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.35it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.40it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.37it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.40it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.28it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.92it/s][A04/21/2024 14:27:47 - INFO - trainer.trainer_mod - Epoch 79 finished. Took 47.18 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  80%|████████  | 80/100 [1:03:50<15:52, 47.65s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.08it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.17it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.05it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.02it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.08it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.04it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.11it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:27:49,295 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:27:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:27:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:27:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:27:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 14:27:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:27:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.461657758221915, 'eval_loss': 1.0846393, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1314, 1535, 1458, 1368, 1201, 873, 610, 789, 1248, 499, 1770], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 21450}


Iteration:   4%|▎         | 10/268 [00:03<03:16,  1.31it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:27,  1.74it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:52,  2.28it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:28,  2.88it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:12,  3.53it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:59,  4.22it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:52,  4.83it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:46,  5.38it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:42,  5.83it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:40,  6.20it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:39,  6.31it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:37,  6.53it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.63it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.90it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.01it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.11it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  6.96it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.93it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.97it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.95it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.03it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.02it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.08it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.06it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.11it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.09it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.32it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.54it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.43it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.24it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.38it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.35it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.35it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.42it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.61it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.34it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.19it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.12it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:27:58,212 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:27:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:27:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:27:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:27:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:28:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:28:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4547203636282881, 'eval_loss': 1.0179868, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1313, 1534, 1457, 1367, 1200, 873, 609, 789, 1246, 499, 1760], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51517356, 'remaining_params': 33500244, 'pruned_model_sparsity': 0.6059610715898825, 'expected_sparsity': 0.60095, 'target_sparsity': 0.6, 'step': 21500}


Iteration:  22%|██▏       | 60/268 [00:12<02:34,  1.34it/s][A04/21/2024 14:28:00 - INFO - trainer.trainer_mod - v4 Global step: 21500, Alignment: tensor([ 1,  7,  8, 10], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:56,  1.77it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:30,  2.28it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:11,  2.87it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:58,  3.50it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:48,  4.18it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:42,  4.80it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:37,  5.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:34,  5.83it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:32,  6.20it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.47it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.75it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.91it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:27,  7.02it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.12it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.08it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.14it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.18it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.18it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.23it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.27it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.28it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.30it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.23it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.18it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.28it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.47it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.46it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.15it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.28it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.25it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.45it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.16it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.20it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.40it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.19it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.02it/s][A[INFO|trainer.py:570] 2024-04-21 14:28:07,126 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:28:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:28:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:28:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:28:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:28:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:28:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4597376022777596, 'eval_loss': 1.0654585, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1313, 1534, 1456, 1366, 1199, 872, 610, 791, 1250, 503, 1777], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 21550}


Iteration:  41%|████      | 110/268 [00:21<01:57,  1.34it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<01:28,  1.77it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<01:08,  2.29it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:53,  2.88it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:44,  3.47it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:37,  4.11it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:32,  4.74it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:28,  5.30it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:25,  5.83it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.21it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.68it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  6.96it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  6.85it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.98it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  7.04it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.97it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.07it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.14it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.19it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.22it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.12it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.18it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.16it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.18it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.26it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.42it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:16,  7.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.56it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.50it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.53it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.44it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.45it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.47it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.59it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.33it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.15it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.20it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.26it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.25it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:28:16,045 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:28:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:28:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:28:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:28:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 14:28:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:28:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4440192352078645, 'eval_loss': 1.0812001, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1313, 1533, 1456, 1365, 1198, 872, 609, 794, 1257, 509, 1804], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51420840, 'remaining_params': 33596760, 'pruned_model_sparsity': 0.6048258242999097, 'expected_sparsity': 0.59957, 'target_sparsity': 0.6, 'step': 21600}


Iteration:  60%|█████▉    | 160/268 [00:30<01:20,  1.34it/s][A04/21/2024 14:28:18 - INFO - trainer.trainer_mod - v4 Global step: 21600, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:30<01:00,  1.76it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:46,  2.28it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:36,  2.87it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:29,  3.47it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:25,  4.06it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:22,  4.63it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:19,  5.19it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:17,  5.67it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:16,  6.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:15,  6.44it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.67it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.86it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.97it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.19it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.21it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.22it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.21it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  6.99it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.99it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.94it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.01it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.16it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.32it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.35it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.41it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.35it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.29it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.28it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.37it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.54it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.54it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.41it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.14it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.21it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.27it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.16it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.12it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.18it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.30it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 14:28:24,971 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:28:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:28:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:28:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:28:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 14:28:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:28:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45003782776384227, 'eval_loss': 1.1092433, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1413, 1313, 1533, 1455, 1366, 1197, 873, 610, 796, 1262, 512, 1819], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51379476, 'remaining_params': 33638124, 'pruned_model_sparsity': 0.6043392897470642, 'expected_sparsity': 0.59892, 'target_sparsity': 0.6, 'step': 21650}


Iteration:  78%|███████▊  | 210/268 [00:39<00:43,  1.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:31,  1.78it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:24,  2.30it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:18,  2.92it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:15,  3.55it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:12,  4.15it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:10,  4.81it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:09,  5.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:08,  5.76it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:08,  6.06it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.20it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.57it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.75it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.89it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.67it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.98it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.07it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.03it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.01it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.92it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.03it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.11it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.97it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.94it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.04it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.97it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.11it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.10it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.13it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.58it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.14it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.12it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.19it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.36it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.34it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.32it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.33it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.00it/s][A[INFO|trainer.py:570] 2024-04-21 14:28:33,961 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:28:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:28:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:28:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:28:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:28:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:28:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4329275215299443, 'eval_loss': 1.084447, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1413, 1313, 1533, 1454, 1366, 1197, 873, 610, 796, 1259, 509, 1794], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50840212, 'remaining_params': 34177388, 'pruned_model_sparsity': 0.5979963207618187, 'expected_sparsity': 0.5993, 'target_sparsity': 0.6, 'step': 21700}


Iteration:  97%|█████████▋| 260/268 [00:48<00:05,  1.34it/s][A04/21/2024 14:28:36 - INFO - trainer.trainer_mod - v4 Global step: 21700, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:48<00:03,  1.76it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:02,  2.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:01,  2.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  3.51it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  4.19it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  4.86it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  5.34it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  6.15it/s][A04/21/2024 14:28:37 - INFO - trainer.trainer_mod - Epoch 80 finished. Took 49.16 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.45it/s]
Epoch:  81%|████████  | 81/100 [1:04:39<15:13, 48.10s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.16it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.43it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.09it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.05it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.13it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.08it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.16it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.19it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.09it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.14it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.10it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.16it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.21it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.21it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.31it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.34it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.30it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.35it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.27it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.07it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.19it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.26it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.16it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.29it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:32,  7.34it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.29it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.34it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.09it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.79it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.94it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.97it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.04it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:32,  7.12it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:32,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 14:28:42,910 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:28:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:28:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:28:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:28:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:28:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:28:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45272024342354794, 'eval_loss': 1.0237879, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1313, 1533, 1454, 1367, 1197, 873, 610, 793, 1250, 503, 1755], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50924472, 'remaining_params': 34093128, 'pruned_model_sparsity': 0.5989874096657634, 'expected_sparsity': 0.60051, 'target_sparsity': 0.6, 'step': 21750}


Iteration:  16%|█▌        | 42/268 [00:07<02:48,  1.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:07,  1.77it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:37,  2.29it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:16,  2.90it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:03,  3.50it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:53,  4.14it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:45,  4.81it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:40,  5.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:37,  5.83it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:35,  6.14it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.67it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.85it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.90it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.21it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.06it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.02it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.99it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.06it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.08it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.10it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  6.95it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.90it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.03it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.14it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.38it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.62it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.59it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.23it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.10it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.34it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.37it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.48it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.55it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.35it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  7.15it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.23it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:28:51,827 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:28:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:28:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:28:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:28:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:28:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:28:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4355648986183852, 'eval_loss': 1.1109748, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1312, 1533, 1453, 1368, 1198, 874, 610, 792, 1246, 500, 1735], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51161932, 'remaining_params': 33855668, 'pruned_model_sparsity': 0.6017804783950618, 'expected_sparsity': 0.60128, 'target_sparsity': 0.6, 'step': 21800}


Iteration:  34%|███▍      | 92/268 [00:16<02:11,  1.34it/s][A04/21/2024 14:28:53 - INFO - trainer.trainer_mod - v4 Global step: 21800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:38,  1.78it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<01:15,  2.30it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:59,  2.90it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:49,  3.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:41,  4.15it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:36,  4.72it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:32,  5.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:29,  5.75it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:27,  6.13it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:25,  6.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:25,  6.38it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:25,  6.54it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:24,  6.75it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:25,  6.44it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:24,  6.66it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.83it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  6.96it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.06it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.13it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.18it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.18it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.30it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.43it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.42it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.45it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.16it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.12it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.29it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.30it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.31it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.32it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.28it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.21it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:17,  7.23it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.13it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:18,  7.05it/s][A[INFO|trainer.py:570] 2024-04-21 14:29:00,793 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:29:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:29:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:29:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:29:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:29:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:29:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45610100596076714, 'eval_loss': 1.0003781, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1312, 1533, 1453, 1369, 1199, 875, 612, 795, 1248, 502, 1738], 'head_nums': [2, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50941324, 'remaining_params': 34076276, 'pruned_model_sparsity': 0.5991856274465522, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 21850}


Iteration:  53%|█████▎    | 142/268 [00:25<01:34,  1.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<01:10,  1.77it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:54,  2.28it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:42,  2.89it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:34,  3.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:29,  4.12it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:25,  4.74it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:22,  5.37it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:20,  5.83it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:19,  6.08it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:18,  6.39it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:17,  6.65it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.83it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  7.00it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.05it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.13it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.06it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.24it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.23it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.15it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.22it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.25it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.11it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.02it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.04it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  7.02it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.11it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.49it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.42it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.26it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.39it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.19it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.21it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.27it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.27it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.30it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.28it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 14:29:09,706 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:29:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:29:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:29:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:29:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:29:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:29:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46425965709454886, 'eval_loss': 1.0435034, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1311, 1534, 1452, 1369, 1199, 875, 613, 800, 1256, 507, 1758], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50293288, 'remaining_params': 34724312, 'pruned_model_sparsity': 0.5915632527853056, 'expected_sparsity': 0.59922, 'target_sparsity': 0.6, 'step': 21900}


Iteration:  72%|███████▏  | 192/268 [00:34<00:56,  1.34it/s][A04/21/2024 14:29:11 - INFO - trainer.trainer_mod - v4 Global step: 21900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:34<00:42,  1.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:32,  2.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:25,  2.87it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:20,  3.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:17,  4.14it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:14,  4.72it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:13,  5.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:12,  5.60it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:11,  6.01it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:10,  6.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.67it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.74it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.71it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.69it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.87it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.98it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.05it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.09it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.15it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.96it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.02it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.08it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  6.95it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  6.98it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.93it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.09it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.10it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.11it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.34it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.26it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.37it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.35it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.23it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.30it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.21it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.20it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.25it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.23it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:29:18,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:29:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:29:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:29:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:29:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:29:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:29:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46674866212559013, 'eval_loss': 1.0330548, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1312, 1533, 1451, 1369, 1198, 875, 612, 801, 1256, 507, 1765], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50285628, 'remaining_params': 34731972, 'pruned_model_sparsity': 0.591473153794038, 'expected_sparsity': 0.59913, 'target_sparsity': 0.6, 'step': 21950}


Iteration:  90%|█████████ | 242/268 [00:43<00:19,  1.34it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:14,  1.78it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:10,  2.30it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:07,  2.89it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:06,  3.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:05,  4.12it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:04,  4.73it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:03,  5.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:03,  5.71it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.21it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  6.51it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.66it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.82it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.84it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.93it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.15it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.19it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.20it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.15it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.14it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.15it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.10it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.10it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.75it/s][A04/21/2024 14:29:24 - INFO - trainer.trainer_mod - Epoch 81 finished. Took 47.25 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  82%|████████▏ | 82/100 [1:05:26<14:21, 47.85s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.40it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.46it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.04it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.15it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.39it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.31it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.27it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.09it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.17it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.20it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.27it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.24it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.19it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.10it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.15it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.19it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 14:29:27,619 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:29:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:29:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:29:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:29:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:29:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:29:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46411094322127294, 'eval_loss': 1.0261221, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1311, 1532, 1450, 1369, 1198, 874, 612, 800, 1251, 504, 1746], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50532280, 'remaining_params': 34485320, 'pruned_model_sparsity': 0.5943743413128576, 'expected_sparsity': 0.59984, 'target_sparsity': 0.6, 'step': 22000}


Iteration:   9%|▉         | 24/268 [00:05<03:02,  1.34it/s][A04/21/2024 14:29:29 - INFO - trainer.trainer_mod - v4 Global step: 22000, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:16,  1.78it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:45,  2.30it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:23,  2.89it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:09,  3.48it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:59,  4.03it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:51,  4.66it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:45,  5.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:41,  5.72it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.19it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.50it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.84it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.86it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.05it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.98it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.96it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.90it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.00it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.29it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.39it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.23it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.31it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.37it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.23it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.26it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.21it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.15it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.22it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.27it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.17it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.22it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.17it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.19it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:29:36,590 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:29:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:29:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:29:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:29:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:29:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:29:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46425965709454886, 'eval_loss': 1.049991, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1310, 1533, 1450, 1370, 1199, 875, 614, 800, 1245, 500, 1716], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50781996, 'remaining_params': 34235604, 'pruned_model_sparsity': 0.5973115684281843, 'expected_sparsity': 0.60049, 'target_sparsity': 0.6, 'step': 22050}


Iteration:  28%|██▊       | 74/268 [00:14<02:25,  1.33it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:49,  1.77it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:24,  2.26it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:07,  2.85it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:54,  3.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:45,  4.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:39,  4.73it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:35,  5.29it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:32,  5.77it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:30,  6.15it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.90it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.93it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.04it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.14it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.19it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.37it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.13it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.28it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.27it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.18it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.30it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.31it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.51it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.52it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.32it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.39it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.16it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.25it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.31it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.32it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.33it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.19it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.12it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.16it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.31it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.33it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:29:45,475 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:29:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:29:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:29:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:29:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:29:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:29:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4668770386077432, 'eval_loss': 1.0875359, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1309, 1533, 1450, 1370, 1198, 875, 613, 799, 1242, 499, 1702], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51013328, 'remaining_params': 34004272, 'pruned_model_sparsity': 0.6000325579644685, 'expected_sparsity': 0.60099, 'target_sparsity': 0.6, 'step': 22100}


Iteration:  46%|████▋     | 124/268 [00:23<01:47,  1.34it/s][A04/21/2024 14:29:47 - INFO - trainer.trainer_mod - v4 Global step: 22100, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:23<01:20,  1.77it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<01:01,  2.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:48,  2.88it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:39,  3.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:34,  4.06it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:29,  4.68it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:25,  5.30it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:23,  5.78it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:22,  6.05it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:21,  6.36it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:21,  6.13it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:20,  6.35it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.52it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.71it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.73it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.99it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.09it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.98it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.91it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.88it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.96it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.06it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.15it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.32it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:15,  7.32it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.99it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.16it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.31it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.38it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.63it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.58it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.47it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.45it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.44it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 14:29:54,439 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:29:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:29:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:29:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:29:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:29:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:29:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42970050739849175, 'eval_loss': 1.0862468, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1308, 1533, 1449, 1370, 1198, 875, 614, 801, 1247, 501, 1715], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50785060, 'remaining_params': 34232540, 'pruned_model_sparsity': 0.5973476080246913, 'expected_sparsity': 0.60031, 'target_sparsity': 0.6, 'step': 22150}


Iteration:  65%|██████▍   | 174/268 [00:32<01:10,  1.34it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:52,  1.77it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:40,  2.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:31,  2.85it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:25,  3.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:21,  4.11it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:18,  4.73it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:16,  5.31it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:14,  5.85it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:13,  6.31it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:13,  6.40it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.63it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.82it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.94it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.90it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.99it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  7.08it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.12it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.18it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.40it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.27it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.27it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.17it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.38it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.29it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:08,  7.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.23it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.43it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.47it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.57it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.29it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.19it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.27it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.27it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.18it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.20it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.20it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.09it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.16it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.14it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.17it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 14:30:03,397 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:30:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:30:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:30:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:30:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:30:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:30:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.458212452857688, 'eval_loss': 1.0457565, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1308, 1532, 1447, 1369, 1198, 876, 614, 804, 1257, 506, 1745], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50714588, 'remaining_params': 34303012, 'pruned_model_sparsity': 0.5965186973050286, 'expected_sparsity': 0.59925, 'target_sparsity': 0.6, 'step': 22200}


Iteration:  84%|████████▎ | 224/268 [00:41<00:33,  1.33it/s][A04/21/2024 14:30:05 - INFO - trainer.trainer_mod - v4 Global step: 22200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:41<00:24,  1.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:18,  2.28it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:14,  2.87it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:11,  3.48it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:09,  4.17it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:08,  4.73it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:07,  5.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:06,  5.73it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.05it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.20it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.70it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.88it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.90it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.94it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.02it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.10it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.12it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.07it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.16it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.17it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.21it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.11it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.21it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.27it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.42it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.62it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.54it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.46it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.63it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.48it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.33it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.11it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.07it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.27it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.83it/s][A04/21/2024 14:30:11 - INFO - trainer.trainer_mod - Epoch 82 finished. Took 47.16 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  83%|████████▎ | 83/100 [1:06:13<13:29, 47.64s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.41it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.03it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 14:30:12,316 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:30:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:30:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:30:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:30:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:30:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:30:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44394828853094276, 'eval_loss': 1.0893683, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1307, 1531, 1447, 1370, 1198, 876, 615, 805, 1259, 507, 1756], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50691608, 'remaining_params': 34325992, 'pruned_model_sparsity': 0.5962484003312255, 'expected_sparsity': 0.5987, 'target_sparsity': 0.6, 'step': 22250}


Iteration:   2%|▏         | 6/268 [00:02<03:37,  1.20it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:38,  1.64it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:59,  2.18it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:32,  2.79it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:15,  3.44it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:03,  4.05it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:55,  4.58it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:49,  5.12it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:45,  5.64it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:41,  6.04it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:38,  6.49it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.60it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:36,  6.79it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:36,  6.80it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  6.94it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  6.93it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.04it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.92it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.13it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.22it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.27it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.10it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.15it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.19it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.12it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.09it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.07it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.09it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.22it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.06it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.07it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.22it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.32it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:30,  7.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.41it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.37it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.26it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.23it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.75it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.78it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.94it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.93it/s][A[INFO|trainer.py:570] 2024-04-21 14:30:21,352 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:30:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:30:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:30:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:30:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:30:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:30:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4751366513569292, 'eval_loss': 1.0780772, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1307, 1530, 1445, 1369, 1197, 874, 613, 802, 1252, 501, 1722], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50781996, 'remaining_params': 34235604, 'pruned_model_sparsity': 0.5973115684281843, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 22300}


Iteration:  21%|██        | 56/268 [00:11<02:39,  1.33it/s][A04/21/2024 14:30:23 - INFO - trainer.trainer_mod - v4 Global step: 22300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:12<01:59,  1.76it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:32,  2.27it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:13,  2.84it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:59,  3.48it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:50,  4.08it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:43,  4.71it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:38,  5.27it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:35,  5.74it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:33,  6.11it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:29,  6.67it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:29,  6.83it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:28,  6.96it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:27,  7.08it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:26,  7.30it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.20it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:27,  7.06it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  7.06it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  7.02it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.09it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.15it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.13it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.13it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.21it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.30it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:24,  7.51it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.31it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.26it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.24it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.31it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.35it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.15it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.37it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.36it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.32it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.21it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 14:30:30,289 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:30:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:30:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:30:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:30:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:30:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:30:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45808021085661066, 'eval_loss': 1.0507203, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1306, 1530, 1446, 1369, 1197, 875, 613, 800, 1244, 498, 1677], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51063884, 'remaining_params': 33953716, 'pruned_model_sparsity': 0.6006272113068353, 'expected_sparsity': 0.60137, 'target_sparsity': 0.6, 'step': 22350}


Iteration:  40%|███▉      | 106/268 [00:20<02:01,  1.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:30,  1.77it/s][A
Iteration:  40%|████      | 108/268 [00:21<01:10,  2.28it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:55,  2.87it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:44,  3.52it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:37,  4.16it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:33,  4.70it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:29,  5.26it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:27,  5.68it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:25,  6.04it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.63it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:21,  6.85it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  6.97it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.99it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.96it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:20,  7.08it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  7.05it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  7.10it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.17it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.23it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.26it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:18,  7.28it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.36it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.35it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.16it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.26it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.10it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.20it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:16,  7.59it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.33it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.30it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.04it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.09it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.96it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  6.98it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.98it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 14:30:39,256 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:30:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:30:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:30:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:30:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:30:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:30:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4583086901610742, 'eval_loss': 1.0335597, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1307, 1530, 1447, 1371, 1199, 876, 615, 803, 1245, 498, 1687], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 11], 'pruned_params': 51028648, 'remaining_params': 33988952, 'pruned_model_sparsity': 0.600212755947004, 'expected_sparsity': 0.60109, 'target_sparsity': 0.6, 'step': 22400}


Iteration:  58%|█████▊    | 156/268 [00:29<01:23,  1.34it/s][A04/21/2024 14:30:41 - INFO - trainer.trainer_mod - v4 Global step: 22400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:29<01:02,  1.76it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:48,  2.28it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:38,  2.87it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:31,  3.47it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:26,  4.09it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:22,  4.70it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:20,  5.24it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:18,  5.71it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.19it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.41it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.64it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.82it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.98it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.09it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.13it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:13,  7.19it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  7.01it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.11it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.19it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.13it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.15it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.21it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.28it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.54it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.24it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.37it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.40it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.48it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.62it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.58it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.56it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:09,  7.62it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.42it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.26it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.21it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.06it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.12it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.07it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:30:48,204 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:30:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:30:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:30:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:30:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:30:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:30:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44397286177085654, 'eval_loss': 1.0663857, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1305, 1528, 1444, 1370, 1198, 875, 615, 806, 1256, 506, 1725], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50755952, 'remaining_params': 34261648, 'pruned_model_sparsity': 0.5970052318578741, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 22450}


Iteration:  77%|███████▋  | 206/268 [00:38<00:46,  1.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:34,  1.75it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:26,  2.26it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:20,  2.86it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:16,  3.50it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:13,  4.13it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:11,  4.73it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:10,  5.27it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:09,  5.67it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  5.97it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:08,  6.39it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.64it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.94it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.14it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.13it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.28it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.26it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.26it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.12it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.03it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.00it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.19it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.15it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.22it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.21it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.26it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.24it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.30it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.01it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.25it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.40it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.30it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.11it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.93it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.03it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.07it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.10it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.08it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.14it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.14it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.01it/s][A[INFO|trainer.py:570] 2024-04-21 14:30:57,172 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:30:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:30:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:30:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:30:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:30:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:30:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.467569840068754, 'eval_loss': 1.028681, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1304, 1529, 1444, 1370, 1198, 876, 616, 811, 1268, 511, 1774], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50644116, 'remaining_params': 34373484, 'pruned_model_sparsity': 0.5956897865853659, 'expected_sparsity': 0.59848, 'target_sparsity': 0.6, 'step': 22500}


Iteration:  96%|█████████▌| 256/268 [00:47<00:09,  1.33it/s][A04/21/2024 14:30:59 - INFO - trainer.trainer_mod - v4 Global step: 22500, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:47<00:06,  1.76it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:04,  2.29it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:03,  2.91it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:02,  3.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  4.18it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  4.79it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  5.33it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  5.80it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.16it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.68it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.30it/s][A04/21/2024 14:31:00 - INFO - trainer.trainer_mod - Epoch 83 finished. Took 49.35 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.43it/s]
Epoch:  84%|████████▍ | 84/100 [1:07:03<12:50, 48.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.39it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.33it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.21it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.26it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.24it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.16it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.12it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.21it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.08it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.14it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.15it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.21it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.31it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.21it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.28it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.32it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.24it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.29it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.34it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.27it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.30it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.29it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:34,  7.04it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.09it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.05it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.12it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.18it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.20it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:32,  7.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 14:31:06,086 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:31:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:31:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:31:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:31:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:31:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:31:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4524393377050599, 'eval_loss': 1.0173317, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1304, 1529, 1442, 1369, 1197, 875, 615, 810, 1270, 511, 1771], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50654840, 'remaining_params': 34362760, 'pruned_model_sparsity': 0.5958159251731406, 'expected_sparsity': 0.59849, 'target_sparsity': 0.6, 'step': 22550}


Iteration:  14%|█▍        | 38/268 [00:07<02:51,  1.34it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:10,  1.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:40,  2.26it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:19,  2.84it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:04,  3.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:54,  4.15it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:46,  4.77it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:41,  5.33it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:39,  5.67it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:36,  6.08it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:34,  6.38it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:33,  6.54it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.88it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.00it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.04it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.07it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.13it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.30it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.29it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.27it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.13it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.19it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.26it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.42it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.43it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.28it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.26it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.26it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.23it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.26it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.26it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.24it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  7.01it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:26,  6.89it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.91it/s][A[INFO|trainer.py:570] 2024-04-21 14:31:15,044 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:31:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:31:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:31:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:31:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:31:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:31:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4637769793053727, 'eval_loss': 1.0600674, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1304, 1530, 1443, 1371, 1198, 876, 615, 808, 1258, 503, 1731], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50740632, 'remaining_params': 34276968, 'pruned_model_sparsity': 0.5968250338753388, 'expected_sparsity': 0.59966, 'target_sparsity': 0.6, 'step': 22600}


Iteration:  33%|███▎      | 88/268 [00:16<02:15,  1.33it/s][A04/21/2024 14:31:17 - INFO - trainer.trainer_mod - v4 Global step: 22600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:41,  1.77it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<01:17,  2.29it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:01,  2.88it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:49,  3.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:41,  4.22it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:37,  4.66it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:33,  5.23it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:31,  5.52it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:29,  5.86it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:27,  6.14it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.74it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.80it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.95it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.09it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.14it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.24it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.07it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.17it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.38it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.50it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:19,  7.80it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:19,  7.59it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:19,  7.76it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.69it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.60it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.58it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.17it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.06it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.15it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.19it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.24it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.21it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.18it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.21it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.21it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.21it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:31:23,959 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:31:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:31:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:31:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:31:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:31:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:31:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4747587637452304, 'eval_loss': 1.0861554, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1303, 1528, 1442, 1370, 1197, 875, 614, 803, 1244, 497, 1678], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50872384, 'remaining_params': 34145216, 'pruned_model_sparsity': 0.5983747365251431, 'expected_sparsity': 0.60167, 'target_sparsity': 0.6, 'step': 22650}


Iteration:  51%|█████▏    | 138/268 [00:25<01:37,  1.34it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<01:13,  1.76it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:56,  2.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:44,  2.87it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:35,  3.53it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:29,  4.22it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:25,  4.88it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:22,  5.42it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:20,  5.87it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:19,  6.23it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:19,  6.06it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:17,  6.85it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  6.96it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.03it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.92it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.93it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  7.00it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.09it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.13it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.32it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.24it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.32it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.40it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.18it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.44it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.33it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.40it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.48it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.27it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.37it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.31it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.09it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.14it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:31:32,859 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:31:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:31:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:31:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:31:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:31:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:31:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.466428275513655, 'eval_loss': 1.0784936, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1302, 1528, 1439, 1369, 1196, 874, 612, 801, 1241, 497, 1667], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50910684, 'remaining_params': 34106916, 'pruned_model_sparsity': 0.5988252314814815, 'expected_sparsity': 0.60216, 'target_sparsity': 0.6, 'step': 22700}


Iteration:  70%|███████   | 188/268 [00:34<00:59,  1.34it/s][A04/21/2024 14:31:34 - INFO - trainer.trainer_mod - v4 Global step: 22700, Alignment: tensor([2, 3, 7, 8], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:34<00:44,  1.77it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:33,  2.30it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:26,  2.86it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:21,  3.47it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:18,  4.10it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:15,  4.76it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:14,  5.21it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:12,  5.68it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:11,  5.95it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:11,  6.29it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.38it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:10,  6.72it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.09it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.16it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.06it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.00it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.07it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.30it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.29it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.31it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.38it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.44it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.44it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.42it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.34it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.53it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.36it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.24it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.24it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.16it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.16it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.16it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.31it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.27it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.03it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  6.95it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.04it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.13it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:31:41,823 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:31:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:31:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:31:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:31:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:31:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:31:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45541959294569456, 'eval_loss': 1.1107066, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1302, 1528, 1438, 1367, 1196, 874, 613, 805, 1252, 504, 1715], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50806508, 'remaining_params': 34211092, 'pruned_model_sparsity': 0.5975998852002409, 'expected_sparsity': 0.60044, 'target_sparsity': 0.6, 'step': 22750}


Iteration:  89%|████████▉ | 238/268 [00:43<00:22,  1.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:16,  1.76it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:12,  2.29it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:09,  2.87it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:07,  3.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:06,  4.14it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:05,  4.75it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:04,  5.31it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  5.75it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.14it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  6.44it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.68it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.78it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.09it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.16it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.22it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.32it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.11it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.03it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.20it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.25it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.28it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.12it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.18it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.81it/s][A04/21/2024 14:31:47 - INFO - trainer.trainer_mod - Epoch 84 finished. Took 47.14 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  85%|████████▌ | 85/100 [1:07:50<11:57, 47.85s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.40it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.21it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.50it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.41it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.39it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.55it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.43it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.37it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.33it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.33it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.29it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.33it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.31it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.03it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.10it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.93it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.22it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:31:50,692 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:31:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:31:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:31:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:31:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:31:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:31:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4526195252024402, 'eval_loss': 1.0927367, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1302, 1528, 1438, 1366, 1194, 873, 614, 810, 1268, 514, 1765], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50687012, 'remaining_params': 34330588, 'pruned_model_sparsity': 0.596194340936465, 'expected_sparsity': 0.59841, 'target_sparsity': 0.6, 'step': 22800}


Iteration:   7%|▋         | 20/268 [00:04<03:05,  1.34it/s][A04/21/2024 14:31:52 - INFO - trainer.trainer_mod - v4 Global step: 22800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:20,  1.76it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:48,  2.27it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:25,  2.85it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:09,  3.50it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:59,  4.11it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:51,  4.72it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.22it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:42,  5.70it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:39,  6.02it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.38it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.64it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.01it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.00it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  7.00it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.94it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.85it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.97it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.91it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.93it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.96it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.10it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.11it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.35it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.59it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:28,  7.59it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.56it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.58it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.57it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.44it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.36it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.29it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.18it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.18it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.97it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.97it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  6.90it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.92it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.00it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.10it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:31:59,689 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:31:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:31:59 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:31:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:31:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 14:32:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:32:01 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4664784054861729, 'eval_loss': 1.0504634, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1301, 1527, 1437, 1366, 1193, 873, 614, 811, 1273, 517, 1779], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50657904, 'remaining_params': 34359696, 'pruned_model_sparsity': 0.5958519647696477, 'expected_sparsity': 0.59786, 'target_sparsity': 0.6, 'step': 22850}


Iteration:  26%|██▌       | 70/268 [00:13<02:28,  1.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:51,  1.76it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<01:26,  2.28it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<01:07,  2.87it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:55,  3.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:46,  4.11it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:41,  4.68it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:36,  5.23it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:33,  5.70it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:31,  5.95it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:29,  6.29it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:29,  6.41it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:28,  6.59it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:27,  6.76it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.81it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.11it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.80it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  6.96it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.30it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:23,  7.35it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.32it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.40it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.37it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.14it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.25it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:24,  6.72it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  7.00it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.02it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.11it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.28it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.29it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.16it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.04it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.08it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.04it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.12it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.13it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.06it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 14:32:08,737 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:32:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:32:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:32:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:32:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:32:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:32:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42676403064167506, 'eval_loss': 1.1096643, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1300, 1527, 1437, 1366, 1193, 873, 614, 809, 1265, 509, 1742], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50743696, 'remaining_params': 34273904, 'pruned_model_sparsity': 0.5968610734718458, 'expected_sparsity': 0.599, 'target_sparsity': 0.6, 'step': 22900}


Iteration:  45%|████▍     | 120/268 [00:22<01:50,  1.34it/s][A04/21/2024 14:32:10 - INFO - trainer.trainer_mod - v4 Global step: 22900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:22<01:23,  1.77it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<01:04,  2.27it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:50,  2.86it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:41,  3.49it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:34,  4.09it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:30,  4.71it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:26,  5.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:24,  5.68it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.08it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  6.81it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.96it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  7.04it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.11it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.19it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.22it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.25it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.32it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.46it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.45it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.55it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.42it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.34it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.31it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.18it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.21it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.15it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.19it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.07it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.09it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.15it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.03it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  7.03it/s][A[INFO|trainer.py:570] 2024-04-21 14:32:17,672 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:32:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:32:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:32:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:32:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:32:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:32:19 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47775581719103866, 'eval_loss': 0.97651273, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1300, 1527, 1437, 1366, 1194, 873, 614, 805, 1252, 501, 1678], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50880044, 'remaining_params': 34137556, 'pruned_model_sparsity': 0.5984648355164107, 'expected_sparsity': 0.60083, 'target_sparsity': 0.6, 'step': 22950}


Iteration:  63%|██████▎   | 170/268 [00:31<01:13,  1.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:54,  1.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:42,  2.28it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:33,  2.87it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:27,  3.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:22,  4.14it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:19,  4.67it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:17,  5.22it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:15,  5.66it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:14,  6.08it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.72it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.10it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.12it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.08it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.10it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.04it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.09it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.17it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.49it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.49it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.48it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.43it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.38it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.41it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.39it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.33it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:07,  7.49it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.20it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.04it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.09it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.01it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.03it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.01it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 14:32:26,603 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:32:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:32:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:32:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:32:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:32:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:32:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47200535411399097, 'eval_loss': 1.0478501, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1300, 1527, 1437, 1367, 1194, 874, 614, 803, 1243, 498, 1640], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50956644, 'remaining_params': 34060956, 'pruned_model_sparsity': 0.5993658254290877, 'expected_sparsity': 0.60194, 'target_sparsity': 0.6, 'step': 23000}


Iteration:  82%|████████▏ | 220/268 [00:40<00:36,  1.33it/s][A04/21/2024 14:32:28 - INFO - trainer.trainer_mod - v4 Global step: 23000, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:40<00:26,  1.76it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:20,  2.28it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:15,  2.85it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:12,  3.46it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:10,  4.10it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:08,  4.67it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:07,  5.14it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:07,  5.62it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:06,  5.95it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.97it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.18it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.99it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.88it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.04it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.17it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.34it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.00it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.23it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:02,  7.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.27it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.22it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.21it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.24it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.18it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.17it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.17it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.09it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.12it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.17it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.71it/s][A04/21/2024 14:32:35 - INFO - trainer.trainer_mod - Epoch 85 finished. Took 47.34 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  86%|████████▌ | 86/100 [1:08:37<11:07, 47.70s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.48it/s][A[INFO|trainer.py:570] 2024-04-21 14:32:35,589 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:32:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:32:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:32:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:32:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:32:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:32:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4664784054861729, 'eval_loss': 1.0824006, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1300, 1526, 1436, 1367, 1194, 874, 613, 804, 1247, 500, 1650], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50935196, 'remaining_params': 34082404, 'pruned_model_sparsity': 0.5991135482535381, 'expected_sparsity': 0.60136, 'target_sparsity': 0.6, 'step': 23050}


Iteration:   1%|          | 2/268 [00:02<05:57,  1.34s/it][A
Iteration:   1%|          | 3/268 [00:02<03:30,  1.26it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:20,  1.87it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:41,  2.58it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:18,  3.34it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:04,  4.06it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:54,  4.73it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:49,  5.23it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:45,  5.72it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:42,  6.03it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:40,  6.35it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:39,  6.51it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:38,  6.57it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:37,  6.79it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:36,  6.96it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.97it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  7.07it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.12it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.18it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.27it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:33,  7.32it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.34it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:33,  7.35it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.31it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.36it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.52it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.53it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:31,  7.53it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.49it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.61it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.31it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.26it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.25it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.14it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.09it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.15it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.06it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.03it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:32,  6.75it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.06it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:32:44,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:32:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:32:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:32:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:32:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:32:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:32:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4553410961810576, 'eval_loss': 1.0521768, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1300, 1524, 1435, 1365, 1192, 873, 614, 807, 1257, 506, 1689], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50660968, 'remaining_params': 34356632, 'pruned_model_sparsity': 0.5958880043661547, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 23100}


Iteration:  19%|█▉        | 52/268 [00:11<02:41,  1.34it/s][A04/21/2024 14:32:46 - INFO - trainer.trainer_mod - v4 Global step: 23100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:01,  1.77it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:33,  2.29it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:13,  2.89it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:00,  3.53it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:50,  4.20it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:43,  4.81it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:38,  5.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:35,  5.88it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:33,  6.24it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:32,  6.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:30,  6.65it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.76it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:28,  7.05it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:28,  7.11it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:27,  7.19it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:27,  7.24it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.27it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.33it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.31it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.39it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.13it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.37it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:24,  7.56it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.29it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.29it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.31it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.27it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.23it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  6.99it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.08it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.14it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.17it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.10it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.13it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.14it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 14:32:53,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:32:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:32:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:32:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:32:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:32:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:32:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4638691307713943, 'eval_loss': 1.066003, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1300, 1524, 1435, 1365, 1191, 873, 614, 809, 1264, 511, 1719], 'head_nums': [3, 3, 2, 3, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50400528, 'remaining_params': 34617072, 'pruned_model_sparsity': 0.5928246386630533, 'expected_sparsity': 0.59854, 'target_sparsity': 0.6, 'step': 23150}


Iteration:  38%|███▊      | 102/268 [00:20<02:04,  1.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:33,  1.76it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<01:12,  2.27it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:56,  2.87it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:46,  3.50it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:38,  4.15it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:33,  4.77it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:29,  5.31it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:27,  5.70it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.11it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:22,  6.81it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.97it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.94it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:21,  7.03it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:21,  7.11it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:20,  7.17it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  7.03it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  7.03it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.07it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.18it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:19,  7.28it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.16it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.06it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.17it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  7.04it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.08it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.22it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:18,  7.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.20it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.32it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.33it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.37it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.35it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.45it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.33it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.44it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.40it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.23it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.24it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.27it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.15it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.14it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.08it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:33:02,354 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:33:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:33:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:33:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:33:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 14:33:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:33:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46663910840666245, 'eval_loss': 1.0527184, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1299, 1524, 1434, 1365, 1191, 873, 614, 809, 1264, 510, 1711], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50613476, 'remaining_params': 34404124, 'pruned_model_sparsity': 0.5953293906202951, 'expected_sparsity': 0.59879, 'target_sparsity': 0.6, 'step': 23200}


Iteration:  57%|█████▋    | 152/268 [00:29<01:27,  1.33it/s][A04/21/2024 14:33:04 - INFO - trainer.trainer_mod - v4 Global step: 23200, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:29<01:05,  1.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:50,  2.27it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:39,  2.89it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:31,  3.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:26,  4.17it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:22,  4.79it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:20,  5.27it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:18,  5.72it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.24it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.51it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.63it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.72it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.88it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:14,  6.97it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  7.06it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  7.01it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  7.06it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.16it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.24it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.30it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.38it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:12,  7.42it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.55it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.40it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.44it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:11,  7.48it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.28it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.26it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.47it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.30it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.17it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.10it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.01it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.09it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.71it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.88it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.99it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  7.08it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.13it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.17it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.19it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 14:33:11,298 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:33:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:33:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:33:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:33:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:33:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:33:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4637046622918281, 'eval_loss': 1.0638055, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1299, 1523, 1433, 1366, 1191, 873, 614, 807, 1257, 504, 1676], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50693140, 'remaining_params': 34324460, 'pruned_model_sparsity': 0.5962664201294791, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 23250}


Iteration:  75%|███████▌  | 202/268 [00:38<00:49,  1.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:36,  1.76it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:28,  2.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:22,  2.81it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:18,  3.43it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:14,  4.08it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:12,  4.68it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:11,  5.12it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:10,  5.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:09,  6.01it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.41it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.63it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.81it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.80it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.95it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  7.04it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  7.12it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.11it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.20it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.19it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.27it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.33it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.24it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.29it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.21it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.26it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.34it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.38it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.14it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.89it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.12it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.03it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.93it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.95it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.91it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.00it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.98it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.17it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.21it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.22it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.26it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.25it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 14:33:20,359 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:33:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:33:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:33:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:33:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:33:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:33:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46924526844967124, 'eval_loss': 1.0169555, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1298, 1522, 1431, 1364, 1189, 872, 612, 804, 1250, 500, 1638], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50788124, 'remaining_params': 34229476, 'pruned_model_sparsity': 0.5973836476211984, 'expected_sparsity': 0.60114, 'target_sparsity': 0.6, 'step': 23300}


Iteration:  94%|█████████▍| 252/268 [00:47<00:12,  1.33it/s][A04/21/2024 14:33:22 - INFO - trainer.trainer_mod - v4 Global step: 23300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:47<00:08,  1.76it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:06,  2.28it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:04,  2.86it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:03,  3.50it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:02,  4.13it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:02,  4.75it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  5.29it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  5.86it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.10it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.24it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.50it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.92it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.99it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  7.09it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.66it/s][A04/21/2024 14:33:24 - INFO - trainer.trainer_mod - Epoch 86 finished. Took 49.29 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.44it/s]
Epoch:  87%|████████▋ | 87/100 [1:09:26<10:26, 48.17s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.44it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.32it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.40it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.44it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.48it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.50it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.31it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.20it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.23it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.28it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.26it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.28it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.46it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:36,  6.83it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.84it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.05it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.04it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.12it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.14it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.00it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.09it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.12it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.05it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.28it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:33:29,296 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:33:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:33:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:33:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:33:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:33:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:33:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46916929434481164, 'eval_loss': 1.0859194, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1298, 1522, 1431, 1364, 1188, 872, 612, 804, 1249, 500, 1634], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50797316, 'remaining_params': 34220284, 'pruned_model_sparsity': 0.5974917664107197, 'expected_sparsity': 0.60132, 'target_sparsity': 0.6, 'step': 23350}


Iteration:  13%|█▎        | 34/268 [00:06<02:55,  1.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:11,  1.77it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:41,  2.28it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:20,  2.87it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:05,  3.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:55,  4.13it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:47,  4.80it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:42,  5.35it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:38,  5.80it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:36,  6.09it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.30it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.54it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.87it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.89it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.01it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.96it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.12it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.22it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.12it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.19it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.17it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.05it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.07it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.04it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.33it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.26it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.45it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.42it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.40it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.38it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.34it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.31it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.21it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.23it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.17it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.19it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.25it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.16it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.30it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 14:33:38,239 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:33:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:33:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:33:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:33:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:33:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:33:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4497290185542299, 'eval_loss': 1.1330891, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1297, 1522, 1431, 1365, 1188, 872, 613, 807, 1255, 503, 1656], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50743696, 'remaining_params': 34273904, 'pruned_model_sparsity': 0.5968610734718458, 'expected_sparsity': 0.60038, 'target_sparsity': 0.6, 'step': 23400}


Iteration:  31%|███▏      | 84/268 [00:15<02:17,  1.34it/s][A04/21/2024 14:33:40 - INFO - trainer.trainer_mod - v4 Global step: 23400, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:44,  1.75it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:20,  2.27it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:02,  2.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:51,  3.52it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:43,  4.13it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:37,  4.75it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:33,  5.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:30,  5.84it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:29,  6.02it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:28,  6.18it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.80it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.97it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.07it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.90it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.01it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  6.99it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.13it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.14it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.26it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.44it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.42it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.33it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.41it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.36it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.37it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.32it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.24it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.27it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.27it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.23it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.02it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.10it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.27it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.10it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.24it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.22it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:33:47,179 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:33:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:33:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:33:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:33:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:33:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:33:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47765307125471923, 'eval_loss': 1.0318161, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1297, 1521, 1430, 1364, 1187, 871, 613, 808, 1263, 509, 1689], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50679352, 'remaining_params': 34338248, 'pruned_model_sparsity': 0.5961042419451972, 'expected_sparsity': 0.59957, 'target_sparsity': 0.6, 'step': 23450}


Iteration:  50%|█████     | 134/268 [00:24<01:39,  1.34it/s][A
Iteration:  50%|█████     | 135/268 [00:24<01:14,  1.78it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:57,  2.28it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:45,  2.86it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:37,  3.49it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:31,  4.10it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:27,  4.69it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:23,  5.30it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:22,  5.72it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:20,  6.00it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.76it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  6.83it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.93it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.02it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.10it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.09it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.20it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.29it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.39it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.17it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.13it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.23it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.32it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.36it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.38it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.33it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.46it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.33it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.24it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.21it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.23it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.36it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.18it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.31it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 14:33:56,116 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:33:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:33:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:33:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:33:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:33:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:33:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4637769793053727, 'eval_loss': 1.0373275, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1296, 1521, 1429, 1364, 1187, 871, 614, 812, 1271, 513, 1707], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50627264, 'remaining_params': 34390336, 'pruned_model_sparsity': 0.595491568804577, 'expected_sparsity': 0.59897, 'target_sparsity': 0.6, 'step': 23500}


Iteration:  69%|██████▊   | 184/268 [00:33<01:02,  1.34it/s][A04/21/2024 14:33:58 - INFO - trainer.trainer_mod - v4 Global step: 23500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:33<00:46,  1.77it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:35,  2.29it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:28,  2.88it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:22,  3.50it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:19,  4.14it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:16,  4.76it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:14,  5.32it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:13,  5.70it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:12,  6.01it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:12,  6.16it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:11,  6.60it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:11,  6.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.56it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.74it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  6.96it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  6.99it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.12it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.19it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.31it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.20it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.06it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.11it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.21it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.23it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.15it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.19it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.12it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.16it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.33it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.47it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.37it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.26it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.15it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.04it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.06it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.23it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.22it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.12it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.16it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:34:05,117 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:34:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:34:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:34:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:34:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:34:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:34:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4751366513569292, 'eval_loss': 1.0126263, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1295, 1521, 1430, 1366, 1189, 872, 615, 813, 1272, 512, 1704], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50621136, 'remaining_params': 34396464, 'pruned_model_sparsity': 0.5954194896115628, 'expected_sparsity': 0.59884, 'target_sparsity': 0.6, 'step': 23550}


Iteration:  87%|████████▋ | 234/268 [00:42<00:25,  1.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:18,  1.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:13,  2.31it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:10,  2.91it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:08,  3.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:06,  4.19it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:05,  4.79it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:05,  5.33it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:04,  5.79it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  6.14it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.64it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.74it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.92it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.92it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.05it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.98it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.43it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.43it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.22it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.16it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.15it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.21it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.19it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.25it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.59it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.50it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.91it/s][A04/21/2024 14:34:11 - INFO - trainer.trainer_mod - Epoch 87 finished. Took 47.19 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  88%|████████▊ | 88/100 [1:10:14<09:34, 47.88s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.17it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.44it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.17it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.09it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  7.02it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.97it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.03it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.05it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.13it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.17it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.10it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:34:14,006 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:34:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:34:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:34:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:34:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 14:34:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:34:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46674866212559013, 'eval_loss': 1.0321589, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1294, 1521, 1430, 1367, 1190, 873, 615, 813, 1264, 507, 1677], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50679352, 'remaining_params': 34338248, 'pruned_model_sparsity': 0.5961042419451972, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 23600}


Iteration:   6%|▌         | 16/268 [00:04<03:09,  1.33it/s][A04/21/2024 14:34:16 - INFO - trainer.trainer_mod - v4 Global step: 23600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:22,  1.76it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:49,  2.28it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:27,  2.86it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:10,  3.52it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:58,  4.21it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:51,  4.80it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:46,  5.21it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:43,  5.62it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:40,  6.05it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:38,  6.35it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:36,  6.60it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:36,  6.61it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.78it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.94it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.17it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.28it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.30it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.38it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.37it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.37it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.36it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.41it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.23it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.15it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.11it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.10it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.98it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.06it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.01it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.27it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.30it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.27it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.17it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.10it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  7.01it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  7.00it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  6.99it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.05it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.07it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.15it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.05it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:34:22,983 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:34:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:34:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:34:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:34:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:34:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:34:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4585588335759275, 'eval_loss': 1.0697222, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1293, 1521, 1430, 1367, 1190, 874, 615, 810, 1256, 502, 1647], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50751356, 'remaining_params': 34266244, 'pruned_model_sparsity': 0.5969511724631135, 'expected_sparsity': 0.60089, 'target_sparsity': 0.6, 'step': 23650}


Iteration:  25%|██▍       | 66/268 [00:13<02:30,  1.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:53,  1.77it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:27,  2.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:09,  2.88it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:57,  3.46it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:48,  4.04it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:41,  4.67it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:37,  5.23it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:34,  5.67it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:32,  5.99it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:30,  6.32it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.74it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.81it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.00it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.16it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.14it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.33it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:24,  7.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:23,  7.60it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:23,  7.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.35it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.32it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.19it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.11it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.05it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  6.95it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  7.03it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.04it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.02it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.12it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.20it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.25it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.18it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.25it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.24it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.17it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.18it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:34:31,981 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:34:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:34:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:34:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:34:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:34:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:34:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46442630929154605, 'eval_loss': 1.0232308, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1293, 1520, 1429, 1365, 1188, 872, 614, 809, 1256, 502, 1639], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50777400, 'remaining_params': 34240200, 'pruned_model_sparsity': 0.5972575090334237, 'expected_sparsity': 0.60117, 'target_sparsity': 0.6, 'step': 23700}


Iteration:  43%|████▎     | 116/268 [00:22<01:53,  1.34it/s][A04/21/2024 14:34:34 - INFO - trainer.trainer_mod - v4 Global step: 23700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:22<01:24,  1.78it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<01:05,  2.30it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:51,  2.89it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:41,  3.53it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:35,  4.14it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:31,  4.65it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:28,  5.14it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:25,  5.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:23,  6.04it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.54it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.75it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.78it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  6.94it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.19it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.30it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.24it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.31it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.35it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.20it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.11it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.33it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.25it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.28it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.28it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.36it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.45it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.40it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.30it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.31it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.11it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.97it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.05it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.76it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.00it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.56it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:16,  6.68it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:16,  6.65it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  6.85it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:15,  6.95it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:34:41,001 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:34:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:34:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:34:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:34:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:34:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:34:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4327081608080881, 'eval_loss': 1.0840565, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1292, 1519, 1428, 1364, 1188, 871, 614, 810, 1263, 504, 1668], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50723780, 'remaining_params': 34293820, 'pruned_model_sparsity': 0.5966268160945498, 'expected_sparsity': 0.6003, 'target_sparsity': 0.6, 'step': 23750}


Iteration:  62%|██████▏   | 166/268 [00:31<01:16,  1.34it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:57,  1.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:43,  2.28it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:34,  2.89it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:27,  3.53it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:23,  4.17it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:20,  4.78it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:17,  5.34it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:16,  5.87it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.22it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.58it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.79it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.98it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.13it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.37it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.18it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.27it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.35it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.17it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  7.03it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.08it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.12it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.20it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.29it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.19it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.06it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.10it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.07it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.15it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.29it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.30it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.30it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.17it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.25it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.42it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 14:34:49,928 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:34:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:34:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:34:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:34:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:34:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:34:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45804529832950347, 'eval_loss': 1.089073, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1293, 1519, 1428, 1365, 1188, 872, 615, 814, 1273, 509, 1696], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50841744, 'remaining_params': 34175856, 'pruned_model_sparsity': 0.5980143405600723, 'expected_sparsity': 0.59919, 'target_sparsity': 0.6, 'step': 23800}


Iteration:  81%|████████  | 216/268 [00:40<00:38,  1.34it/s][A04/21/2024 14:34:51 - INFO - trainer.trainer_mod - v4 Global step: 23800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:40<00:28,  1.77it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:21,  2.29it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:16,  2.89it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:13,  3.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:11,  4.15it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:09,  4.82it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:08,  5.36it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:07,  5.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.17it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.76it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.87it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.02it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.15it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.25it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.28it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.34it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.55it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.33it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.29it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.55it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.48it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.32it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.03it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.11it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.23it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.06it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.11it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.17it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 14:34:58,810 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:34:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:34:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:34:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:34:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:35:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:35:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44113488112476795, 'eval_loss': 1.0573218, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1292, 1518, 1427, 1365, 1188, 871, 615, 814, 1275, 509, 1700], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50644116, 'remaining_params': 34373484, 'pruned_model_sparsity': 0.5956897865853659, 'expected_sparsity': 0.59909, 'target_sparsity': 0.6, 'step': 23850}


Iteration:  99%|█████████▉| 266/268 [00:49<00:01,  1.34it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  1.77it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  2.34it/s][A04/21/2024 14:35:01 - INFO - trainer.trainer_mod - Epoch 88 finished. Took 49.32 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.43it/s]
Epoch:  89%|████████▉ | 89/100 [1:11:03<08:51, 48.31s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.22it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.10it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.13it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.21it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.23it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.22it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.07it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.14it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.12it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.24it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.48it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.48it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.49it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.47it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.38it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.29it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.49it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.45it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.38it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.41it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.43it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.40it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.36it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.23it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.24it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.15it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.01it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.19it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.25it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:32,  7.15it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.19it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.09it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.12it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:32,  7.07it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:32,  7.09it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.10it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.14it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:31,  7.15it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:32,  6.84it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:31,  6.97it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:31,  7.06it/s][A[INFO|trainer.py:570] 2024-04-21 14:35:07,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:35:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:35:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:35:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:35:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:35:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:35:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4181278600904661, 'eval_loss': 1.1606987, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1292, 1518, 1426, 1364, 1186, 871, 614, 812, 1271, 506, 1684], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50690076, 'remaining_params': 34327524, 'pruned_model_sparsity': 0.596230380532972, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 23900}


Iteration:  18%|█▊        | 48/268 [00:08<02:45,  1.33it/s][A04/21/2024 14:35:09 - INFO - trainer.trainer_mod - v4 Global step: 23900, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<02:04,  1.76it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:35,  2.28it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:16,  2.84it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:02,  3.48it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:52,  4.13it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:45,  4.75it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:40,  5.29it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:37,  5.70it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:34,  6.08it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.00it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.13it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.50it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.47it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.51it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.44it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.51it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.34it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.36it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  6.99it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:27,  6.95it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.04it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.28it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.42it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.54it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.43it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.39it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.23it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  7.13it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.16it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.20it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.19it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:24,  7.23it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:24,  7.13it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:24,  7.18it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:23,  7.19it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:23,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:35:16,629 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:35:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:35:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:35:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:35:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:35:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:35:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4584243142844763, 'eval_loss': 1.035053, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1291, 1517, 1425, 1365, 1186, 872, 616, 813, 1267, 504, 1656], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50740632, 'remaining_params': 34276968, 'pruned_model_sparsity': 0.5968250338753388, 'expected_sparsity': 0.60055, 'target_sparsity': 0.6, 'step': 23950}


Iteration:  37%|███▋      | 98/268 [00:17<02:07,  1.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:35,  1.77it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:13,  2.29it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:57,  2.90it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:46,  3.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:39,  4.17it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:35,  4.67it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:31,  5.12it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:28,  5.60it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:27,  5.87it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:25,  6.22it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:24,  6.40it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:23,  6.72it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.84it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:22,  6.94it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.09it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.20it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.27it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.23it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.29it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.34it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.16it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.25it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.30it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.29it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.26it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.16it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.19it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.13it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.15it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.20it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.11it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  7.17it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.09it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.10it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.07it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:17,  7.16it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  7.22it/s][A
Iteration:  54%|█████▍    | 146/268 [00:24<00:16,  7.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:24<00:16,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:35:25,634 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:35:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:35:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:35:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:35:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]04/21/2024 14:35:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:35:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45003782776384227, 'eval_loss': 1.0441824, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1290, 1517, 1425, 1365, 1185, 873, 616, 813, 1267, 503, 1643], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50763612, 'remaining_params': 34253988, 'pruned_model_sparsity': 0.5970953308491418, 'expected_sparsity': 0.60059, 'target_sparsity': 0.6, 'step': 24000}


Iteration:  55%|█████▌    | 148/268 [00:26<01:30,  1.33it/s][A04/21/2024 14:35:27 - INFO - trainer.trainer_mod - v4 Global step: 24000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:26<01:07,  1.76it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:51,  2.28it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:40,  2.87it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:33,  3.51it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:27,  4.15it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:24,  4.74it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:21,  5.17it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:19,  5.65it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:18,  6.04it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:17,  6.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.67it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  6.87it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.16it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.16it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.24it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.56it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.65it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.62it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.31it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.40it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.45it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.36it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.15it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.19it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.13it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.16it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.22it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.20it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.26it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.38it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.36it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.34it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.35it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.26it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.26it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.20it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  6.95it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  6.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  6.87it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  6.97it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  6.95it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:10,  7.01it/s][A[INFO|trainer.py:570] 2024-04-21 14:35:34,579 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:35:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:35:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:35:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:35:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:35:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:35:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4355648986183852, 'eval_loss': 1.050001, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1290, 1517, 1424, 1365, 1185, 873, 615, 813, 1270, 505, 1650], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50748292, 'remaining_params': 34269308, 'pruned_model_sparsity': 0.5969151328666065, 'expected_sparsity': 0.60039, 'target_sparsity': 0.6, 'step': 24050}


Iteration:  74%|███████▍  | 198/268 [00:35<00:52,  1.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:39,  1.76it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:29,  2.28it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:23,  2.83it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:19,  3.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:15,  4.11it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:13,  4.79it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:11,  5.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:10,  5.71it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.17it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.72it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.02it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.13it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.40it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.43it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.40it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.28it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.33it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.47it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.47it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.61it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.48it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.48it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.43it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.24it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.22it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.15it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.16it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.15it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.19it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.21it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.10it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.07it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.23it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.06it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  6.88it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.00it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  6.89it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  6.81it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  6.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.03it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.14it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.05it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.14it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:35:43,556 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:35:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:35:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:35:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:35:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 14:35:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:35:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4447228660377303, 'eval_loss': 1.0486994, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1290, 1517, 1424, 1365, 1185, 875, 617, 817, 1277, 507, 1677], 'head_nums': [3, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 50679352, 'remaining_params': 34338248, 'pruned_model_sparsity': 0.5961042419451972, 'expected_sparsity': 0.59947, 'target_sparsity': 0.6, 'step': 24100}


Iteration:  93%|█████████▎| 248/268 [00:44<00:14,  1.33it/s][A04/21/2024 14:35:45 - INFO - trainer.trainer_mod - v4 Global step: 24100, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:44<00:10,  1.76it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:07,  2.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:05,  2.85it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:04,  3.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:03,  4.10it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  4.72it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  5.26it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:02,  5.73it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.03it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.73it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.91it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.07it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.18it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.40it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.43it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.45it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.39it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.90it/s][A04/21/2024 14:35:48 - INFO - trainer.trainer_mod - Epoch 89 finished. Took 47.23 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  90%|█████████ | 90/100 [1:11:50<07:59, 47.99s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.68it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.47it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.32it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.12it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.06it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.15it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.99it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.09it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.28it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.20it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.70it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.84it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.77it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.80it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.86it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.08it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.06it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.13it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.29it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.26it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.19it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.19it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.20it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.11it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.95it/s][A[INFO|trainer.py:570] 2024-04-21 14:35:52,530 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:35:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:35:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:35:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:35:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:35:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:35:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43340222780977355, 'eval_loss': 1.0930943, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1290, 1516, 1424, 1365, 1185, 875, 617, 819, 1280, 509, 1683], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51250788, 'remaining_params': 33766812, 'pruned_model_sparsity': 0.6028256266937669, 'expected_sparsity': 0.59925, 'target_sparsity': 0.6, 'step': 24150}


Iteration:  11%|█         | 30/268 [00:06<02:58,  1.33it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:14,  1.76it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:43,  2.29it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:21,  2.88it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:06,  3.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:55,  4.16it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:48,  4.82it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:43,  5.30it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:40,  5.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:38,  6.02it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:36,  6.28it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:35,  6.47it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:33,  6.81it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.83it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.99it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.11it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.23it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.34it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.25it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.35it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.38it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.34it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.32it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.26it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.15it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.10it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.13it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.23it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.07it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.14it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.17it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.09it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  6.97it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.09it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.17it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.29it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:25,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 14:36:01,471 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:36:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:36:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:36:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:36:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:36:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:36:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43624361512112764, 'eval_loss': 1.1415218, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1290, 1515, 1423, 1366, 1185, 875, 617, 818, 1278, 507, 1671], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51278364, 'remaining_params': 33739236, 'pruned_model_sparsity': 0.6031499830623306, 'expected_sparsity': 0.59978, 'target_sparsity': 0.6, 'step': 24200}


Iteration:  30%|██▉       | 80/268 [00:15<02:19,  1.34it/s][A04/21/2024 14:36:03 - INFO - trainer.trainer_mod - v4 Global step: 24200, Alignment: tensor([2, 3, 7, 8], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:15<01:45,  1.78it/s][A
Iteration:  31%|███       | 82/268 [00:15<01:21,  2.29it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:05,  2.85it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:52,  3.49it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:43,  4.18it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:38,  4.78it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:33,  5.35it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:31,  5.80it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:28,  6.19it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.53it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.69it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.93it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.08it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  6.98it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.03it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.04it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.06it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.15it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.30it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.16it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.26it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.31it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.22it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.26it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.16it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.20it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.21it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.24it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.04it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.08it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.09it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.11it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.05it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.11it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.37it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:21,  6.98it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.16it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:19,  7.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.29it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.30it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.18it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.18it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  6.99it/s][A[INFO|trainer.py:570] 2024-04-21 14:36:10,446 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:36:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:36:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:36:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:36:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:36:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:36:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4411215655571869, 'eval_loss': 1.1586355, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 765, 'intermediate_dims': [1414, 1289, 1515, 1422, 1366, 1184, 875, 616, 816, 1274, 504, 1647], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51379020, 'remaining_params': 33638580, 'pruned_model_sparsity': 0.6043339261517615, 'expected_sparsity': 0.60045, 'target_sparsity': 0.6, 'step': 24250}


Iteration:  49%|████▊     | 130/268 [00:24<01:43,  1.34it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<01:17,  1.77it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:59,  2.27it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:47,  2.86it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:38,  3.49it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:32,  4.13it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:27,  4.75it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:24,  5.34it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:22,  5.78it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.19it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:20,  6.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.67it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.04it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.16it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.24it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.26it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.38it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.23it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.15it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.21it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.22it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.26it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.25it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.18it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.01it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.10it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.17it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.40it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.23it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.15it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.17it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.27it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  6.98it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.10it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.16it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.31it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.28it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.47it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:36:19,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:36:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:36:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:36:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:36:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:36:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:36:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43577816963420296, 'eval_loss': 1.127239, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 765, 'intermediate_dims': [1414, 1289, 1515, 1422, 1366, 1184, 875, 616, 816, 1273, 504, 1634], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51400440, 'remaining_params': 33617160, 'pruned_model_sparsity': 0.6045858739837399, 'expected_sparsity': 0.60075, 'target_sparsity': 0.6, 'step': 24300}


Iteration:  67%|██████▋   | 180/268 [00:33<01:05,  1.34it/s][A04/21/2024 14:36:21 - INFO - trainer.trainer_mod - v4 Global step: 24300, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:33<00:48,  1.78it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:37,  2.30it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:29,  2.89it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:23,  3.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:20,  4.14it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:17,  4.70it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:15,  5.25it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:14,  5.66it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:12,  6.17it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:12,  6.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.67it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  6.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.05it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.16it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.27it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.29it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:08,  7.35it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.31it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.43it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.13it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.19it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.36it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.32it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.42it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.18it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.19it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.23it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.36it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.32it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.33it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.29it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.28it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 14:36:28,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:36:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:36:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:36:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:36:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:36:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:36:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4386209168112411, 'eval_loss': 1.1313562, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1289, 1515, 1422, 1365, 1183, 874, 615, 817, 1278, 508, 1642], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51331984, 'remaining_params': 33685616, 'pruned_model_sparsity': 0.6037806760012044, 'expected_sparsity': 0.60036, 'target_sparsity': 0.6, 'step': 24350}


Iteration:  86%|████████▌ | 230/268 [00:41<00:28,  1.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:20,  1.78it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:15,  2.30it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:11,  2.92it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:09,  3.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:07,  4.21it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:06,  4.80it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:06,  5.13it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:05,  5.64it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.09it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.34it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.66it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.82it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.20it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.21it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.12it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.98it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.12it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.23it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.19it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.29it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.31it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.33it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.21it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.22it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.12it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.04it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.06it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.94it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.93it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.02it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.02it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.10it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.33it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.88it/s][A04/21/2024 14:36:35 - INFO - trainer.trainer_mod - Epoch 90 finished. Took 47.2 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  91%|█████████ | 91/100 [1:12:37<07:09, 47.75s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.10it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.22it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.12it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.09it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.13it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.30it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 14:36:37,155 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:36:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:36:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:36:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:36:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:36:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:36:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4440867985315811, 'eval_loss': 1.0827079, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1289, 1515, 1422, 1366, 1183, 874, 616, 820, 1285, 511, 1665], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51275300, 'remaining_params': 33742300, 'pruned_model_sparsity': 0.6031139434658236, 'expected_sparsity': 0.59953, 'target_sparsity': 0.6, 'step': 24400}


Iteration:   4%|▍         | 12/268 [00:03<03:11,  1.34it/s][A04/21/2024 14:36:39 - INFO - trainer.trainer_mod - v4 Global step: 24400, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:23,  1.78it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:50,  2.30it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:26,  2.92it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:10,  3.56it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:59,  4.25it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:51,  4.86it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:46,  5.37it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:42,  5.90it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:39,  6.19it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.40it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.61it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.94it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.03it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.15it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.41it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.31it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.48it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.28it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.35it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.29it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.16it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.25it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.13it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.16it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.80it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.94it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  7.01it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.10it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.16it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.11it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.13it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.18it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.11it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  7.00it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.09it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.00it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.01it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.09it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.95it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.18it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.05it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:36:46,116 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:36:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:36:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:36:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:36:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:36:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:36:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4384135017689582, 'eval_loss': 1.110811, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1288, 1514, 1422, 1365, 1183, 874, 617, 823, 1290, 513, 1679], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51243128, 'remaining_params': 33774472, 'pruned_model_sparsity': 0.6027355277024993, 'expected_sparsity': 0.59906, 'target_sparsity': 0.6, 'step': 24450}


Iteration:  23%|██▎       | 62/268 [00:12<02:34,  1.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:55,  1.77it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:29,  2.29it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<01:10,  2.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:57,  3.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:48,  4.12it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:42,  4.69it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:38,  5.23it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:35,  5.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:33,  5.95it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:30,  6.33it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.63it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  7.09it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.21it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.27it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.36it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.40it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.41it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.42it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.62it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.34it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.25it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.04it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.92it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.05it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.13it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.18it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.23it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.09it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.94it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.19it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.23it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.26it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.26it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.25it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.24it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.27it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.28it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.21it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:36:55,062 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:36:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:36:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:36:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:36:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:36:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:36:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44455763518973207, 'eval_loss': 1.0909007, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1287, 1514, 1422, 1364, 1183, 874, 617, 822, 1285, 510, 1656], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51295216, 'remaining_params': 33722384, 'pruned_model_sparsity': 0.6033482008431196, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 24500}


Iteration:  42%|████▏     | 112/268 [00:21<01:56,  1.34it/s][A04/21/2024 14:36:57 - INFO - trainer.trainer_mod - v4 Global step: 24500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:21<01:27,  1.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<01:08,  2.25it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:53,  2.84it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:43,  3.47it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:36,  4.09it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:31,  4.72it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:27,  5.34it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:25,  5.84it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:23,  6.26it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.60it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.86it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.03it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.18it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.16it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.42it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:18,  7.48it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:17,  7.63it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:17,  7.63it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:17,  7.61it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.53it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.37it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.18it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.41it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.14it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.17it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.18it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.19it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.24it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.12it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.13it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.14it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.17it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.19it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.10it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.12it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.13it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.17it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.15it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.18it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:37:03,950 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:37:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:37:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:37:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:37:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:37:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:37:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4505173993303405, 'eval_loss': 1.0480618, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1286, 1512, 1422, 1365, 1182, 874, 618, 821, 1279, 508, 1636], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51342708, 'remaining_params': 33674892, 'pruned_model_sparsity': 0.6039068145889792, 'expected_sparsity': 0.60092, 'target_sparsity': 0.6, 'step': 24550}


Iteration:  60%|██████    | 162/268 [00:30<01:18,  1.35it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:58,  1.78it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:45,  2.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:35,  2.89it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:28,  3.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:24,  4.19it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:20,  4.80it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:18,  5.40it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:16,  5.85it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:15,  6.25it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.47it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.67it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.90it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  7.06it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.17it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:11,  7.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.36it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.28it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.35it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.41it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.27it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.05it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.24it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.70it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.66it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.81it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.97it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.27it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.04it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.29it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.28it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.21it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.22it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.17it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.36it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.22it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.05it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 14:37:12,893 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:37:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:37:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:37:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:37:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:37:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:37:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4440192352078645, 'eval_loss': 1.0616335, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 765, 'intermediate_dims': [1413, 1285, 1512, 1421, 1364, 1182, 873, 617, 821, 1279, 509, 1652], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51369840, 'remaining_params': 33647760, 'pruned_model_sparsity': 0.6042259485094851, 'expected_sparsity': 0.60087, 'target_sparsity': 0.6, 'step': 24600}


Iteration:  79%|███████▉  | 212/268 [00:39<00:41,  1.33it/s][A04/21/2024 14:37:14 - INFO - trainer.trainer_mod - v4 Global step: 24600, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:39<00:31,  1.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:23,  2.28it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:18,  2.87it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:14,  3.47it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:12,  4.11it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:10,  4.69it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:09,  5.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:08,  5.74it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.08it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:07,  6.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.51it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.88it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.05it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.08it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.25it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.22it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.28it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.29it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.01it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.98it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.05it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.10it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.13it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.13it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.05it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.08it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.02it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.11it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.17it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.08it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.13it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.96it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.05it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.02it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.07it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.14it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.27it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.18it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 14:37:21,906 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:37:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:37:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:37:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:37:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:37:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:37:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44960521225224076, 'eval_loss': 1.069635, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 765, 'intermediate_dims': [1413, 1284, 1511, 1421, 1364, 1181, 874, 618, 824, 1290, 515, 1697], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51271920, 'remaining_params': 33745680, 'pruned_model_sparsity': 0.6030741869918699, 'expected_sparsity': 0.59965, 'target_sparsity': 0.6, 'step': 24650}


Iteration:  98%|█████████▊| 262/268 [00:48<00:04,  1.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:02,  1.77it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  2.29it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:01,  2.88it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  3.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  4.17it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.02it/s][A04/21/2024 14:37:24 - INFO - trainer.trainer_mod - Epoch 91 finished. Took 49.21 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.45it/s]
Epoch:  92%|█████████▏| 92/100 [1:13:27<06:25, 48.19s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  7.01it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.32it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.34it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.42it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.26it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.19it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.28it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.40it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.59it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.09it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.20it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.23it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.23it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.37it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.56it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.51it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.20it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.09it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.37it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.12it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:34,  7.02it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.08it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.97it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.28it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.17it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.32it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.33it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.32it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.10it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.35it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.23it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.15it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:33,  6.64it/s][A[INFO|trainer.py:570] 2024-04-21 14:37:30,817 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:37:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:37:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:37:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:37:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:37:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:37:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4553410961810576, 'eval_loss': 1.0666591, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 765, 'intermediate_dims': [1412, 1283, 1511, 1421, 1365, 1182, 875, 618, 826, 1297, 519, 1719], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51216840, 'remaining_params': 33800760, 'pruned_model_sparsity': 0.6024263211382114, 'expected_sparsity': 0.59887, 'target_sparsity': 0.6, 'step': 24700}


Iteration:  16%|█▋        | 44/268 [00:08<02:48,  1.33it/s][A04/21/2024 14:37:32 - INFO - trainer.trainer_mod - v4 Global step: 24700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:06,  1.76it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:37,  2.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:17,  2.86it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:02,  3.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:52,  4.18it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:45,  4.78it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:40,  5.41it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:36,  5.90it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:34,  6.30it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.54it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:32,  6.61it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.81it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.92it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.08it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.28it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.36it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.32it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  6.98it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.08it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.14it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.35it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.14it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.17it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.22it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.21it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.20it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.31it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.38it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:25,  7.25it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.11it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.16it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  7.04it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:26,  6.99it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.17it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.17it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.19it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.24it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.43it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 14:37:39,716 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:37:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:37:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:37:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:37:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:37:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:37:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44791344231403457, 'eval_loss': 1.0822936, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1281, 1511, 1421, 1365, 1181, 875, 618, 825, 1296, 516, 1705], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51206360, 'remaining_params': 33811240, 'pruned_model_sparsity': 0.6023030525444143, 'expected_sparsity': 0.59925, 'target_sparsity': 0.6, 'step': 24750}


Iteration:  35%|███▌      | 94/268 [00:17<02:09,  1.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:37,  1.78it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<01:14,  2.30it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:59,  2.90it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:47,  3.56it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:40,  4.21it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:34,  4.82it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:31,  5.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:28,  5.87it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:25,  6.35it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:24,  6.67it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  6.83it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  7.02it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.26it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.22it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.19it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.46it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.23it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.32it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.29it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.12it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.12it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  7.14it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  7.07it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:21,  7.00it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:21,  6.95it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  6.98it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.06it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.14it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.17it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.18it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:20,  7.03it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.11it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.14it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.20it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.07it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:19,  7.04it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  7.01it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:19,  6.93it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.05it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.08it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.14it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.10it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  7.12it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:18,  7.11it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.05it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:37:48,679 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:37:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:37:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:37:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:37:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:37:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:37:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45115517656589194, 'eval_loss': 1.0793878, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1280, 1509, 1420, 1366, 1181, 874, 617, 823, 1285, 510, 1660], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51312068, 'remaining_params': 33705532, 'pruned_model_sparsity': 0.6035464186239085, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 24800}


Iteration:  54%|█████▎    | 144/268 [00:25<01:32,  1.34it/s][A04/21/2024 14:37:50 - INFO - trainer.trainer_mod - v4 Global step: 24800, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:26<01:09,  1.78it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:52,  2.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:41,  2.91it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:34,  3.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:28,  4.17it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:24,  4.80it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:21,  5.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:19,  5.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:18,  6.31it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:17,  6.44it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:17,  6.64it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.89it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  6.97it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.11it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.36it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.39it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.46it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.48it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.41it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.39it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.10it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.12it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  6.96it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.08it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.27it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.15it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.05it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.09it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.13it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.07it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:12,  7.03it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.09it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.16it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.18it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.11it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.16it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.20it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:11,  6.99it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.08it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.14it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.18it/s][A[INFO|trainer.py:570] 2024-04-21 14:37:57,601 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:37:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:37:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:37:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:37:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:37:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:37:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4420898648237221, 'eval_loss': 1.0620244, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1411, 1280, 1508, 1418, 1365, 1180, 874, 617, 822, 1281, 507, 1632], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51376412, 'remaining_params': 33641188, 'pruned_model_sparsity': 0.6043032501505571, 'expected_sparsity': 0.60135, 'target_sparsity': 0.6, 'step': 24850}


Iteration:  72%|███████▏  | 194/268 [00:34<00:54,  1.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:40,  1.78it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:31,  2.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:24,  2.90it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:19,  3.53it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:16,  4.18it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:14,  4.81it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:12,  5.24it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:11,  5.73it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:10,  6.08it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  6.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.75it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  6.94it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.14it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  7.15it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.30it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.22it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.27it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.40it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.35it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.35it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.32it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.30it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.49it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.29it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.18it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.10it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.14it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  6.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:06,  6.87it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:06,  6.81it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  6.96it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.02it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.09it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.11it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.06it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.10it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.18it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.20it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.11it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.15it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.17it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.23it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.22it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 14:38:06,570 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:38:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:38:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:38:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:38:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:38:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:38:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44836079619347136, 'eval_loss': 1.0564282, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1280, 1509, 1418, 1365, 1181, 874, 618, 825, 1288, 512, 1662], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51301344, 'remaining_params': 33716256, 'pruned_model_sparsity': 0.6034202800361337, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 24900}


Iteration:  91%|█████████ | 244/268 [00:43<00:17,  1.34it/s][A04/21/2024 14:38:08 - INFO - trainer.trainer_mod - v4 Global step: 24900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:44<00:13,  1.77it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:09,  2.29it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:07,  2.87it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:05,  3.50it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:04,  4.16it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:03,  4.79it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:03,  5.36it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  5.86it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  6.28it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.56it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.93it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.98it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.98it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.12it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.14it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.13it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.20it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.38it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.28it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.20it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.24it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.78it/s][A04/21/2024 14:38:11 - INFO - trainer.trainer_mod - Epoch 92 finished. Took 47.13 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  93%|█████████▎| 93/100 [1:14:14<05:35, 47.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.08it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.11it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.33it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.33it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.04it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.12it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.17it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.09it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.12it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.18it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.20it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.24it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.16it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.17it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.32it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.28it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.25it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.37it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.35it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.34it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.18it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.11it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 14:38:15,451 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:38:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:38:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:38:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:38:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:38:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:38:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.47012447895058357, 'eval_loss': 1.0550318, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1280, 1509, 1419, 1367, 1183, 876, 620, 830, 1299, 518, 1696], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51201764, 'remaining_params': 33815836, 'pruned_model_sparsity': 0.6022489931496537, 'expected_sparsity': 0.59895, 'target_sparsity': 0.6, 'step': 24950}


Iteration:  10%|▉         | 26/268 [00:05<02:59,  1.35it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:15,  1.78it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:44,  2.29it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:22,  2.89it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:07,  3.52it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:58,  4.08it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:49,  4.76it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:44,  5.28it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:40,  5.79it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:38,  6.10it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.44it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.71it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.90it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.95it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.09it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.23it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.27it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.30it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.35it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.19it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.22it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.21it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.24it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.38it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.10it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.09it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.03it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.19it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.23it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.04it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.15it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.18it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.20it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  7.04it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.09it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.17it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.18it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 14:38:24,402 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:38:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:38:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:38:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:38:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:38:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:38:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.46801804195138824, 'eval_loss': 1.0681993, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1280, 1509, 1419, 1367, 1182, 874, 620, 830, 1300, 519, 1705], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51189508, 'remaining_params': 33828092, 'pruned_model_sparsity': 0.6021048347636254, 'expected_sparsity': 0.59882, 'target_sparsity': 0.6, 'step': 25000}


Iteration:  28%|██▊       | 76/268 [00:14<02:23,  1.34it/s][A04/21/2024 14:38:26 - INFO - trainer.trainer_mod - v4 Global step: 25000, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:48,  1.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:23,  2.28it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:06,  2.83it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:54,  3.44it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:45,  4.09it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:39,  4.73it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:34,  5.29it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:31,  5.80it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:29,  6.15it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.34it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.64it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.88it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.03it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.17it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.56it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:22,  7.58it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.40it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.05it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.11it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.14it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.19it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.22it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.23it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.21it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.06it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.05it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:23,  6.56it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.76it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.80it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  6.95it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  6.95it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:21,  6.97it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:21,  6.97it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:21,  6.87it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.82it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  6.95it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 14:38:33,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:38:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:38:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:38:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:38:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:38:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:38:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44887349757367434, 'eval_loss': 1.068364, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1412, 1279, 1509, 1418, 1366, 1182, 874, 619, 826, 1289, 514, 1665], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51287556, 'remaining_params': 33730044, 'pruned_model_sparsity': 0.6032581018518518, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 25050}


Iteration:  47%|████▋     | 126/268 [00:23<01:46,  1.34it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<01:19,  1.77it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<01:01,  2.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:49,  2.83it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:39,  3.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:33,  4.11it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:29,  4.67it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:25,  5.26it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:23,  5.78it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:21,  6.28it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.62it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.76it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.06it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.34it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.21it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.27it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.14it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.17it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.31it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.23it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.43it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.28it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.06it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.02it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.01it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.11it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  7.05it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.02it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.11it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.82it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  6.95it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  7.06it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  6.95it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.04it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.04it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.01it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  6.94it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  6.84it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  6.95it/s][A[INFO|trainer.py:570] 2024-04-21 14:38:42,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:38:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:38:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:38:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:38:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 14:38:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:38:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4526195252024402, 'eval_loss': 1.0792711, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1413, 1278, 1508, 1417, 1365, 1182, 874, 619, 823, 1280, 509, 1629], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51373348, 'remaining_params': 33644252, 'pruned_model_sparsity': 0.60426721055405, 'expected_sparsity': 0.60119, 'target_sparsity': 0.6, 'step': 25100}


Iteration:  66%|██████▌   | 176/268 [00:32<01:09,  1.33it/s][A04/21/2024 14:38:44 - INFO - trainer.trainer_mod - v4 Global step: 25100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:32<00:52,  1.74it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:40,  2.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:31,  2.82it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:25,  3.46it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:21,  4.12it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:18,  4.75it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:15,  5.35it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:14,  5.83it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:13,  6.24it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.59it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.65it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.88it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.94it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.20it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.40it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.33it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.51it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.46it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.63it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:08,  7.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.51it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.47it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.48it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.10it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.18it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.20it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.36it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.34it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.29it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.26it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.21it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.08it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.20it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.18it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.22it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.22it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 14:38:51,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:38:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:38:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:38:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:38:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:38:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:38:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4509257189091659, 'eval_loss': 1.0553659, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1413, 1278, 1507, 1415, 1364, 1180, 873, 618, 824, 1282, 512, 1637], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51364156, 'remaining_params': 33653444, 'pruned_model_sparsity': 0.6041590917645288, 'expected_sparsity': 0.60093, 'target_sparsity': 0.6, 'step': 25150}


Iteration:  84%|████████▍ | 226/268 [00:41<00:31,  1.34it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:23,  1.78it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:17,  2.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:13,  2.90it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:10,  3.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:08,  4.14it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:07,  4.78it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:06,  5.30it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  5.92it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.74it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.94it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.87it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.08it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.30it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.34it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.31it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.21it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.13it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.07it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.23it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.23it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.14it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.14it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.18it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.18it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.21it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.20it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.20it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.24it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.17it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.28it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.77it/s][A04/21/2024 14:38:59 - INFO - trainer.trainer_mod - Epoch 93 finished. Took 47.22 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  94%|█████████▍| 94/100 [1:15:01<04:46, 47.67s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.16it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.04it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.09it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 14:39:00,170 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:39:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:39:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:39:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:39:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:39:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:39:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45610100596076714, 'eval_loss': 1.075255, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1278, 1508, 1416, 1365, 1181, 874, 620, 829, 1294, 520, 1676], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51253852, 'remaining_params': 33763748, 'pruned_model_sparsity': 0.602861666290274, 'expected_sparsity': 0.59954, 'target_sparsity': 0.6, 'step': 25200}


Iteration:   3%|▎         | 8/268 [00:03<03:22,  1.28it/s][A04/21/2024 14:39:02 - INFO - trainer.trainer_mod - v4 Global step: 25200, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:29,  1.73it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:54,  2.26it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:29,  2.86it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:13,  3.49it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:01,  4.16it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:52,  4.81it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:47,  5.33it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:44,  5.73it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:40,  6.23it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.42it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.71it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  6.95it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.08it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:33,  7.40it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.44it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.49it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.38it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.11it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.09it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  7.02it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.07it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.15it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.07it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.03it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.19it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.09it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.14it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.20it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.22it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.23it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.44it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.42it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.42it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.12it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.09it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.98it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.06it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.02it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.13it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.08it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.16it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.20it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.23it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 14:39:09,113 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:39:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:39:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:39:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:39:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:39:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:39:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4588826894375657, 'eval_loss': 1.0413558, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1278, 1509, 1416, 1365, 1182, 875, 622, 832, 1304, 526, 1704], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51174188, 'remaining_params': 33843412, 'pruned_model_sparsity': 0.60192463678109, 'expected_sparsity': 0.59859, 'target_sparsity': 0.6, 'step': 25250}


Iteration:  22%|██▏       | 58/268 [00:12<02:36,  1.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:57,  1.78it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:30,  2.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:11,  2.89it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:58,  3.54it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:48,  4.20it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:42,  4.85it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:38,  5.32it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:35,  5.68it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:32,  6.13it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:31,  6.36it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:29,  6.70it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:28,  6.92it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.09it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:27,  7.18it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.59it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:25,  7.42it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.27it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.30it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.17it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.17it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.07it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.18it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.28it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.15it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.07it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.11it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.14it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.45it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.50it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.16it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 14:39:17,986 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:39:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:39:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:39:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:39:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:39:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:39:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45017936365298244, 'eval_loss': 1.053653, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1277, 1508, 1415, 1365, 1182, 875, 621, 832, 1300, 522, 1691], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51210956, 'remaining_params': 33806644, 'pruned_model_sparsity': 0.602357111939175, 'expected_sparsity': 0.5992, 'target_sparsity': 0.6, 'step': 25300}


Iteration:  40%|████      | 108/268 [00:20<01:59,  1.34it/s][A04/21/2024 14:39:20 - INFO - trainer.trainer_mod - v4 Global step: 25300, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:21<01:30,  1.76it/s][A
Iteration:  41%|████      | 110/268 [00:21<01:09,  2.27it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:55,  2.85it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:44,  3.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:37,  4.17it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:32,  4.81it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:28,  5.34it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:26,  5.84it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.13it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.40it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.71it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.94it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.09it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.23it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.50it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:19,  7.50it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.42it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.26it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.73it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.92it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.05it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.11it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.18it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.36it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.36it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.38it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.27it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.35it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.25it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.17it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.20it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.36it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.27it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.26it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.23it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.25it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.29it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.32it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 14:39:26,885 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:39:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:39:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:39:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:39:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:39:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:39:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4477152744261397, 'eval_loss': 1.0555335, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1277, 1507, 1415, 1365, 1181, 875, 621, 828, 1284, 515, 1644], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51327388, 'remaining_params': 33690212, 'pruned_model_sparsity': 0.6037266166064439, 'expected_sparsity': 0.60071, 'target_sparsity': 0.6, 'step': 25350}


Iteration:  59%|█████▉    | 158/268 [00:29<01:21,  1.34it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<01:01,  1.77it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:46,  2.31it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:36,  2.92it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:29,  3.57it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:24,  4.23it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:21,  4.82it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:19,  5.40it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:17,  5.89it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:16,  6.18it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.67it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  7.01it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.15it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.17it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.41it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.35it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.20it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.20it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.22it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.26it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.31it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.20it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.06it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.00it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  7.04it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.08it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  6.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  6.88it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.01it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.93it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.13it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.17it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.98it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.06it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.16it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.07it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.13it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.01it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.10it/s][A[INFO|trainer.py:570] 2024-04-21 14:39:35,816 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:39:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:39:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:39:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:39:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:39:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:39:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44710293548831637, 'eval_loss': 1.0451131, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1276, 1507, 1415, 1364, 1180, 874, 621, 826, 1277, 511, 1621], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51388668, 'remaining_params': 33628932, 'pruned_model_sparsity': 0.6044474085365854, 'expected_sparsity': 0.60135, 'target_sparsity': 0.6, 'step': 25400}


Iteration:  78%|███████▊  | 208/268 [00:38<00:44,  1.33it/s][A04/21/2024 14:39:37 - INFO - trainer.trainer_mod - v4 Global step: 25400, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:38<00:33,  1.75it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:25,  2.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:19,  2.86it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:15,  3.53it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:13,  4.12it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:11,  4.67it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:09,  5.31it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:09,  5.73it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:08,  6.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.68it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.05it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.20it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.19it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.28it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.32it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.22it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.23it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.20it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.23it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.22it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.14it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.34it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.23it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.45it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.18it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.22it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.27it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.07it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.21it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.25it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.89it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.69it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.84it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  6.95it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.04it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.13it/s][A[INFO|trainer.py:570] 2024-04-21 14:39:44,760 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:39:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:39:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:39:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:39:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:39:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:39:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4420898648237221, 'eval_loss': 1.0754721, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1277, 1506, 1413, 1364, 1179, 874, 620, 827, 1283, 515, 1648], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51335048, 'remaining_params': 33682552, 'pruned_model_sparsity': 0.6038167155977116, 'expected_sparsity': 0.6007, 'target_sparsity': 0.6, 'step': 25450}


Iteration:  96%|█████████▋| 258/268 [00:47<00:07,  1.34it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:05,  1.77it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:03,  2.28it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:02,  2.86it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  3.48it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:01,  4.13it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  4.76it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  5.34it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  5.83it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.09it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  6.76it/s][A04/21/2024 14:39:48 - INFO - trainer.trainer_mod - Epoch 94 finished. Took 49.08 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.46it/s]
Epoch:  95%|█████████▌| 95/100 [1:15:50<04:00, 48.10s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.18it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.30it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.35it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.11it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.18it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.07it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.13it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.18it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  6.97it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.09it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.15it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.16it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.14it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.16it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.14it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.13it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.17it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  6.98it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.26it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.25it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.15it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.22it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.22it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.21it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 14:39:53,684 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:39:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:39:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:39:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:39:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:39:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:39:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4435607522294471, 'eval_loss': 1.0724698, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1277, 1506, 1414, 1365, 1180, 875, 622, 830, 1296, 523, 1693], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51220148, 'remaining_params': 33797452, 'pruned_model_sparsity': 0.6024652307286962, 'expected_sparsity': 0.5993, 'target_sparsity': 0.6, 'step': 25500}


Iteration:  15%|█▍        | 40/268 [00:07<02:48,  1.35it/s][A04/21/2024 14:39:55 - INFO - trainer.trainer_mod - v4 Global step: 25500, Alignment: tensor([1, 3, 7, 8], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:06,  1.79it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:37,  2.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<01:17,  2.90it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:03,  3.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:53,  4.20it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:47,  4.72it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:42,  5.20it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:38,  5.73it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:35,  6.19it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:32,  6.62it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.75it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.85it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.03it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.14it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.26it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.33it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.21it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.00it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.20it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.25it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.87it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.08it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.16it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.05it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.10it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.17it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.19it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.11it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.17it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.37it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.29it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.09it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.09it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  6.99it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  6.99it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.24it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.25it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.29it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 14:40:02,641 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:40:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:40:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:40:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:40:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 14:40:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:40:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4419038227281786, 'eval_loss': 1.0901451, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1276, 1505, 1414, 1366, 1180, 875, 622, 832, 1303, 528, 1711], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51172656, 'remaining_params': 33844944, 'pruned_model_sparsity': 0.6019066169828365, 'expected_sparsity': 0.59879, 'target_sparsity': 0.6, 'step': 25550}


Iteration:  34%|███▎      | 90/268 [00:16<02:12,  1.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:39,  1.77it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:17,  2.28it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<01:00,  2.87it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:49,  3.52it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:43,  4.00it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:37,  4.65it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:32,  5.19it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:29,  5.74it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:27,  6.15it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.58it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.80it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.18it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.20it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.13it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.32it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.17it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.07it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.33it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.32it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.31it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.23it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.12it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.14it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.18it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.11it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:20,  7.03it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.10it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.16it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.31it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.26it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.29it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.20it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.09it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.19it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.25it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.12it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:18,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:40:11,620 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:40:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:40:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:40:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:40:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:40:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:40:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4503393755428836, 'eval_loss': 1.0581558, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1273, 1501, 1412, 1364, 1179, 875, 620, 828, 1295, 524, 1693], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51249256, 'remaining_params': 33768344, 'pruned_model_sparsity': 0.6028076068955134, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 25600}


Iteration:  52%|█████▏    | 140/268 [00:25<01:35,  1.34it/s][A04/21/2024 14:40:13 - INFO - trainer.trainer_mod - v4 Global step: 25600, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:25<01:11,  1.78it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:54,  2.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:43,  2.89it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:35,  3.54it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:29,  4.15it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:25,  4.78it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:22,  5.35it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:20,  5.80it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:19,  6.24it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:17,  6.56it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  6.97it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.13it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.25it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.26it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.20it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.26it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.31it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.31it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.27it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.05it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.21it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.23it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.27it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.28it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.26it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.23it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.16it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.20it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.21it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.24it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.06it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:12,  7.06it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:12,  6.99it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.07it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.14it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.34it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.22it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:40:20,516 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:40:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:40:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:40:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:40:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:40:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:40:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4481287541235995, 'eval_loss': 1.0247073, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1273, 1500, 1412, 1363, 1179, 875, 620, 827, 1290, 523, 1673], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51292152, 'remaining_params': 33725448, 'pruned_model_sparsity': 0.6033121612466125, 'expected_sparsity': 0.6006, 'target_sparsity': 0.6, 'step': 25650}


Iteration:  71%|███████   | 190/268 [00:34<00:58,  1.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:43,  1.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:33,  2.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:26,  2.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:20,  3.53it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:17,  4.15it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:15,  4.73it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:13,  5.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:11,  5.88it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.36it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:10,  6.74it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  6.78it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  6.97it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.09it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.23it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.32it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.27it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  7.07it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.14it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.18it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.20it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.08it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.02it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.10it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.91it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.01it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.21it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.21it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.22it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.23it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.23it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.21it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.25it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.22it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.15it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.17it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.12it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.20it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.18it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.18it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.09it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 14:40:29,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:40:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:40:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:40:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:40:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:40:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:40:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4531370540010336, 'eval_loss': 1.0303862, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1273, 1501, 1413, 1363, 1179, 876, 621, 829, 1290, 524, 1668], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51290620, 'remaining_params': 33726980, 'pruned_model_sparsity': 0.6032941414483589, 'expected_sparsity': 0.60042, 'target_sparsity': 0.6, 'step': 25700}


Iteration:  90%|████████▉ | 240/268 [00:43<00:21,  1.33it/s][A04/21/2024 14:40:31 - INFO - trainer.trainer_mod - v4 Global step: 25700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:43<00:15,  1.75it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:11,  2.27it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:08,  2.87it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:06,  3.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:05,  4.15it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:04,  4.78it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  5.26it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  5.75it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:03,  6.18it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.76it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.13it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.05it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.16it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.08it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.11it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.18it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.09it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.15it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.22it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.26it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.25it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.80it/s][A04/21/2024 14:40:35 - INFO - trainer.trainer_mod - Epoch 95 finished. Took 47.19 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  96%|█████████▌| 96/100 [1:16:37<03:11, 47.82s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.47it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.37it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.34it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.37it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.35it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.23it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.27it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.37it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.34it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 14:40:38,330 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:40:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:40:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:40:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:40:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 14:40:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:40:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4505173993303405, 'eval_loss': 1.0569066, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1273, 1501, 1413, 1363, 1180, 876, 622, 831, 1294, 528, 1681], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51250788, 'remaining_params': 33766812, 'pruned_model_sparsity': 0.6028256266937669, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 25750}


Iteration:   8%|▊         | 22/268 [00:05<03:02,  1.35it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:17,  1.78it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:45,  2.31it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:24,  2.87it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:09,  3.47it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:57,  4.19it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:49,  4.81it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:44,  5.39it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:40,  5.87it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.20it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.69it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.81it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.90it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.05it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.03it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.15it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.95it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.14it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.15it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.20it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.13it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.14it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.04it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.99it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.05it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.25it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.09it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.11it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.18it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.11it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.14it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.10it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.08it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.17it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.09it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.11it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.14it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.29it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.27it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.25it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.25it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.26it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.11it/s][A[INFO|trainer.py:570] 2024-04-21 14:40:47,321 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:40:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:40:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:40:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:40:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:40:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:40:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44753468131064017, 'eval_loss': 1.063815, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1273, 1501, 1413, 1363, 1181, 877, 623, 833, 1297, 531, 1698], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51207892, 'remaining_params': 33809708, 'pruned_model_sparsity': 0.6023210723426679, 'expected_sparsity': 0.59934, 'target_sparsity': 0.6, 'step': 25800}


Iteration:  27%|██▋       | 72/268 [00:14<02:26,  1.34it/s][A04/21/2024 14:40:49 - INFO - trainer.trainer_mod - v4 Global step: 25800, Alignment: tensor([1, 3, 7, 9], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:14<01:50,  1.77it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<01:24,  2.30it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:06,  2.89it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:54,  3.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:45,  4.17it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:39,  4.77it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:35,  5.28it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:32,  5.79it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:32,  5.79it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:29,  6.21it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.46it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.72it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.05it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.18it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.20it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.13it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.17it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.09it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.04it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.01it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  6.99it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.98it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.24it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.26it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.27it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.30it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.30it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.30it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.24it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.28it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.29it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.31it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.24it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.31it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.29it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.15it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:21,  7.09it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.15it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 14:40:56,276 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:40:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:40:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:40:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:40:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:40:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:40:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44791344231403457, 'eval_loss': 1.017695, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1274, 1501, 1412, 1363, 1180, 877, 623, 833, 1293, 530, 1686], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51235468, 'remaining_params': 33782132, 'pruned_model_sparsity': 0.6026454287112316, 'expected_sparsity': 0.59966, 'target_sparsity': 0.6, 'step': 25850}


Iteration:  46%|████▌     | 122/268 [00:22<01:48,  1.34it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<01:21,  1.77it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<01:03,  2.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:50,  2.85it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:40,  3.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:33,  4.19it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:29,  4.73it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:26,  5.19it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:24,  5.71it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:22,  6.16it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.85it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  7.01it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.03it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.12it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.16it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.12it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:18,  7.13it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  7.10it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.06it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.76it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.92it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.01it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  6.96it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.05it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.21it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.25it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.20it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.02it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.09it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  6.97it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.07it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.16it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.03it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.28it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.06it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.15it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.18it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.06it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 14:41:05,269 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:41:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:41:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:41:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:41:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:41:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:41:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4507129896372791, 'eval_loss': 1.0233111, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1274, 1500, 1411, 1361, 1179, 876, 622, 830, 1287, 526, 1668], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51293684, 'remaining_params': 33723916, 'pruned_model_sparsity': 0.603330181044866, 'expected_sparsity': 0.60036, 'target_sparsity': 0.6, 'step': 25900}


Iteration:  64%|██████▍   | 172/268 [00:31<01:11,  1.34it/s][A04/21/2024 14:41:07 - INFO - trainer.trainer_mod - v4 Global step: 25900, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:32<00:53,  1.77it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:41,  2.29it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:32,  2.87it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:26,  3.53it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:21,  4.16it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:18,  4.83it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:16,  5.50it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:14,  5.96it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.33it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.66it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.90it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.06it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.04it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.02it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.09it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  7.15it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.20it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.24it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.18it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.14it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.19it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.19it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.40it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  6.93it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  6.83it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  6.93it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  6.94it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  6.93it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:09,  7.00it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:09,  6.96it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  6.93it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.01it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.98it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.08it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.93it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.15it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.20it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.32it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.20it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.23it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.16it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.20it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 14:41:14,247 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:41:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:41:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:41:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:41:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:41:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:41:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.439472886967031, 'eval_loss': 1.0808718, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1273, 1499, 1409, 1361, 1179, 877, 621, 828, 1283, 524, 1664], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51318196, 'remaining_params': 33699404, 'pruned_model_sparsity': 0.6036184978169226, 'expected_sparsity': 0.60073, 'target_sparsity': 0.6, 'step': 25950}


Iteration:  83%|████████▎ | 222/268 [00:40<00:34,  1.34it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:25,  1.78it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:19,  2.28it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:14,  2.88it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:11,  3.53it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:09,  4.11it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:08,  4.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:07,  5.37it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:06,  5.88it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.29it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.69it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.20it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.21it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.23it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.02it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.13it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.16it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.00it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.27it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.44it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.26it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.19it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.00it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.07it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.12it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.14it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.20it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.25it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.26it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.45it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.33it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.32it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.48it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.56it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.39it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.97it/s][A04/21/2024 14:41:22 - INFO - trainer.trainer_mod - Epoch 96 finished. Took 47.2 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  97%|█████████▋| 97/100 [1:17:24<02:22, 47.64s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.93it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.60it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 14:41:23,080 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:41:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:41:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:41:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:41:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:41:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:41:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44753468131064017, 'eval_loss': 1.0712647, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1414, 1272, 1498, 1408, 1361, 1178, 877, 621, 829, 1286, 529, 1681], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51286024, 'remaining_params': 33731576, 'pruned_model_sparsity': 0.6032400820535984, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 26000}


Iteration:   1%|▏         | 4/268 [00:02<04:06,  1.07it/s][A04/21/2024 14:41:25 - INFO - trainer.trainer_mod - v4 Global step: 26000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:50,  1.55it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:03,  2.12it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:34,  2.76it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:15,  3.43it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:02,  4.13it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:54,  4.74it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:47,  5.43it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:44,  5.76it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:41,  6.18it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:38,  6.55it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:38,  6.64it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:37,  6.69it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.88it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  7.01it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:35,  7.09it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.14it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.18it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.04it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.10it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.17it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  6.99it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  6.95it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.93it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.94it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.03it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.04it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.07it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.12it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.17it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.19it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.03it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.96it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.02it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.98it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.07it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.13it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.22it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.17it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.29it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.24it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.24it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.13it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.16it/s][A[INFO|trainer.py:570] 2024-04-21 14:41:32,092 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:41:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:41:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:41:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:41:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:41:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:41:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4430056251607798, 'eval_loss': 1.075386, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1415, 1272, 1498, 1408, 1362, 1179, 877, 622, 832, 1293, 536, 1712], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51206360, 'remaining_params': 33811240, 'pruned_model_sparsity': 0.6023030525444143, 'expected_sparsity': 0.59927, 'target_sparsity': 0.6, 'step': 26050}


Iteration:  20%|██        | 54/268 [00:11<02:40,  1.34it/s][A
Iteration:  21%|██        | 55/268 [00:11<02:00,  1.77it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:32,  2.30it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<01:12,  2.92it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:58,  3.56it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:49,  4.22it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:42,  4.86it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:38,  5.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:34,  5.92it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.24it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:30,  6.71it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:29,  6.82it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:29,  6.79it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:29,  6.80it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  6.96it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:28,  6.89it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  7.01it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:28,  6.93it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.19it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.16it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.18it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.15it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.16it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.19it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.17it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.23it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.23it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.28it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.29it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.26it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.12it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.92it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.04it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.09it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.98it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.05it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.02it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.03it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.08it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.03it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.10it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 14:41:41,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:41:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:41:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:41:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:41:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:41:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:41:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4481287541235995, 'eval_loss': 1.0610214, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1272, 1498, 1407, 1362, 1179, 877, 622, 831, 1295, 540, 1715], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51194104, 'remaining_params': 33823496, 'pruned_model_sparsity': 0.6021588941583861, 'expected_sparsity': 0.59919, 'target_sparsity': 0.6, 'step': 26100}


Iteration:  39%|███▉      | 104/268 [00:20<02:02,  1.34it/s][A04/21/2024 14:41:43 - INFO - trainer.trainer_mod - v4 Global step: 26100, Alignment: tensor([2, 3, 7, 8], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:20<01:31,  1.78it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<01:10,  2.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:55,  2.90it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:45,  3.56it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:38,  4.13it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:32,  4.83it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:29,  5.34it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:26,  5.82it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.23it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:22,  6.70it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:22,  6.74it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:21,  6.87it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:21,  6.88it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  6.99it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.99it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.98it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:20,  6.96it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  7.24it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  7.15it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:20,  7.10it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  7.10it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.14it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.19it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.21it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.24it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:18,  7.24it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.26it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.25it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.15it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.15it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.21it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.40it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.34it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.28it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.34it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.29it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.12it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.14it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.29it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.31it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.18it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.24it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.08it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.14it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 14:41:50,015 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:41:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:41:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:41:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:41:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:41:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:41:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4544455053417749, 'eval_loss': 1.0343714, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1272, 1498, 1408, 1362, 1179, 877, 622, 830, 1289, 536, 1685], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51255384, 'remaining_params': 33762216, 'pruned_model_sparsity': 0.6028796860885276, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 26150}


Iteration:  57%|█████▋    | 154/268 [00:29<01:24,  1.34it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<01:03,  1.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:48,  2.30it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:38,  2.90it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:30,  3.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:25,  4.20it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:22,  4.84it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:19,  5.41it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:17,  5.89it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.43it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.78it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.90it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:13,  7.14it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.39it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.37it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  7.22it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:12,  7.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.16it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.96it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.04it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.98it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.98it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  7.03it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  7.13it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.22it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.12it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.19it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.05it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  6.93it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  7.01it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.96it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  7.06it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.13it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  7.00it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.27it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  7.20it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.15it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.29it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.18it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.37it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.19it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 14:41:58,967 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:41:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:41:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:41:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:41:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 14:42:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:42:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44229349485124575, 'eval_loss': 1.0378748, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1272, 1498, 1408, 1363, 1179, 878, 622, 830, 1282, 533, 1647], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51325856, 'remaining_params': 33691744, 'pruned_model_sparsity': 0.6037085968081903, 'expected_sparsity': 0.60085, 'target_sparsity': 0.6, 'step': 26200}


Iteration:  76%|███████▌  | 204/268 [00:38<00:47,  1.34it/s][A04/21/2024 14:42:01 - INFO - trainer.trainer_mod - v4 Global step: 26200, Alignment: tensor([2, 3, 7, 8], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:38<00:35,  1.77it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:26,  2.30it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:21,  2.89it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:17,  3.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:14,  4.11it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:12,  4.65it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:11,  5.18it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:09,  5.76it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.17it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.51it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.72it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.80it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.71it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.84it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.94it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.02it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.09it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.02it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.98it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.97it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  7.06it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.09it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.25it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.27it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.29it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.05it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  7.13it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.20it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.23it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  7.23it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.33it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.93it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.00it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.10it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.12it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  7.28it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.38it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 14:42:07,922 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:42:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:42:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:42:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:42:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:42:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:42:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44581075604527515, 'eval_loss': 1.0494906, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1272, 1498, 1409, 1365, 1180, 879, 624, 832, 1283, 533, 1652], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51302876, 'remaining_params': 33714724, 'pruned_model_sparsity': 0.6034382998343872, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 26250}


Iteration:  95%|█████████▍| 254/268 [00:47<00:10,  1.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:07,  1.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:05,  2.30it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:03,  2.91it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:02,  3.53it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:02,  4.19it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  4.83it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  5.35it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:01,  5.77it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.18it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.44it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.62it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.75it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.91it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.48it/s][A04/21/2024 14:42:11 - INFO - trainer.trainer_mod - Epoch 97 finished. Took 49.31 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.44it/s]
Epoch:  98%|█████████▊| 98/100 [1:18:14<01:36, 48.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.20it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.42it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.21it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.26it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.15it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.18it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.18it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.13it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.02it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.11it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.14it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.20it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.21it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.14it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.15it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.21it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.03it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:35,  6.90it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.18it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.08it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.11it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.33it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.26it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:32,  7.25it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.86it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.86it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.82it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.96it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:33,  7.05it/s][A[INFO|trainer.py:570] 2024-04-21 14:42:16,909 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:42:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:42:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:42:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:42:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:42:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:42:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44791344231403457, 'eval_loss': 1.0602831, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1416, 1271, 1498, 1408, 1365, 1181, 879, 625, 835, 1288, 538, 1667], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51259980, 'remaining_params': 33757620, 'pruned_model_sparsity': 0.6029337454832882, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 26300}


Iteration:  13%|█▎        | 36/268 [00:07<02:53,  1.34it/s][A04/21/2024 14:42:18 - INFO - trainer.trainer_mod - v4 Global step: 26300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:09,  1.78it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:39,  2.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:18,  2.91it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:04,  3.54it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:54,  4.18it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:47,  4.77it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:42,  5.34it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:37,  5.96it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:34,  6.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.76it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.83it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.98it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.10it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  7.00it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.98it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.10it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.16it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.13it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.15it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.09it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.05it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.03it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.96it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.06it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.95it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.05it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.10it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.13it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.18it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.17it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.11it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.08it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.14it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.19it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.01it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.10it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:27,  6.98it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.97it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.06it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.10it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.16it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  6.96it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.09it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 14:42:25,898 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:42:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:42:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:42:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:42:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 14:42:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:42:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4392663684224782, 'eval_loss': 1.074465, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1271, 1496, 1407, 1366, 1181, 879, 624, 834, 1292, 540, 1677], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51240064, 'remaining_params': 33777536, 'pruned_model_sparsity': 0.6026994881059922, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 26350}


Iteration:  32%|███▏      | 86/268 [00:16<02:15,  1.34it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:41,  1.78it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:18,  2.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<01:02,  2.87it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:50,  3.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:42,  4.15it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:36,  4.79it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:32,  5.34it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:30,  5.78it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:27,  6.29it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.80it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.95it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.99it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.96it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.14it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.16it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.18it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.17it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.09it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.10it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.06it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.01it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.08it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.15it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.17it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.19it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.19it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:19,  7.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.23it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.36it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.21it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.23it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.14it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.18it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.12it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.29it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 14:42:34,861 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:42:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:42:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:42:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:42:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 14:42:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:42:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4449061312549573, 'eval_loss': 1.0585303, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1271, 1496, 1407, 1366, 1180, 879, 624, 834, 1289, 538, 1664], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51269172, 'remaining_params': 33748428, 'pruned_model_sparsity': 0.6030418642728094, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 26400}


Iteration:  51%|█████     | 136/268 [00:25<01:38,  1.34it/s][A04/21/2024 14:42:36 - INFO - trainer.trainer_mod - v4 Global step: 26400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:25<01:14,  1.77it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:57,  2.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:44,  2.87it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:36,  3.49it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:30,  4.16it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:26,  4.75it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:23,  5.28it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:21,  5.77it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.27it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:18,  6.67it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.76it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.89it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.67it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.94it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.98it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.08it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  7.00it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.11it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.18it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.41it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.37it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.37it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.15it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.20it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.27it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.23it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.23it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.86it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  6.97it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.83it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  6.96it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  6.91it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.11it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:13,  7.04it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.03it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:13,  6.92it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.04it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.37it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.23it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.42it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 14:42:43,862 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:42:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:42:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:42:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:42:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 14:42:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:42:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4427517864666164, 'eval_loss': 1.0339329, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1271, 1496, 1406, 1366, 1180, 879, 623, 833, 1284, 535, 1647], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51312068, 'remaining_params': 33705532, 'pruned_model_sparsity': 0.6035464186239085, 'expected_sparsity': 0.60035, 'target_sparsity': 0.6, 'step': 26450}


Iteration:  69%|██████▉   | 186/268 [00:34<01:00,  1.35it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:45,  1.79it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:34,  2.32it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:27,  2.91it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:21,  3.57it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:18,  4.23it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:15,  4.86it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:13,  5.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:12,  5.95it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:11,  6.30it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.57it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.81it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.94it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.02it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.30it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.26it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.26it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.09it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.14it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.27it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.33it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.32it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.27it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.10it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.29it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.42it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.35it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.37it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.26it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.26it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.24it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.23it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.26it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.08it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.92it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.06it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.07it/s][A[INFO|trainer.py:570] 2024-04-21 14:42:52,772 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:42:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:42:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:42:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:42:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]04/21/2024 14:42:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:42:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4427517864666164, 'eval_loss': 1.0338147, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1271, 1496, 1405, 1365, 1179, 878, 623, 833, 1283, 536, 1643], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51324324, 'remaining_params': 33693276, 'pruned_model_sparsity': 0.6036905770099368, 'expected_sparsity': 0.6006, 'target_sparsity': 0.6, 'step': 26500}


Iteration:  88%|████████▊ | 236/268 [00:42<00:23,  1.34it/s][A04/21/2024 14:42:54 - INFO - trainer.trainer_mod - v4 Global step: 26500, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:43<00:17,  1.77it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:13,  2.30it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:10,  2.87it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:07,  3.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:06,  4.18it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:05,  4.87it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  5.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:04,  5.90it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.27it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.75it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.70it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.94it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.92it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.15it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.08it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.13it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.20it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.10it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.13it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.17it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.23it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.28it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.44it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.19it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.36it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.16it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.76it/s][A04/21/2024 14:42:59 - INFO - trainer.trainer_mod - Epoch 98 finished. Took 47.29 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  99%|█████████▉| 99/100 [1:19:01<00:47, 47.89s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.20it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.40it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.38it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.37it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.45it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.12it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.04it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.02it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.09it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.04it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.02it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.09it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.16it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 14:43:01,648 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:43:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:43:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:43:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:43:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:43:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:43:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44510697839859065, 'eval_loss': 1.0560918, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1270, 1494, 1404, 1364, 1178, 878, 623, 836, 1290, 541, 1679], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51255384, 'remaining_params': 33762216, 'pruned_model_sparsity': 0.6028796860885276, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 26550}


Iteration:   7%|▋         | 18/268 [00:04<03:06,  1.34it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:20,  1.77it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:47,  2.31it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:24,  2.91it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:09,  3.56it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:58,  4.22it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:50,  4.82it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:44,  5.41it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:40,  5.98it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:38,  6.18it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:36,  6.49it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.65it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.83it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.86it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  6.99it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.03it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.98it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.09it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.27it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.12it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.13it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.20it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.23it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.11it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.07it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.98it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.09it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.03it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  7.00it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.10it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.06it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.15it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.18it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.20it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.22it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  7.00it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.18it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.18it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.08it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.15it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.13it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.33it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.31it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 14:43:10,618 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:43:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:43:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:43:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:43:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:43:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:43:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4477152744261397, 'eval_loss': 1.0654397, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1271, 1494, 1404, 1365, 1178, 879, 624, 838, 1298, 548, 1698], 'head_nums': [2, 3, 2, 2, 9, 11, 8, 7, 4, 3, 2, 12], 'pruned_params': 51194104, 'remaining_params': 33823496, 'pruned_model_sparsity': 0.6021588941583861, 'expected_sparsity': 0.5991, 'target_sparsity': 0.6, 'step': 26600}


Iteration:  25%|██▌       | 68/268 [00:13<02:28,  1.34it/s][A04/21/2024 14:43:12 - INFO - trainer.trainer_mod - v4 Global step: 26600, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:51,  1.78it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:26,  2.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:07,  2.90it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:55,  3.54it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:46,  4.20it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:40,  4.73it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:36,  5.32it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:34,  5.57it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:32,  5.96it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.39it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.78it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.93it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.03it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.08it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.27it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.16it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.09it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.13it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.42it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.21it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.20it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.09it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.09it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.99it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.04it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.99it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.08it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.26it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.26it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.27it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.27it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.27it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.24it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.17it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.13it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.19it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.19it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.02it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.24it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.28it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.18it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 14:43:19,565 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:43:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:43:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:43:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:43:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 14:43:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:43:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44791344231403457, 'eval_loss': 1.0485255, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1270, 1495, 1404, 1365, 1179, 881, 625, 838, 1293, 543, 1680], 'head_nums': [2, 3, 2, 2, 9, 11, 9, 7, 4, 3, 2, 12], 'pruned_params': 51034776, 'remaining_params': 33982824, 'pruned_model_sparsity': 0.6002848351400181, 'expected_sparsity': 0.59929, 'target_sparsity': 0.6, 'step': 26650}


Iteration:  44%|████▍     | 118/268 [00:22<01:51,  1.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<01:23,  1.78it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<01:04,  2.31it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:50,  2.89it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:41,  3.54it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:34,  4.21it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:29,  4.84it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:26,  5.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:23,  5.95it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.79it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.94it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  6.95it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  7.21it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.13it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.14it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.19it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.12it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.16it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.19it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.22it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.25it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.22it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.22it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.16it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.36it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.33it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.14it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.17it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.97it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.35it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.16it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  6.98it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.93it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.91it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.01it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.09it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:15,  7.10it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.14it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  7.05it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.16it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.40it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.48it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.31it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 14:43:28,488 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:43:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:43:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:43:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:43:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 14:43:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:43:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4453249733137911, 'eval_loss': 1.0371692, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1270, 1495, 1404, 1365, 1178, 880, 624, 834, 1279, 534, 1638], 'head_nums': [2, 3, 2, 2, 9, 11, 9, 7, 4, 3, 2, 12], 'pruned_params': 51145080, 'remaining_params': 33872520, 'pruned_model_sparsity': 0.6015822606142728, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 26700}


Iteration:  63%|██████▎   | 168/268 [00:31<01:14,  1.34it/s][A04/21/2024 14:43:30 - INFO - trainer.trainer_mod - v4 Global step: 26700, Alignment: tensor([2, 3, 7, 9], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:31<00:55,  1.78it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:42,  2.30it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:33,  2.90it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:27,  3.54it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:22,  4.19it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:19,  4.91it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:16,  5.48it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:15,  5.91it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:14,  6.28it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.53it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.72it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.90it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.88it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.94it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.06it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.15it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.33it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.48it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.35it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.27it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.81it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.12it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.24it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  7.20it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.28it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.36it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.25it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:08,  7.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.43it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.17it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.32it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.49it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.50it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.52it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.34it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.30it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 14:43:37,333 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:43:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:43:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:43:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:43:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:43:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:43:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4453249733137911, 'eval_loss': 1.0365639, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1417, 1270, 1494, 1404, 1365, 1177, 880, 623, 832, 1272, 531, 1616], 'head_nums': [2, 3, 2, 2, 9, 11, 9, 7, 4, 3, 2, 12], 'pruned_params': 51201764, 'remaining_params': 33815836, 'pruned_model_sparsity': 0.6022489931496537, 'expected_sparsity': 0.60138, 'target_sparsity': 0.6, 'step': 26750}


Iteration:  81%|████████▏ | 218/268 [00:40<00:36,  1.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:27,  1.79it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:20,  2.30it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:16,  2.90it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:12,  3.55it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:10,  4.21it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:08,  4.94it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:07,  5.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:07,  5.86it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.23it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.68it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.90it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.96it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.11it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.23it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.33it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.69it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.49it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.39it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.41it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.49it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.33it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.32it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.24it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.43it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.52it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 14:43:46,059 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 14:43:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 14:43:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 14:43:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 14:43:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 14:43:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 14:43:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44791344231403457, 'eval_loss': 1.0483544, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1418, 1270, 1493, 1403, 1365, 1176, 880, 623, 835, 1282, 540, 1650], 'head_nums': [2, 3, 2, 2, 9, 11, 9, 7, 5, 3, 2, 12], 'pruned_params': 50922940, 'remaining_params': 34094660, 'pruned_model_sparsity': 0.5989693898675098, 'expected_sparsity': 0.60037, 'target_sparsity': 0.6, 'step': 26800}


Iteration: 100%|██████████| 268/268 [00:48<00:00,  1.37it/s][A04/21/2024 14:43:48 - INFO - trainer.trainer_mod - Epoch 99 finished. Took 48.93 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.48it/s]
Epoch: 100%|██████████| 100/100 [1:19:50<00:00, 48.20s/it]Epoch: 100%|██████████| 100/100 [1:19:50<00:00, 47.90s/it]
[INFO|configuration_utils.py:439] 2024-04-21 14:43:48,113 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/config.json
[INFO|modeling_utils.py:1084] 2024-04-21 14:43:48,731 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-21 14:43:48,732 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-21 14:43:48,733 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.6/special_tokens_map.json
04/21/2024 14:43:48 - INFO - __main__ - Training took 4798.52 seconds.
