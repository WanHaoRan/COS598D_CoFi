Sat Mar 23 23:01:47 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/rte_0.6
nvidia-smi output:
Sat Mar 23 23:01:47 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:E3:00.0 Off |                    0 |
| N/A   38C    P0              39W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
03/23/2024 23:01:51 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
03/23/2024 23:01:51 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/runs/Mar23_23-01-51_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
03/23/2024 23:01:51 - INFO - __main__ - Model Arguments:
03/23/2024 23:01:51 - INFO - __main__ - model_name_or_path = bert-base-uncased
03/23/2024 23:01:51 - INFO - __main__ - config_name = None
03/23/2024 23:01:51 - INFO - __main__ - tokenizer_name = None
03/23/2024 23:01:51 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
03/23/2024 23:01:51 - INFO - __main__ - use_fast_tokenizer = True
03/23/2024 23:01:51 - INFO - __main__ - model_revision = main
03/23/2024 23:01:51 - INFO - __main__ - use_auth_token = False
03/23/2024 23:01:51 - INFO - __main__ - Data Arguments:
03/23/2024 23:01:51 - INFO - __main__ - task_name = rte
03/23/2024 23:01:51 - INFO - __main__ - dataset_name = None
03/23/2024 23:01:51 - INFO - __main__ - t_name = None
03/23/2024 23:01:51 - INFO - __main__ - dataset_config_name = None
03/23/2024 23:01:51 - INFO - __main__ - max_seq_length = 128
03/23/2024 23:01:51 - INFO - __main__ - overwrite_cache = False
03/23/2024 23:01:51 - INFO - __main__ - pad_to_max_length = True
03/23/2024 23:01:51 - INFO - __main__ - max_train_samples = None
03/23/2024 23:01:51 - INFO - __main__ - max_eval_samples = None
03/23/2024 23:01:51 - INFO - __main__ - max_predict_samples = None
03/23/2024 23:01:51 - INFO - __main__ - train_file = None
03/23/2024 23:01:51 - INFO - __main__ - validation_file = None
03/23/2024 23:01:51 - INFO - __main__ - test_file = None
03/23/2024 23:01:51 - INFO - __main__ - Training Arguments:
03/23/2024 23:01:51 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6
03/23/2024 23:01:51 - INFO - __main__ - overwrite_output_dir = True
03/23/2024 23:01:51 - INFO - __main__ - do_train = True
03/23/2024 23:01:51 - INFO - __main__ - do_eval = True
03/23/2024 23:01:51 - INFO - __main__ - do_predict = False
03/23/2024 23:01:51 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
03/23/2024 23:01:51 - INFO - __main__ - prediction_loss_only = False
03/23/2024 23:01:51 - INFO - __main__ - per_device_train_batch_size = 32
03/23/2024 23:01:51 - INFO - __main__ - per_device_eval_batch_size = 32
03/23/2024 23:01:51 - INFO - __main__ - per_gpu_train_batch_size = None
03/23/2024 23:01:51 - INFO - __main__ - per_gpu_eval_batch_size = None
03/23/2024 23:01:51 - INFO - __main__ - gradient_accumulation_steps = 1
03/23/2024 23:01:51 - INFO - __main__ - eval_accumulation_steps = None
03/23/2024 23:01:51 - INFO - __main__ - learning_rate = 2e-05
03/23/2024 23:01:51 - INFO - __main__ - weight_decay = 0.0
03/23/2024 23:01:51 - INFO - __main__ - adam_beta1 = 0.9
03/23/2024 23:01:51 - INFO - __main__ - adam_beta2 = 0.999
03/23/2024 23:01:51 - INFO - __main__ - adam_epsilon = 1e-08
03/23/2024 23:01:51 - INFO - __main__ - max_grad_norm = 1.0
03/23/2024 23:01:51 - INFO - __main__ - num_train_epochs = 100.0
03/23/2024 23:01:51 - INFO - __main__ - max_steps = -1
03/23/2024 23:01:51 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
03/23/2024 23:01:51 - INFO - __main__ - warmup_ratio = 0.0
03/23/2024 23:01:51 - INFO - __main__ - warmup_steps = 0
03/23/2024 23:01:51 - INFO - __main__ - log_level = -1
03/23/2024 23:01:51 - INFO - __main__ - log_level_replica = -1
03/23/2024 23:01:51 - INFO - __main__ - log_on_each_node = True
03/23/2024 23:01:51 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/runs/Mar23_23-01-51_adroit-h11g2
03/23/2024 23:01:51 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
03/23/2024 23:01:51 - INFO - __main__ - logging_first_step = False
03/23/2024 23:01:51 - INFO - __main__ - logging_steps = 100
03/23/2024 23:01:51 - INFO - __main__ - logging_nan_inf_filter = True
03/23/2024 23:01:51 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
03/23/2024 23:01:51 - INFO - __main__ - save_steps = 0
03/23/2024 23:01:51 - INFO - __main__ - save_total_limit = None
03/23/2024 23:01:51 - INFO - __main__ - save_on_each_node = False
03/23/2024 23:01:51 - INFO - __main__ - no_cuda = False
03/23/2024 23:01:51 - INFO - __main__ - seed = 57
03/23/2024 23:01:51 - INFO - __main__ - bf16 = False
03/23/2024 23:01:51 - INFO - __main__ - fp16 = False
03/23/2024 23:01:51 - INFO - __main__ - fp16_opt_level = O1
03/23/2024 23:01:51 - INFO - __main__ - half_precision_backend = auto
03/23/2024 23:01:51 - INFO - __main__ - bf16_full_eval = False
03/23/2024 23:01:51 - INFO - __main__ - fp16_full_eval = False
03/23/2024 23:01:51 - INFO - __main__ - tf32 = None
03/23/2024 23:01:51 - INFO - __main__ - local_rank = -1
03/23/2024 23:01:51 - INFO - __main__ - xpu_backend = None
03/23/2024 23:01:51 - INFO - __main__ - tpu_num_cores = None
03/23/2024 23:01:51 - INFO - __main__ - tpu_metrics_debug = False
03/23/2024 23:01:51 - INFO - __main__ - debug = []
03/23/2024 23:01:51 - INFO - __main__ - dataloader_drop_last = False
03/23/2024 23:01:51 - INFO - __main__ - eval_steps = 50
03/23/2024 23:01:51 - INFO - __main__ - dataloader_num_workers = 0
03/23/2024 23:01:51 - INFO - __main__ - past_index = -1
03/23/2024 23:01:51 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6
03/23/2024 23:01:51 - INFO - __main__ - disable_tqdm = False
03/23/2024 23:01:51 - INFO - __main__ - remove_unused_columns = True
03/23/2024 23:01:51 - INFO - __main__ - label_names = None
03/23/2024 23:01:51 - INFO - __main__ - load_best_model_at_end = False
03/23/2024 23:01:51 - INFO - __main__ - metric_for_best_model = None
03/23/2024 23:01:51 - INFO - __main__ - greater_is_better = None
03/23/2024 23:01:51 - INFO - __main__ - ignore_data_skip = False
03/23/2024 23:01:51 - INFO - __main__ - sharded_ddp = []
03/23/2024 23:01:51 - INFO - __main__ - deepspeed = None
03/23/2024 23:01:51 - INFO - __main__ - label_smoothing_factor = 0.0
03/23/2024 23:01:51 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
03/23/2024 23:01:51 - INFO - __main__ - adafactor = False
03/23/2024 23:01:51 - INFO - __main__ - group_by_length = False
03/23/2024 23:01:51 - INFO - __main__ - length_column_name = length
03/23/2024 23:01:51 - INFO - __main__ - report_to = []
03/23/2024 23:01:51 - INFO - __main__ - ddp_find_unused_parameters = None
03/23/2024 23:01:51 - INFO - __main__ - ddp_bucket_cap_mb = None
03/23/2024 23:01:51 - INFO - __main__ - dataloader_pin_memory = True
03/23/2024 23:01:51 - INFO - __main__ - skip_memory_metrics = True
03/23/2024 23:01:51 - INFO - __main__ - use_legacy_prediction_loop = False
03/23/2024 23:01:51 - INFO - __main__ - push_to_hub = False
03/23/2024 23:01:51 - INFO - __main__ - resume_from_checkpoint = None
03/23/2024 23:01:51 - INFO - __main__ - hub_model_id = None
03/23/2024 23:01:51 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
03/23/2024 23:01:51 - INFO - __main__ - hub_token = None
03/23/2024 23:01:51 - INFO - __main__ - gradient_checkpointing = False
03/23/2024 23:01:51 - INFO - __main__ - fp16_backend = auto
03/23/2024 23:01:51 - INFO - __main__ - push_to_hub_model_id = None
03/23/2024 23:01:51 - INFO - __main__ - push_to_hub_organization = None
03/23/2024 23:01:51 - INFO - __main__ - push_to_hub_token = None
03/23/2024 23:01:51 - INFO - __main__ - mp_parameters = 
03/23/2024 23:01:51 - INFO - __main__ - _n_gpu = 1
03/23/2024 23:01:51 - INFO - __main__ - __cached__setup_devices = cuda:0
03/23/2024 23:01:51 - INFO - __main__ - Additional Arguments:
03/23/2024 23:01:51 - INFO - __main__ - test = False
03/23/2024 23:01:51 - INFO - __main__ - ex_name = RTE_sparsity0.6
03/23/2024 23:01:51 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
03/23/2024 23:01:51 - INFO - __main__ - reg_learning_rate = 0.01
03/23/2024 23:01:51 - INFO - __main__ - scheduler_type = linear
03/23/2024 23:01:51 - INFO - __main__ - freeze_embeddings = True
03/23/2024 23:01:51 - INFO - __main__ - pretrained_pruned_model = None
03/23/2024 23:01:51 - INFO - __main__ - droprate_init = 0.5
03/23/2024 23:01:51 - INFO - __main__ - temperature = 0.6666666666666666
03/23/2024 23:01:51 - INFO - __main__ - prepruning_finetune_epochs = 4
03/23/2024 23:01:51 - INFO - __main__ - lagrangian_warmup_epochs = 20
03/23/2024 23:01:51 - INFO - __main__ - target_sparsity = 0.6
03/23/2024 23:01:51 - INFO - __main__ - sparsity_epsilon = 0
03/23/2024 23:01:51 - INFO - __main__ - distillation_path = textattack/bert-base-uncased-RTE
03/23/2024 23:01:51 - INFO - __main__ - do_distill = True
03/23/2024 23:01:51 - INFO - __main__ - do_layer_distill = True
03/23/2024 23:01:51 - INFO - __main__ - layer_distill_version = 4
03/23/2024 23:01:51 - INFO - __main__ - distill_loss_alpha = 0.9
03/23/2024 23:01:51 - INFO - __main__ - distill_ce_loss_alpha = 0.1
03/23/2024 23:01:51 - INFO - __main__ - distill_temp = 2.0
03/23/2024 23:01:51 - INFO - datasets.builder - Overwrite dataset info from restored data version.
03/23/2024 23:01:51 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
03/23/2024 23:01:51 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
03/23/2024 23:01:51 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 727.50it/s]
[INFO|configuration_utils.py:648] 2024-03-23 23:01:51,421 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 23:01:51,421 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "rte",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-03-23 23:01:51,423 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 23:01:51,423 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-03-23 23:01:51,426 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-03-23 23:01:51,426 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-03-23 23:01:51,426 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-03-23 23:01:51,426 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-03-23 23:01:51,429 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 23:01:51,429 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
03/23/2024 23:02:00 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
03/23/2024 23:02:00 - INFO - __main__ - Model size: 85054464
03/23/2024 23:02:00 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x1493d1bdde50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
03/23/2024 23:02:00 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
03/23/2024 23:02:00 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x1493d1bddd30> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 23:02:00 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
03/23/2024 23:02:00 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x1493d1bdde50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 23:02:00 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
03/23/2024 23:02:00 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The CBS Evening News commentary segment "Free Speech" , which made its debut with Katie Couric this month, was accused last Friday by Bill Maher of HBO\'s "Real Time with Bill Maher" of being "anything but free speech". Maher said he was asked by CBS News to appear on the segment. But when he asked if he could talk about religion, "that was a dealbreaker from the start". Instead, he said they would send over a list of "acceptable topics". CBS News executive producer Rome Hartman has since responded in an e-mail to TVNewser saying that, "Bill Maher was never told that he couldn\'t discuss religion in a Free Speech segment," and added, "In fact, Free Speech has already addressed religion and we expect others will in the future."', 'sentence2': 'Free Speech is a part of the CBS Evening News.', 'label': 0, 'idx': 2105, 'input_ids': [101, 1996, 6568, 3944, 2739, 8570, 6903, 1000, 2489, 4613, 1000, 1010, 2029, 2081, 2049, 2834, 2007, 9734, 2522, 9496, 2278, 2023, 3204, 1010, 2001, 5496, 2197, 5958, 2011, 3021, 5003, 5886, 1997, 14633, 1005, 1055, 1000, 2613, 2051, 2007, 3021, 5003, 5886, 1000, 1997, 2108, 1000, 2505, 2021, 2489, 4613, 1000, 1012, 5003, 5886, 2056, 2002, 2001, 2356, 2011, 6568, 2739, 2000, 3711, 2006, 1996, 6903, 1012, 2021, 2043, 2002, 2356, 2065, 2002, 2071, 2831, 2055, 4676, 1010, 1000, 2008, 2001, 1037, 3066, 21204, 2013, 1996, 2707, 1000, 1012, 2612, 1010, 2002, 2056, 2027, 2052, 4604, 2058, 1037, 2862, 1997, 1000, 11701, 7832, 1000, 1012, 6568, 2739, 3237, 3135, 4199, 26766, 2038, 2144, 5838, 102, 2489, 4613, 2003, 1037, 2112, 1997, 1996, 6568, 3944, 2739, 1012, 102], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}.
03/23/2024 23:02:00 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': "He said those three detainees are Khalid Sheikh Mohammed - one of the architects of the September 11th attacks on New York and Washington, Abu Zubaydah - who is believed to have been a top al-Qaida strategist, and Abd al-Rahim al-Nashiri - who is believed to have played a key role in the bombing of the USS Cole. All three are being held at the U.S. detention facility at Guantanamo Bay. Hayden said waterboarding was used against the three detainees nearly five years ago because of circumstances at the time, including the belief that additional attacks against the United States were imminent. Hayden defended the CIA's use of extreme interrogation techniques as lawful, and urged lawmakers not to impose restrictions on such methods. Congress is considering legislation that would restrict the CIA to using only the interrogation techniques authorized by the U.S. Army's field manual, which does not include waterboarding.", 'sentence2': 'Abu Zubaydah belongs to al-Qaida.', 'label': 0, 'idx': 1315, 'input_ids': [101, 2002, 2056, 2216, 2093, 26485, 2024, 21828, 12840, 12619, 1011, 2028, 1997, 1996, 8160, 1997, 1996, 2244, 6252, 4491, 2006, 2047, 2259, 1998, 2899, 1010, 8273, 16950, 15907, 18417, 1011, 2040, 2003, 3373, 2000, 2031, 2042, 1037, 2327, 2632, 1011, 1053, 14326, 2050, 2358, 11657, 24063, 1010, 1998, 19935, 2632, 1011, 10958, 14341, 2632, 1011, 10594, 15735, 1011, 2040, 2003, 3373, 2000, 2031, 2209, 1037, 3145, 2535, 1999, 1996, 8647, 1997, 1996, 7234, 5624, 1012, 2035, 2093, 2024, 2108, 2218, 2012, 1996, 1057, 1012, 1055, 1012, 12345, 4322, 2012, 23094, 3016, 1012, 13872, 2056, 2300, 21172, 2001, 2109, 2114, 1996, 2093, 26485, 3053, 2274, 2086, 3283, 2138, 1997, 6214, 2012, 1996, 2051, 1010, 102, 8273, 16950, 15907, 18417, 7460, 2000, 2632, 1011, 1053, 14326, 2050, 1012, 102], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}.
03/23/2024 23:02:00 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "Please note that Arabic is the language of Quran so it's better to learn it to understand clearly all the miracles in Quran.", 'sentence2': 'Arabic is the language of the Quran.', 'label': 0, 'idx': 1955, 'input_ids': [101, 3531, 3602, 2008, 5640, 2003, 1996, 2653, 1997, 21288, 2061, 2009, 1005, 1055, 2488, 2000, 4553, 2009, 2000, 3305, 4415, 2035, 1996, 17861, 1999, 21288, 1012, 102, 5640, 2003, 1996, 2653, 1997, 1996, 21288, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 23:02:00 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
03/23/2024 23:02:00 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
03/23/2024 23:02:00 - INFO - __main__ - ************* 2490 Training Examples Loaded *************
03/23/2024 23:02:00 - INFO - __main__ - ************* 277 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-03-23 23:02:00,937 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:02:00 - INFO - trainer.trainer - Prepruning finetune steps: 100
03/23/2024 23:02:00 - INFO - trainer.trainer - Lagrangian warmup steps: 1560
03/23/2024 23:02:00 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 23:02:00 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 23:02:00 - INFO - trainer.trainer - ***** Running training *****
03/23/2024 23:02:00 - INFO - trainer.trainer -   Num examples = 2490
03/23/2024 23:02:00 - INFO - trainer.trainer -   Num Epochs = 100
03/23/2024 23:02:00 - INFO - trainer.trainer -   Instantaneous batch size per device = 32
03/23/2024 23:02:00 - INFO - trainer.trainer -   Total train batch size (w. parallel, distributed & accumulation) = 32
03/23/2024 23:02:00 - INFO - trainer.trainer -   Gradient Accumulation steps = 1
03/23/2024 23:02:00 - INFO - trainer.trainer -   Total optimization steps = 7800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-03-23 23:02:00,942 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:02:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:02:00 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:02:00 - INFO - trainer.trainer -   Batch size = 32

Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A
Evaluation:  11%|█         | 1/9 [00:00<00:01,  6.57it/s][A
Evaluation:  33%|███▎      | 3/9 [00:00<00:00, 10.81it/s][A
Evaluation:  56%|█████▌    | 5/9 [00:00<00:00, 13.42it/s][A
Evaluation:  78%|███████▊  | 7/9 [00:00<00:00, 14.77it/s][AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 14.40it/s]03/23/2024 23:02:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:02:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.5415162454873647, 'eval_loss': 0.691169, 'step': 0}


Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A03/23/2024 23:02:01 - INFO - trainer.trainer - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.99it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.47it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:20,  3.68it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:19,  3.80it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:18,  3.87it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:18,  3.91it/s][A
Iteration:   9%|▉         | 7/78 [00:01<00:18,  3.93it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:17,  3.95it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:17,  3.96it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:17,  3.97it/s][A
Iteration:  14%|█▍        | 11/78 [00:02<00:16,  3.97it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:16,  3.98it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:16,  3.98it/s][A
Iteration:  18%|█▊        | 14/78 [00:03<00:16,  3.98it/s][A
Iteration:  19%|█▉        | 15/78 [00:03<00:15,  3.98it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:15,  3.98it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:15,  3.97it/s][A
Iteration:  23%|██▎       | 18/78 [00:04<00:15,  3.97it/s][A
Iteration:  24%|██▍       | 19/78 [00:04<00:14,  3.98it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:14,  3.98it/s][A
Iteration:  27%|██▋       | 21/78 [00:05<00:14,  3.98it/s][A
Iteration:  28%|██▊       | 22/78 [00:05<00:14,  3.98it/s][A
Iteration:  29%|██▉       | 23/78 [00:05<00:13,  3.98it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:13,  3.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:06<00:13,  3.98it/s][A
Iteration:  33%|███▎      | 26/78 [00:06<00:13,  3.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:06<00:12,  3.98it/s][A
Iteration:  36%|███▌      | 28/78 [00:07<00:12,  3.98it/s][A
Iteration:  37%|███▋      | 29/78 [00:07<00:12,  4.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:07<00:11,  4.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:07<00:11,  4.02it/s][A
Iteration:  41%|████      | 32/78 [00:08<00:11,  4.00it/s][A
Iteration:  42%|████▏     | 33/78 [00:08<00:11,  3.99it/s][A
Iteration:  44%|████▎     | 34/78 [00:08<00:11,  3.98it/s][A
Iteration:  45%|████▍     | 35/78 [00:08<00:10,  3.98it/s][A
Iteration:  46%|████▌     | 36/78 [00:09<00:10,  3.97it/s][A
Iteration:  47%|████▋     | 37/78 [00:09<00:10,  3.98it/s][A
Iteration:  49%|████▊     | 38/78 [00:09<00:10,  3.97it/s][A
Iteration:  50%|█████     | 39/78 [00:09<00:09,  3.97it/s][A
Iteration:  51%|█████▏    | 40/78 [00:10<00:09,  3.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:10<00:10,  3.63it/s][A
Iteration:  54%|█████▍    | 42/78 [00:10<00:09,  3.72it/s][A
Iteration:  55%|█████▌    | 43/78 [00:10<00:09,  3.79it/s][A
Iteration:  56%|█████▋    | 44/78 [00:11<00:08,  3.85it/s][A
Iteration:  58%|█████▊    | 45/78 [00:11<00:08,  3.88it/s][A
Iteration:  59%|█████▉    | 46/78 [00:11<00:08,  3.91it/s][A
Iteration:  60%|██████    | 47/78 [00:11<00:07,  3.93it/s][A
Iteration:  62%|██████▏   | 48/78 [00:12<00:07,  3.94it/s][A
Iteration:  63%|██████▎   | 49/78 [00:12<00:07,  3.95it/s][A[INFO|trainer.py:570] 2024-03-23 23:02:14,311 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:02:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:02:14 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:02:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A

Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 17.26it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 17.16it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 17.16it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 17.17it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.81it/s]03/23/2024 23:02:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:02:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.64271367, 'step': 50}


Iteration:  64%|██████▍   | 50/78 [00:13<00:11,  2.46it/s][A
Iteration:  65%|██████▌   | 51/78 [00:13<00:09,  2.77it/s][A
Iteration:  67%|██████▋   | 52/78 [00:13<00:08,  3.04it/s][A
Iteration:  68%|██████▊   | 53/78 [00:13<00:07,  3.27it/s][A
Iteration:  69%|██████▉   | 54/78 [00:14<00:06,  3.45it/s][A
Iteration:  71%|███████   | 55/78 [00:14<00:06,  3.77it/s][A
Iteration:  72%|███████▏  | 56/78 [00:14<00:05,  3.82it/s][A
Iteration:  73%|███████▎  | 57/78 [00:14<00:05,  3.87it/s][A
Iteration:  74%|███████▍  | 58/78 [00:15<00:05,  3.89it/s][A
Iteration:  76%|███████▌  | 59/78 [00:15<00:04,  3.92it/s][A
Iteration:  77%|███████▋  | 60/78 [00:15<00:04,  3.92it/s][A
Iteration:  78%|███████▊  | 61/78 [00:15<00:04,  3.93it/s][A
Iteration:  79%|███████▉  | 62/78 [00:16<00:04,  3.94it/s][A
Iteration:  81%|████████  | 63/78 [00:16<00:03,  3.94it/s][A
Iteration:  82%|████████▏ | 64/78 [00:16<00:03,  3.95it/s][A
Iteration:  83%|████████▎ | 65/78 [00:16<00:03,  3.95it/s][A
Iteration:  85%|████████▍ | 66/78 [00:17<00:03,  3.95it/s][A
Iteration:  86%|████████▌ | 67/78 [00:17<00:02,  3.95it/s][A
Iteration:  87%|████████▋ | 68/78 [00:17<00:02,  3.95it/s][A
Iteration:  88%|████████▊ | 69/78 [00:17<00:02,  3.96it/s][A
Iteration:  90%|████████▉ | 70/78 [00:18<00:02,  3.95it/s][A
Iteration:  91%|█████████ | 71/78 [00:18<00:01,  3.95it/s][A
Iteration:  92%|█████████▏| 72/78 [00:18<00:01,  3.95it/s][A
Iteration:  94%|█████████▎| 73/78 [00:19<00:01,  3.95it/s][A
Iteration:  95%|█████████▍| 74/78 [00:19<00:01,  3.95it/s][A
Iteration:  96%|█████████▌| 75/78 [00:19<00:00,  3.95it/s][A
Iteration:  97%|█████████▋| 76/78 [00:19<00:00,  3.95it/s][A
Iteration:  99%|█████████▊| 77/78 [00:20<00:00,  3.95it/s][A
Iteration: 100%|██████████| 78/78 [00:20<00:00,  4.19it/s][A03/23/2024 23:02:21 - INFO - trainer.trainer - Epoch 0 finished. Took 20.23 seconds.
Iteration: 100%|██████████| 78/78 [00:20<00:00,  3.86it/s]
Epoch:   1%|          | 1/100 [00:20<34:26, 20.87s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:19,  3.95it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:19,  3.95it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:19,  3.95it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:18,  3.94it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:18,  3.95it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:18,  3.95it/s][A
Iteration:   9%|▉         | 7/78 [00:01<00:17,  3.95it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:17,  3.95it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:17,  3.95it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:17,  3.95it/s][A
Iteration:  14%|█▍        | 11/78 [00:02<00:16,  3.95it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:16,  4.02it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:16,  4.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:03<00:16,  3.98it/s][A
Iteration:  19%|█▉        | 15/78 [00:03<00:15,  3.97it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:15,  3.97it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:15,  3.96it/s][A
Iteration:  23%|██▎       | 18/78 [00:04<00:15,  3.96it/s][A
Iteration:  24%|██▍       | 19/78 [00:04<00:14,  3.96it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:14,  3.95it/s][A
Iteration:  27%|██▋       | 21/78 [00:05<00:14,  3.95it/s][A[INFO|trainer.py:570] 2024-03-23 23:02:27,369 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:02:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:02:27 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:02:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A

Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 17.21it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 17.21it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 17.15it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 17.12it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.76it/s]03/23/2024 23:02:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:02:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.6787981, 'step': 100}


Iteration:  28%|██▊       | 22/78 [00:06<00:22,  2.45it/s][A03/23/2024 23:02:27 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 23:02:27 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 23:02:27 - INFO - trainer.trainer - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
03/23/2024 23:02:27 - INFO - trainer.trainer - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
03/23/2024 23:02:27 - INFO - trainer.trainer - Starting l0 regularization!
03/23/2024 23:02:28 - INFO - trainer.trainer - v4 Global step: 100, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  29%|██▉       | 23/78 [00:06<00:21,  2.52it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:20,  2.65it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:19,  2.76it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:18,  2.82it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:17,  2.88it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:17,  2.92it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:16,  2.95it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:16,  2.98it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:15,  3.00it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:15,  3.00it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:14,  3.01it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.02it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:14,  3.04it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:13,  3.03it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.03it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:12,  3.05it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.03it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:12,  3.03it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:11,  3.03it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.03it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:11,  3.02it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:10,  3.03it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.02it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:10,  3.03it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.03it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.02it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.03it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  3.02it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.02it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.03it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.02it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.02it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:06,  3.03it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.03it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.02it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.01it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.02it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.02it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:03,  2.99it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.00it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.02it/s][A[INFO|trainer.py:570] 2024-03-23 23:02:44,466 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:02:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:02:44 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:02:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:02:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.46it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.45it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.01it/s]03/23/2024 23:02:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:02:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.6491158, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2621, 2610, 2612, 2605, 2607, 2610, 2593, 2592, 2592, 2586, 2586, 2595], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8967588, 'remaining_params': 76050012, 'pruned_model_sparsity': 0.10547919489611562, 'expected_sparsity': 0.10701, 'target_sparsity': 0.01923076923076923, 'step': 150}


Iteration:  92%|█████████▏| 72/78 [00:23<00:03,  1.93it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:02,  2.16it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  2.36it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:01,  2.53it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  2.66it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  2.77it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  2.96it/s][A03/23/2024 23:02:47 - INFO - trainer.trainer - Epoch 1 finished. Took 25.21 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.09it/s]
Epoch:   2%|▏         | 2/100 [00:46<38:15, 23.43s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:26,  2.93it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.99it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.99it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.01it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.00it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:23,  3.01it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.02it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.02it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.02it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.02it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.03it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.00it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.02it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.02it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.03it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.03it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.04it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.03it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.03it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.02it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.02it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.03it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.03it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.03it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.03it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.03it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.02it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.02it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.02it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.02it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.03it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.03it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.03it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.03it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.03it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.03it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.03it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:12,  3.00it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.01it/s][A[INFO|trainer.py:570] 2024-03-23 23:03:01,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:03:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:03:01 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:03:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:03:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.42it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.43it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.01it/s]03/23/2024 23:03:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:03:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.63715094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2669, 2655, 2657, 2642, 2648, 2654, 2627, 2627, 2631, 2623, 2634, 2676], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8149500, 'remaining_params': 76868100, 'pruned_model_sparsity': 0.09585662262872628, 'expected_sparsity': 0.09739, 'target_sparsity': 0.03846153846153846, 'step': 200}


Iteration:  56%|█████▋    | 44/78 [00:15<00:17,  1.93it/s][A03/23/2024 23:03:02 - INFO - trainer.trainer - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  58%|█████▊    | 45/78 [00:15<00:14,  2.22it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:13,  2.41it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:12,  2.56it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:11,  2.68it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:10,  2.77it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.86it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.90it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.94it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.97it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.99it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.00it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.01it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.01it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.01it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.00it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.01it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.02it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.03it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.02it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.02it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.01it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.01it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.01it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.00it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.00it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.01it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.16it/s][A03/23/2024 23:03:13 - INFO - trainer.trainer - Epoch 2 finished. Took 26.37 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.96it/s]
Epoch:   3%|▎         | 3/100 [01:12<40:02, 24.77s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.00it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.01it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.04it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.02it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.03it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.02it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.02it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.01it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.01it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.01it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.01it/s][A[INFO|trainer.py:570] 2024-03-23 23:03:18,702 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:03:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:03:18 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:03:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:03:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.42it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.38it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.96it/s]03/23/2024 23:03:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:03:19 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.6791806, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2711, 2696, 2697, 2678, 2685, 2694, 2661, 2661, 2670, 2662, 2685, 2753], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7368180, 'remaining_params': 77649420, 'pruned_model_sparsity': 0.08666652551942186, 'expected_sparsity': 0.0882, 'target_sparsity': 0.057692307692307696, 'step': 250}


Iteration:  21%|██        | 16/78 [00:05<00:32,  1.93it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:28,  2.17it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:25,  2.37it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:23,  2.53it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:21,  2.67it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:20,  2.75it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.83it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.87it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.91it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.95it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.97it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.99it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.00it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.00it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.01it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.02it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.02it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.02it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.02it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.02it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.99it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.99it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.99it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.01it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.03it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.03it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.02it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.03it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.03it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.03it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.02it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.01it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.01it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.01it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.01it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.03it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.02it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.02it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.02it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.02it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A[INFO|trainer.py:570] 2024-03-23 23:03:35,899 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:03:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:03:35 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:03:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:03:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.49it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.46it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.40it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.98it/s]03/23/2024 23:03:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:03:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.6902049, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2748, 2734, 2735, 2713, 2720, 2729, 2692, 2693, 2706, 2698, 2730, 2813], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6666524, 'remaining_params': 78351076, 'pruned_model_sparsity': 0.07841345791930142, 'expected_sparsity': 0.07999, 'target_sparsity': 0.07692307692307691, 'step': 300}


Iteration:  85%|████████▍ | 66/78 [00:23<00:06,  1.93it/s][A03/23/2024 23:03:36 - INFO - trainer.trainer - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  86%|████████▌ | 67/78 [00:23<00:05,  2.16it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:04,  2.36it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.52it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:03,  2.65it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.75it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.84it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.89it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.91it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.97it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.99it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.15it/s][A03/23/2024 23:03:40 - INFO - trainer.trainer - Epoch 3 finished. Took 27.05 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.88it/s]
Epoch:   4%|▍         | 4/100 [01:39<41:04, 25.67s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.03it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.02it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.02it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.04it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.04it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.04it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.02it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.01it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.01it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.01it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.02it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.01it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.00it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.00it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.01it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.01it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.04it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.03it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.02it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.03it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.01it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.01it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.01it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.01it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.02it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.02it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.02it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.02it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.02it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.03it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.02it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.02it/s][A[INFO|trainer.py:570] 2024-03-23 23:03:53,034 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:03:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:03:53 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:03:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:03:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.50it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.36it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.95it/s]03/23/2024 23:03:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:03:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.64530706, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2778, 2764, 2767, 2740, 2750, 2758, 2719, 2720, 2736, 2728, 2765, 2857], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6098152, 'remaining_params': 78919448, 'pruned_model_sparsity': 0.07172811276723878, 'expected_sparsity': 0.07329, 'target_sparsity': 0.09615384615384616, 'step': 350}


Iteration:  49%|████▊     | 38/78 [00:13<00:20,  1.93it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:18,  2.16it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:16,  2.36it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:14,  2.52it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.65it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.74it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:12,  2.82it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.87it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.90it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.97it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.99it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.01it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.02it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.02it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.03it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.00it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.03it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.03it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.03it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.02it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.00it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  3.00it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.00it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.01it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.00it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.01it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.01it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.00it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.01it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.01it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.01it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.33it/s][A03/23/2024 23:04:06 - INFO - trainer.trainer - Epoch 4 finished. Took 26.36 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.96it/s]
Epoch:   5%|▌         | 5/100 [02:05<41:02, 25.92s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.03it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.02it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.02it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.02it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.02it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.01it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A[INFO|trainer.py:570] 2024-03-23 23:04:10,124 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:04:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:04:10 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:04:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:04:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.40it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.42it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.38it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.96it/s]03/23/2024 23:04:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:04:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.6246805, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2804, 2790, 2793, 2764, 2774, 2783, 2740, 2743, 2760, 2750, 2792, 2886], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5643148, 'remaining_params': 79374452, 'pruned_model_sparsity': 0.06637623268593797, 'expected_sparsity': 0.06796, 'target_sparsity': 0.11538461538461539, 'step': 400}


Iteration:  13%|█▎        | 10/78 [00:03<00:35,  1.91it/s][A03/23/2024 23:04:10 - INFO - trainer.trainer - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 11/78 [00:04<00:31,  2.14it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:28,  2.35it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:25,  2.52it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:24,  2.65it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:22,  2.75it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.83it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.87it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.89it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.93it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.95it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.97it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.99it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.99it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.00it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.00it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.01it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.01it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.01it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.01it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.01it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.00it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.01it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.01it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.01it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.01it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.01it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.01it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.01it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.01it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.00it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.00it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.01it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.01it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.02it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.02it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.00it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.01it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.02it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.00it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.00it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.01it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A[INFO|trainer.py:570] 2024-03-23 23:04:27,367 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:04:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:04:27 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:04:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:04:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.45it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.42it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.34it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.92it/s]03/23/2024 23:04:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:04:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.65549934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2821, 2808, 2812, 2781, 2792, 2800, 2755, 2758, 2776, 2763, 2807, 2903], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5341344, 'remaining_params': 79676256, 'pruned_model_sparsity': 0.06282633242999097, 'expected_sparsity': 0.06439, 'target_sparsity': 0.1346153846153846, 'step': 450}


Iteration:  77%|███████▋  | 60/78 [00:21<00:09,  1.93it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:07,  2.16it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:06,  2.37it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:05,  2.53it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.65it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.75it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:04,  2.83it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.87it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.91it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.94it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.96it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.98it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  3.00it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.00it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.02it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.02it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.01it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.98it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.15it/s][A03/23/2024 23:04:33 - INFO - trainer.trainer - Epoch 5 finished. Took 27.1 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.88it/s]
Epoch:   6%|▌         | 6/100 [02:32<41:14, 26.32s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.99it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.04it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.02it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.02it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.02it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.00it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.01it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.02it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.02it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.02it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.01it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.02it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.03it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.02it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.02it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.03it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.02it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.02it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.03it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.02it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.02it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.02it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.02it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.01it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.00it/s][A[INFO|trainer.py:570] 2024-03-23 23:04:44,518 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:04:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:04:44 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:04:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:04:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.47it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.40it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.36it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.37it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.93it/s]03/23/2024 23:04:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:04:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.6728846, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2832, 2819, 2824, 2790, 2802, 2812, 2764, 2768, 2786, 2767, 2811, 2909], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5175888, 'remaining_params': 79841712, 'pruned_model_sparsity': 0.06088019421860885, 'expected_sparsity': 0.06248, 'target_sparsity': 0.15384615384615383, 'step': 500}


Iteration:  41%|████      | 32/78 [00:11<00:23,  1.93it/s][A03/23/2024 23:04:45 - INFO - trainer.trainer - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 33/78 [00:11<00:20,  2.16it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:18,  2.37it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:17,  2.53it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:15,  2.65it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.75it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:14,  2.83it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.85it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.91it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  2.94it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.96it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.98it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.99it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.99it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.99it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.01it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.02it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.01it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.05it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.03it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.03it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.01it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.02it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.02it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.02it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.02it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.03it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.02it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.02it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.02it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.01it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.02it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.03it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.03it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.02it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.02it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.03it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.03it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.02it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.02it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.17it/s][A03/23/2024 23:05:00 - INFO - trainer.trainer - Epoch 6 finished. Took 26.4 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:   7%|▋         | 7/100 [02:59<40:50, 26.35s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.01it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.01it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.00it/s][A[INFO|trainer.py:570] 2024-03-23 23:05:01,652 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:05:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:05:01 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:05:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:05:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.34it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.92it/s]03/23/2024 23:05:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:05:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.7242823, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2834, 2822, 2828, 2792, 2806, 2817, 2764, 2768, 2786, 2758, 2801, 2900], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5188144, 'remaining_params': 79829456, 'pruned_model_sparsity': 0.06102435260463716, 'expected_sparsity': 0.06268, 'target_sparsity': 0.17307692307692304, 'step': 550}


Iteration:   5%|▌         | 4/78 [00:01<00:42,  1.73it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:35,  2.05it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:31,  2.30it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:28,  2.49it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:26,  2.63it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:25,  2.74it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:24,  2.81it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.87it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.91it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.93it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.96it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.97it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.97it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.99it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.98it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.00it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.99it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.00it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.00it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.01it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.01it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.00it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.01it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.01it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.04it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.03it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.02it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.02it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.03it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.02it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.03it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.01it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.01it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.02it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.03it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.03it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.03it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.02it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.00it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.01it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.01it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.04it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.03it/s][A[INFO|trainer.py:570] 2024-03-23 23:05:18,848 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:05:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:05:18 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:05:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:05:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.46it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.40it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.34it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.93it/s]03/23/2024 23:05:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:05:19 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.7966693, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2828, 2815, 2823, 2783, 2800, 2813, 2752, 2755, 2774, 2731, 2766, 2867], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5447052, 'remaining_params': 79570548, 'pruned_model_sparsity': 0.0640696985094851, 'expected_sparsity': 0.06582, 'target_sparsity': 0.19230769230769232, 'step': 600}


Iteration:  69%|██████▉   | 54/78 [00:19<00:12,  1.93it/s][A03/23/2024 23:05:19 - INFO - trainer.trainer - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.16it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:09,  2.36it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:08,  2.52it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.65it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.75it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:06,  2.82it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.88it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.92it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:05,  2.95it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.97it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.98it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:04,  3.00it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.01it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.98it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.99it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:01,  3.00it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.00it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.00it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.00it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.01it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.16it/s][A03/23/2024 23:05:27 - INFO - trainer.trainer - Epoch 7 finished. Took 27.08 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.88it/s]
Epoch:   8%|▊         | 8/100 [03:26<40:45, 26.58s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.04it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.03it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.03it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.03it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.02it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.02it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.02it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.01it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.02it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.03it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.02it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.01it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.01it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.01it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.01it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.02it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.02it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.01it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.01it/s][A[INFO|trainer.py:570] 2024-03-23 23:05:36,003 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:05:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:05:36 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:05:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:05:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.49it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.37it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.93it/s]03/23/2024 23:05:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:05:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.77438754, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2808, 2793, 2807, 2761, 2781, 2798, 2723, 2726, 2745, 2669, 2681, 2764], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6137984, 'remaining_params': 78879616, 'pruned_model_sparsity': 0.07219662752183077, 'expected_sparsity': 0.07407, 'target_sparsity': 0.21153846153846154, 'step': 650}


Iteration:  33%|███▎      | 26/78 [00:09<00:26,  1.93it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.15it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:21,  2.36it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:19,  2.51it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:18,  2.65it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:17,  2.75it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:16,  2.81it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.86it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:15,  2.91it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  2.93it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.96it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.99it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.00it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.99it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.01it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.01it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.01it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.01it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.01it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.01it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.02it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.02it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.02it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.03it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.05it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.05it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.02it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.01it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.00it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.02it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.03it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.02it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.03it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.03it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.02it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.02it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.02it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.01it/s][A[INFO|trainer.py:570] 2024-03-23 23:05:53,201 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:05:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:05:53 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:05:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:05:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.39it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.95it/s]03/23/2024 23:05:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:05:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7328519855595668, 'eval_loss': 0.7590057, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2764, 2746, 2773, 2718, 2743, 2766, 2672, 2673, 2690, 2538, 2472, 2419], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7795608, 'remaining_params': 77221992, 'pruned_model_sparsity': 0.09169404923215899, 'expected_sparsity': 0.09407, 'target_sparsity': 0.23076923076923078, 'step': 700}


Iteration:  97%|█████████▋| 76/78 [00:26<00:01,  1.93it/s][A03/23/2024 23:05:53 - INFO - trainer.trainer - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.16it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.45it/s][A03/23/2024 23:05:54 - INFO - trainer.trainer - Epoch 8 finished. Took 27.03 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.89it/s]
Epoch:   9%|▉         | 9/100 [03:53<40:31, 26.72s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.01it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.02it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.00it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.00it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.98it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  3.00it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.01it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.01it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.01it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.01it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.00it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.00it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:21,  3.00it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.01it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.01it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.00it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.00it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.01it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.01it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.01it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.00it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:18,  2.99it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.99it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  2.99it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.01it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.01it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.01it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.02it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.99it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:15,  3.00it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.00it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.03it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.02it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.02it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.02it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.02it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.02it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.02it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.02it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.01it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.02it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.02it/s][A[INFO|trainer.py:570] 2024-03-23 23:06:10,389 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:06:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:06:10 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:06:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:06:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.39it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.37it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.34it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.92it/s]03/23/2024 23:06:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:06:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7292418772563177, 'eval_loss': 0.7694189, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2674, 2652, 2709, 2640, 2673, 2709, 2579, 2577, 2585, 2279, 2030, 1675], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 11153752, 'remaining_params': 73863848, 'pruned_model_sparsity': 0.13119344700391447, 'expected_sparsity': 0.13449, 'target_sparsity': 0.25, 'step': 750}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.93it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:13,  2.16it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:11,  2.36it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.53it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.65it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:09,  2.76it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.84it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.88it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.92it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.94it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  2.96it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.98it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.98it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  2.99it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.00it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.00it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.02it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.02it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.99it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.99it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.00it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.00it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.03it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.03it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.17it/s][A03/23/2024 23:06:20 - INFO - trainer.trainer - Epoch 9 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  10%|█         | 10/100 [04:19<39:58, 26.65s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.02it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.02it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.01it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.01it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.01it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.02it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.00it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.01it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.01it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.00it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.01it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.01it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.00it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.02it/s][A[INFO|trainer.py:570] 2024-03-23 23:06:27,545 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:06:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:06:27 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:06:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:06:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.47it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.42it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.94it/s]03/23/2024 23:06:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:06:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7256317689530686, 'eval_loss': 0.80336905, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2526, 2499, 2600, 2515, 2560, 2618, 2435, 2428, 2414, 1909, 1477, 1024], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 15408116, 'remaining_params': 69609484, 'pruned_model_sparsity': 0.18123442675398976, 'expected_sparsity': 0.18797, 'target_sparsity': 0.2692307692307692, 'step': 800}


Iteration:  26%|██▌       | 20/78 [00:07<00:29,  1.93it/s][A03/23/2024 23:06:28 - INFO - trainer.trainer - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 21/78 [00:07<00:26,  2.17it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.37it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.54it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:20,  2.66it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:19,  2.76it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:18,  2.83it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.87it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:17,  2.92it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.94it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.96it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.98it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.99it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  3.00it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.01it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.01it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.01it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.01it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.01it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.01it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.01it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.00it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.00it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.00it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.01it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.00it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.01it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.02it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.01it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.01it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.01it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.01it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.01it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.01it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.01it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.01it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.01it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.01it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.02it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.02it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.02it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.01it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.03it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.02it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.02it/s][A[INFO|trainer.py:570] 2024-03-23 23:06:44,759 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:06:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:06:44 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:06:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:06:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.43it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.97it/s]03/23/2024 23:06:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:06:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.703971119133574, 'eval_loss': 0.8241246, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2340, 2312, 2447, 2340, 2407, 2492, 2244, 2234, 2184, 1548, 1040, 719], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12], 'pruned_params': 20839056, 'remaining_params': 64178544, 'pruned_model_sparsity': 0.2451146115627823, 'expected_sparsity': 0.24475, 'target_sparsity': 0.28846153846153844, 'step': 850}


Iteration:  90%|████████▉ | 70/78 [00:24<00:04,  1.94it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.17it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.38it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.55it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.67it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.88it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.93it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.08it/s][A03/23/2024 23:06:47 - INFO - trainer.trainer - Epoch 10 finished. Took 27.03 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.89it/s]
Epoch:  11%|█         | 11/100 [04:47<39:42, 26.77s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.02it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.03it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.03it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.02it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.00it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.00it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.00it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.00it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.02it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.04it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.05it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.04it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.03it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.04it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.05it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.03it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.03it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.04it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.04it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.04it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.05it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.05it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.05it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.04it/s][A[INFO|trainer.py:570] 2024-03-23 23:07:01,749 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:07:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:07:01 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:07:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:07:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.45it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.41it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.43it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.98it/s]03/23/2024 23:07:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:07:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7003610108303249, 'eval_loss': 0.82649803, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2145, 2123, 2270, 2139, 2234, 2345, 2037, 2028, 1945, 1294, 763, 610], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 12], 'pruned_params': 24505132, 'remaining_params': 60512468, 'pruned_model_sparsity': 0.28823598878349893, 'expected_sparsity': 0.29905, 'target_sparsity': 0.30769230769230765, 'step': 900}


Iteration:  54%|█████▍    | 42/78 [00:14<00:18,  1.95it/s][A03/23/2024 23:07:02 - INFO - trainer.trainer - v4 Global step: 900, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  55%|█████▌    | 43/78 [00:14<00:16,  2.18it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:14,  2.38it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:12,  2.56it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.70it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:11,  2.80it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.85it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.91it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.96it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  3.00it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.00it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.01it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.04it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.04it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.05it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.05it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:07:14 - INFO - trainer.trainer - Epoch 11 finished. Took 26.14 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.98it/s]
Epoch:  12%|█▏        | 12/100 [05:13<38:58, 26.57s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.02it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.02it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.04it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.03it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.04it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.04it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.05it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:07:18,674 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:07:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:07:18 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:07:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:07:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.50it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.49it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.45it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.03it/s]03/23/2024 23:07:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:07:19 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.8852855, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1963, 1954, 2095, 1944, 2069, 2197, 1844, 1838, 1739, 1181, 593, 566], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 11], 'pruned_params': 29430512, 'remaining_params': 55587088, 'pruned_model_sparsity': 0.3461696401686239, 'expected_sparsity': 0.34207, 'target_sparsity': 0.32692307692307687, 'step': 950}


Iteration:  18%|█▊        | 14/78 [00:05<00:32,  1.95it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:28,  2.18it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:25,  2.39it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:23,  2.54it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:22,  2.68it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:21,  2.79it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:20,  2.87it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.93it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.97it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.99it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.02it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.04it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.02it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.04it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.05it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.04it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.10it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.05it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:07:35,607 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:07:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:07:35 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:07:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:07:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.06it/s]03/23/2024 23:07:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:07:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.8884368, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1804, 1811, 1938, 1772, 1923, 2061, 1675, 1673, 1568, 1135, 482, 541], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 12, 11, 11], 'pruned_params': 31969036, 'remaining_params': 53048564, 'pruned_model_sparsity': 0.37602844587473655, 'expected_sparsity': 0.37502, 'target_sparsity': 0.3461538461538461, 'step': 1000}


Iteration:  82%|████████▏ | 64/78 [00:22<00:07,  1.96it/s][A03/23/2024 23:07:36 - INFO - trainer.trainer - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.20it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.41it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:04,  2.57it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.70it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.80it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.88it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.94it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.99it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.99it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.99it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.02it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.03it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.05it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A03/23/2024 23:07:40 - INFO - trainer.trainer - Epoch 12 finished. Took 26.67 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.92it/s]
Epoch:  13%|█▎        | 13/100 [05:39<38:34, 26.60s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.04it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.04it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.02it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.03it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.05it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.04it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:07:52,519 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:07:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:07:52 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:07:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:07:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.46it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.04it/s]03/23/2024 23:07:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:07:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.9014531, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1670, 1691, 1801, 1628, 1798, 1944, 1532, 1537, 1432, 1110, 408, 524], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 10, 12, 11, 11, 11], 'pruned_params': 34496836, 'remaining_params': 50520764, 'pruned_model_sparsity': 0.4057611129930744, 'expected_sparsity': 0.40426, 'target_sparsity': 0.36538461538461536, 'step': 1050}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.95it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.19it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:16,  2.40it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.56it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:14,  2.69it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:13,  2.80it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.88it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.93it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.96it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.99it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.01it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.04it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.05it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.05it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:08:06 - INFO - trainer.trainer - Epoch 13 finished. Took 26.04 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.00it/s]
Epoch:  14%|█▍        | 14/100 [06:05<37:53, 26.43s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:08:09,387 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:08:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:08:09 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:08:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:08:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.49it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.06it/s]03/23/2024 23:08:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:08:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.87451327, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1562, 1594, 1686, 1509, 1693, 1841, 1414, 1423, 1323, 1093, 358, 511], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 9, 12, 10, 10, 11], 'pruned_params': 36675340, 'remaining_params': 48342260, 'pruned_model_sparsity': 0.43138526610960554, 'expected_sparsity': 0.42836, 'target_sparsity': 0.38461538461538464, 'step': 1100}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.92it/s][A03/23/2024 23:08:10 - INFO - trainer.trainer - v4 Global step: 1100, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  12%|█▏        | 9/78 [00:03<00:31,  2.18it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.40it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:26,  2.58it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.71it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.79it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.84it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.90it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.93it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.97it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.00it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.03it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.05it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.04it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.05it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.04it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.02it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.03it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.04it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.05it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.05it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.05it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:08:26,341 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:08:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:08:26 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:08:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:08:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.06it/s]03/23/2024 23:08:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:08:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.9012226, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1474, 1515, 1592, 1413, 1606, 1754, 1314, 1327, 1235, 1081, 323, 501], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 9, 12, 10, 10, 11], 'pruned_params': 37977540, 'remaining_params': 47040060, 'pruned_model_sparsity': 0.4467020946251129, 'expected_sparsity': 0.44647, 'target_sparsity': 0.40384615384615385, 'step': 1150}


Iteration:  74%|███████▍  | 58/78 [00:20<00:10,  1.96it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.19it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.39it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.56it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.69it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.79it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.87it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.92it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.97it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.99it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.01it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.04it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.04it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.04it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.03it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:08:33 - INFO - trainer.trainer - Epoch 14 finished. Took 26.66 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  15%|█▌        | 15/100 [06:32<37:32, 26.50s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.05it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.04it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.05it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:08:43,209 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:08:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:08:43 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:08:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:08:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.06it/s]03/23/2024 23:08:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:08:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.9307122, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1399, 1449, 1513, 1331, 1533, 1680, 1231, 1249, 1162, 1071, 297, 493], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 9, 12, 10, 9, 11], 'pruned_params': 39259824, 'remaining_params': 45757776, 'pruned_model_sparsity': 0.4617846657633243, 'expected_sparsity': 0.46101, 'target_sparsity': 0.4230769230769231, 'step': 1200}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.96it/s][A03/23/2024 23:08:43 - INFO - trainer.trainer - v4 Global step: 1200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.20it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:19,  2.41it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.58it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.72it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:15,  2.81it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.87it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.92it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.94it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.98it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.99it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.03it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.04it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.11it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:08:59 - INFO - trainer.trainer - Epoch 15 finished. Took 25.96 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.00it/s]
Epoch:  16%|█▌        | 16/100 [06:58<36:52, 26.34s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A[INFO|trainer.py:570] 2024-03-23 23:09:00,061 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:09:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:09:00 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:09:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:09:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]03/23/2024 23:09:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:09:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.9121597, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1337, 1395, 1445, 1262, 1469, 1616, 1159, 1181, 1101, 1062, 278, 486], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 9, 12, 10, 9, 11], 'pruned_params': 40180556, 'remaining_params': 44837044, 'pruned_model_sparsity': 0.4726145645137007, 'expected_sparsity': 0.47354, 'target_sparsity': 0.44230769230769235, 'step': 1250}


Iteration:   3%|▎         | 2/78 [00:01<00:52,  1.46it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:39,  1.92it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:32,  2.26it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.50it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:27,  2.67it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.78it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.88it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.94it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.97it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.00it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.01it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.04it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:20,  3.05it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.05it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:09:16,955 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:09:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:09:16 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:09:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:09:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.11it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.26it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.37it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.90it/s]03/23/2024 23:09:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:09:17 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.91694605, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1284, 1348, 1387, 1204, 1413, 1558, 1096, 1121, 1047, 1054, 264, 479], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 8, 12, 10, 9, 10], 'pruned_params': 41370920, 'remaining_params': 43646680, 'pruned_model_sparsity': 0.4866159477566998, 'expected_sparsity': 0.4849, 'target_sparsity': 0.46153846153846156, 'step': 1300}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.95it/s][A03/23/2024 23:09:17 - INFO - trainer.trainer - v4 Global step: 1300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.19it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:10,  2.39it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.56it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.69it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.80it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.87it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.90it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.95it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.99it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.02it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.03it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.05it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.20it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.16it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.12it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A03/23/2024 23:09:25 - INFO - trainer.trainer - Epoch 16 finished. Took 26.57 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  17%|█▋        | 17/100 [07:25<36:31, 26.41s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.02it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:09:33,791 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:09:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:09:33 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:09:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:09:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.12it/s]03/23/2024 23:09:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:09:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.8800019, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1238, 1308, 1336, 1152, 1363, 1507, 1040, 1068, 1000, 1045, 252, 473], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 8, 12, 10, 9, 10], 'pruned_params': 42072576, 'remaining_params': 42945024, 'pruned_model_sparsity': 0.4948690153568202, 'expected_sparsity': 0.49412, 'target_sparsity': 0.4807692307692308, 'step': 1350}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.96it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:24,  2.19it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.40it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.57it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.71it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.81it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.89it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.95it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.00it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.03it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.04it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:09:50,704 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:09:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:09:50 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:09:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:09:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]03/23/2024 23:09:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:09:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.91300946, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1271, 1288, 1105, 1318, 1460, 987, 1018, 958, 1036, 243, 466], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 8, 12, 10, 9, 10], 'pruned_params': 42719080, 'remaining_params': 42298520, 'pruned_model_sparsity': 0.5024733702198133, 'expected_sparsity': 0.50251, 'target_sparsity': 0.5, 'step': 1400}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.95it/s][A03/23/2024 23:09:51 - INFO - trainer.trainer - v4 Global step: 1400, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.19it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.40it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.55it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.79it/s][A03/23/2024 23:09:52 - INFO - trainer.trainer - Epoch 17 finished. Took 26.6 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  18%|█▊        | 18/100 [07:51<36:10, 26.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.11it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:10:07,537 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:10:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:10:07 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:10:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:10:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]03/23/2024 23:10:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:10:08 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.86947507, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1154, 1234, 1243, 1060, 1274, 1412, 936, 969, 917, 1026, 235, 458], 'head_nums': [12, 11, 12, 11, 12, 12, 11, 8, 12, 10, 9, 10], 'pruned_params': 43540232, 'remaining_params': 41477368, 'pruned_model_sparsity': 0.5121319820837097, 'expected_sparsity': 0.51168, 'target_sparsity': 0.5192307692307693, 'step': 1450}


Iteration:  59%|█████▉    | 46/78 [00:15<00:16,  1.96it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:14,  2.20it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:12,  2.40it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:11,  2.56it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:10,  2.69it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.80it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.88it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.94it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.00it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.01it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.03it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.05it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:10:18 - INFO - trainer.trainer - Epoch 18 finished. Took 25.94 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  19%|█▉        | 19/100 [08:17<35:30, 26.31s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.04it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:10:24,387 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:10:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:10:24 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:10:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:10:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.50it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]03/23/2024 23:10:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:10:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7003610108303249, 'eval_loss': 0.87512386, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1113, 1199, 1199, 1016, 1231, 1365, 886, 923, 877, 1016, 228, 451], 'head_nums': [12, 11, 12, 11, 12, 12, 11, 8, 12, 10, 8, 10], 'pruned_params': 44344532, 'remaining_params': 40673068, 'pruned_model_sparsity': 0.5215923761668172, 'expected_sparsity': 0.52148, 'target_sparsity': 0.5384615384615384, 'step': 1500}


Iteration:  23%|██▎       | 18/78 [00:06<00:30,  1.95it/s][A03/23/2024 23:10:25 - INFO - trainer.trainer - v4 Global step: 1500, Alignment: tensor([0, 0, 1, 2], device='cuda:0')

Iteration:  24%|██▍       | 19/78 [00:06<00:26,  2.19it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:24,  2.40it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:22,  2.57it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:20,  2.72it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.82it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.88it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.93it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.04it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.05it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.04it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:10:41,258 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:10:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:10:41 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:10:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:10:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.50it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]03/23/2024 23:10:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:10:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.88601094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1075, 1164, 1155, 974, 1187, 1318, 837, 877, 840, 1004, 222, 443], 'head_nums': [12, 11, 12, 11, 12, 12, 10, 8, 12, 9, 8, 10], 'pruned_params': 45331140, 'remaining_params': 39686460, 'pruned_model_sparsity': 0.5331971262420958, 'expected_sparsity': 0.53116, 'target_sparsity': 0.5576923076923077, 'step': 1550}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.96it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.20it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:03,  2.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.58it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.71it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.81it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.89it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.99it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.14it/s][A03/23/2024 23:10:45 - INFO - trainer.trainer - Epoch 19 finished. Took 26.57 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  20%|██        | 20/100 [08:44<35:10, 26.39s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.04it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.05it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.02it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.05it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:10:58,167 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:10:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:10:58 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:10:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:10:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:10:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:10:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.8691605, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1038, 1130, 1113, 933, 1145, 1271, 789, 832, 802, 992, 216, 433], 'head_nums': [12, 11, 12, 11, 12, 12, 10, 8, 12, 9, 8, 9], 'pruned_params': 46109396, 'remaining_params': 38908204, 'pruned_model_sparsity': 0.5423511837548931, 'expected_sparsity': 0.54012, 'target_sparsity': 0.5769230769230769, 'step': 1600}


Iteration:  51%|█████▏    | 40/78 [00:13<00:19,  1.95it/s][A03/23/2024 23:10:58 - INFO - trainer.trainer - v4 Global step: 1600, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  53%|█████▎    | 41/78 [00:14<00:16,  2.19it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:14,  2.40it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.57it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.71it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.80it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.87it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.94it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.98it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.00it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.00it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.04it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.05it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A03/23/2024 23:11:11 - INFO - trainer.trainer - Epoch 20 finished. Took 26.01 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.00it/s]
Epoch:  21%|██        | 21/100 [09:10<34:35, 26.27s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:11:15,013 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:11:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:11:15 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:11:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:11:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.07it/s]03/23/2024 23:11:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:11:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.8778776, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1001, 1094, 1069, 893, 1102, 1224, 742, 787, 766, 977, 211, 424], 'head_nums': [12, 11, 12, 11, 12, 12, 10, 8, 12, 9, 8, 8], 'pruned_params': 46887652, 'remaining_params': 38129948, 'pruned_model_sparsity': 0.5515052412676904, 'expected_sparsity': 0.55052, 'target_sparsity': 0.5961538461538461, 'step': 1650}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.95it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.19it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.39it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.56it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:23,  2.69it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:22,  2.76it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:21,  2.84it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.89it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.96it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.99it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.01it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.03it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.16it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.13it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.11it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.10it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.10it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.10it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:11:31,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:11:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:11:31 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:11:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:11:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.06it/s]03/23/2024 23:11:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:11:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8470537, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [964, 1058, 1027, 854, 1060, 1176, 694, 743, 729, 961, 207, 413], 'head_nums': [12, 11, 11, 11, 12, 12, 10, 8, 12, 9, 8, 7], 'pruned_params': 47857408, 'remaining_params': 37160192, 'pruned_model_sparsity': 0.56291177356218, 'expected_sparsity': 0.5626, 'target_sparsity': 0.6, 'step': 1700}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  1.96it/s][A03/23/2024 23:11:32 - INFO - trainer.trainer - v4 Global step: 1700, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.20it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.40it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.55it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.70it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.80it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.88it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.94it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.97it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.01it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.03it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.04it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.05it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.05it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.18it/s][A03/23/2024 23:11:37 - INFO - trainer.trainer - Epoch 21 finished. Took 26.58 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  22%|██▏       | 22/100 [09:36<34:16, 26.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.12it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.11it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.05it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.05it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:11:48,756 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:11:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:11:48 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:11:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:11:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]03/23/2024 23:11:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:11:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.88022256, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [931, 1025, 988, 819, 1021, 1132, 653, 703, 696, 945, 203, 401], 'head_nums': [12, 11, 11, 11, 12, 12, 10, 8, 12, 9, 7, 6], 'pruned_params': 48772012, 'remaining_params': 36245588, 'pruned_model_sparsity': 0.5736695931195424, 'expected_sparsity': 0.57312, 'target_sparsity': 0.6, 'step': 1750}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.96it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:19,  2.20it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.41it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.57it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.70it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.80it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.88it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.95it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.99it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.99it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.01it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.02it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.02it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A03/23/2024 23:12:03 - INFO - trainer.trainer - Epoch 22 finished. Took 25.96 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.00it/s]
Epoch:  23%|██▎       | 23/100 [10:02<33:40, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A[INFO|trainer.py:570] 2024-03-23 23:12:05,585 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:12:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:12:05 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:12:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:12:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:12:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:12:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.92078036, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [902, 995, 953, 787, 986, 1093, 616, 667, 666, 928, 200, 390], 'head_nums': [12, 11, 10, 11, 12, 12, 9, 8, 12, 9, 7, 5], 'pruned_params': 49829092, 'remaining_params': 35188508, 'pruned_model_sparsity': 0.5861032539144836, 'expected_sparsity': 0.58214, 'target_sparsity': 0.6, 'step': 1800}


Iteration:   8%|▊         | 6/78 [00:02<00:38,  1.88it/s][A03/23/2024 23:12:06 - INFO - trainer.trainer - v4 Global step: 1800, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:   9%|▉         | 7/78 [00:02<00:33,  2.15it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.40it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:26,  2.59it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:24,  2.72it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.83it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.90it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.94it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.99it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.02it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.03it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.04it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:12:22,438 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:12:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:12:22 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:12:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:12:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:12:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:12:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.9181489, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [875, 966, 923, 760, 954, 1056, 583, 636, 639, 910, 197, 379], 'head_nums': [12, 11, 10, 11, 12, 12, 9, 8, 12, 9, 7, 5], 'pruned_params': 50251924, 'remaining_params': 34765676, 'pruned_model_sparsity': 0.5910767182324601, 'expected_sparsity': 0.59193, 'target_sparsity': 0.6, 'step': 1850}


Iteration:  72%|███████▏  | 56/78 [00:19<00:11,  1.96it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.21it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:08,  2.41it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:07,  2.58it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.71it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.82it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.89it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.93it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.98it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.04it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.05it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.04it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.05it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.05it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.17it/s][A03/23/2024 23:12:30 - INFO - trainer.trainer - Epoch 23 finished. Took 26.53 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  24%|██▍       | 24/100 [10:29<33:21, 26.33s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.12it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.06it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.04it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:12:39,278 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:12:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:12:39 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:12:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:12:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:12:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:12:39 - INFO - trainer.trainer - Starting saving the best from epoch 24 and step 1900
03/23/2024 23:12:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.8903067, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [852, 940, 896, 736, 926, 1024, 554, 608, 616, 893, 195, 368], 'head_nums': [12, 11, 9, 11, 12, 11, 8, 8, 12, 9, 7, 5], 'pruned_params': 51210956, 'remaining_params': 33806644, 'pruned_model_sparsity': 0.602357111939175, 'expected_sparsity': 0.6016, 'target_sparsity': 0.6, 'step': 1900}
03/23/2024 23:12:39 - INFO - trainer.trainer - Saving the best model so far: [Epoch 24 | Step: 1900 | Model size: 33806644 | Score: 0.66787]

[INFO|configuration_utils.py:439] 2024-03-23 23:12:39,903 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 23:12:41,103 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  36%|███▌      | 28/78 [00:10<00:43,  1.15it/s][A03/23/2024 23:12:41 - INFO - trainer.trainer - v4 Global step: 1900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  37%|███▋      | 29/78 [00:11<00:34,  1.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:11<00:28,  1.69it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:24,  1.95it/s][A
Iteration:  41%|████      | 32/78 [00:12<00:21,  2.18it/s][A
Iteration:  42%|████▏     | 33/78 [00:12<00:18,  2.39it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:17,  2.55it/s][A
Iteration:  45%|████▍     | 35/78 [00:13<00:16,  2.69it/s][A
Iteration:  46%|████▌     | 36/78 [00:13<00:15,  2.79it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:14,  2.86it/s][A
Iteration:  49%|████▊     | 38/78 [00:14<00:13,  2.92it/s][A
Iteration:  50%|█████     | 39/78 [00:14<00:13,  2.96it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:15<00:12,  3.03it/s][A
Iteration:  54%|█████▍    | 42/78 [00:15<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  3.04it/s][A
Iteration:  56%|█████▋    | 44/78 [00:16<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:16<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:17<00:10,  3.04it/s][A
Iteration:  62%|██████▏   | 48/78 [00:17<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:18<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:18<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:19<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:19<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:20<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:21<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:22<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:23<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:12:57,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:12:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:12:57 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:12:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:12:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:12:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:12:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.8709811, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [831, 918, 873, 716, 902, 995, 529, 585, 595, 876, 193, 358], 'head_nums': [12, 11, 9, 11, 11, 11, 8, 8, 12, 8, 7, 4], 'pruned_params': 52120964, 'remaining_params': 32896636, 'pruned_model_sparsity': 0.6130608721017766, 'expected_sparsity': 0.61041, 'target_sparsity': 0.6, 'step': 1950}


Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.02it/s][A03/23/2024 23:12:57 - INFO - trainer.trainer - Epoch 24 finished. Took 27.8 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.81it/s]
Epoch:  25%|██▌       | 25/100 [10:57<33:27, 26.77s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.03it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.10it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.10it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.04it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:13:14,230 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:13:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:13:14 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:13:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:13:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]03/23/2024 23:13:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:13:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.89873505, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [812, 898, 853, 698, 880, 970, 508, 565, 578, 860, 192, 349], 'head_nums': [12, 11, 9, 11, 11, 11, 7, 8, 12, 8, 6, 4], 'pruned_params': 52793512, 'remaining_params': 32224088, 'pruned_model_sparsity': 0.6209715635350798, 'expected_sparsity': 0.61864, 'target_sparsity': 0.6, 'step': 2000}
03/23/2024 23:13:14 - INFO - trainer.trainer - Saving the best model so far: [Epoch 25 | Step: 2000 | Model size: 32224088 | Score: 0.68953]

[INFO|configuration_utils.py:439] 2024-03-23 23:13:14,858 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 23:13:15,929 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  64%|██████▍   | 50/78 [00:17<00:23,  1.20it/s][A03/23/2024 23:13:16 - INFO - trainer.trainer - v4 Global step: 2000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  65%|██████▌   | 51/78 [00:18<00:18,  1.46it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:14,  1.74it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:12,  2.00it/s][A
Iteration:  69%|██████▉   | 54/78 [00:19<00:10,  2.23it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:09,  2.43it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.60it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:07,  2.73it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.82it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.89it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:06,  2.95it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.99it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.02it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.05it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.19it/s][A03/23/2024 23:13:24 - INFO - trainer.trainer - Epoch 25 finished. Took 27.02 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.89it/s]
Epoch:  26%|██▌       | 26/100 [11:24<33:06, 26.85s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.10it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:13:32,139 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:13:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:13:32 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:13:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:13:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:13:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:13:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.8847402, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [796, 881, 836, 683, 861, 948, 491, 548, 562, 844, 190, 340], 'head_nums': [12, 11, 9, 11, 11, 11, 6, 8, 12, 7, 6, 4], 'pruned_params': 53427760, 'remaining_params': 31589840, 'pruned_model_sparsity': 0.6284317600120446, 'expected_sparsity': 0.62563, 'target_sparsity': 0.6, 'step': 2050}
03/23/2024 23:13:32 - INFO - trainer.trainer - Saving the best model so far: [Epoch 26 | Step: 2050 | Model size: 31589840 | Score: 0.69314]

[INFO|configuration_utils.py:439] 2024-03-23 23:13:32,760 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 23:13:34,866 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  28%|██▊       | 22/78 [00:09<01:04,  1.14s/it][A
Iteration:  29%|██▉       | 23/78 [00:10<00:50,  1.09it/s][A
Iteration:  31%|███       | 24/78 [00:10<00:39,  1.35it/s][A
Iteration:  32%|███▏      | 25/78 [00:10<00:32,  1.63it/s][A
Iteration:  33%|███▎      | 26/78 [00:11<00:27,  1.90it/s][A
Iteration:  35%|███▍      | 27/78 [00:11<00:23,  2.15it/s][A
Iteration:  36%|███▌      | 28/78 [00:11<00:21,  2.37it/s][A
Iteration:  37%|███▋      | 29/78 [00:12<00:19,  2.55it/s][A
Iteration:  38%|███▊      | 30/78 [00:12<00:17,  2.69it/s][A
Iteration:  40%|███▉      | 31/78 [00:12<00:16,  2.80it/s][A
Iteration:  41%|████      | 32/78 [00:13<00:15,  2.88it/s][A
Iteration:  42%|████▏     | 33/78 [00:13<00:15,  2.95it/s][A
Iteration:  44%|████▎     | 34/78 [00:13<00:14,  2.98it/s][A
Iteration:  45%|████▍     | 35/78 [00:14<00:14,  3.00it/s][A
Iteration:  46%|████▌     | 36/78 [00:14<00:13,  3.03it/s][A
Iteration:  47%|████▋     | 37/78 [00:14<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:15<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:15<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:15<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:16<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:16<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:16<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:17<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:17<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:17<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:18<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:18<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:18<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:18<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:19<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:19<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:19<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:20<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:20<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:20<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:21<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:21<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:21<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:22<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:22<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:22<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:23<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:23<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:23<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:24<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:24<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:24<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:25<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:25<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:25<00:02,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:13:51,135 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:13:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:13:51 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:13:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:13:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:13:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:13:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.9213876, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [783, 867, 822, 671, 846, 928, 476, 534, 550, 830, 189, 332], 'head_nums': [12, 11, 9, 11, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 53823016, 'remaining_params': 31194584, 'pruned_model_sparsity': 0.6330808679614573, 'expected_sparsity': 0.63176, 'target_sparsity': 0.6, 'step': 2100}


Iteration:  92%|█████████▏| 72/78 [00:26<00:03,  1.97it/s][A03/23/2024 23:13:51 - INFO - trainer.trainer - v4 Global step: 2100, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  94%|█████████▎| 73/78 [00:27<00:02,  2.20it/s][A
Iteration:  95%|█████████▍| 74/78 [00:27<00:01,  2.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:27<00:01,  2.57it/s][A
Iteration:  97%|█████████▋| 76/78 [00:28<00:00,  2.71it/s][A
Iteration:  99%|█████████▊| 77/78 [00:28<00:00,  2.81it/s][A
Iteration: 100%|██████████| 78/78 [00:28<00:00,  3.00it/s][A03/23/2024 23:13:53 - INFO - trainer.trainer - Epoch 26 finished. Took 28.66 seconds.
Iteration: 100%|██████████| 78/78 [00:28<00:00,  2.72it/s]
Epoch:  27%|██▋       | 27/100 [11:52<33:19, 27.39s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:14:07,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:14:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:14:07 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:14:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:14:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:14:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:14:08 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.9242842, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [772, 856, 812, 661, 833, 913, 463, 523, 540, 818, 188, 325], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 54179972, 'remaining_params': 30837628, 'pruned_model_sparsity': 0.6372794809545318, 'expected_sparsity': 0.63712, 'target_sparsity': 0.6, 'step': 2150}


Iteration:  56%|█████▋    | 44/78 [00:14<00:17,  1.97it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:14,  2.21it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:13,  2.42it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:12,  2.58it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:11,  2.72it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:10,  2.82it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.88it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.92it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.97it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.00it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.04it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:14:19 - INFO - trainer.trainer - Epoch 27 finished. Took 25.89 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  28%|██▊       | 28/100 [12:18<32:19, 26.94s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.11it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.11it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:14:24,734 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:14:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:14:24 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:14:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:14:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:14:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:14:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.91841364, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [763, 847, 804, 654, 824, 901, 454, 514, 531, 807, 188, 319], 'head_nums': [12, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 54892352, 'remaining_params': 30125248, 'pruned_model_sparsity': 0.645658687142427, 'expected_sparsity': 0.64098, 'target_sparsity': 0.6, 'step': 2200}


Iteration:  21%|██        | 16/78 [00:05<00:31,  1.96it/s][A03/23/2024 23:14:25 - INFO - trainer.trainer - v4 Global step: 2200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  22%|██▏       | 17/78 [00:06<00:27,  2.20it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:24,  2.40it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:23,  2.56it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:21,  2.70it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:20,  2.81it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.89it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.95it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.98it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.01it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.03it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.10it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.10it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.03it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.17it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.14it/s][A[INFO|trainer.py:570] 2024-03-23 23:14:41,558 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:14:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:14:41 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:14:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:14:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:14:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:14:42 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.90787417, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [757, 841, 798, 648, 817, 893, 447, 507, 525, 797, 187, 314], 'head_nums': [12, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 54984272, 'remaining_params': 30033328, 'pruned_model_sparsity': 0.6467398750376393, 'expected_sparsity': 0.64332, 'target_sparsity': 0.6, 'step': 2250}


Iteration:  85%|████████▍ | 66/78 [00:22<00:06,  1.98it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:04,  2.21it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:04,  2.42it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.59it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.72it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.82it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.88it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.94it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.99it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.02it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A03/23/2024 23:14:46 - INFO - trainer.trainer - Epoch 28 finished. Took 26.47 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  29%|██▉       | 29/100 [12:45<31:42, 26.80s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.13it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.11it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.11it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.11it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.11it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:14:58,342 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:14:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:14:58 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:14:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:14:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:14:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:14:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.922832, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [754, 837, 794, 644, 812, 887, 442, 503, 521, 789, 187, 310], 'head_nums': [11, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 55240116, 'remaining_params': 29777484, 'pruned_model_sparsity': 0.6497491813459801, 'expected_sparsity': 0.645, 'target_sparsity': 0.6, 'step': 2300}


Iteration:  49%|████▊     | 38/78 [00:12<00:20,  1.96it/s][A03/23/2024 23:14:59 - INFO - trainer.trainer - v4 Global step: 2300, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  50%|█████     | 39/78 [00:13<00:17,  2.20it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:15,  2.40it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:14,  2.57it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.70it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.81it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.88it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.95it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.98it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.01it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.03it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.03it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.04it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:15:11 - INFO - trainer.trainer - Epoch 29 finished. Took 25.89 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  30%|███       | 30/100 [13:10<30:56, 26.53s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.15it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.13it/s][A[INFO|trainer.py:570] 2024-03-23 23:15:15,141 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:15:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:15:15 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:15:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:15:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:15:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:15:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.9292075, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [751, 835, 792, 642, 810, 883, 438, 500, 518, 783, 186, 307], 'head_nums': [11, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 55279948, 'remaining_params': 29737652, 'pruned_model_sparsity': 0.6502176961005721, 'expected_sparsity': 0.64595, 'target_sparsity': 0.6, 'step': 2350}


Iteration:  13%|█▎        | 10/78 [00:03<00:34,  1.96it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:30,  2.20it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:27,  2.40it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:25,  2.58it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:23,  2.72it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:22,  2.82it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.89it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.95it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.98it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.02it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.04it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.05it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.05it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.10it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.10it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:15:31,983 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:15:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:15:31 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:15:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:15:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:15:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:15:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.92393345, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [751, 835, 792, 642, 809, 883, 436, 499, 517, 779, 186, 304], 'head_nums': [11, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 55287608, 'remaining_params': 29729992, 'pruned_model_sparsity': 0.6503077950918398, 'expected_sparsity': 0.64621, 'target_sparsity': 0.6, 'step': 2400}


Iteration:  77%|███████▋  | 60/78 [00:20<00:09,  1.97it/s][A03/23/2024 23:15:32 - INFO - trainer.trainer - v4 Global step: 2400, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  78%|███████▊  | 61/78 [00:21<00:07,  2.21it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:06,  2.42it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.59it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:05,  2.70it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.80it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.88it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.94it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.97it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.99it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.02it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.04it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.05it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.14it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.24it/s][A03/23/2024 23:15:38 - INFO - trainer.trainer - Epoch 30 finished. Took 26.47 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  31%|███       | 31/100 [13:37<30:29, 26.51s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:15:48,793 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:15:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:15:48 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:15:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:15:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:15:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:15:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.9358463, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [753, 837, 794, 642, 811, 884, 436, 499, 517, 776, 186, 303], 'head_nums': [11, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 55273820, 'remaining_params': 29743780, 'pruned_model_sparsity': 0.650145616907558, 'expected_sparsity': 0.64598, 'target_sparsity': 0.6, 'step': 2450}


Iteration:  41%|████      | 32/78 [00:11<00:23,  1.97it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:20,  2.21it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:18,  2.42it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:16,  2.58it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:15,  2.71it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.80it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.89it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.94it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.98it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.02it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.04it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.04it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:16:04 - INFO - trainer.trainer - Epoch 31 finished. Took 25.92 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  32%|███▏      | 32/100 [14:03<29:50, 26.34s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:16:05,614 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:16:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:16:05 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:16:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:16:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:16:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:16:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.9498064, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [757, 840, 798, 645, 814, 889, 438, 501, 520, 776, 186, 303], 'head_nums': [11, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 55229392, 'remaining_params': 29788208, 'pruned_model_sparsity': 0.6496230427582054, 'expected_sparsity': 0.64529, 'target_sparsity': 0.6, 'step': 2500}


Iteration:   5%|▌         | 4/78 [00:01<00:41,  1.76it/s][A03/23/2024 23:16:06 - INFO - trainer.trainer - v4 Global step: 2500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   6%|▋         | 5/78 [00:02<00:35,  2.08it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:30,  2.34it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:28,  2.53it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:26,  2.68it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:24,  2.79it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:23,  2.87it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  2.94it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.96it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.99it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.01it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.00it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.03it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.04it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.04it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.05it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.05it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:16:22,537 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:16:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:16:22 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:16:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:16:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:16:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:16:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 0.96706957, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [764, 847, 805, 651, 821, 897, 442, 506, 525, 777, 190, 304], 'head_nums': [11, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 55137472, 'remaining_params': 29880128, 'pruned_model_sparsity': 0.6485418548629931, 'expected_sparsity': 0.64385, 'target_sparsity': 0.6, 'step': 2550}


Iteration:  69%|██████▉   | 54/78 [00:18<00:12,  1.96it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.20it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:09,  2.41it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:08,  2.58it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.71it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.82it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.89it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.95it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.99it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.02it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.03it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.03it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.03it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A03/23/2024 23:16:30 - INFO - trainer.trainer - Epoch 32 finished. Took 26.59 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  33%|███▎      | 33/100 [14:29<29:29, 26.41s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.11it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.11it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.10it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A[INFO|trainer.py:570] 2024-03-23 23:16:39,322 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:16:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:16:39 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:16:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:16:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:16:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:16:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.96014, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [775, 859, 815, 661, 831, 908, 450, 515, 533, 781, 198, 305], 'head_nums': [11, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 54988868, 'remaining_params': 30028732, 'pruned_model_sparsity': 0.6467939344323999, 'expected_sparsity': 0.64134, 'target_sparsity': 0.6, 'step': 2600}


Iteration:  33%|███▎      | 26/78 [00:09<00:26,  1.97it/s][A03/23/2024 23:16:40 - INFO - trainer.trainer - v4 Global step: 2600, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.20it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:20,  2.41it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:18,  2.60it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:17,  2.72it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:16,  2.82it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.90it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.95it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.99it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.02it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.03it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.05it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:16:56,172 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:16:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:16:56 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:16:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:16:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:16:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:16:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.9634483, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [790, 874, 830, 674, 845, 923, 461, 527, 546, 786, 214, 308], 'head_nums': [11, 11, 9, 10, 11, 10, 4, 7, 12, 7, 6, 4], 'pruned_params': 54775920, 'remaining_params': 30241680, 'pruned_model_sparsity': 0.6442891824751581, 'expected_sparsity': 0.63751, 'target_sparsity': 0.6, 'step': 2650}


Iteration:  97%|█████████▋| 76/78 [00:25<00:01,  1.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.20it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.49it/s][A03/23/2024 23:16:57 - INFO - trainer.trainer - Epoch 33 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  34%|███▍      | 34/100 [14:56<29:04, 26.43s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.24it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.18it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.13it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:17:12,966 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:17:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:17:12 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:17:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:17:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:17:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:17:13 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.9302408, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [811, 894, 849, 692, 863, 943, 477, 543, 563, 795, 238, 313], 'head_nums': [12, 11, 9, 10, 11, 10, 5, 7, 12, 7, 6, 5], 'pruned_params': 53898084, 'remaining_params': 31119516, 'pruned_model_sparsity': 0.6339638380758807, 'expected_sparsity': 0.63186, 'target_sparsity': 0.6, 'step': 2700}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.96it/s][A03/23/2024 23:17:13 - INFO - trainer.trainer - v4 Global step: 2700, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  63%|██████▎   | 49/78 [00:16<00:13,  2.20it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:11,  2.40it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.58it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.71it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.82it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.88it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.93it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.98it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.02it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.04it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.03it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.04it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.05it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.05it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:17:23 - INFO - trainer.trainer - Epoch 34 finished. Took 25.9 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  35%|███▌      | 35/100 [15:22<28:27, 26.27s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.04it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:17:29,816 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:17:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:17:29 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:17:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:17:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:17:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:17:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.9279501, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [838, 920, 874, 713, 886, 967, 498, 564, 587, 807, 278, 319], 'head_nums': [12, 11, 9, 10, 11, 10, 5, 8, 12, 7, 7, 5], 'pruned_params': 53119828, 'remaining_params': 31897772, 'pruned_model_sparsity': 0.6248097805630835, 'expected_sparsity': 0.62375, 'target_sparsity': 0.6, 'step': 2750}


Iteration:  26%|██▌       | 20/78 [00:07<00:29,  1.96it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:25,  2.20it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.40it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.57it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:19,  2.70it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.80it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:18,  2.88it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.94it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.97it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.01it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.03it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.04it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.26it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.20it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.16it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.12it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:17:46,640 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:17:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:17:46 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:17:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:17:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]03/23/2024 23:17:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:17:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.92553324, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [873, 954, 905, 740, 914, 996, 522, 589, 616, 823, 341, 326], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 8, 7, 5], 'pruned_params': 52229736, 'remaining_params': 32787864, 'pruned_model_sparsity': 0.6143402777777778, 'expected_sparsity': 0.61142, 'target_sparsity': 0.6, 'step': 2800}


Iteration:  90%|████████▉ | 70/78 [00:23<00:04,  1.95it/s][A03/23/2024 23:17:47 - INFO - trainer.trainer - v4 Global step: 2800, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.20it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.41it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.56it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.68it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.88it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.94it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.11it/s][A03/23/2024 23:17:49 - INFO - trainer.trainer - Epoch 35 finished. Took 26.53 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  36%|███▌      | 36/100 [15:48<28:06, 26.35s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.05it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.05it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:18:03,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:18:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:18:03 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:18:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:18:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:18:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:18:04 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.8895488, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [916, 994, 941, 771, 945, 1027, 549, 618, 651, 842, 438, 334], 'head_nums': [12, 11, 10, 11, 11, 11, 6, 9, 12, 8, 7, 6], 'pruned_params': 50636456, 'remaining_params': 34381144, 'pruned_model_sparsity': 0.5955996875940982, 'expected_sparsity': 0.59339, 'target_sparsity': 0.6, 'step': 2850}
03/23/2024 23:18:04 - INFO - trainer.trainer - Saving the best model so far: [Epoch 36 | Step: 2850 | Model size: 34381144 | Score: 0.69675]

[INFO|configuration_utils.py:439] 2024-03-23 23:18:04,120 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 23:18:05,002 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  54%|█████▍    | 42/78 [00:15<00:27,  1.29it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:22,  1.56it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:18,  1.82it/s][A
Iteration:  58%|█████▊    | 45/78 [00:16<00:15,  2.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:13,  2.30it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:12,  2.48it/s][A
Iteration:  62%|██████▏   | 48/78 [00:17<00:11,  2.64it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:10,  2.77it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.85it/s][A
Iteration:  65%|██████▌   | 51/78 [00:18<00:09,  2.91it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  2.97it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.98it/s][A
Iteration:  69%|██████▉   | 54/78 [00:19<00:07,  3.01it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  3.04it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A03/23/2024 23:18:16 - INFO - trainer.trainer - Epoch 36 finished. Took 26.85 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.91it/s]
Epoch:  37%|███▋      | 37/100 [16:15<27:49, 26.50s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.04it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.03it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.04it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:18:21,231 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:18:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:18:21 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:18:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:18:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:18:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:18:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.90847194, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [960, 1036, 978, 801, 974, 1058, 575, 646, 686, 863, 561, 342], 'head_nums': [12, 12, 10, 11, 11, 11, 7, 10, 12, 9, 8, 6], 'pruned_params': 49004876, 'remaining_params': 36012724, 'pruned_model_sparsity': 0.5764086024540801, 'expected_sparsity': 0.57321, 'target_sparsity': 0.6, 'step': 2900}


Iteration:  18%|█▊        | 14/78 [00:05<00:32,  1.98it/s][A03/23/2024 23:18:21 - INFO - trainer.trainer - v4 Global step: 2900, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  19%|█▉        | 15/78 [00:05<00:28,  2.20it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:25,  2.41it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:23,  2.58it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:22,  2.72it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:21,  2.79it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:20,  2.85it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.91it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.96it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.00it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.00it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.02it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.03it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.04it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.04it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.04it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.05it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:18:38,187 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:18:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:18:38 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:18:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:18:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.07it/s]03/23/2024 23:18:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:18:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.88684916, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [993, 1066, 1004, 822, 995, 1078, 592, 665, 709, 877, 653, 347], 'head_nums': [12, 12, 10, 11, 11, 11, 8, 11, 12, 9, 9, 7], 'pruned_params': 47757828, 'remaining_params': 37259772, 'pruned_model_sparsity': 0.5617404866757001, 'expected_sparsity': 0.55976, 'target_sparsity': 0.6, 'step': 2950}


Iteration:  82%|████████▏ | 64/78 [00:22<00:07,  1.95it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.18it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:05,  2.39it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:04,  2.56it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.69it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.80it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.88it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.93it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.98it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.02it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.01it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:18:43 - INFO - trainer.trainer - Epoch 37 finished. Took 26.66 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  38%|███▊      | 38/100 [16:42<27:25, 26.55s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.04it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.03it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.03it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.04it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.04it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.04it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.05it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.04it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:18:55,085 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:18:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:18:55 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:18:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:18:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.07it/s]03/23/2024 23:18:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:18:55 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.90397376, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1002, 1074, 1013, 827, 1001, 1085, 595, 669, 714, 877, 658, 347], 'head_nums': [12, 12, 10, 11, 11, 11, 8, 11, 12, 9, 9, 7], 'pruned_params': 47664376, 'remaining_params': 37353224, 'pruned_model_sparsity': 0.5606412789822343, 'expected_sparsity': 0.55743, 'target_sparsity': 0.6, 'step': 3000}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.95it/s][A03/23/2024 23:18:55 - INFO - trainer.trainer - v4 Global step: 3000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.19it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:16,  2.40it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.57it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:14,  2.70it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:13,  2.78it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.87it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.93it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.99it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.01it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.04it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.04it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.23it/s][A03/23/2024 23:19:09 - INFO - trainer.trainer - Epoch 38 finished. Took 26.01 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.00it/s]
Epoch:  39%|███▉      | 39/100 [17:08<26:49, 26.39s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:19:11,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:19:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:19:11 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:19:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:19:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]03/23/2024 23:19:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:19:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8927942, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [991, 1064, 1006, 821, 995, 1080, 588, 661, 702, 867, 587, 343], 'head_nums': [12, 12, 10, 11, 11, 11, 8, 11, 12, 9, 8, 6], 'pruned_params': 48275644, 'remaining_params': 36741956, 'pruned_model_sparsity': 0.567831178485396, 'expected_sparsity': 0.56429, 'target_sparsity': 0.6, 'step': 3050}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.93it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:31,  2.18it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.40it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:26,  2.57it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.71it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.80it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.86it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.91it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.95it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.98it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  3.00it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.01it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.04it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.04it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.05it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.04it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.05it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:19:28,881 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:19:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:19:28 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:19:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:19:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]03/23/2024 23:19:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:19:29 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.870911, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [971, 1046, 991, 808, 984, 1070, 575, 648, 684, 851, 497, 338], 'head_nums': [12, 12, 10, 11, 11, 11, 7, 10, 12, 9, 8, 6], 'pruned_params': 49006408, 'remaining_params': 36011192, 'pruned_model_sparsity': 0.5764266222523337, 'expected_sparsity': 0.57523, 'target_sparsity': 0.6, 'step': 3100}


Iteration:  74%|███████▍  | 58/78 [00:20<00:10,  1.96it/s][A03/23/2024 23:19:29 - INFO - trainer.trainer - v4 Global step: 3100, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.21it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.40it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.57it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.69it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.80it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.87it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.93it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.96it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.99it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.02it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.03it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:19:35 - INFO - trainer.trainer - Epoch 39 finished. Took 26.63 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  40%|████      | 40/100 [17:35<26:27, 26.46s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.06it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.05it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.04it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:19:45,743 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:19:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:19:45 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:19:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:19:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:19:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:19:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.90934587, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [951, 1027, 975, 794, 971, 1058, 562, 634, 665, 836, 419, 333], 'head_nums': [12, 11, 10, 11, 11, 11, 7, 10, 12, 8, 8, 5], 'pruned_params': 49928672, 'remaining_params': 35088928, 'pruned_model_sparsity': 0.5872745408009635, 'expected_sparsity': 0.58593, 'target_sparsity': 0.6, 'step': 3150}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.95it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.19it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:19,  2.40it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.56it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.69it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:15,  2.78it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.86it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.88it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.93it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.95it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.99it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.01it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.02it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.02it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.05it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.05it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A03/23/2024 23:20:01 - INFO - trainer.trainer - Epoch 40 finished. Took 26.01 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.00it/s]
Epoch:  41%|████      | 41/100 [18:01<25:53, 26.33s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:20:02,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:20:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:20:02 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:20:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:20:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.12it/s]03/23/2024 23:20:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:20:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8895788, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [934, 1012, 962, 783, 960, 1048, 550, 622, 649, 824, 363, 328], 'head_nums': [12, 11, 10, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 50978092, 'remaining_params': 34039508, 'pruned_model_sparsity': 0.5996181026046371, 'expected_sparsity': 0.59454, 'target_sparsity': 0.6, 'step': 3200}


Iteration:   3%|▎         | 2/78 [00:01<00:52,  1.44it/s][A03/23/2024 23:20:03 - INFO - trainer.trainer - v4 Global step: 3200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   4%|▍         | 3/78 [00:01<00:39,  1.90it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:33,  2.24it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.48it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:27,  2.64it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.78it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.87it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.94it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.98it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.02it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.04it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.04it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.11it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.11it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.12it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:20:19,496 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:20:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:20:19 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:20:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:20:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:20:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:20:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.90382624, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [921, 1000, 951, 774, 952, 1040, 540, 613, 637, 815, 325, 324], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 51373348, 'remaining_params': 33644252, 'pruned_model_sparsity': 0.60426721055405, 'expected_sparsity': 0.60093, 'target_sparsity': 0.6, 'step': 3250}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.97it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.20it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:09,  2.41it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.58it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.70it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.80it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.88it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.94it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.99it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.02it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.20it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.16it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.15it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.12it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.10it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.24it/s][A03/23/2024 23:20:28 - INFO - trainer.trainer - Epoch 41 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  42%|████▏     | 42/100 [18:27<25:29, 26.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.05it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.05it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.05it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:20:36,288 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:20:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:20:36 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:20:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:20:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:20:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:20:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8810588, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [912, 992, 944, 767, 946, 1035, 533, 605, 629, 808, 298, 321], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 51514292, 'remaining_params': 33503308, 'pruned_model_sparsity': 0.6059250319933754, 'expected_sparsity': 0.60526, 'target_sparsity': 0.6, 'step': 3300}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.96it/s][A03/23/2024 23:20:37 - INFO - trainer.trainer - v4 Global step: 3300, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  32%|███▏      | 25/78 [00:08<00:24,  2.19it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.39it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.57it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.70it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.80it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.88it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.94it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.00it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.02it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.03it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:20:53,162 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:20:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:20:53 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:20:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:20:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.12it/s]03/23/2024 23:20:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:20:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8769248, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [907, 988, 941, 764, 943, 1032, 528, 601, 623, 803, 281, 319], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 9, 12, 8, 7, 5], 'pruned_params': 51791584, 'remaining_params': 33226016, 'pruned_model_sparsity': 0.6091866154772659, 'expected_sparsity': 0.6078, 'target_sparsity': 0.6, 'step': 3350}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.97it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.20it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.40it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.57it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.81it/s][A03/23/2024 23:20:55 - INFO - trainer.trainer - Epoch 42 finished. Took 26.57 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  43%|████▎     | 43/100 [18:54<25:06, 26.43s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.98it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.12it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.11it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:21:10,001 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:21:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:21:10 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:21:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:21:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:21:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:21:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7003610108303249, 'eval_loss': 0.8807473, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [906, 986, 940, 762, 942, 1031, 526, 599, 621, 800, 270, 317], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 9, 12, 8, 7, 5], 'pruned_params': 51829884, 'remaining_params': 33187716, 'pruned_model_sparsity': 0.6096371104336044, 'expected_sparsity': 0.60912, 'target_sparsity': 0.6, 'step': 3400}
03/23/2024 23:21:10 - INFO - trainer.trainer - Saving the best model so far: [Epoch 43 | Step: 3400 | Model size: 33187716 | Score: 0.70036]

[INFO|configuration_utils.py:439] 2024-03-23 23:21:10,627 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 23:21:13,326 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  59%|█████▉    | 46/78 [00:18<00:42,  1.32s/it][A03/23/2024 23:21:13 - INFO - trainer.trainer - v4 Global step: 3400, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  60%|██████    | 47/78 [00:18<00:32,  1.04s/it][A
Iteration:  62%|██████▏   | 48/78 [00:19<00:24,  1.21it/s][A
Iteration:  63%|██████▎   | 49/78 [00:19<00:19,  1.48it/s][A
Iteration:  64%|██████▍   | 50/78 [00:19<00:15,  1.75it/s][A
Iteration:  65%|██████▌   | 51/78 [00:19<00:13,  2.01it/s][A
Iteration:  67%|██████▋   | 52/78 [00:20<00:11,  2.25it/s][A
Iteration:  68%|██████▊   | 53/78 [00:20<00:10,  2.45it/s][A
Iteration:  69%|██████▉   | 54/78 [00:20<00:09,  2.61it/s][A
Iteration:  71%|███████   | 55/78 [00:21<00:08,  2.73it/s][A
Iteration:  72%|███████▏  | 56/78 [00:21<00:07,  2.83it/s][A
Iteration:  73%|███████▎  | 57/78 [00:21<00:07,  2.90it/s][A
Iteration:  74%|███████▍  | 58/78 [00:22<00:06,  2.93it/s][A
Iteration:  76%|███████▌  | 59/78 [00:22<00:06,  2.98it/s][A
Iteration:  77%|███████▋  | 60/78 [00:22<00:05,  3.00it/s][A
Iteration:  78%|███████▊  | 61/78 [00:23<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:23<00:05,  3.04it/s][A
Iteration:  81%|████████  | 63/78 [00:23<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:24<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:24<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:24<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:25<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:25<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:25<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:26<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:26<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:26<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:27<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:27<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:27<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:28<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:28<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:28<00:00,  3.20it/s][A03/23/2024 23:21:23 - INFO - trainer.trainer - Epoch 43 finished. Took 28.72 seconds.
Iteration: 100%|██████████| 78/78 [00:28<00:00,  2.72it/s]
Epoch:  44%|████▍     | 44/100 [19:22<25:18, 27.12s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.10it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:21:29,601 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:21:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:21:29 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:21:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:21:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]03/23/2024 23:21:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:21:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.8817784, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [907, 988, 942, 763, 944, 1033, 526, 599, 621, 798, 264, 317], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 9, 12, 7, 7, 5], 'pruned_params': 52019852, 'remaining_params': 32997748, 'pruned_model_sparsity': 0.611871565417043, 'expected_sparsity': 0.60934, 'target_sparsity': 0.6, 'step': 3450}


Iteration:  23%|██▎       | 18/78 [00:06<00:30,  1.96it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:26,  2.20it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:24,  2.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:22,  2.59it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:20,  2.72it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.82it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.88it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.93it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.97it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.00it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.02it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.03it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.05it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.11it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.11it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.10it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.11it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.05it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A[INFO|trainer.py:570] 2024-03-23 23:21:46,417 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:21:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:21:46 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:21:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:21:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:21:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:21:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.9042884, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [911, 992, 946, 766, 947, 1037, 527, 601, 623, 798, 263, 316], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 9, 12, 7, 7, 5], 'pruned_params': 51980020, 'remaining_params': 33037580, 'pruned_model_sparsity': 0.611403050662451, 'expected_sparsity': 0.60878, 'target_sparsity': 0.6, 'step': 3500}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.97it/s][A03/23/2024 23:21:47 - INFO - trainer.trainer - v4 Global step: 3500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.20it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:03,  2.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.58it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.72it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.80it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.87it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.97it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.98it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.14it/s][A03/23/2024 23:21:50 - INFO - trainer.trainer - Epoch 44 finished. Took 26.49 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  45%|████▌     | 45/100 [19:49<24:41, 26.93s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.04it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.05it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:22:03,267 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:22:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:22:03 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:22:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:22:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:22:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:22:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.9120611, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [918, 998, 953, 771, 953, 1043, 531, 605, 627, 798, 265, 317], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 9, 12, 8, 7, 5], 'pruned_params': 51705792, 'remaining_params': 33311808, 'pruned_model_sparsity': 0.6081775067750678, 'expected_sparsity': 0.60727, 'target_sparsity': 0.6, 'step': 3550}


Iteration:  51%|█████▏    | 40/78 [00:13<00:19,  1.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:16,  2.20it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:14,  2.41it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.58it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.71it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.81it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.88it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.93it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.97it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.01it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:22:16 - INFO - trainer.trainer - Epoch 45 finished. Took 25.94 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  46%|████▌     | 46/100 [20:15<23:58, 26.63s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:22:20,085 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:22:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:22:20 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:22:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:22:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:22:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:22:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8816283, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [927, 1006, 962, 778, 959, 1051, 536, 611, 634, 800, 269, 317], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 51403988, 'remaining_params': 33613612, 'pruned_model_sparsity': 0.6046276065191207, 'expected_sparsity': 0.6052, 'target_sparsity': 0.6, 'step': 3600}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.95it/s][A03/23/2024 23:22:20 - INFO - trainer.trainer - v4 Global step: 3600, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.19it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.39it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.57it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:22,  2.70it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.79it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.87it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.91it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.96it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  3.00it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.02it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.02it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.03it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:22:36,981 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:22:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:22:36 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:22:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:22:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:22:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:22:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8920541, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [938, 1016, 972, 786, 968, 1059, 542, 617, 641, 801, 276, 318], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 51278364, 'remaining_params': 33739236, 'pruned_model_sparsity': 0.6031499830623306, 'expected_sparsity': 0.6027, 'target_sparsity': 0.6, 'step': 3650}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  1.95it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.20it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.41it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.58it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.72it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.81it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.87it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.92it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.96it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.99it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.00it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A03/23/2024 23:22:42 - INFO - trainer.trainer - Epoch 46 finished. Took 26.57 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  47%|████▋     | 47/100 [20:41<23:30, 26.62s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.04it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:22:53,836 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:22:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:22:53 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:22:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:22:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:22:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:22:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.88421077, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [948, 1026, 982, 794, 976, 1068, 548, 624, 648, 803, 283, 319], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 51152740, 'remaining_params': 33864860, 'pruned_model_sparsity': 0.6016723596055406, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 3700}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.97it/s][A03/23/2024 23:22:54 - INFO - trainer.trainer - v4 Global step: 3700, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  45%|████▍     | 35/78 [00:12<00:19,  2.20it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.40it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.57it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.71it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.81it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.89it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.95it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.99it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.00it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.03it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.05it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:23:08 - INFO - trainer.trainer - Epoch 47 finished. Took 25.95 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  48%|████▊     | 48/100 [21:07<22:53, 26.42s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.03it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.02it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.04it/s][A[INFO|trainer.py:570] 2024-03-23 23:23:10,681 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:23:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:23:10 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:23:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:23:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:23:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:23:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8968787, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [959, 1035, 992, 801, 983, 1075, 553, 630, 654, 805, 288, 320], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 51040904, 'remaining_params': 33976696, 'pruned_model_sparsity': 0.6003569143330322, 'expected_sparsity': 0.59758, 'target_sparsity': 0.6, 'step': 3750}


Iteration:   8%|▊         | 6/78 [00:02<00:38,  1.86it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:33,  2.14it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.37it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:27,  2.54it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.69it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.80it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:23,  2.87it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.94it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.98it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  3.00it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.04it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.04it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:23:27,552 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:23:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:23:27 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:23:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:23:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:23:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:23:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.86643666, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [967, 1042, 1000, 806, 989, 1082, 556, 634, 659, 805, 290, 320], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 50956644, 'remaining_params': 34060956, 'pruned_model_sparsity': 0.5993658254290877, 'expected_sparsity': 0.59591, 'target_sparsity': 0.6, 'step': 3800}


Iteration:  72%|███████▏  | 56/78 [00:19<00:11,  1.97it/s][A03/23/2024 23:23:28 - INFO - trainer.trainer - v4 Global step: 3800, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.20it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:08,  2.41it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:07,  2.58it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.71it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.81it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.89it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.95it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.99it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.03it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.04it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.04it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.05it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:23:35 - INFO - trainer.trainer - Epoch 48 finished. Took 26.57 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  49%|████▉     | 49/100 [21:34<22:29, 26.46s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:23:44,392 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:23:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:23:44 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:23:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:23:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:23:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:23:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8744786, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [972, 1047, 1006, 810, 993, 1086, 558, 636, 661, 805, 287, 320], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 50909152, 'remaining_params': 34108448, 'pruned_model_sparsity': 0.5988072116832279, 'expected_sparsity': 0.59521, 'target_sparsity': 0.6, 'step': 3850}


Iteration:  36%|███▌      | 28/78 [00:09<00:25,  1.97it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:22,  2.20it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:20,  2.39it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:18,  2.56it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:17,  2.69it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:16,  2.79it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:15,  2.86it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  2.88it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.93it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.98it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.00it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  3.00it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.02it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.02it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.05it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.03it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.05it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.05it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:24:01,298 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:24:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:24:01 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:24:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:24:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:24:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:24:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.9135305, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [974, 1050, 1009, 811, 994, 1089, 557, 637, 663, 802, 281, 319], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 50895364, 'remaining_params': 34122236, 'pruned_model_sparsity': 0.5986450334989462, 'expected_sparsity': 0.59544, 'target_sparsity': 0.6, 'step': 3900}


Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.01it/s][A03/23/2024 23:24:01 - INFO - trainer.trainer - Epoch 49 finished. Took 26.63 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  50%|█████     | 50/100 [22:00<22:05, 26.51s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A03/23/2024 23:24:02 - INFO - trainer.trainer - v4 Global step: 3900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.23it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.18it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.15it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.13it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.12it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.10it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:24:18,113 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:24:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:24:18 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:24:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:24:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:24:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:24:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.91541517, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [974, 1051, 1011, 811, 995, 1090, 556, 636, 661, 799, 272, 317], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 50907620, 'remaining_params': 34109980, 'pruned_model_sparsity': 0.5987891918849744, 'expected_sparsity': 0.59635, 'target_sparsity': 0.6, 'step': 3950}


Iteration:  64%|██████▍   | 50/78 [00:16<00:14,  1.96it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:12,  2.20it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:10,  2.41it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:09,  2.57it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.68it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:08,  2.79it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.87it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.93it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  2.96it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.00it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.03it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.05it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.04it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.16it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.15it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.13it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.11it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.11it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A03/23/2024 23:24:27 - INFO - trainer.trainer - Epoch 50 finished. Took 25.86 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  51%|█████     | 51/100 [22:26<21:29, 26.32s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.00it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:24:34,935 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:24:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:24:34 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:24:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:24:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:24:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:24:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.8988789, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [972, 1050, 1011, 810, 994, 1090, 554, 635, 659, 795, 261, 316], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 8, 7, 5], 'pruned_params': 50939792, 'remaining_params': 34077808, 'pruned_model_sparsity': 0.5991676076482987, 'expected_sparsity': 0.59769, 'target_sparsity': 0.6, 'step': 4000}


Iteration:  28%|██▊       | 22/78 [00:07<00:28,  1.96it/s][A03/23/2024 23:24:35 - INFO - trainer.trainer - v4 Global step: 4000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  29%|██▉       | 23/78 [00:08<00:25,  2.20it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:22,  2.40it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:20,  2.57it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:19,  2.69it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:18,  2.82it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:17,  2.89it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.95it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.99it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.02it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.04it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.04it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.04it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:24:51,832 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:24:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:24:51 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:24:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:24:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:24:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:24:52 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.8663104, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [969, 1048, 1009, 808, 994, 1089, 551, 632, 657, 792, 251, 314], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 5], 'pruned_params': 51178784, 'remaining_params': 33838816, 'pruned_model_sparsity': 0.6019786961758506, 'expected_sparsity': 0.59919, 'target_sparsity': 0.6, 'step': 4050}


Iteration:  92%|█████████▏| 72/78 [00:24<00:03,  1.96it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:02,  2.20it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.58it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.71it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.80it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.99it/s][A03/23/2024 23:24:54 - INFO - trainer.trainer - Epoch 51 finished. Took 26.58 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  52%|█████▏    | 52/100 [22:53<21:07, 26.40s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.02it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.05it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.05it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.04it/s][A[INFO|trainer.py:570] 2024-03-23 23:25:08,708 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:25:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:25:08 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:25:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:25:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:25:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:25:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.866007, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [968, 1048, 1009, 807, 993, 1089, 549, 631, 655, 788, 241, 312], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 5], 'pruned_params': 51206360, 'remaining_params': 33811240, 'pruned_model_sparsity': 0.6023030525444143, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 4100}


Iteration:  56%|█████▋    | 44/78 [00:14<00:17,  1.96it/s][A03/23/2024 23:25:09 - INFO - trainer.trainer - v4 Global step: 4100, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  58%|█████▊    | 45/78 [00:15<00:15,  2.20it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:13,  2.41it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:11,  2.59it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:11,  2.71it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:10,  2.81it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.88it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.94it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.98it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.00it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.04it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.04it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:25:20 - INFO - trainer.trainer - Epoch 52 finished. Took 25.97 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.00it/s]
Epoch:  53%|█████▎    | 53/100 [23:19<20:34, 26.27s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.14it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.11it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:25:25,504 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:25:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:25:25 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:25:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:25:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:25:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:25:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.89007634, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [967, 1047, 1009, 806, 993, 1090, 547, 629, 654, 785, 233, 311], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 5], 'pruned_params': 51229340, 'remaining_params': 33788260, 'pruned_model_sparsity': 0.6025733495182174, 'expected_sparsity': 0.60137, 'target_sparsity': 0.6, 'step': 4150}


Iteration:  21%|██        | 16/78 [00:05<00:31,  1.96it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:27,  2.20it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:24,  2.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:22,  2.58it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:21,  2.70it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:20,  2.81it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.89it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.96it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.99it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.03it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.04it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.04it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.04it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.11it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.10it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.26it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.18it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.14it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.11it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.11it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.11it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A[INFO|trainer.py:570] 2024-03-23 23:25:42,286 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:25:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:25:42 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:25:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:25:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:25:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:25:42 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7003610108303249, 'eval_loss': 0.8761158, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [968, 1048, 1011, 806, 994, 1092, 547, 629, 654, 782, 227, 310], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51423904, 'remaining_params': 33593696, 'pruned_model_sparsity': 0.6048618638964167, 'expected_sparsity': 0.60188, 'target_sparsity': 0.6, 'step': 4200}


Iteration:  85%|████████▍ | 66/78 [00:22<00:06,  1.97it/s][A03/23/2024 23:25:43 - INFO - trainer.trainer - v4 Global step: 4200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  86%|████████▌ | 67/78 [00:22<00:04,  2.20it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:04,  2.41it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.58it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.71it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.82it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.90it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.95it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.98it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.01it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.02it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.04it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.18it/s][A03/23/2024 23:25:46 - INFO - trainer.trainer - Epoch 53 finished. Took 26.44 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  54%|█████▍    | 54/100 [23:45<20:10, 26.32s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.04it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.04it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.11it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.10it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:25:59,097 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:25:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:25:59 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:25:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:25:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:25:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:25:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.8567732, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [970, 1051, 1015, 806, 995, 1094, 546, 629, 655, 780, 223, 309], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51411648, 'remaining_params': 33605952, 'pruned_model_sparsity': 0.6047177055103884, 'expected_sparsity': 0.60199, 'target_sparsity': 0.6, 'step': 4250}


Iteration:  49%|████▊     | 38/78 [00:12<00:20,  1.97it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:17,  2.21it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:15,  2.40it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:14,  2.57it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.70it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.80it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.88it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.95it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.99it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.00it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.02it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.04it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.05it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:26:12 - INFO - trainer.trainer - Epoch 54 finished. Took 25.91 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  55%|█████▌    | 55/100 [24:11<19:38, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.15it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.17it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.12it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:26:15,918 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:26:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:26:15 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:26:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:26:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:26:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:26:16 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8639692, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [973, 1054, 1019, 809, 998, 1097, 547, 631, 657, 780, 220, 308], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51379476, 'remaining_params': 33638124, 'pruned_model_sparsity': 0.6043392897470642, 'expected_sparsity': 0.60168, 'target_sparsity': 0.6, 'step': 4300}


Iteration:  13%|█▎        | 10/78 [00:03<00:35,  1.93it/s][A03/23/2024 23:26:16 - INFO - trainer.trainer - v4 Global step: 4300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  14%|█▍        | 11/78 [00:04<00:30,  2.19it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:27,  2.39it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:25,  2.56it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:23,  2.70it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:22,  2.79it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.87it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.94it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.98it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.01it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.03it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.02it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.04it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.05it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.10it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A[INFO|trainer.py:570] 2024-03-23 23:26:32,798 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:26:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:26:32 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:26:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:26:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:26:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:26:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8652927, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [978, 1058, 1025, 811, 1001, 1101, 549, 633, 660, 779, 218, 307], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51335048, 'remaining_params': 33682552, 'pruned_model_sparsity': 0.6038167155977116, 'expected_sparsity': 0.60119, 'target_sparsity': 0.6, 'step': 4350}


Iteration:  77%|███████▋  | 60/78 [00:20<00:09,  1.97it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:07,  2.21it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:06,  2.41it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.60it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.73it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.83it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.90it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.95it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.97it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.00it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.03it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.18it/s][A03/23/2024 23:26:39 - INFO - trainer.trainer - Epoch 55 finished. Took 26.54 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  56%|█████▌    | 56/100 [24:38<19:17, 26.30s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.04it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:26:49,620 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:26:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:26:49 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:26:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:26:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:26:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:26:50 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.86821145, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1063, 1031, 815, 1004, 1106, 551, 636, 663, 778, 216, 307], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51281428, 'remaining_params': 33736172, 'pruned_model_sparsity': 0.6031860226588377, 'expected_sparsity': 0.60045, 'target_sparsity': 0.6, 'step': 4400}


Iteration:  41%|████      | 32/78 [00:11<00:23,  1.96it/s][A03/23/2024 23:26:50 - INFO - trainer.trainer - v4 Global step: 4400, Alignment: tensor([ 2,  5,  6, 10], device='cuda:0')

Iteration:  42%|████▏     | 33/78 [00:11<00:20,  2.20it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:18,  2.39it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:16,  2.57it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:15,  2.70it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.81it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.88it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.93it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.97it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.01it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.03it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.11it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.10it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.10it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A03/23/2024 23:27:05 - INFO - trainer.trainer - Epoch 56 finished. Took 25.93 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  57%|█████▋    | 57/100 [25:04<18:46, 26.19s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:27:06,445 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:27:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:27:06 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:27:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:27:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:27:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:27:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7003610108303249, 'eval_loss': 0.8663396, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [990, 1069, 1037, 818, 1008, 1111, 552, 639, 666, 777, 215, 306], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 4450}


Iteration:   5%|▌         | 4/78 [00:01<00:42,  1.76it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:35,  2.07it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:30,  2.33it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:27,  2.54it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:25,  2.69it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:24,  2.81it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:23,  2.88it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  2.93it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.98it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.99it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.01it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.03it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.10it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.05it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:27:23,313 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:27:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:27:23 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:27:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:27:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:27:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:27:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.8716977, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [995, 1074, 1044, 822, 1012, 1115, 553, 641, 668, 776, 213, 306], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51177252, 'remaining_params': 33840348, 'pruned_model_sparsity': 0.6019606763775971, 'expected_sparsity': 0.59922, 'target_sparsity': 0.6, 'step': 4500}


Iteration:  69%|██████▉   | 54/78 [00:18<00:12,  1.96it/s][A03/23/2024 23:27:24 - INFO - trainer.trainer - v4 Global step: 4500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.19it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:09,  2.39it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:08,  2.57it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.70it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.80it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.88it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.93it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.98it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.04it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.05it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A03/23/2024 23:27:31 - INFO - trainer.trainer - Epoch 57 finished. Took 26.54 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  58%|█████▊    | 58/100 [25:30<18:24, 26.29s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:27:40,144 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:27:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:27:40 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:27:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:27:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:27:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:27:40 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.87627274, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1000, 1078, 1050, 824, 1015, 1118, 554, 643, 670, 775, 210, 305], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51138952, 'remaining_params': 33878648, 'pruned_model_sparsity': 0.6015101814212587, 'expected_sparsity': 0.59899, 'target_sparsity': 0.6, 'step': 4550}


Iteration:  33%|███▎      | 26/78 [00:09<00:26,  1.96it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.20it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:20,  2.41it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:19,  2.57it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:17,  2.71it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:16,  2.80it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.88it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.94it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.98it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.02it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.03it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.04it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.04it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.05it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.11it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.10it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.10it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:27:56,997 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:27:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:27:56 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:27:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:27:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:27:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:27:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.87780046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1002, 1081, 1054, 826, 1017, 1121, 555, 644, 672, 773, 207, 304], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51112908, 'remaining_params': 33904692, 'pruned_model_sparsity': 0.6012038448509485, 'expected_sparsity': 0.59891, 'target_sparsity': 0.6, 'step': 4600}


Iteration:  97%|█████████▋| 76/78 [00:25<00:01,  1.96it/s][A03/23/2024 23:27:57 - INFO - trainer.trainer - v4 Global step: 4600, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.20it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.49it/s][A03/23/2024 23:27:58 - INFO - trainer.trainer - Epoch 58 finished. Took 26.53 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  59%|█████▉    | 59/100 [25:57<18:01, 26.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:28:13,835 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:28:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:28:13 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:28:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:28:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:28:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:28:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.887038, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1004, 1083, 1057, 827, 1019, 1124, 554, 645, 673, 771, 204, 303], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51096056, 'remaining_params': 33921544, 'pruned_model_sparsity': 0.6010056270701596, 'expected_sparsity': 0.59899, 'target_sparsity': 0.6, 'step': 4650}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.97it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:13,  2.21it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:11,  2.42it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.58it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.71it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.80it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.87it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.93it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.98it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.00it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.03it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.03it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.19it/s][A03/23/2024 23:28:24 - INFO - trainer.trainer - Epoch 59 finished. Took 25.95 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  60%|██████    | 60/100 [26:23<17:29, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:28:30,678 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:28:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:28:30 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:28:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:28:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:28:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:28:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7003610108303249, 'eval_loss': 0.8722012, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1006, 1085, 1060, 827, 1019, 1126, 554, 646, 673, 768, 202, 302], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51083800, 'remaining_params': 33933800, 'pruned_model_sparsity': 0.6008614686841313, 'expected_sparsity': 0.59922, 'target_sparsity': 0.6, 'step': 4700}


Iteration:  26%|██▌       | 20/78 [00:07<00:29,  1.96it/s][A03/23/2024 23:28:31 - INFO - trainer.trainer - v4 Global step: 4700, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  27%|██▋       | 21/78 [00:07<00:25,  2.20it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.41it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.58it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:19,  2.71it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.80it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:18,  2.87it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.94it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.99it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.02it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.05it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.05it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.05it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.05it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:28:47,565 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:28:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:28:47 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:28:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:28:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:28:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:28:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.87832, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1085, 1062, 827, 1020, 1127, 553, 646, 674, 766, 200, 301], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51079204, 'remaining_params': 33938396, 'pruned_model_sparsity': 0.6008074092893707, 'expected_sparsity': 0.59955, 'target_sparsity': 0.6, 'step': 4750}


Iteration:  90%|████████▉ | 70/78 [00:24<00:04,  1.96it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.20it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.41it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.58it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.71it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.90it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.95it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.11it/s][A03/23/2024 23:28:50 - INFO - trainer.trainer - Epoch 60 finished. Took 26.55 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  61%|██████    | 61/100 [26:49<17:07, 26.34s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.04it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.11it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.10it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.05it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:29:04,378 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:29:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:29:04 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:29:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:29:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:29:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:29:04 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.884619, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1006, 1086, 1064, 826, 1020, 1127, 552, 646, 673, 763, 199, 300], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51082268, 'remaining_params': 33935332, 'pruned_model_sparsity': 0.6008434488858777, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 4800}


Iteration:  54%|█████▍    | 42/78 [00:14<00:18,  1.96it/s][A03/23/2024 23:29:05 - INFO - trainer.trainer - v4 Global step: 4800, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  55%|█████▌    | 43/78 [00:14<00:15,  2.19it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:14,  2.39it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:12,  2.57it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.71it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:11,  2.82it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.89it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.95it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.98it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.01it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.04it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.05it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.12it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.11it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.11it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.12it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.25it/s][A03/23/2024 23:29:16 - INFO - trainer.trainer - Epoch 61 finished. Took 25.89 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  62%|██████▏   | 62/100 [27:15<16:35, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.98it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.05it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:29:21,192 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:29:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:29:21 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:29:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:29:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:29:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:29:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.88938016, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1006, 1087, 1065, 826, 1020, 1128, 552, 646, 674, 761, 198, 298], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 7, 4], 'pruned_params': 51077672, 'remaining_params': 33939928, 'pruned_model_sparsity': 0.6007893894911172, 'expected_sparsity': 0.60015, 'target_sparsity': 0.6, 'step': 4850}


Iteration:  18%|█▊        | 14/78 [00:05<00:32,  1.96it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:28,  2.20it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:25,  2.41it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:23,  2.57it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:22,  2.71it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:21,  2.80it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:20,  2.88it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.94it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.98it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.00it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.03it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.05it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.04it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.12it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:29:38,063 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:29:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:29:38 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:29:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:29:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:29:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:29:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.89023334, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1089, 1067, 826, 1021, 1130, 551, 646, 674, 758, 197, 297], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 6, 4], 'pruned_params': 51264576, 'remaining_params': 33753024, 'pruned_model_sparsity': 0.6029878048780488, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 4900}


Iteration:  82%|████████▏ | 64/78 [00:22<00:07,  1.96it/s][A03/23/2024 23:29:38 - INFO - trainer.trainer - v4 Global step: 4900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.20it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.41it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:04,  2.57it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.71it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.82it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.89it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.92it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.95it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.99it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.02it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:29:43 - INFO - trainer.trainer - Epoch 62 finished. Took 26.57 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  63%|██████▎   | 63/100 [27:42<16:13, 26.31s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.05it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.04it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.05it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.05it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.04it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:29:54,933 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:29:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:29:54 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:29:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:29:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:29:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:29:55 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8790825, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1008, 1090, 1070, 826, 1023, 1131, 551, 646, 675, 756, 197, 296], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 6, 4], 'pruned_params': 51250788, 'remaining_params': 33766812, 'pruned_model_sparsity': 0.6028256266937669, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 4950}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.97it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.21it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:16,  2.41it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.57it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:14,  2.71it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:13,  2.81it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.88it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.93it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.97it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.00it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.01it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.03it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:30:09 - INFO - trainer.trainer - Epoch 63 finished. Took 25.97 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.00it/s]
Epoch:  64%|██████▍   | 64/100 [28:08<15:43, 26.21s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.04it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:30:11,763 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:30:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:30:11 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:30:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:30:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:30:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:30:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8963285, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1010, 1091, 1073, 827, 1024, 1133, 551, 647, 677, 754, 197, 294], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 6, 4], 'pruned_params': 51230872, 'remaining_params': 33786728, 'pruned_model_sparsity': 0.602591369316471, 'expected_sparsity': 0.60037, 'target_sparsity': 0.6, 'step': 5000}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.92it/s][A03/23/2024 23:30:12 - INFO - trainer.trainer - v4 Global step: 5000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  12%|█▏        | 9/78 [00:03<00:31,  2.17it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.39it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:26,  2.56it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.70it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.82it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.89it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.95it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.96it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.99it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.02it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.04it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.05it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.04it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.05it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.04it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.04it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.05it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.05it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.14it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.11it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.10it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.10it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A[INFO|trainer.py:570] 2024-03-23 23:30:28,659 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:30:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:30:28 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:30:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:30:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:30:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:30:29 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8791958, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1012, 1093, 1077, 827, 1026, 1136, 551, 649, 678, 751, 196, 293], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 6, 4], 'pruned_params': 51207892, 'remaining_params': 33809708, 'pruned_model_sparsity': 0.6023210723426679, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 5050}


Iteration:  74%|███████▍  | 58/78 [00:20<00:10,  1.97it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.19it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.40it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.57it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.71it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.80it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.88it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.94it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.97it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.01it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.03it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:30:35 - INFO - trainer.trainer - Epoch 64 finished. Took 26.58 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  65%|██████▌   | 65/100 [28:34<15:21, 26.32s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.10it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:30:45,492 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:30:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:30:45 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:30:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:30:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:30:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:30:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.87727076, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1015, 1096, 1081, 828, 1028, 1139, 551, 650, 680, 749, 196, 292], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 6, 4], 'pruned_params': 51178784, 'remaining_params': 33838816, 'pruned_model_sparsity': 0.6019786961758506, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 5100}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.96it/s][A03/23/2024 23:30:46 - INFO - trainer.trainer - v4 Global step: 5100, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.20it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:19,  2.41it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.58it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.71it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:15,  2.81it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.88it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.93it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.97it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.00it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.02it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:31:01 - INFO - trainer.trainer - Epoch 65 finished. Took 25.92 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  66%|██████▌   | 66/100 [29:00<14:50, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A[INFO|trainer.py:570] 2024-03-23 23:31:02,307 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:31:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:31:02 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:31:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:31:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:31:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:31:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.87271845, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1018, 1099, 1085, 829, 1030, 1141, 551, 651, 681, 747, 196, 291], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 6, 4], 'pruned_params': 51152740, 'remaining_params': 33864860, 'pruned_model_sparsity': 0.6016723596055406, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 5150}


Iteration:   3%|▎         | 2/78 [00:01<00:52,  1.46it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:39,  1.90it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:32,  2.25it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.49it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:27,  2.66it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.79it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.87it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.95it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.99it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.03it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.04it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.04it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.04it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:31:19,183 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:31:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:31:19 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:31:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:31:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:31:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:31:19 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.8667193, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1020, 1101, 1089, 830, 1032, 1144, 551, 653, 683, 745, 196, 290], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 9, 12, 7, 6, 4], 'pruned_params': 51125164, 'remaining_params': 33892436, 'pruned_model_sparsity': 0.6013480032369768, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 5200}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.96it/s][A03/23/2024 23:31:19 - INFO - trainer.trainer - v4 Global step: 5200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.20it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:09,  2.41it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.58it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.71it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.81it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.89it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.96it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.99it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.04it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.05it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.03it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A03/23/2024 23:31:28 - INFO - trainer.trainer - Epoch 66 finished. Took 26.56 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  67%|██████▋   | 67/100 [29:27<14:28, 26.31s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.10it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:31:35,977 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:31:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:31:35 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:31:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:31:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:31:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:31:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.8524496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1022, 1103, 1092, 830, 1034, 1146, 552, 654, 684, 742, 196, 288], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 8, 12, 7, 6, 4], 'pruned_params': 51299812, 'remaining_params': 33717788, 'pruned_model_sparsity': 0.6034022602378801, 'expected_sparsity': 0.59962, 'target_sparsity': 0.6, 'step': 5250}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:23,  2.21it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.42it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.58it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.71it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.80it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.88it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.94it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.99it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.02it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.05it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:31:52,861 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:31:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:31:52 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:31:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:31:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:31:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:31:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.8683331, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 1104, 1095, 830, 1035, 1148, 551, 654, 685, 740, 196, 287], 'head_nums': [12, 11, 9, 10, 11, 11, 6, 8, 12, 7, 6, 4], 'pruned_params': 51287556, 'remaining_params': 33730044, 'pruned_model_sparsity': 0.6032581018518518, 'expected_sparsity': 0.59965, 'target_sparsity': 0.6, 'step': 5300}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.96it/s][A03/23/2024 23:31:53 - INFO - trainer.trainer - v4 Global step: 5300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.20it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.41it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.59it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.82it/s][A03/23/2024 23:31:54 - INFO - trainer.trainer - Epoch 67 finished. Took 26.51 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  68%|██████▊   | 68/100 [29:53<14:03, 26.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.05it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.05it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:32:09,695 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:32:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:32:09 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:32:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:32:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:32:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:32:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8511138, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 1105, 1097, 829, 1036, 1150, 551, 655, 686, 737, 196, 285], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 5350}


Iteration:  59%|█████▉    | 46/78 [00:15<00:16,  1.96it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:14,  2.19it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:12,  2.39it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:11,  2.56it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:10,  2.69it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.80it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.89it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.94it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.99it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.02it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.03it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:32:20 - INFO - trainer.trainer - Epoch 68 finished. Took 25.94 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  69%|██████▉   | 69/100 [30:19<13:33, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:32:26,517 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:32:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:32:26 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:32:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:32:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:32:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:32:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.8599031, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 1106, 1098, 829, 1036, 1151, 550, 655, 687, 733, 196, 284], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 5400}


Iteration:  23%|██▎       | 18/78 [00:06<00:30,  1.96it/s][A03/23/2024 23:32:27 - INFO - trainer.trainer - v4 Global step: 5400, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  24%|██▍       | 19/78 [00:06<00:26,  2.20it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:24,  2.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:22,  2.57it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:20,  2.70it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.80it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.88it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.94it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.99it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.03it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.03it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.05it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:13,  3.32it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.26it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.20it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:12,  3.16it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.15it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.12it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.12it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.11it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.11it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.11it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.10it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.11it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.11it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:32:43,266 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:32:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:32:43 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:32:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:32:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:32:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:32:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.86180574, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 1107, 1100, 829, 1037, 1152, 550, 656, 687, 730, 196, 282], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 5450}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.96it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.20it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:03,  2.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.57it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.70it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.80it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.88it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.99it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.02it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.16it/s][A03/23/2024 23:32:47 - INFO - trainer.trainer - Epoch 69 finished. Took 26.42 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  70%|███████   | 70/100 [30:46<13:08, 26.29s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.05it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:33:00,091 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:33:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:33:00 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:33:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:33:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:33:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:33:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7003610108303249, 'eval_loss': 0.8670741, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1024, 1107, 1102, 828, 1037, 1154, 549, 656, 688, 727, 196, 281], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 5500}


Iteration:  51%|█████▏    | 40/78 [00:13<00:19,  1.96it/s][A03/23/2024 23:33:00 - INFO - trainer.trainer - v4 Global step: 5500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  53%|█████▎    | 41/78 [00:13<00:16,  2.20it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:14,  2.41it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.58it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.71it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.82it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.89it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.93it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.95it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.00it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.03it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.03it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.04it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:33:13 - INFO - trainer.trainer - Epoch 70 finished. Took 25.94 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  71%|███████   | 71/100 [31:12<12:39, 26.19s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:33:16,927 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:33:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:33:16 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:33:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:33:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.25it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.39it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.43it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.99it/s]03/23/2024 23:33:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:33:17 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.8738638, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1025, 1108, 1104, 828, 1038, 1156, 548, 657, 689, 723, 197, 279], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 5550}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.95it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.19it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.40it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.57it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:22,  2.71it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.81it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.89it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.94it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.99it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.02it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:33:33,790 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:33:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:33:33 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:33:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:33:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:33:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:33:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.86429197, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1026, 1109, 1107, 829, 1039, 1157, 548, 658, 691, 720, 197, 277], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51422372, 'remaining_params': 33595228, 'pruned_model_sparsity': 0.6048438440981632, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 5600}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  1.96it/s][A03/23/2024 23:33:34 - INFO - trainer.trainer - v4 Global step: 5600, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.18it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.39it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.56it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.70it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.81it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.89it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.94it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.97it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.01it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.05it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.05it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A03/23/2024 23:33:39 - INFO - trainer.trainer - Epoch 71 finished. Took 26.54 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  72%|███████▏  | 72/100 [31:38<12:16, 26.29s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.04it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.05it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.10it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.10it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.10it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:33:50,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:33:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:33:50 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:33:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:33:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:33:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:33:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.86441076, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1027, 1110, 1109, 829, 1039, 1158, 548, 659, 692, 717, 197, 276], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51411648, 'remaining_params': 33605952, 'pruned_model_sparsity': 0.6047177055103884, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 5650}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.96it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:19,  2.20it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.41it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.58it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.70it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.81it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.88it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.93it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.96it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.99it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.01it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.04it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:34:05 - INFO - trainer.trainer - Epoch 72 finished. Took 25.92 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  73%|███████▎  | 73/100 [32:04<11:46, 26.18s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.01it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:34:07,448 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:34:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:34:07 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:34:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:34:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:34:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:34:08 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.85201263, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1026, 1111, 1110, 829, 1040, 1160, 548, 659, 694, 713, 197, 274], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51402456, 'remaining_params': 33615144, 'pruned_model_sparsity': 0.6046095867208672, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 5700}


Iteration:   8%|▊         | 6/78 [00:02<00:38,  1.87it/s][A03/23/2024 23:34:08 - INFO - trainer.trainer - v4 Global step: 5700, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   9%|▉         | 7/78 [00:02<00:33,  2.14it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.37it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:26,  2.56it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.70it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.81it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.89it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.94it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.97it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  3.00it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.03it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.04it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.11it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.10it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.10it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.11it/s][A[INFO|trainer.py:570] 2024-03-23 23:34:24,286 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:34:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:34:24 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:34:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:34:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:34:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:34:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.8560418, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1026, 1112, 1111, 828, 1041, 1161, 548, 660, 695, 710, 197, 272], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51394796, 'remaining_params': 33622804, 'pruned_model_sparsity': 0.6045194877295995, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 5750}


Iteration:  72%|███████▏  | 56/78 [00:19<00:11,  1.97it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.21it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:08,  2.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:07,  2.58it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.72it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.81it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.87it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.92it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.98it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.15it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.13it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.12it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.11it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A03/23/2024 23:34:31 - INFO - trainer.trainer - Epoch 73 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  74%|███████▍  | 74/100 [32:31<11:23, 26.27s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.14it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.13it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.12it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.11it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.10it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:34:41,031 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:34:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:34:41 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:34:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:34:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:34:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:34:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8423418, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1026, 1112, 1114, 828, 1041, 1163, 548, 660, 696, 706, 197, 271], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51385604, 'remaining_params': 33631996, 'pruned_model_sparsity': 0.6044113689400783, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 5800}


Iteration:  36%|███▌      | 28/78 [00:09<00:25,  1.97it/s][A03/23/2024 23:34:41 - INFO - trainer.trainer - v4 Global step: 5800, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  37%|███▋      | 29/78 [00:10<00:22,  2.20it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:20,  2.39it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:18,  2.57it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:17,  2.70it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:16,  2.80it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:15,  2.86it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  2.92it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.95it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.98it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.01it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.01it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.03it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.04it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.05it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.05it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.04it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.05it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:34:57,915 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:34:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:34:57 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:34:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:34:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:34:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:34:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.8453169, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1026, 1113, 1115, 827, 1042, 1163, 547, 660, 697, 702, 197, 269], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51382540, 'remaining_params': 33635060, 'pruned_model_sparsity': 0.6043753293435712, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 5850}


Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.02it/s][A03/23/2024 23:34:58 - INFO - trainer.trainer - Epoch 74 finished. Took 26.57 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  75%|███████▌  | 75/100 [32:57<10:58, 26.36s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.04it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.05it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.05it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.10it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.12it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.11it/s][A[INFO|trainer.py:570] 2024-03-23 23:35:14,771 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:35:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:35:14 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:35:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:35:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:35:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:35:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.8614384, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1025, 1113, 1117, 827, 1042, 1164, 547, 661, 698, 698, 197, 267], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51376412, 'remaining_params': 33641188, 'pruned_model_sparsity': 0.6043032501505571, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 5900}


Iteration:  64%|██████▍   | 50/78 [00:16<00:14,  1.98it/s][A03/23/2024 23:35:15 - INFO - trainer.trainer - v4 Global step: 5900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  65%|██████▌   | 51/78 [00:17<00:12,  2.21it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:10,  2.42it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:09,  2.59it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.72it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:08,  2.82it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.85it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.92it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  2.97it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.00it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.00it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.02it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.02it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.05it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:35:24 - INFO - trainer.trainer - Epoch 75 finished. Took 25.93 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  76%|███████▌  | 76/100 [33:23<10:29, 26.23s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.04it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.10it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:35:31,614 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:35:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:35:31 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:35:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:35:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:35:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:35:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.85073715, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1025, 1114, 1118, 826, 1042, 1165, 546, 661, 698, 694, 197, 265], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51374880, 'remaining_params': 33642720, 'pruned_model_sparsity': 0.6042852303523035, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 5950}


Iteration:  28%|██▊       | 22/78 [00:07<00:28,  1.96it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:25,  2.20it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:22,  2.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:20,  2.58it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:19,  2.71it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:18,  2.80it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:17,  2.87it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.93it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.98it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.00it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.02it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.04it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.05it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:35:48,481 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:35:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:35:48 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:35:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:35:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:35:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:35:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.84481627, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1024, 1113, 1119, 826, 1042, 1166, 546, 661, 699, 689, 197, 263], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51373348, 'remaining_params': 33644252, 'pruned_model_sparsity': 0.60426721055405, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 6000}


Iteration:  92%|█████████▏| 72/78 [00:24<00:03,  1.97it/s][A03/23/2024 23:35:49 - INFO - trainer.trainer - v4 Global step: 6000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  94%|█████████▎| 73/78 [00:24<00:02,  2.20it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.40it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.58it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.71it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.80it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.99it/s][A03/23/2024 23:35:51 - INFO - trainer.trainer - Epoch 76 finished. Took 26.55 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  77%|███████▋  | 77/100 [33:50<10:05, 26.33s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.04it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.05it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.05it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.05it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.04it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:36:05,354 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:36:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:36:05 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:36:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:36:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:36:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:36:05 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.8501935, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 1114, 1120, 825, 1043, 1166, 545, 661, 700, 685, 198, 261], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51370284, 'remaining_params': 33647316, 'pruned_model_sparsity': 0.6042311709575429, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 6050}


Iteration:  56%|█████▋    | 44/78 [00:14<00:17,  1.96it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:14,  2.20it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:13,  2.41it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:12,  2.57it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:11,  2.70it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:10,  2.81it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.89it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.93it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.97it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.99it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.02it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.04it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A03/23/2024 23:36:16 - INFO - trainer.trainer - Epoch 77 finished. Took 25.98 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.00it/s]
Epoch:  78%|███████▊  | 78/100 [34:16<09:36, 26.22s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.02it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:36:22,210 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:36:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:36:22 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:36:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:36:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:36:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:36:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8440653, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 1114, 1120, 825, 1043, 1166, 545, 661, 701, 681, 198, 260], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51368752, 'remaining_params': 33648848, 'pruned_model_sparsity': 0.6042131511592894, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 6100}


Iteration:  21%|██        | 16/78 [00:05<00:31,  1.96it/s][A03/23/2024 23:36:22 - INFO - trainer.trainer - v4 Global step: 6100, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  22%|██▏       | 17/78 [00:06<00:27,  2.20it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:24,  2.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:22,  2.58it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:21,  2.71it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:20,  2.80it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.87it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.92it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.01it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.01it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.05it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.05it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:36:39,087 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:36:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:36:39 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:36:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:36:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:36:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:36:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.84230024, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 1114, 1121, 824, 1043, 1167, 544, 661, 701, 676, 198, 258], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51368752, 'remaining_params': 33648848, 'pruned_model_sparsity': 0.6042131511592894, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 6150}


Iteration:  85%|████████▍ | 66/78 [00:22<00:06,  1.96it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:04,  2.21it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:04,  2.42it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.58it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.72it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.82it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.88it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.93it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.98it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.01it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.02it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.05it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A03/23/2024 23:36:43 - INFO - trainer.trainer - Epoch 78 finished. Took 26.55 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  79%|███████▉  | 79/100 [34:42<09:12, 26.32s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.15it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.11it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.11it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.11it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:36:55,888 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:36:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:36:55 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:36:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:36:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:36:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:36:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.844703, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1022, 1114, 1122, 823, 1043, 1168, 544, 661, 702, 671, 198, 256], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51367220, 'remaining_params': 33650380, 'pruned_model_sparsity': 0.6041951313610359, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 6200}


Iteration:  49%|████▊     | 38/78 [00:12<00:20,  1.96it/s][A03/23/2024 23:36:56 - INFO - trainer.trainer - v4 Global step: 6200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  50%|█████     | 39/78 [00:13<00:17,  2.20it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:15,  2.41it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:14,  2.57it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.70it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.81it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.88it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.93it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.97it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.99it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.02it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.04it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.05it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:37:09 - INFO - trainer.trainer - Epoch 79 finished. Took 25.91 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  80%|████████  | 80/100 [35:08<08:44, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.02it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:37:12,729 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:37:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:37:12 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:37:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:37:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:37:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:37:13 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8491916, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1022, 1115, 1123, 823, 1043, 1168, 543, 662, 703, 667, 198, 254], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51362624, 'remaining_params': 33654976, 'pruned_model_sparsity': 0.6041410719662752, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 6250}


Iteration:  13%|█▎        | 10/78 [00:03<00:35,  1.94it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:30,  2.19it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:27,  2.40it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:25,  2.58it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:23,  2.70it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:22,  2.80it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.87it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.93it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.97it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.00it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.03it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.05it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.04it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.12it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.11it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:37:29,593 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:37:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:37:29 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:37:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:37:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:37:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:37:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.85788274, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1021, 1115, 1124, 823, 1043, 1169, 543, 663, 704, 662, 198, 253], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51358028, 'remaining_params': 33659572, 'pruned_model_sparsity': 0.6040870125715146, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 6300}


Iteration:  77%|███████▋  | 60/78 [00:20<00:09,  1.96it/s][A03/23/2024 23:37:30 - INFO - trainer.trainer - v4 Global step: 6300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  78%|███████▊  | 61/78 [00:21<00:07,  2.20it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:06,  2.41it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.58it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.72it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.80it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.88it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.92it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.97it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.01it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.02it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.23it/s][A03/23/2024 23:37:35 - INFO - trainer.trainer - Epoch 80 finished. Took 26.53 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  81%|████████  | 81/100 [35:35<08:19, 26.30s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:37:46,393 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:37:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:37:46 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:37:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:37:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:37:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:37:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.8623784, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1020, 1115, 1125, 824, 1044, 1170, 542, 663, 704, 657, 198, 251], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51354964, 'remaining_params': 33662636, 'pruned_model_sparsity': 0.6040509729750075, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 6350}


Iteration:  41%|████      | 32/78 [00:11<00:23,  1.96it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:20,  2.19it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:18,  2.39it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:16,  2.55it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:15,  2.69it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.80it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.87it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.92it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.00it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.01it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.04it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.05it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:38:01 - INFO - trainer.trainer - Epoch 81 finished. Took 25.95 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  82%|████████▏ | 82/100 [36:00<07:51, 26.19s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:38:03,234 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:38:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:38:03 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:38:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:38:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:38:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:38:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8605046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1020, 1115, 1126, 823, 1044, 1170, 542, 663, 705, 652, 198, 249], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51353432, 'remaining_params': 33664168, 'pruned_model_sparsity': 0.604032953176754, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 6400}


Iteration:   5%|▌         | 4/78 [00:01<00:41,  1.77it/s][A03/23/2024 23:38:03 - INFO - trainer.trainer - v4 Global step: 6400, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   6%|▋         | 5/78 [00:02<00:34,  2.10it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:30,  2.36it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:27,  2.56it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:25,  2.70it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:24,  2.81it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:23,  2.89it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  2.94it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.97it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.98it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.01it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.04it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.04it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:38:20,126 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:38:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:38:20 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:38:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:38:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]03/23/2024 23:38:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:38:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.85186183, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1019, 1115, 1127, 823, 1044, 1171, 542, 663, 706, 647, 198, 248], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51350368, 'remaining_params': 33667232, 'pruned_model_sparsity': 0.6039969135802469, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 6450}


Iteration:  69%|██████▉   | 54/78 [00:18<00:12,  1.95it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.19it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:09,  2.40it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:08,  2.58it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.84it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.91it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.95it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.00it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.02it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.03it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A03/23/2024 23:38:28 - INFO - trainer.trainer - Epoch 82 finished. Took 26.5 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  83%|████████▎ | 83/100 [36:27<07:26, 26.29s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.06it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:38:36,891 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:38:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:38:36 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:38:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:38:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:38:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:38:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.85376686, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1019, 1116, 1127, 823, 1044, 1172, 542, 664, 707, 642, 198, 246], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51344240, 'remaining_params': 33673360, 'pruned_model_sparsity': 0.6039248343872328, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 6500}


Iteration:  33%|███▎      | 26/78 [00:09<00:26,  1.96it/s][A03/23/2024 23:38:37 - INFO - trainer.trainer - v4 Global step: 6500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.20it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:20,  2.41it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:18,  2.58it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:17,  2.71it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:16,  2.80it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.88it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.94it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.99it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.03it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.05it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.11it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.10it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.04it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.05it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:38:53,785 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:38:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:38:53 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:38:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:38:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:38:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:38:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.84573674, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1018, 1115, 1127, 822, 1044, 1172, 541, 664, 708, 636, 197, 244], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51350368, 'remaining_params': 33667232, 'pruned_model_sparsity': 0.6039969135802469, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 6550}


Iteration:  97%|█████████▋| 76/78 [00:25<00:01,  1.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.20it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.49it/s][A03/23/2024 23:38:54 - INFO - trainer.trainer - Epoch 83 finished. Took 26.56 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  84%|████████▍ | 84/100 [36:54<07:01, 26.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.01it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.05it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:39:10,638 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:39:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:39:10 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:39:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:39:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:39:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:39:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.84793997, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1017, 1114, 1126, 822, 1044, 1172, 540, 664, 708, 631, 197, 242], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51356496, 'remaining_params': 33661104, 'pruned_model_sparsity': 0.6040689927732611, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 6600}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.95it/s][A03/23/2024 23:39:11 - INFO - trainer.trainer - v4 Global step: 6600, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  63%|██████▎   | 49/78 [00:16<00:13,  2.19it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:11,  2.41it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.57it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.69it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.80it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.89it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.94it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.99it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.01it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.03it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.05it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:39:20 - INFO - trainer.trainer - Epoch 84 finished. Took 25.96 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.00it/s]
Epoch:  85%|████████▌ | 85/100 [37:20<06:33, 26.25s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:39:27,454 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:39:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:39:27 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:39:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:39:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:39:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:39:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.8690971, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1016, 1114, 1126, 821, 1043, 1172, 539, 664, 708, 625, 197, 241], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51362624, 'remaining_params': 33654976, 'pruned_model_sparsity': 0.6041410719662752, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 6650}


Iteration:  26%|██▌       | 20/78 [00:07<00:29,  1.97it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:25,  2.20it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.41it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.57it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:19,  2.71it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.79it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:18,  2.88it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.94it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.98it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.03it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.04it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:39:44,332 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:39:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:39:44 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:39:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:39:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:39:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:39:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.86105055, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1016, 1114, 1126, 821, 1043, 1172, 539, 664, 709, 619, 197, 239], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51361092, 'remaining_params': 33656508, 'pruned_model_sparsity': 0.6041230521680216, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 6700}


Iteration:  90%|████████▉ | 70/78 [00:23<00:04,  1.96it/s][A03/23/2024 23:39:45 - INFO - trainer.trainer - v4 Global step: 6700, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.21it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.41it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.57it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.72it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.90it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.95it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.12it/s][A03/23/2024 23:39:47 - INFO - trainer.trainer - Epoch 85 finished. Took 26.53 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  86%|████████▌ | 86/100 [37:46<06:08, 26.33s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.01it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:40:01,154 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:40:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:40:01 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:40:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:40:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:40:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:40:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.8747264, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1015, 1114, 1126, 821, 1042, 1172, 539, 664, 710, 614, 197, 237], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51362624, 'remaining_params': 33654976, 'pruned_model_sparsity': 0.6041410719662752, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 6750}


Iteration:  54%|█████▍    | 42/78 [00:14<00:18,  1.97it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:15,  2.20it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:14,  2.40it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:12,  2.58it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.71it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:11,  2.81it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.89it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.93it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.97it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.00it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.04it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.05it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.04it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.05it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.04it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:40:13 - INFO - trainer.trainer - Epoch 86 finished. Took 25.97 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.00it/s]
Epoch:  87%|████████▋ | 87/100 [38:12<05:40, 26.22s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.12it/s][A[INFO|trainer.py:570] 2024-03-23 23:40:17,992 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:40:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:40:17 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:40:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:40:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:40:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:40:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.703971119133574, 'eval_loss': 0.8439101, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1014, 1114, 1126, 820, 1042, 1173, 538, 664, 710, 608, 197, 235], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51365688, 'remaining_params': 33651912, 'pruned_model_sparsity': 0.6041771115627823, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 6800}
03/23/2024 23:40:18 - INFO - trainer.trainer - Saving the best model so far: [Epoch 87 | Step: 6800 | Model size: 33651912 | Score: 0.70397]

[INFO|configuration_utils.py:439] 2024-03-23 23:40:18,615 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 23:40:21,527 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  18%|█▊        | 14/78 [00:08<01:28,  1.39s/it][A03/23/2024 23:40:21 - INFO - trainer.trainer - v4 Global step: 6800, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  19%|█▉        | 15/78 [00:08<01:08,  1.09s/it][A
Iteration:  21%|██        | 16/78 [00:08<00:53,  1.17it/s][A
Iteration:  22%|██▏       | 17/78 [00:09<00:42,  1.43it/s][A
Iteration:  23%|██▎       | 18/78 [00:09<00:35,  1.70it/s][A
Iteration:  24%|██▍       | 19/78 [00:09<00:30,  1.96it/s][A
Iteration:  26%|██▌       | 20/78 [00:10<00:26,  2.20it/s][A
Iteration:  27%|██▋       | 21/78 [00:10<00:23,  2.41it/s][A
Iteration:  28%|██▊       | 22/78 [00:10<00:21,  2.58it/s][A
Iteration:  29%|██▉       | 23/78 [00:11<00:20,  2.71it/s][A
Iteration:  31%|███       | 24/78 [00:11<00:19,  2.81it/s][A
Iteration:  32%|███▏      | 25/78 [00:11<00:18,  2.88it/s][A
Iteration:  33%|███▎      | 26/78 [00:12<00:17,  2.93it/s][A
Iteration:  35%|███▍      | 27/78 [00:12<00:17,  2.97it/s][A
Iteration:  36%|███▌      | 28/78 [00:12<00:16,  3.00it/s][A
Iteration:  37%|███▋      | 29/78 [00:13<00:16,  3.03it/s][A
Iteration:  38%|███▊      | 30/78 [00:13<00:15,  3.05it/s][A
Iteration:  40%|███▉      | 31/78 [00:13<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:13<00:15,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:14<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:14<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:14<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:15<00:13,  3.13it/s][A
Iteration:  47%|████▋     | 37/78 [00:15<00:13,  3.12it/s][A
Iteration:  49%|████▊     | 38/78 [00:15<00:12,  3.11it/s][A
Iteration:  50%|█████     | 39/78 [00:16<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:16<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:16<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:17<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:17<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:17<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:18<00:10,  3.10it/s][A
Iteration:  59%|█████▉    | 46/78 [00:18<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:18<00:09,  3.10it/s][A
Iteration:  62%|██████▏   | 48/78 [00:19<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:19<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:19<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:20<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:20<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:20<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:21<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:21<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:21<00:07,  3.12it/s][A
Iteration:  73%|███████▎  | 57/78 [00:22<00:06,  3.11it/s][A
Iteration:  74%|███████▍  | 58/78 [00:22<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:22<00:06,  3.11it/s][A
Iteration:  77%|███████▋  | 60/78 [00:23<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:23<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:23<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:24<00:04,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:40:37,791 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:40:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:40:37 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:40:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:40:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]03/23/2024 23:40:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:40:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.852259, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1014, 1114, 1126, 821, 1042, 1174, 538, 664, 711, 603, 197, 234], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51361092, 'remaining_params': 33656508, 'pruned_model_sparsity': 0.6041230521680216, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 6850}


Iteration:  82%|████████▏ | 64/78 [00:24<00:07,  1.97it/s][A
Iteration:  83%|████████▎ | 65/78 [00:25<00:05,  2.21it/s][A
Iteration:  85%|████████▍ | 66/78 [00:25<00:05,  2.40it/s][A
Iteration:  86%|████████▌ | 67/78 [00:25<00:04,  2.57it/s][A
Iteration:  87%|████████▋ | 68/78 [00:26<00:03,  2.71it/s][A
Iteration:  88%|████████▊ | 69/78 [00:26<00:03,  2.82it/s][A
Iteration:  90%|████████▉ | 70/78 [00:26<00:02,  2.90it/s][A
Iteration:  91%|█████████ | 71/78 [00:27<00:02,  2.95it/s][A
Iteration:  92%|█████████▏| 72/78 [00:27<00:02,  2.99it/s][A
Iteration:  94%|█████████▎| 73/78 [00:27<00:01,  2.99it/s][A
Iteration:  95%|█████████▍| 74/78 [00:28<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 75/78 [00:28<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:28<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:29<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:29<00:00,  3.23it/s][A03/23/2024 23:40:42 - INFO - trainer.trainer - Epoch 87 finished. Took 29.42 seconds.
Iteration: 100%|██████████| 78/78 [00:29<00:00,  2.65it/s]
Epoch:  88%|████████▊ | 88/100 [38:41<05:26, 27.18s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.10it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.10it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:40:54,585 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:40:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:40:54 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:40:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:40:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:40:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:40:55 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8457096, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1013, 1114, 1127, 820, 1042, 1174, 538, 664, 712, 597, 197, 232], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51361092, 'remaining_params': 33656508, 'pruned_model_sparsity': 0.6041230521680216, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 6900}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.96it/s][A03/23/2024 23:40:55 - INFO - trainer.trainer - v4 Global step: 6900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.19it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:16,  2.40it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.57it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:14,  2.71it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:13,  2.82it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.89it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.94it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.01it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.03it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.04it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:41:08 - INFO - trainer.trainer - Epoch 88 finished. Took 25.92 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  89%|████████▉ | 89/100 [39:07<04:54, 26.80s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.04it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:41:11,402 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:41:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:41:11 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:41:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:41:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:41:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:41:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.8527886, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1013, 1114, 1127, 820, 1042, 1174, 538, 664, 713, 592, 197, 231], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51359560, 'remaining_params': 33658040, 'pruned_model_sparsity': 0.6041050323697681, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 6950}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.92it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:31,  2.18it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.39it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:26,  2.56it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.71it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.81it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.88it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.95it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.97it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.00it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.04it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.05it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.13it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.12it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.11it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.11it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.21it/s][A[INFO|trainer.py:570] 2024-03-23 23:41:28,215 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:41:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:41:28 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:41:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:41:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:41:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:41:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.85418886, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1012, 1115, 1128, 820, 1043, 1175, 537, 664, 713, 586, 197, 230], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51356496, 'remaining_params': 33661104, 'pruned_model_sparsity': 0.6040689927732611, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 7000}


Iteration:  74%|███████▍  | 58/78 [00:20<00:09,  2.01it/s][A03/23/2024 23:41:28 - INFO - trainer.trainer - v4 Global step: 7000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.25it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.45it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:06,  2.61it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.74it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.83it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.90it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.95it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.99it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.00it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.02it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.03it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A03/23/2024 23:41:35 - INFO - trainer.trainer - Epoch 89 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  90%|█████████ | 90/100 [39:34<04:27, 26.71s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.12it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.11it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.11it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:41:45,005 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:41:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:41:45 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:41:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:41:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]03/23/2024 23:41:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:41:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.8462898, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1012, 1115, 1130, 821, 1043, 1176, 538, 664, 714, 581, 197, 228], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51347304, 'remaining_params': 33670296, 'pruned_model_sparsity': 0.6039608739837399, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 7050}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.96it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.20it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:19,  2.41it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.58it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.72it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:15,  2.80it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.88it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.93it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.97it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.01it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.03it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.05it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:42:01 - INFO - trainer.trainer - Epoch 90 finished. Took 25.92 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  91%|█████████ | 91/100 [40:00<03:58, 26.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A[INFO|trainer.py:570] 2024-03-23 23:42:01,838 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:42:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:42:01 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:42:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:42:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:42:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:42:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.84162456, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1012, 1115, 1130, 822, 1044, 1177, 538, 665, 715, 575, 197, 227], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51339644, 'remaining_params': 33677956, 'pruned_model_sparsity': 0.6038707749924721, 'expected_sparsity': 0.59984, 'target_sparsity': 0.6, 'step': 7100}


Iteration:   3%|▎         | 2/78 [00:01<00:52,  1.46it/s][A03/23/2024 23:42:02 - INFO - trainer.trainer - v4 Global step: 7100, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   4%|▍         | 3/78 [00:01<00:39,  1.92it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:32,  2.26it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.51it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:26,  2.68it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.80it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.88it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.94it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.97it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.00it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.02it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.03it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.03it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.14it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.13it/s][A[INFO|trainer.py:570] 2024-03-23 23:42:18,687 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:42:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:42:18 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:42:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:42:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:42:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:42:19 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8409469, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1011, 1115, 1130, 822, 1044, 1177, 537, 665, 715, 569, 197, 225], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51342708, 'remaining_params': 33674892, 'pruned_model_sparsity': 0.6039068145889792, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 7150}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.98it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.23it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:09,  2.43it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.60it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.72it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.81it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.90it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.95it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  3.00it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.02it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.03it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A03/23/2024 23:42:27 - INFO - trainer.trainer - Epoch 91 finished. Took 26.5 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  92%|█████████▏| 92/100 [40:26<03:31, 26.48s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.02it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:42:35,513 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:42:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:42:35 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:42:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:42:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:42:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:42:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8454382, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1010, 1115, 1130, 821, 1044, 1178, 537, 665, 715, 563, 197, 224], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51344240, 'remaining_params': 33673360, 'pruned_model_sparsity': 0.6039248343872328, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 7200}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.96it/s][A03/23/2024 23:42:36 - INFO - trainer.trainer - v4 Global step: 7200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  32%|███▏      | 25/78 [00:08<00:24,  2.20it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.40it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.58it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.71it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.82it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.89it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:16,  2.93it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  3.00it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.03it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:42:52,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:42:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:42:52 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:42:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:42:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:42:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:42:52 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.84308714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1010, 1115, 1130, 820, 1043, 1177, 536, 665, 715, 557, 197, 223], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51350368, 'remaining_params': 33667232, 'pruned_model_sparsity': 0.6039969135802469, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 7250}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.97it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.21it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.42it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.58it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.82it/s][A03/23/2024 23:42:54 - INFO - trainer.trainer - Epoch 92 finished. Took 26.53 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  93%|█████████▎| 93/100 [40:53<03:05, 26.49s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.16it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.13it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.11it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.10it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:43:09,171 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:43:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:43:09 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:43:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:43:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]03/23/2024 23:43:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:43:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.8599845, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1009, 1115, 1129, 819, 1043, 1177, 536, 665, 716, 551, 197, 221], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51353432, 'remaining_params': 33664168, 'pruned_model_sparsity': 0.604032953176754, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 7300}


Iteration:  59%|█████▉    | 46/78 [00:15<00:16,  1.95it/s][A03/23/2024 23:43:09 - INFO - trainer.trainer - v4 Global step: 7300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  60%|██████    | 47/78 [00:15<00:14,  2.19it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:12,  2.39it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:11,  2.57it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:10,  2.70it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.80it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.86it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.91it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.97it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.00it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.03it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.05it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.05it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.03it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.05it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A03/23/2024 23:43:20 - INFO - trainer.trainer - Epoch 93 finished. Took 25.94 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  94%|█████████▍| 94/100 [41:19<02:37, 26.33s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:43:26,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:43:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:43:26 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:43:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:43:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:43:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:43:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.8653983, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1008, 1114, 1129, 819, 1043, 1177, 535, 665, 715, 544, 197, 220], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51359560, 'remaining_params': 33658040, 'pruned_model_sparsity': 0.6041050323697681, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 7350}


Iteration:  23%|██▎       | 18/78 [00:06<00:36,  1.66it/s][A
Iteration:  24%|██▍       | 19/78 [00:07<00:30,  1.92it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:26,  2.17it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:23,  2.38it/s][A
Iteration:  28%|██▊       | 22/78 [00:08<00:21,  2.55it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:20,  2.68it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:19,  2.79it/s][A
Iteration:  32%|███▏      | 25/78 [00:09<00:18,  2.87it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.93it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.97it/s][A
Iteration:  36%|███▌      | 28/78 [00:10<00:16,  2.99it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.02it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:43:43,220 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:43:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:43:43 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:43:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:43:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:43:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:43:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8540222, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1114, 1128, 819, 1043, 1177, 535, 665, 715, 538, 197, 219], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51362624, 'remaining_params': 33654976, 'pruned_model_sparsity': 0.6041410719662752, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 7400}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.96it/s][A03/23/2024 23:43:43 - INFO - trainer.trainer - v4 Global step: 7400, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.20it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:03,  2.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.58it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.71it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.81it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.88it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.98it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.01it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.15it/s][A03/23/2024 23:43:47 - INFO - trainer.trainer - Epoch 94 finished. Took 26.88 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.90it/s]
Epoch:  95%|█████████▌| 95/100 [41:46<02:12, 26.49s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.05it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:44:00,065 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:44:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:44:00 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:44:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:44:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:44:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:44:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.845176, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1114, 1128, 818, 1043, 1177, 535, 665, 715, 532, 197, 218], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51364156, 'remaining_params': 33653444, 'pruned_model_sparsity': 0.6041590917645288, 'expected_sparsity': 0.60015, 'target_sparsity': 0.6, 'step': 7450}


Iteration:  51%|█████▏    | 40/78 [00:13<00:19,  1.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:16,  2.20it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:14,  2.42it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.58it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.72it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.83it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.90it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.94it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.99it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.02it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.01it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.05it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.05it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A03/23/2024 23:44:12 - INFO - trainer.trainer - Epoch 95 finished. Took 25.95 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  96%|█████████▌| 96/100 [42:12<01:45, 26.33s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.12it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.11it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:44:16,878 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:44:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:44:16 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:44:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:44:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.46it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.08it/s]03/23/2024 23:44:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:44:17 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.845532, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1114, 1129, 819, 1043, 1178, 535, 665, 716, 526, 197, 216], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51358028, 'remaining_params': 33659572, 'pruned_model_sparsity': 0.6040870125715146, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 7500}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.95it/s][A03/23/2024 23:44:17 - INFO - trainer.trainer - v4 Global step: 7500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.19it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.41it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.58it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:22,  2.71it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.80it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.89it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.94it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.98it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.98it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.01it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.04it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A[INFO|trainer.py:570] 2024-03-23 23:44:33,755 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:44:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:44:33 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:44:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:44:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]03/23/2024 23:44:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:44:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8595144, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1113, 1129, 819, 1043, 1178, 535, 665, 717, 521, 197, 215], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51358028, 'remaining_params': 33659572, 'pruned_model_sparsity': 0.6040870125715146, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 7550}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  1.96it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.20it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.41it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.58it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.71it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.81it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.88it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.93it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.98it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.04it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.05it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.05it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.05it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A03/23/2024 23:44:39 - INFO - trainer.trainer - Epoch 96 finished. Took 26.54 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  97%|█████████▋| 97/100 [42:38<01:19, 26.39s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.25it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.20it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.15it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.13it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.10it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.10it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.10it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:44:50,516 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:44:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:44:50 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:44:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:44:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:44:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:44:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.8505813, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1114, 1130, 819, 1044, 1179, 534, 665, 717, 515, 197, 214], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51353432, 'remaining_params': 33664168, 'pruned_model_sparsity': 0.604032953176754, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 7600}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.97it/s][A03/23/2024 23:44:51 - INFO - trainer.trainer - v4 Global step: 7600, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  45%|████▍     | 35/78 [00:11<00:19,  2.20it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.41it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.58it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.71it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.81it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.89it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.94it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.97it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.00it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.01it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.04it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.05it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.05it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A03/23/2024 23:45:05 - INFO - trainer.trainer - Epoch 97 finished. Took 25.86 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  98%|█████████▊| 98/100 [43:04<00:52, 26.23s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A[INFO|trainer.py:570] 2024-03-23 23:45:07,347 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:45:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:45:07 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:45:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:45:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:45:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:45:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.8551024, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1008, 1114, 1131, 819, 1044, 1180, 534, 666, 718, 510, 197, 213], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51345772, 'remaining_params': 33671828, 'pruned_model_sparsity': 0.6039428541854863, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 7650}


Iteration:   8%|▊         | 6/78 [00:02<00:38,  1.87it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:33,  2.15it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.38it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:26,  2.56it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.70it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.80it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.88it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.94it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.98it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.00it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.03it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.03it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.04it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.05it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A[INFO|trainer.py:570] 2024-03-23 23:45:24,245 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:45:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:45:24 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:45:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:45:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.12it/s]03/23/2024 23:45:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:45:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6823104693140795, 'eval_loss': 0.8486773, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1008, 1115, 1132, 819, 1044, 1180, 534, 666, 719, 505, 197, 212], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51341176, 'remaining_params': 33676424, 'pruned_model_sparsity': 0.6038887947907257, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 7700}


Iteration:  72%|███████▏  | 56/78 [00:19<00:11,  1.95it/s][A03/23/2024 23:45:24 - INFO - trainer.trainer - v4 Global step: 7700, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.20it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:08,  2.40it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:07,  2.57it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.70it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.81it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.89it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.95it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.99it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A03/23/2024 23:45:31 - INFO - trainer.trainer - Epoch 98 finished. Took 26.56 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  99%|█████████▉| 99/100 [43:31<00:26, 26.33s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.05it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:45:41,059 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:45:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:45:41 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:45:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:45:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]03/23/2024 23:45:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:45:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.85383457, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1115, 1132, 818, 1044, 1181, 534, 666, 720, 500, 197, 211], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51341176, 'remaining_params': 33676424, 'pruned_model_sparsity': 0.6038887947907257, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 7750}


Iteration:  36%|███▌      | 28/78 [00:09<00:25,  1.96it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:22,  2.19it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:19,  2.40it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:18,  2.57it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:17,  2.70it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:16,  2.80it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:15,  2.88it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  2.93it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.98it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.01it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.04it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A[INFO|trainer.py:570] 2024-03-23 23:45:57,890 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 23:45:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 23:45:57 - INFO - trainer.trainer -   Num examples = 277
03/23/2024 23:45:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A03/23/2024 23:45:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]03/23/2024 23:45:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
03/23/2024 23:45:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8546144, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1007, 1115, 1133, 818, 1044, 1181, 534, 667, 720, 494, 197, 210], 'head_nums': [12, 11, 9, 10, 11, 11, 5, 8, 12, 7, 6, 4], 'pruned_params': 51338112, 'remaining_params': 33679488, 'pruned_model_sparsity': 0.6038527551942187, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 7800}


Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.02it/s][A03/23/2024 23:45:58 - INFO - trainer.trainer - Epoch 99 finished. Took 26.55 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch: 100%|██████████| 100/100 [43:57<00:00, 26.40s/it]Epoch: 100%|██████████| 100/100 [43:57<00:00, 26.38s/it]
[INFO|configuration_utils.py:439] 2024-03-23 23:45:58,513 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 23:46:01,361 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-03-23 23:46:01,362 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-03-23 23:46:01,363 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi/RTE_sparsity0.6/special_tokens_map.json
03/23/2024 23:46:01 - INFO - __main__ - Training took 2650.11 seconds.
