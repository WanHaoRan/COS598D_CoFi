Tue Apr 23 21:45:27 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/mrpc_mod_0.95
nvidia-smi output:
Tue Apr 23 21:45:27 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:17:00.0 Off |                    0 |
| N/A   29C    P0              34W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/23/2024 21:45:46 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/23/2024 21:45:46 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95/runs/Apr23_21-45-46_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/23/2024 21:45:46 - INFO - __main__ - Model Arguments:
04/23/2024 21:45:46 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/23/2024 21:45:46 - INFO - __main__ - config_name = None
04/23/2024 21:45:46 - INFO - __main__ - tokenizer_name = None
04/23/2024 21:45:46 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/23/2024 21:45:46 - INFO - __main__ - use_fast_tokenizer = True
04/23/2024 21:45:46 - INFO - __main__ - model_revision = main
04/23/2024 21:45:46 - INFO - __main__ - use_auth_token = False
04/23/2024 21:45:46 - INFO - __main__ - Data Arguments:
04/23/2024 21:45:46 - INFO - __main__ - task_name = mrpc
04/23/2024 21:45:46 - INFO - __main__ - dataset_name = None
04/23/2024 21:45:46 - INFO - __main__ - t_name = None
04/23/2024 21:45:46 - INFO - __main__ - dataset_config_name = None
04/23/2024 21:45:46 - INFO - __main__ - max_seq_length = 128
04/23/2024 21:45:46 - INFO - __main__ - overwrite_cache = False
04/23/2024 21:45:46 - INFO - __main__ - pad_to_max_length = True
04/23/2024 21:45:46 - INFO - __main__ - max_train_samples = None
04/23/2024 21:45:46 - INFO - __main__ - max_eval_samples = None
04/23/2024 21:45:46 - INFO - __main__ - max_predict_samples = None
04/23/2024 21:45:46 - INFO - __main__ - train_file = None
04/23/2024 21:45:46 - INFO - __main__ - validation_file = None
04/23/2024 21:45:46 - INFO - __main__ - test_file = None
04/23/2024 21:45:46 - INFO - __main__ - Training Arguments:
04/23/2024 21:45:46 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95
04/23/2024 21:45:46 - INFO - __main__ - overwrite_output_dir = True
04/23/2024 21:45:46 - INFO - __main__ - do_train = True
04/23/2024 21:45:46 - INFO - __main__ - do_eval = True
04/23/2024 21:45:46 - INFO - __main__ - do_predict = False
04/23/2024 21:45:46 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/23/2024 21:45:46 - INFO - __main__ - prediction_loss_only = False
04/23/2024 21:45:46 - INFO - __main__ - per_device_train_batch_size = 32
04/23/2024 21:45:46 - INFO - __main__ - per_device_eval_batch_size = 32
04/23/2024 21:45:46 - INFO - __main__ - per_gpu_train_batch_size = None
04/23/2024 21:45:46 - INFO - __main__ - per_gpu_eval_batch_size = None
04/23/2024 21:45:46 - INFO - __main__ - gradient_accumulation_steps = 1
04/23/2024 21:45:46 - INFO - __main__ - eval_accumulation_steps = None
04/23/2024 21:45:46 - INFO - __main__ - learning_rate = 2e-05
04/23/2024 21:45:46 - INFO - __main__ - weight_decay = 0.0
04/23/2024 21:45:46 - INFO - __main__ - adam_beta1 = 0.9
04/23/2024 21:45:46 - INFO - __main__ - adam_beta2 = 0.999
04/23/2024 21:45:46 - INFO - __main__ - adam_epsilon = 1e-08
04/23/2024 21:45:46 - INFO - __main__ - max_grad_norm = 1.0
04/23/2024 21:45:46 - INFO - __main__ - num_train_epochs = 100.0
04/23/2024 21:45:46 - INFO - __main__ - max_steps = -1
04/23/2024 21:45:46 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/23/2024 21:45:46 - INFO - __main__ - warmup_ratio = 0.0
04/23/2024 21:45:46 - INFO - __main__ - warmup_steps = 0
04/23/2024 21:45:46 - INFO - __main__ - log_level = -1
04/23/2024 21:45:46 - INFO - __main__ - log_level_replica = -1
04/23/2024 21:45:46 - INFO - __main__ - log_on_each_node = True
04/23/2024 21:45:46 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95/runs/Apr23_21-45-46_adroit-h11g2
04/23/2024 21:45:46 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/23/2024 21:45:46 - INFO - __main__ - logging_first_step = False
04/23/2024 21:45:46 - INFO - __main__ - logging_steps = 100
04/23/2024 21:45:46 - INFO - __main__ - logging_nan_inf_filter = True
04/23/2024 21:45:46 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/23/2024 21:45:46 - INFO - __main__ - save_steps = 0
04/23/2024 21:45:46 - INFO - __main__ - save_total_limit = None
04/23/2024 21:45:46 - INFO - __main__ - save_on_each_node = False
04/23/2024 21:45:46 - INFO - __main__ - no_cuda = False
04/23/2024 21:45:46 - INFO - __main__ - seed = 57
04/23/2024 21:45:46 - INFO - __main__ - bf16 = False
04/23/2024 21:45:46 - INFO - __main__ - fp16 = False
04/23/2024 21:45:46 - INFO - __main__ - fp16_opt_level = O1
04/23/2024 21:45:46 - INFO - __main__ - half_precision_backend = auto
04/23/2024 21:45:46 - INFO - __main__ - bf16_full_eval = False
04/23/2024 21:45:46 - INFO - __main__ - fp16_full_eval = False
04/23/2024 21:45:46 - INFO - __main__ - tf32 = None
04/23/2024 21:45:46 - INFO - __main__ - local_rank = -1
04/23/2024 21:45:46 - INFO - __main__ - xpu_backend = None
04/23/2024 21:45:46 - INFO - __main__ - tpu_num_cores = None
04/23/2024 21:45:46 - INFO - __main__ - tpu_metrics_debug = False
04/23/2024 21:45:46 - INFO - __main__ - debug = []
04/23/2024 21:45:46 - INFO - __main__ - dataloader_drop_last = False
04/23/2024 21:45:46 - INFO - __main__ - eval_steps = 50
04/23/2024 21:45:46 - INFO - __main__ - dataloader_num_workers = 0
04/23/2024 21:45:46 - INFO - __main__ - past_index = -1
04/23/2024 21:45:46 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95
04/23/2024 21:45:46 - INFO - __main__ - disable_tqdm = False
04/23/2024 21:45:46 - INFO - __main__ - remove_unused_columns = True
04/23/2024 21:45:46 - INFO - __main__ - label_names = None
04/23/2024 21:45:46 - INFO - __main__ - load_best_model_at_end = False
04/23/2024 21:45:46 - INFO - __main__ - metric_for_best_model = None
04/23/2024 21:45:46 - INFO - __main__ - greater_is_better = None
04/23/2024 21:45:46 - INFO - __main__ - ignore_data_skip = False
04/23/2024 21:45:46 - INFO - __main__ - sharded_ddp = []
04/23/2024 21:45:46 - INFO - __main__ - deepspeed = None
04/23/2024 21:45:46 - INFO - __main__ - label_smoothing_factor = 0.0
04/23/2024 21:45:46 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/23/2024 21:45:46 - INFO - __main__ - adafactor = False
04/23/2024 21:45:46 - INFO - __main__ - group_by_length = False
04/23/2024 21:45:46 - INFO - __main__ - length_column_name = length
04/23/2024 21:45:46 - INFO - __main__ - report_to = []
04/23/2024 21:45:46 - INFO - __main__ - ddp_find_unused_parameters = None
04/23/2024 21:45:46 - INFO - __main__ - ddp_bucket_cap_mb = None
04/23/2024 21:45:46 - INFO - __main__ - dataloader_pin_memory = True
04/23/2024 21:45:46 - INFO - __main__ - skip_memory_metrics = True
04/23/2024 21:45:46 - INFO - __main__ - use_legacy_prediction_loop = False
04/23/2024 21:45:46 - INFO - __main__ - push_to_hub = False
04/23/2024 21:45:46 - INFO - __main__ - resume_from_checkpoint = None
04/23/2024 21:45:46 - INFO - __main__ - hub_model_id = None
04/23/2024 21:45:46 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/23/2024 21:45:46 - INFO - __main__ - hub_token = None
04/23/2024 21:45:46 - INFO - __main__ - gradient_checkpointing = False
04/23/2024 21:45:46 - INFO - __main__ - fp16_backend = auto
04/23/2024 21:45:46 - INFO - __main__ - push_to_hub_model_id = None
04/23/2024 21:45:46 - INFO - __main__ - push_to_hub_organization = None
04/23/2024 21:45:46 - INFO - __main__ - push_to_hub_token = None
04/23/2024 21:45:46 - INFO - __main__ - mp_parameters = 
04/23/2024 21:45:46 - INFO - __main__ - _n_gpu = 1
04/23/2024 21:45:46 - INFO - __main__ - __cached__setup_devices = cuda:0
04/23/2024 21:45:46 - INFO - __main__ - Additional Arguments:
04/23/2024 21:45:46 - INFO - __main__ - test = False
04/23/2024 21:45:46 - INFO - __main__ - ex_name = MRPC_sparsity0.95
04/23/2024 21:45:46 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/23/2024 21:45:46 - INFO - __main__ - reg_learning_rate = 0.01
04/23/2024 21:45:46 - INFO - __main__ - scheduler_type = linear
04/23/2024 21:45:46 - INFO - __main__ - freeze_embeddings = True
04/23/2024 21:45:46 - INFO - __main__ - pretrained_pruned_model = None
04/23/2024 21:45:46 - INFO - __main__ - droprate_init = 0.5
04/23/2024 21:45:46 - INFO - __main__ - temperature = 0.6666666666666666
04/23/2024 21:45:46 - INFO - __main__ - prepruning_finetune_epochs = 4
04/23/2024 21:45:46 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/23/2024 21:45:46 - INFO - __main__ - target_sparsity = 0.95
04/23/2024 21:45:46 - INFO - __main__ - sparsity_epsilon = 0
04/23/2024 21:45:46 - INFO - __main__ - distillation_path = Intel/bert-base-uncased-mrpc
04/23/2024 21:45:46 - INFO - __main__ - do_distill = True
04/23/2024 21:45:46 - INFO - __main__ - do_layer_distill = True
04/23/2024 21:45:46 - INFO - __main__ - layer_distill_version = 4
04/23/2024 21:45:46 - INFO - __main__ - distill_loss_alpha = 0.9
04/23/2024 21:45:46 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/23/2024 21:45:46 - INFO - __main__ - distill_temp = 2.0
04/23/2024 21:45:46 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/23/2024 21:45:46 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/23/2024 21:45:46 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/23/2024 21:45:46 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 787.27it/s]
[INFO|configuration_utils.py:648] 2024-04-23 21:45:46,700 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 21:45:46,701 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "mrpc",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-23 21:45:46,703 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 21:45:46,703 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-23 21:45:46,705 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-23 21:45:46,706 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-23 21:45:46,706 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-23 21:45:46,706 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-23 21:45:46,708 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 21:45:46,709 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/23/2024 21:45:56 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/23/2024 21:45:56 - INFO - __main__ - Model size: 85054464
04/23/2024 21:45:56 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14b8cec9ff70> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/23/2024 21:45:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/23/2024 21:45:56 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14b8cec9fd30> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/23/2024 21:45:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/23/2024 21:45:56 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14b8cec9ff70> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/23/2024 21:45:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/23/2024 21:45:56 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The Communicator can also consolidate e-mail from multiple screen names and other POP and IMAP accounts into a single application .', 'sentence2': 'AOL Communicator can consolidate e-mail from multiple AOL screen names , as well as from other POP and IMAP-based e-mail accounts .', 'label': 1, 'idx': 2338, 'input_ids': [101, 1996, 4012, 23041, 5555, 4263, 2064, 2036, 24939, 1041, 1011, 5653, 2013, 3674, 3898, 3415, 1998, 2060, 3769, 1998, 10047, 9331, 6115, 2046, 1037, 2309, 4646, 1012, 102, 20118, 2140, 4012, 23041, 5555, 4263, 2064, 24939, 1041, 1011, 5653, 2013, 3674, 20118, 2140, 3898, 3415, 1010, 2004, 2092, 2004, 2013, 2060, 3769, 1998, 10047, 9331, 1011, 2241, 1041, 1011, 5653, 6115, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/23/2024 21:45:56 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': 'The dollar gained against the euro , yen and Swiss franc after September U.S. retail sales figures came in slightly weaker than consensus forecasts .', 'sentence2': 'The greenback rose steeply against the euro , yen and Swiss franc despite weaker-than-expected September U.S. retail sales figures .', 'label': 1, 'idx': 1465, 'input_ids': [101, 1996, 7922, 4227, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2044, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 2234, 1999, 3621, 15863, 2084, 10465, 19939, 2015, 1012, 102, 1996, 2665, 5963, 3123, 9561, 2135, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2750, 15863, 1011, 2084, 1011, 3517, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/23/2024 21:45:56 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "But he said he had Dr Hollingworth 's legal advice that he had been denied natural justice by the church inquiry .", 'sentence2': "Senator Brandis backed Dr Hollingworth 's claims he had been denied natural justice by the Anglican Church inquiry into the claims against him .", 'label': 0, 'idx': 2170, 'input_ids': [101, 2021, 2002, 2056, 2002, 2018, 2852, 7570, 13112, 5172, 1005, 1055, 3423, 6040, 2008, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 2277, 9934, 1012, 102, 5205, 4435, 2483, 6153, 2852, 7570, 13112, 5172, 1005, 1055, 4447, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 9437, 2277, 9934, 2046, 1996, 4447, 2114, 2032, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/23/2024 21:45:56 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/23/2024 21:45:57 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/23/2024 21:45:57 - INFO - __main__ - ************* 3668 Training Examples Loaded *************
04/23/2024 21:45:57 - INFO - __main__ - ************* 408 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-23 21:45:57,543 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - Prepruning finetune steps: 100
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - Lagrangian warmup steps: 2300
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - ***** Running training *****
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Num examples = 3668
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Num Epochs = 100
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Instantaneous batch size per device = 32
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Gradient Accumulation steps = 1
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Total optimization steps = 11500
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-23 21:45:57,548 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Batch size = 32

Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A
Evaluation:   8%|▊         | 1/13 [00:00<00:01,  6.46it/s][A
Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.06it/s][A
Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A
Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.13it/s][A
Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.31it/s][A
Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.42it/s][A
Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.95it/s][AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/23/2024 21:45:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:45:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.3161764705882353, 'f1': 0.0, 'combined_score': 0.15808823529411764, 'eval_loss': 0.7583998, 'step': 0}


Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 21:45:59 - INFO - trainer.trainer_mod - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:51,  2.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.22it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.31it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:32,  3.39it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:31,  3.51it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:29,  3.61it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:28,  3.79it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:27,  3.79it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:28,  3.74it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:27,  3.77it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:27,  3.70it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:27,  3.74it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:25,  3.89it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:27,  3.67it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.41it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:27,  3.62it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:26,  3.58it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:26,  3.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:24,  3.75it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:24,  3.76it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.59it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:24,  3.66it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:24,  3.65it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:24,  3.65it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:23,  3.73it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:22,  3.78it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:21,  3.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:21,  3.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:09<00:21,  3.85it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:20,  3.87it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:21,  3.73it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:10<00:20,  3.79it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:20,  3.71it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:20,  3.77it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:19,  3.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:11<00:18,  3.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:18,  3.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:18,  3.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:18,  3.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:12<00:18,  3.87it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:17,  3.85it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:18,  3.75it/s][A
Iteration:  42%|████▏     | 48/115 [00:13<00:17,  3.80it/s][A
Iteration:  43%|████▎     | 49/115 [00:13<00:18,  3.64it/s][A[INFO|trainer.py:570] 2024-04-23 21:46:12,461 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:46:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:46:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:46:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.61it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.82it/s]04/23/2024 21:46:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:46:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7132352941176471, 'f1': 0.8245877061469266, 'combined_score': 0.7689115001322868, 'eval_loss': 0.52764785, 'step': 50}


Iteration:  43%|████▎     | 50/115 [00:14<00:41,  1.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:15<00:33,  1.90it/s][A
Iteration:  45%|████▌     | 52/115 [00:15<00:27,  2.28it/s][A
Iteration:  46%|████▌     | 53/115 [00:15<00:24,  2.53it/s][A
Iteration:  47%|████▋     | 54/115 [00:15<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:16<00:19,  3.05it/s][A
Iteration:  49%|████▊     | 56/115 [00:16<00:18,  3.24it/s][A
Iteration:  50%|████▉     | 57/115 [00:16<00:17,  3.39it/s][A
Iteration:  50%|█████     | 58/115 [00:16<00:16,  3.48it/s][A
Iteration:  51%|█████▏    | 59/115 [00:17<00:16,  3.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:17<00:15,  3.51it/s][A
Iteration:  53%|█████▎    | 61/115 [00:17<00:15,  3.57it/s][A
Iteration:  54%|█████▍    | 62/115 [00:18<00:15,  3.40it/s][A
Iteration:  55%|█████▍    | 63/115 [00:18<00:14,  3.51it/s][A
Iteration:  56%|█████▌    | 64/115 [00:18<00:14,  3.62it/s][A
Iteration:  57%|█████▋    | 65/115 [00:18<00:13,  3.68it/s][A
Iteration:  57%|█████▋    | 66/115 [00:19<00:13,  3.72it/s][A
Iteration:  58%|█████▊    | 67/115 [00:19<00:12,  3.71it/s][A
Iteration:  59%|█████▉    | 68/115 [00:19<00:12,  3.73it/s][A
Iteration:  60%|██████    | 69/115 [00:19<00:12,  3.79it/s][A
Iteration:  61%|██████    | 70/115 [00:20<00:12,  3.74it/s][A
Iteration:  62%|██████▏   | 71/115 [00:20<00:11,  3.74it/s][A
Iteration:  63%|██████▎   | 72/115 [00:20<00:11,  3.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:20<00:10,  3.83it/s][A
Iteration:  64%|██████▍   | 74/115 [00:21<00:10,  3.86it/s][A
Iteration:  65%|██████▌   | 75/115 [00:21<00:10,  3.87it/s][A
Iteration:  66%|██████▌   | 76/115 [00:21<00:10,  3.79it/s][A
Iteration:  67%|██████▋   | 77/115 [00:22<00:10,  3.74it/s][A
Iteration:  68%|██████▊   | 78/115 [00:22<00:09,  3.75it/s][A
Iteration:  69%|██████▊   | 79/115 [00:22<00:09,  3.75it/s][A
Iteration:  70%|██████▉   | 80/115 [00:22<00:09,  3.74it/s][A
Iteration:  70%|███████   | 81/115 [00:23<00:08,  3.80it/s][A
Iteration:  71%|███████▏  | 82/115 [00:23<00:08,  3.80it/s][A
Iteration:  72%|███████▏  | 83/115 [00:23<00:08,  3.83it/s][A
Iteration:  73%|███████▎  | 84/115 [00:23<00:08,  3.80it/s][A
Iteration:  74%|███████▍  | 85/115 [00:24<00:07,  3.75it/s][A
Iteration:  75%|███████▍  | 86/115 [00:24<00:07,  3.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:24<00:07,  3.72it/s][A
Iteration:  77%|███████▋  | 88/115 [00:24<00:06,  3.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:25<00:06,  3.86it/s][A
Iteration:  78%|███████▊  | 90/115 [00:25<00:06,  3.81it/s][A
Iteration:  79%|███████▉  | 91/115 [00:25<00:06,  3.82it/s][A
Iteration:  80%|████████  | 92/115 [00:25<00:05,  3.85it/s][A
Iteration:  81%|████████  | 93/115 [00:26<00:05,  3.84it/s][A
Iteration:  82%|████████▏ | 94/115 [00:26<00:05,  3.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:26<00:05,  3.79it/s][A
Iteration:  83%|████████▎ | 96/115 [00:27<00:04,  3.82it/s][A
Iteration:  84%|████████▍ | 97/115 [00:27<00:04,  3.69it/s][A
Iteration:  85%|████████▌ | 98/115 [00:27<00:04,  3.68it/s][A
Iteration:  86%|████████▌ | 99/115 [00:27<00:04,  3.67it/s][A[INFO|trainer.py:570] 2024-04-23 21:46:27,018 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:46:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:46:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:46:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.75it/s]04/23/2024 21:46:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.8807631160572338, 'combined_score': 0.8484697933227345, 'eval_loss': 0.60521734, 'step': 100}


Iteration:  87%|████████▋ | 100/115 [00:29<00:09,  1.56it/s][A04/23/2024 21:46:28 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - Starting l0 regularization!
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - v4 Global step: 100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:29<00:07,  1.78it/s][A
Iteration:  89%|████████▊ | 102/115 [00:30<00:06,  1.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:30<00:05,  2.17it/s][A
Iteration:  90%|█████████ | 104/115 [00:30<00:04,  2.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:31<00:04,  2.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:31<00:03,  2.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:31<00:03,  2.64it/s][A
Iteration:  94%|█████████▍| 108/115 [00:32<00:02,  2.69it/s][A
Iteration:  95%|█████████▍| 109/115 [00:32<00:02,  2.76it/s][A
Iteration:  96%|█████████▌| 110/115 [00:32<00:01,  2.76it/s][A
Iteration:  97%|█████████▋| 111/115 [00:33<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 112/115 [00:33<00:01,  2.66it/s][A
Iteration:  98%|█████████▊| 113/115 [00:34<00:00,  2.71it/s][A
Iteration:  99%|█████████▉| 114/115 [00:34<00:00,  2.81it/s][A
Iteration: 100%|██████████| 115/115 [00:34<00:00,  3.02it/s][A04/23/2024 21:46:33 - INFO - trainer.trainer_mod - Epoch 0 finished. Took 34.67 seconds.
Iteration: 100%|██████████| 115/115 [00:34<00:00,  3.32it/s]
Epoch:   1%|          | 1/100 [00:35<59:23, 36.00s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.10it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.74it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.83it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.84it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.81it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.81it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.73it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.74it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.75it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:37,  2.74it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:37,  2.73it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.78it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.81it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.78it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.82it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.79it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.79it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.82it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.84it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.86it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:30,  2.86it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:30,  2.83it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.82it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.85it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.84it/s][A[INFO|trainer.py:570] 2024-04-23 21:46:45,921 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:46:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:46:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:46:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:46:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:46:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:46:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 1.3919415, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2601, 2596, 2597, 2586, 2588, 2591, 2584, 2584, 2583, 2580, 2584, 2591], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9188196, 'remaining_params': 75829404, 'pruned_model_sparsity': 0.10807404584462511, 'expected_sparsity': 0.10962, 'target_sparsity': 0.020652173913043477, 'step': 150}


Iteration:  30%|███       | 35/115 [00:13<01:01,  1.30it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:50,  1.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:43,  1.79it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:38,  2.01it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:34,  2.21it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:32,  2.34it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:30,  2.46it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:28,  2.55it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:27,  2.63it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:26,  2.70it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:25,  2.69it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.80it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:24,  2.79it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:22,  2.84it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.89it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.87it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.77it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.79it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.66it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.71it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.78it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.77it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.85it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.84it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.80it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.81it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.83it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.88it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.88it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.85it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.83it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.84it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.91it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.85it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.84it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.85it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.68it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.69it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:12,  2.59it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.64it/s][A[INFO|trainer.py:570] 2024-04-23 21:47:05,144 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:47:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:47:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:47:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:47:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:47:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:47:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7279411764705882, 'f1': 0.8330827067669173, 'combined_score': 0.7805119416187527, 'eval_loss': 0.96996474, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2636, 2628, 2629, 2609, 2613, 2621, 2607, 2607, 2608, 2607, 2620, 2650], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8621356, 'remaining_params': 76396244, 'pruned_model_sparsity': 0.10140672049081602, 'expected_sparsity': 0.103, 'target_sparsity': 0.041304347826086954, 'step': 200}


Iteration:  74%|███████▍  | 85/115 [00:32<00:23,  1.26it/s][A04/23/2024 21:47:06 - INFO - trainer.trainer_mod - v4 Global step: 200, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:33<00:19,  1.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:15,  1.75it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:13,  1.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:11,  2.20it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:10,  2.36it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:09,  2.51it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.57it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:08,  2.65it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:08,  2.59it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.65it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:07,  2.65it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.73it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.78it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.78it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.87it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.87it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:40<00:03,  2.85it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.83it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.80it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.84it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.81it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.83it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.85it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.85it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.07it/s][A04/23/2024 21:47:17 - INFO - trainer.trainer_mod - Epoch 1 finished. Took 43.5 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s]
Epoch:   2%|▏         | 2/100 [01:19<1:06:00, 40.41s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.85it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.82it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:41,  2.64it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:40,  2.70it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.70it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:39,  2.70it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.75it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.76it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.80it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.83it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:35,  2.85it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.86it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.82it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A[INFO|trainer.py:570] 2024-04-23 21:47:24,196 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:47:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:47:24 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:47:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:47:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:47:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:47:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8675078864353312, 'combined_score': 0.8308127667470773, 'eval_loss': 0.8431374, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2667, 2657, 2658, 2632, 2639, 2650, 2631, 2631, 2633, 2638, 2660, 2706], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8059112, 'remaining_params': 76958488, 'pruned_model_sparsity': 0.09479345453176755, 'expected_sparsity': 0.09636, 'target_sparsity': 0.06195652173913043, 'step': 250}


Iteration:  17%|█▋        | 20/115 [00:08<01:14,  1.28it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<01:02,  1.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:53,  1.75it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:45,  2.01it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:41,  2.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:38,  2.34it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:37,  2.34it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:34,  2.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:33,  2.58it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:32,  2.66it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:31,  2.74it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:30,  2.78it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.77it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:29,  2.80it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.83it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.90it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.87it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.87it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.85it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:24,  2.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.89it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:23,  2.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:24,  2.68it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:23,  2.73it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.80it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.82it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.78it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.81it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.80it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.68it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:21,  2.71it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.75it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.78it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:19,  2.80it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.81it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.81it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.78it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.79it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.77it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.81it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.79it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.77it/s][A[INFO|trainer.py:570] 2024-04-23 21:47:43,399 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:47:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:47:43 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:47:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:47:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:47:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:47:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8762214983713356, 'combined_score': 0.844973494283707, 'eval_loss': 0.6612431, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2693, 2682, 2682, 2653, 2661, 2675, 2653, 2655, 2659, 2671, 2699, 2753], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7547424, 'remaining_params': 77470176, 'pruned_model_sparsity': 0.08877484191508582, 'expected_sparsity': 0.09041, 'target_sparsity': 0.08260869565217391, 'step': 300}


Iteration:  61%|██████    | 70/115 [00:27<00:34,  1.29it/s][A04/23/2024 21:47:44 - INFO - trainer.trainer_mod - v4 Global step: 300, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:28<00:28,  1.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:25,  1.72it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:21,  1.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:29<00:18,  2.17it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:17,  2.32it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:15,  2.45it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:14,  2.56it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.67it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:13,  2.73it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:12,  2.77it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.87it/s][A
Iteration:  74%|███████▍  | 85/115 [00:33<00:10,  2.83it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.80it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:10,  2.77it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.78it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.83it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.83it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.73it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.72it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.78it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.77it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.80it/s][A
Iteration:  86%|████████▌ | 99/115 [00:38<00:05,  2.71it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.80it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.82it/s][A
Iteration:  89%|████████▊ | 102/115 [00:39<00:04,  2.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.78it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.80it/s][A
Iteration:  91%|█████████▏| 105/115 [00:40<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.81it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.80it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.83it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.84it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.19it/s][A04/23/2024 21:48:00 - INFO - trainer.trainer_mod - Epoch 2 finished. Took 43.55 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s]
Epoch:   3%|▎         | 3/100 [02:03<1:07:39, 41.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.09it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 21:48:02,359 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:48:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:48:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:48:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:48:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:48:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:48:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.8803827751196173, 'combined_score': 0.8482796228539262, 'eval_loss': 0.62400883, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2712, 2699, 2699, 2672, 2680, 2697, 2673, 2675, 2682, 2698, 2730, 2789], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7133784, 'remaining_params': 77883816, 'pruned_model_sparsity': 0.08390949638663053, 'expected_sparsity': 0.08553, 'target_sparsity': 0.10326086956521738, 'step': 350}


Iteration:   4%|▍         | 5/115 [00:03<01:35,  1.15it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:14,  1.46it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:01,  1.74it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  1.98it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.24it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:44,  2.37it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:41,  2.50it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:39,  2.58it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.71it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.83it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.86it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:35,  2.70it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:35,  2.68it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:34,  2.71it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.77it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.86it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.85it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:31,  2.81it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.80it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.88it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.85it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.86it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.80it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.90it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.83it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.81it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.80it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.82it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.79it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:27,  2.70it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:26,  2.72it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:26,  2.76it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.79it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:25,  2.79it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.81it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.81it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:22,  2.88it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:23,  2.70it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.73it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.78it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.78it/s][A[INFO|trainer.py:570] 2024-04-23 21:48:21,524 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:48:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:48:21 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:48:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:48:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.72it/s]04/23/2024 21:48:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:48:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7549019607843137, 'f1': 0.8475609756097561, 'combined_score': 0.801231468197035, 'eval_loss': 0.9232556, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2729, 2717, 2715, 2688, 2695, 2715, 2690, 2692, 2700, 2720, 2757, 2814], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6787552, 'remaining_params': 78230048, 'pruned_model_sparsity': 0.07983702198133093, 'expected_sparsity': 0.08145, 'target_sparsity': 0.12391304347826086, 'step': 400}


Iteration:  48%|████▊     | 55/115 [00:22<00:47,  1.25it/s][A04/23/2024 21:48:23 - INFO - trainer.trainer_mod - v4 Global step: 400, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:22<00:38,  1.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:32,  1.76it/s][A
Iteration:  50%|█████     | 58/115 [00:23<00:28,  1.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:23<00:25,  2.20it/s][A
Iteration:  52%|█████▏    | 60/115 [00:24<00:23,  2.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:21,  2.51it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:20,  2.56it/s][A
Iteration:  55%|█████▍    | 63/115 [00:25<00:19,  2.64it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:18,  2.76it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:18,  2.76it/s][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:18,  2.72it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:17,  2.79it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.76it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:16,  2.79it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:16,  2.77it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.80it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:15,  2.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.66it/s][A
Iteration:  64%|██████▍   | 74/115 [00:29<00:15,  2.72it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.73it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:14,  2.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:14,  2.67it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.73it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.78it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:12,  2.81it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.84it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.85it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.80it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:07,  2.88it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.85it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.76it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.77it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.82it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.81it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.84it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.82it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.80it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.81it/s][A[INFO|trainer.py:570] 2024-04-23 21:48:40,656 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:48:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:48:40 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:48:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:48:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:48:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:48:42 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7696078431372549, 'f1': 0.8549382716049383, 'combined_score': 0.8122730573710966, 'eval_loss': 0.6249916, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2740, 2728, 2724, 2697, 2704, 2724, 2700, 2701, 2713, 2733, 2773, 2827], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6585328, 'remaining_params': 78432272, 'pruned_model_sparsity': 0.0774584086118639, 'expected_sparsity': 0.07911, 'target_sparsity': 0.14456521739130435, 'step': 450}


Iteration:  91%|█████████▏| 105/115 [00:41<00:07,  1.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:41<00:05,  1.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:42<00:04,  1.77it/s][A
Iteration:  94%|█████████▍| 108/115 [00:42<00:03,  1.99it/s][A
Iteration:  95%|█████████▍| 109/115 [00:42<00:02,  2.19it/s][A
Iteration:  96%|█████████▌| 110/115 [00:43<00:02,  2.35it/s][A
Iteration:  97%|█████████▋| 111/115 [00:43<00:01,  2.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  2.56it/s][A
Iteration:  98%|█████████▊| 113/115 [00:44<00:00,  2.59it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.63it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.89it/s][A04/23/2024 21:48:45 - INFO - trainer.trainer_mod - Epoch 3 finished. Took 44.96 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.56it/s]
Epoch:   4%|▍         | 4/100 [02:48<1:08:55, 43.07s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.75it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.83it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.82it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.84it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.80it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.83it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.84it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.92it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.90it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.90it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.81it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.77it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:35,  2.78it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.79it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.81it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.88it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.85it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:30,  2.75it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.77it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.85it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:28,  2.82it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.79it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:27,  2.73it/s][A[INFO|trainer.py:570] 2024-04-23 21:48:59,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:48:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:48:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:48:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:48:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.50it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:49:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:49:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7450980392156863, 'f1': 0.8429003021148036, 'combined_score': 0.793999170665245, 'eval_loss': 0.91037935, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2746, 2735, 2732, 2704, 2709, 2731, 2706, 2708, 2718, 2736, 2780, 2830], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6476556, 'remaining_params': 78541044, 'pruned_model_sparsity': 0.07617900293586269, 'expected_sparsity': 0.07784, 'target_sparsity': 0.16521739130434782, 'step': 500}


Iteration:  35%|███▍      | 40/115 [00:15<00:58,  1.28it/s][A04/23/2024 21:49:01 - INFO - trainer.trainer_mod - v4 Global step: 500, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:48,  1.53it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:41,  1.78it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:37,  1.92it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:33,  2.10it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:30,  2.29it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:28,  2.44it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:27,  2.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:27,  2.46it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:25,  2.56it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:23,  2.72it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:23,  2.72it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.82it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.86it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.80it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.82it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.89it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.86it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.80it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.81it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.79it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.81it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.80it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.83it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.79it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.83it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.81it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.82it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.78it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.80it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.79it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.83it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.80it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.79it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.76it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.76it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.75it/s][A[INFO|trainer.py:570] 2024-04-23 21:49:18,865 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:49:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:49:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:49:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:49:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:49:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:49:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8814102564102565, 'combined_score': 0.8500188536953244, 'eval_loss': 0.6722913, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2747, 2735, 2733, 2702, 2707, 2728, 2701, 2704, 2714, 2726, 2774, 2819], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6545496, 'remaining_params': 78472104, 'pruned_model_sparsity': 0.07698989385727191, 'expected_sparsity': 0.07864, 'target_sparsity': 0.1858695652173913, 'step': 550}


Iteration:  78%|███████▊  | 90/115 [00:34<00:19,  1.28it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:15,  1.53it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:12,  1.81it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:11,  1.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:09,  2.17it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:08,  2.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:07,  2.50it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.58it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.68it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.73it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.72it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.74it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.74it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.84it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.81it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.84it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.83it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.66it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.69it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.75it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.64it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.72it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.63it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.89it/s][A04/23/2024 21:49:29 - INFO - trainer.trainer_mod - Epoch 4 finished. Took 43.61 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s]
Epoch:   5%|▌         | 5/100 [03:31<1:08:30, 43.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:42,  2.68it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:41,  2.73it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:41,  2.70it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.71it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.78it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:41,  2.63it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.71it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.76it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.70it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:38,  2.71it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:38,  2.68it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:37,  2.72it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:36,  2.77it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:36,  2.77it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.77it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:35,  2.78it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.83it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.84it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.82it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.80it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.88it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 21:49:38,229 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:49:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:49:38 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:49:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:49:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.49it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:49:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:49:39 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8687499999999999, 'combined_score': 0.8314338235294116, 'eval_loss': 0.83338404, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2741, 2728, 2730, 2692, 2697, 2717, 2686, 2690, 2696, 2695, 2748, 2787], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6825852, 'remaining_params': 78191748, 'pruned_model_sparsity': 0.08028751693766938, 'expected_sparsity': 0.08201, 'target_sparsity': 0.20652173913043476, 'step': 600}


Iteration:  22%|██▏       | 25/115 [00:10<01:10,  1.27it/s][A04/23/2024 21:49:39 - INFO - trainer.trainer_mod - v4 Global step: 600, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:58,  1.52it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:51,  1.71it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:44,  1.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:39,  2.19it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:35,  2.39it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:33,  2.51it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:32,  2.59it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:30,  2.65it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:30,  2.70it/s][A
Iteration:  30%|███       | 35/115 [00:14<00:29,  2.72it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:28,  2.77it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.78it/s][A
Iteration:  33%|███▎      | 38/115 [00:15<00:27,  2.75it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:27,  2.80it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.83it/s][A
Iteration:  36%|███▌      | 41/115 [00:16<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.84it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:24,  2.85it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.80it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.81it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.78it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:23,  2.79it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.82it/s][A
Iteration:  45%|████▌     | 52/115 [00:20<00:22,  2.79it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.76it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.80it/s][A
Iteration:  48%|████▊     | 55/115 [00:21<00:22,  2.66it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.78it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.81it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.86it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:18,  2.86it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.87it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.80it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:17,  2.79it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.83it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.78it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.80it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.71it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.81it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.78it/s][A[INFO|trainer.py:570] 2024-04-23 21:49:57,481 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:49:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:49:57 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:49:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:49:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:49:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:49:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7622549019607843, 'f1': 0.8519083969465648, 'combined_score': 0.8070816494536746, 'eval_loss': 0.9816945, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2727, 2712, 2719, 2671, 2676, 2693, 2653, 2660, 2658, 2631, 2686, 2710], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7455504, 'remaining_params': 77562096, 'pruned_model_sparsity': 0.08769365401987353, 'expected_sparsity': 0.0895, 'target_sparsity': 0.22717391304347825, 'step': 650}


Iteration:  65%|██████▌   | 75/115 [00:29<00:31,  1.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:30<00:25,  1.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:21,  1.76it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:18,  1.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:31<00:16,  2.16it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:14,  2.34it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:13,  2.44it/s][A
Iteration:  71%|███████▏  | 82/115 [00:32<00:12,  2.55it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:12,  2.60it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:11,  2.64it/s][A
Iteration:  74%|███████▍  | 85/115 [00:33<00:11,  2.68it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.70it/s][A
Iteration:  76%|███████▌  | 87/115 [00:34<00:10,  2.75it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.75it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.77it/s][A
Iteration:  78%|███████▊  | 90/115 [00:35<00:09,  2.76it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.80it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.82it/s][A
Iteration:  81%|████████  | 93/115 [00:36<00:07,  2.84it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 96/115 [00:37<00:06,  2.84it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.82it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.84it/s][A
Iteration:  86%|████████▌ | 99/115 [00:38<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:39<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.89it/s][A
Iteration:  91%|█████████▏| 105/115 [00:40<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.82it/s][A
Iteration:  93%|█████████▎| 107/115 [00:41<00:02,  2.81it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.82it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.80it/s][A
Iteration:  96%|█████████▌| 110/115 [00:42<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.81it/s][A
Iteration:  98%|█████████▊| 113/115 [00:43<00:00,  2.84it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.86it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.09it/s][A04/23/2024 21:50:12 - INFO - trainer.trainer_mod - Epoch 5 finished. Took 43.74 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.63it/s]
Epoch:   6%|▌         | 6/100 [04:15<1:08:02, 43.43s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.92it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.80it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.79it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.84it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.86it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.82it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.79it/s][A[INFO|trainer.py:570] 2024-04-23 21:50:16,442 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:50:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:50:16 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:50:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:50:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.50it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:50:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:50:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8789808917197452, 'combined_score': 0.8463531909579118, 'eval_loss': 0.9823549, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2703, 2686, 2700, 2639, 2641, 2651, 2592, 2604, 2583, 2490, 2535, 2503], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8786812, 'remaining_params': 76230788, 'pruned_model_sparsity': 0.10335285870219814, 'expected_sparsity': 0.10533, 'target_sparsity': 0.24782608695652172, 'step': 700}


Iteration:   9%|▊         | 10/115 [00:04<01:22,  1.27it/s][A04/23/2024 21:50:17 - INFO - trainer.trainer_mod - v4 Global step: 700, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:08,  1.51it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:58,  1.76it/s][A
Iteration:  11%|█▏        | 13/115 [00:06<00:51,  1.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:46,  2.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:07<00:39,  2.50it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.60it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:36,  2.69it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:34,  2.76it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.80it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.78it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.78it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.81it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.83it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:32,  2.80it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.81it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.79it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:31,  2.79it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.83it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.83it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.84it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.76it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:31,  2.64it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.73it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.71it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:28,  2.81it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.82it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.82it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.84it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.80it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.83it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.81it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:24,  2.84it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.84it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.86it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:22,  2.83it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.83it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.82it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.82it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.84it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.67it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.74it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.80it/s][A[INFO|trainer.py:570] 2024-04-23 21:50:35,609 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:50:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:50:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:50:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:50:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:50:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:50:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8571428571428571, 'combined_score': 0.8146008403361344, 'eval_loss': 1.3739312, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2663, 2645, 2670, 2589, 2589, 2584, 2498, 2510, 2455, 2222, 2257, 2034], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 11254864, 'remaining_params': 73762736, 'pruned_model_sparsity': 0.132382753688648, 'expected_sparsity': 0.13486, 'target_sparsity': 0.26847826086956517, 'step': 750}


Iteration:  52%|█████▏    | 60/115 [00:24<00:42,  1.28it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:35,  1.54it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:29,  1.77it/s][A
Iteration:  55%|█████▍    | 63/115 [00:25<00:25,  2.01it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:23,  2.21it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:20,  2.41it/s][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:19,  2.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:18,  2.53it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:18,  2.60it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:17,  2.65it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:16,  2.68it/s][A
Iteration:  62%|██████▏   | 71/115 [00:28<00:16,  2.59it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:16,  2.66it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.71it/s][A
Iteration:  64%|██████▍   | 74/115 [00:29<00:14,  2.77it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.81it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.84it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:13,  2.83it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:12,  2.85it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:11,  2.80it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.82it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.72it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:10,  2.78it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.80it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:09,  2.78it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.80it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.79it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.91it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.89it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.84it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.85it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.85it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.74it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.76it/s][A
Iteration:  91%|█████████▏| 105/115 [00:40<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.87it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.85it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.91it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 21:50:54,693 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:50:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:50:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:50:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:50:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:50:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:50:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8867313915857604, 'combined_score': 0.8575813820673901, 'eval_loss': 0.7989329, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2608, 2585, 2628, 2515, 2513, 2487, 2359, 2378, 2291, 1883, 1927, 1458], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 14447552, 'remaining_params': 70570048, 'pruned_model_sparsity': 0.16993601324902138, 'expected_sparsity': 0.17387, 'target_sparsity': 0.2891304347826087, 'step': 800}


Iteration:  96%|█████████▌| 110/115 [00:43<00:03,  1.30it/s][A04/23/2024 21:50:56 - INFO - trainer.trainer_mod - v4 Global step: 800, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:43<00:02,  1.55it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  1.80it/s][A
Iteration:  98%|█████████▊| 113/115 [00:44<00:00,  2.03it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.11it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.43it/s][A04/23/2024 21:50:57 - INFO - trainer.trainer_mod - Epoch 6 finished. Took 44.93 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.56it/s]
Epoch:   7%|▋         | 7/100 [05:00<1:08:04, 43.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.85it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.77it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.81it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.84it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:41,  2.65it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:40,  2.72it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.78it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:40,  2.67it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:40,  2.62it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:39,  2.66it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:38,  2.72it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:37,  2.72it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.78it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:36,  2.77it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:36,  2.75it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.78it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.88it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.90it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.89it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.88it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:30,  2.76it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:29,  2.76it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:28,  2.83it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.80it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.84it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:25,  2.76it/s][A[INFO|trainer.py:570] 2024-04-23 21:51:13,769 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:51:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:51:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:51:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:51:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:51:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:51:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8914858096828046, 'combined_score': 0.8660860420963042, 'eval_loss': 0.8319558, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2534, 2507, 2571, 2418, 2413, 2360, 2190, 2228, 2110, 1563, 1612, 1024], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 17667816, 'remaining_params': 67349784, 'pruned_model_sparsity': 0.20781362917795845, 'expected_sparsity': 0.21798, 'target_sparsity': 0.30978260869565216, 'step': 850}


Iteration:  39%|███▉      | 45/115 [00:17<00:53,  1.30it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:44,  1.55it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:37,  1.80it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:33,  2.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:29,  2.26it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:26,  2.43it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:24,  2.58it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:24,  2.57it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.72it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:22,  2.77it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.76it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.79it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.82it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.87it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.90it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.85it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:19,  2.69it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.72it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:18,  2.76it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.73it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.76it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:17,  2.72it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.73it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.78it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.75it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.75it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.78it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.80it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.82it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.85it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.78it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.79it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.82it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.84it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.83it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.70it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.71it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.76it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.75it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.76it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.80it/s][A[INFO|trainer.py:570] 2024-04-23 21:51:32,934 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:51:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:51:32 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:51:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:51:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.76it/s]04/23/2024 21:51:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:51:34 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8916083916083916, 'combined_score': 0.869823803647333, 'eval_loss': 0.58829606, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2438, 2409, 2503, 2306, 2292, 2213, 2015, 2075, 1935, 1365, 1344, 761], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11], 'pruned_params': 22826060, 'remaining_params': 62191540, 'pruned_model_sparsity': 0.2684862898976212, 'expected_sparsity': 0.26492, 'target_sparsity': 0.33043478260869563, 'step': 900}


Iteration:  83%|████████▎ | 95/115 [00:36<00:15,  1.29it/s][A04/23/2024 21:51:34 - INFO - trainer.trainer_mod - v4 Global step: 900, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:36<00:12,  1.54it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:10,  1.79it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:08,  2.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:07,  2.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:06,  2.37it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.50it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:05,  2.60it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.64it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:04,  2.68it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.81it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.88it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.10it/s][A04/23/2024 21:51:41 - INFO - trainer.trainer_mod - Epoch 7 finished. Took 43.37 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:   8%|▊         | 8/100 [05:43<1:07:04, 43.74s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.88it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.98it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.89it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.82it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.74it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.79it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.80it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:34,  2.73it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.84it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.85it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.80it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.85it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.89it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 21:51:51,669 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:51:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:51:51 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:51:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:51:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/23/2024 21:51:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:51:53 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8779661016949152, 'combined_score': 0.8507477567298105, 'eval_loss': 0.90275514, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2330, 2303, 2427, 2181, 2158, 2058, 1850, 1928, 1770, 1283, 1117, 632], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 11], 'pruned_params': 26345064, 'remaining_params': 58672536, 'pruned_model_sparsity': 0.3098777664859982, 'expected_sparsity': 0.30412, 'target_sparsity': 0.3510869565217391, 'step': 950}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.31it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:45,  1.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:36,  2.22it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:33,  2.40it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:31,  2.51it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.67it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.74it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.76it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.77it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.82it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.94it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.86it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.88it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.89it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.91it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.80it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.86it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.88it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:15,  2.73it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.78it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:14,  2.74it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.80it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.86it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 21:52:10,388 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:52:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:52:10 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:52:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:52:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/23/2024 21:52:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:52:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.883495145631068, 'combined_score': 0.8535122786978869, 'eval_loss': 0.74536365, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2208, 2192, 2343, 2048, 2016, 1899, 1693, 1791, 1619, 1243, 929, 583], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 11, 10], 'pruned_params': 28857544, 'remaining_params': 56160056, 'pruned_model_sparsity': 0.33943023562180064, 'expected_sparsity': 0.33629, 'target_sparsity': 0.3717391304347826, 'step': 1000}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.31it/s][A04/23/2024 21:52:11 - INFO - trainer.trainer_mod - v4 Global step: 1000, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:18,  1.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.09it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:12,  2.46it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:11,  2.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:10,  2.59it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.67it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:09,  2.66it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.75it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.82it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.86it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.87it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.88it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.74it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.85it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.89it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.89it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.90it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.74it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.73it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.77it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.98it/s][A04/23/2024 21:52:23 - INFO - trainer.trainer_mod - Epoch 8 finished. Took 42.74 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.69it/s]
Epoch:   9%|▉         | 9/100 [06:26<1:05:52, 43.43s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  3.00it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.01it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 21:52:29,034 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:52:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:52:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:52:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:52:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/23/2024 21:52:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:52:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8888888888888888, 'combined_score': 0.8611111111111112, 'eval_loss': 0.97420216, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2082, 2077, 2252, 1910, 1869, 1739, 1547, 1661, 1480, 1217, 775, 561], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 11, 9], 'pruned_params': 31311808, 'remaining_params': 53705792, 'pruned_model_sparsity': 0.3682979524239687, 'expected_sparsity': 0.36532, 'target_sparsity': 0.3923913043478261, 'step': 1050}


Iteration:  13%|█▎        | 15/115 [00:06<01:15,  1.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:41,  2.30it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.45it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:36,  2.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:34,  2.70it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:33,  2.76it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.81it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.73it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.77it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.83it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.78it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:29,  2.65it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.70it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.75it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.76it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.86it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.95it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.93it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.82it/s][A[INFO|trainer.py:570] 2024-04-23 21:52:47,758 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:52:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:52:47 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:52:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:52:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.77it/s]04/23/2024 21:52:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:52:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8858603066439524, 'combined_score': 0.8608223101847213, 'eval_loss': 0.73145944, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1948, 1958, 2156, 1775, 1728, 1594, 1420, 1544, 1356, 1198, 649, 547], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 11, 9], 'pruned_params': 33248256, 'remaining_params': 51769344, 'pruned_model_sparsity': 0.3910749774164408, 'expected_sparsity': 0.39148, 'target_sparsity': 0.4130434782608695, 'step': 1100}


Iteration:  57%|█████▋    | 65/115 [00:25<00:39,  1.28it/s][A04/23/2024 21:52:49 - INFO - trainer.trainer_mod - v4 Global step: 1100, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.53it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:27,  1.73it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:24,  1.93it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:21,  2.14it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:19,  2.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:17,  2.49it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.61it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.68it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.81it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.87it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.90it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.81it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.85it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.87it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.87it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.83it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.83it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.73it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.80it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.88it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.88it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.87it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.87it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.82it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.87it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.75it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.81it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 21:53:06,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:53:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:53:06 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:53:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:53:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/23/2024 21:53:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:53:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8411214953271028, 'combined_score': 0.8163940809968847, 'eval_loss': 0.70383406, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1822, 1848, 2060, 1648, 1600, 1462, 1308, 1437, 1245, 1181, 549, 536], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 11, 8], 'pruned_params': 35596812, 'remaining_params': 49420788, 'pruned_model_sparsity': 0.4186993281391147, 'expected_sparsity': 0.41653, 'target_sparsity': 0.433695652173913, 'step': 1150}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.36it/s][A04/23/2024 21:53:07 - INFO - trainer.trainer_mod - Epoch 9 finished. Took 43.95 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.62it/s]
Epoch:  10%|█         | 10/100 [07:10<1:05:23, 43.59s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.78it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.83it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.82it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.83it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.75it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.74it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.78it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.82it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.90it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.77it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.81it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.83it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.96it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.76it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.83it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.92it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.81it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.87it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:25,  2.86it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.85it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.89it/s][A[INFO|trainer.py:570] 2024-04-23 21:53:25,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:53:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:53:25 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:53:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:53:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/23/2024 21:53:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:53:26 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8628158844765343, 'combined_score': 0.8382706873363064, 'eval_loss': 0.8330399, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1702, 1745, 1967, 1528, 1481, 1343, 1211, 1341, 1145, 1165, 467, 529], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 11, 8], 'pruned_params': 37203880, 'remaining_params': 47813720, 'pruned_model_sparsity': 0.43760209650707615, 'expected_sparsity': 0.43966, 'target_sparsity': 0.4543478260869565, 'step': 1200}


Iteration:  43%|████▎     | 50/115 [00:18<00:49,  1.30it/s][A04/23/2024 21:53:26 - INFO - trainer.trainer_mod - v4 Global step: 1200, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:19<00:41,  1.56it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:34,  1.82it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:30,  2.05it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:28,  2.17it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:25,  2.34it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.49it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:22,  2.60it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.67it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.73it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:20,  2.63it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.81it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.83it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.86it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.85it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.83it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.88it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.73it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.80it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.89it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.93it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.90it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.83it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.89it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.90it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.89it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 21:53:44,094 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:53:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:53:44 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:53:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:53:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/23/2024 21:53:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:53:45 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.8769497400346621, 'combined_score': 0.8514650660957623, 'eval_loss': 0.7156785, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1590, 1647, 1877, 1416, 1370, 1235, 1124, 1253, 1055, 1148, 403, 522], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 10, 7], 'pruned_params': 39066792, 'remaining_params': 45950808, 'pruned_model_sparsity': 0.4595141711833785, 'expected_sparsity': 0.46352, 'target_sparsity': 0.475, 'step': 1250}


Iteration:  87%|████████▋ | 100/115 [00:37<00:11,  1.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.57it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:07,  1.82it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:05,  2.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.24it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:04,  2.39it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:03,  2.62it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.70it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.75it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.73it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.89it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.88it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.89it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.13it/s][A04/23/2024 21:53:50 - INFO - trainer.trainer_mod - Epoch 10 finished. Took 42.68 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.69it/s]
Epoch:  11%|█         | 11/100 [07:53<1:04:14, 43.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.76it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:42,  2.63it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.74it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.84it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.71it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.79it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.84it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.84it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.87it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.76it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:37,  2.78it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.83it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.81it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.90it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.99it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:32,  2.80it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:30,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.89it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.85it/s][A[INFO|trainer.py:570] 2024-04-23 21:54:02,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:54:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:54:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:54:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:54:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/23/2024 21:54:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:54:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8752260397830017, 'combined_score': 0.8530541963620891, 'eval_loss': 0.6728146, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1486, 1555, 1789, 1313, 1270, 1138, 1047, 1175, 974, 1132, 355, 515], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 9, 10, 7], 'pruned_params': 42553624, 'remaining_params': 42463976, 'pruned_model_sparsity': 0.5005272320084312, 'expected_sparsity': 0.4942, 'target_sparsity': 0.49565217391304345, 'step': 1300}


Iteration:  30%|███       | 35/115 [00:13<01:01,  1.31it/s][A04/23/2024 21:54:04 - INFO - trainer.trainer_mod - v4 Global step: 1300, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:14<00:50,  1.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:43,  1.81it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:38,  2.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:34,  2.23it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:31,  2.39it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.53it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:27,  2.69it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:26,  2.77it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.79it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.81it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:20,  2.99it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.97it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.96it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.82it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.81it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.84it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.85it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.86it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.85it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.84it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.93it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 21:54:21,382 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:54:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:54:21 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:54:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:54:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.80it/s]04/23/2024 21:54:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:54:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8112745098039216, 'f1': 0.8764044943820225, 'combined_score': 0.8438395020929721, 'eval_loss': 0.9190521, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1393, 1469, 1704, 1222, 1181, 1054, 980, 1104, 905, 1115, 324, 508], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 9, 10, 6], 'pruned_params': 43923232, 'remaining_params': 41094368, 'pruned_model_sparsity': 0.5166369316470942, 'expected_sparsity': 0.5161, 'target_sparsity': 0.5163043478260869, 'step': 1350}


Iteration:  74%|███████▍  | 85/115 [00:32<00:22,  1.33it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:18,  1.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:13,  2.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:11,  2.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.39it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:09,  2.52it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.69it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.74it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.86it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.89it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.89it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.87it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.86it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.87it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.87it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.88it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.89it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.88it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.83it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.06it/s][A04/23/2024 21:54:33 - INFO - trainer.trainer_mod - Epoch 11 finished. Took 42.46 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.71it/s]
Epoch:  12%|█▏        | 12/100 [08:35<1:03:08, 43.05s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.74it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.85it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.74it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.79it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.85it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.92it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 21:54:39,938 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:54:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:54:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:54:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:54:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.61it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/23/2024 21:54:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:54:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8758865248226951, 'combined_score': 0.8521589486858574, 'eval_loss': 0.6463759, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1309, 1393, 1626, 1143, 1102, 981, 923, 1042, 842, 1098, 307, 500], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 9, 10, 6], 'pruned_params': 45613028, 'remaining_params': 39404572, 'pruned_model_sparsity': 0.5365127691207467, 'expected_sparsity': 0.53221, 'target_sparsity': 0.5369565217391303, 'step': 1400}


Iteration:  17%|█▋        | 20/115 [00:08<01:12,  1.32it/s][A04/23/2024 21:54:41 - INFO - trainer.trainer_mod - v4 Global step: 1400, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.83it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.05it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:41,  2.18it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:38,  2.34it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:35,  2.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:33,  2.63it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:32,  2.72it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.75it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.82it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:30,  2.76it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.83it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.82it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.89it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.86it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.00it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.89it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.86it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.88it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.89it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.89it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.87it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.75it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.78it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.81it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 21:54:58,633 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:54:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:54:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:54:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:54:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/23/2024 21:54:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:55:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8708133971291866, 'combined_score': 0.8361419926822404, 'eval_loss': 0.9999533, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1232, 1318, 1548, 1067, 1029, 914, 870, 986, 786, 1080, 298, 493], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 9, 10, 6], 'pruned_params': 46549080, 'remaining_params': 38468520, 'pruned_model_sparsity': 0.5475228658536585, 'expected_sparsity': 0.5458, 'target_sparsity': 0.557608695652174, 'step': 1450}


Iteration:  61%|██████    | 70/115 [00:26<00:34,  1.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:28,  1.57it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:24,  1.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:20,  2.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:18,  2.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.38it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:15,  2.54it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.64it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.71it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.79it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.82it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.76it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.79it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.84it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.93it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.87it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.89it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.96it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  3.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.83it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.91it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.12it/s][A04/23/2024 21:55:15 - INFO - trainer.trainer_mod - Epoch 12 finished. Took 42.43 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.71it/s]
Epoch:  13%|█▎        | 13/100 [09:17<1:02:09, 42.86s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.81it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.81it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 21:55:17,213 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:55:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:55:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:55:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:55:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 21:55:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:55:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8824531516183987, 'combined_score': 0.8566677522797876, 'eval_loss': 0.68921936, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1162, 1246, 1470, 998, 961, 851, 823, 934, 735, 1062, 293, 486], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 9, 10, 6], 'pruned_params': 47422320, 'remaining_params': 37595280, 'pruned_model_sparsity': 0.5577941508581753, 'expected_sparsity': 0.55769, 'target_sparsity': 0.5782608695652174, 'step': 1500}


Iteration:   4%|▍         | 5/115 [00:03<01:33,  1.18it/s][A04/23/2024 21:55:18 - INFO - trainer.trainer_mod - v4 Global step: 1500, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.78it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  2.01it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:48,  2.21it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:45,  2.29it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:42,  2.45it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:40,  2.57it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:38,  2.65it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.79it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.84it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.01it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:24,  3.02it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.02it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.97it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.77it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.86it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 21:55:35,645 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:55:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:55:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:55:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:55:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/23/2024 21:55:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:55:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.88339222614841, 'combined_score': 0.8608137601330286, 'eval_loss': 0.70910263, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1096, 1177, 1392, 936, 897, 793, 780, 885, 689, 1042, 290, 478], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 9, 10, 6], 'pruned_params': 48241940, 'remaining_params': 36775660, 'pruned_model_sparsity': 0.5674347429238181, 'expected_sparsity': 0.56993, 'target_sparsity': 0.5989130434782609, 'step': 1550}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.33it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:36,  1.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:30,  1.89it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:26,  2.15it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.47it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:20,  2.63it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.67it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.80it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.91it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.78it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.81it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.91it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.94it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.90it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.77it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.82it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.77it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.80it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.81it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.79it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.82it/s][A[INFO|trainer.py:570] 2024-04-23 21:55:54,216 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:55:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:55:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:55:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:55:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 21:55:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:55:55 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7450980392156863, 'f1': 0.7833333333333333, 'combined_score': 0.7642156862745098, 'eval_loss': 0.7759714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1034, 1111, 1316, 890, 841, 746, 742, 842, 647, 1021, 288, 470], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 9, 10, 6], 'pruned_params': 50334652, 'remaining_params': 34682948, 'pruned_model_sparsity': 0.5920497873381512, 'expected_sparsity': 0.58544, 'target_sparsity': 0.6195652173913043, 'step': 1600}


Iteration:  91%|█████████▏| 105/115 [00:40<00:07,  1.32it/s][A04/23/2024 21:55:55 - INFO - trainer.trainer_mod - v4 Global step: 1600, Alignment: tensor([2, 3, 6, 7], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.84it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:03,  2.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.25it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.48it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.61it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.58it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.66it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.88it/s][A04/23/2024 21:55:59 - INFO - trainer.trainer_mod - Epoch 13 finished. Took 43.59 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s]
Epoch:  14%|█▍        | 14/100 [10:01<1:01:45, 43.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.83it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.84it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.86it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.83it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:31,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.92it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.92it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.91it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 21:56:12,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:56:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:56:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:56:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:56:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 21:56:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:56:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8741258741258742, 'combined_score': 0.84882764294529, 'eval_loss': 0.6052995, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1045, 1243, 866, 795, 704, 710, 804, 610, 999, 285, 462], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 8, 10, 6], 'pruned_params': 51327388, 'remaining_params': 33690212, 'pruned_model_sparsity': 0.6037266166064439, 'expected_sparsity': 0.60058, 'target_sparsity': 0.6402173913043477, 'step': 1650}


Iteration:  35%|███▍      | 40/115 [00:15<00:56,  1.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:35,  2.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:32,  2.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.38it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:27,  2.51it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:26,  2.61it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:25,  2.68it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.77it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.81it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.82it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.76it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.79it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.91it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.92it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.77it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.83it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.84it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.74it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.76it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.80it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 21:56:31,468 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:56:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:56:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:56:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:56:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 21:56:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:56:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8576, 'combined_score': 0.8197313725490196, 'eval_loss': 0.76249987, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [920, 985, 1173, 854, 751, 667, 679, 767, 576, 976, 283, 453], 'head_nums': [12, 12, 12, 12, 11, 11, 10, 9, 12, 8, 10, 6], 'pruned_params': 52480984, 'remaining_params': 32536616, 'pruned_model_sparsity': 0.6172955246913581, 'expected_sparsity': 0.61431, 'target_sparsity': 0.6608695652173913, 'step': 1700}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.32it/s][A04/23/2024 21:56:32 - INFO - trainer.trainer_mod - v4 Global step: 1700, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:34<00:15,  1.57it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.82it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.05it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:09,  2.27it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.43it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.54it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.65it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.79it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.88it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.23it/s][A04/23/2024 21:56:41 - INFO - trainer.trainer_mod - Epoch 14 finished. Took 42.16 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  15%|█▌        | 15/100 [10:43<1:00:38, 42.81s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.90it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.87it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.87it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.93it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.90it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.81it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 21:56:49,750 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:56:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:56:49 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:56:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:56:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 21:56:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:56:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7328431372549019, 'f1': 0.8365817091454272, 'combined_score': 0.7847124232001645, 'eval_loss': 1.0808022, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [868, 927, 1106, 847, 712, 632, 651, 733, 545, 952, 281, 445], 'head_nums': [12, 12, 12, 12, 11, 11, 10, 9, 12, 7, 10, 6], 'pruned_params': 53204088, 'remaining_params': 31813512, 'pruned_model_sparsity': 0.625800869467028, 'expected_sparsity': 0.62791, 'target_sparsity': 0.6815217391304347, 'step': 1750}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:38,  2.26it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.65it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.73it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.74it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.71it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.78it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.83it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.85it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.05it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.99it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  3.00it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.85it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.02it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.02it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 21:57:08,094 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:57:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:57:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:57:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:57:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.74it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 21:57:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:57:09 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8576, 'combined_score': 0.8197313725490196, 'eval_loss': 0.87434554, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [819, 870, 1041, 842, 673, 597, 623, 701, 516, 926, 279, 435], 'head_nums': [12, 12, 12, 12, 11, 11, 10, 9, 12, 7, 10, 6], 'pruned_params': 54892352, 'remaining_params': 30125248, 'pruned_model_sparsity': 0.645658687142427, 'expected_sparsity': 0.64092, 'target_sparsity': 0.7021739130434782, 'step': 1800}


Iteration:  65%|██████▌   | 75/115 [00:28<00:29,  1.34it/s][A04/23/2024 21:57:09 - INFO - trainer.trainer_mod - v4 Global step: 1800, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.11it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:14,  2.40it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.56it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.58it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.71it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.75it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.82it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.95it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.80it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.95it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.80it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.82it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.11it/s][A04/23/2024 21:57:23 - INFO - trainer.trainer_mod - Epoch 15 finished. Took 41.95 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  16%|█▌        | 16/100 [11:25<59:34, 42.55s/it]  
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.75it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.86it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.05it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:34,  3.05it/s][A[INFO|trainer.py:570] 2024-04-23 21:57:26,563 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:57:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:57:26 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:57:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:57:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.72it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 21:57:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:57:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8596802841918295, 'combined_score': 0.8330264166057186, 'eval_loss': 0.63654906, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [771, 816, 980, 837, 636, 563, 595, 671, 489, 898, 276, 425], 'head_nums': [12, 12, 12, 12, 11, 11, 10, 9, 12, 6, 10, 6], 'pruned_params': 55577156, 'remaining_params': 29440444, 'pruned_model_sparsity': 0.6537135369617585, 'expected_sparsity': 0.64985, 'target_sparsity': 0.7228260869565217, 'step': 1850}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.31it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:05,  1.58it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:40,  2.44it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:39,  2.50it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.59it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:36,  2.64it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.78it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.81it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.83it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.82it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.87it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.80it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.88it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.94it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.92it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 21:57:45,077 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:57:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:57:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:57:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:57:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 21:57:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:57:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7303921568627451, 'f1': 0.8348348348348348, 'combined_score': 0.7826134958487899, 'eval_loss': 1.466993, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [726, 764, 919, 832, 601, 531, 569, 642, 464, 868, 273, 415], 'head_nums': [12, 12, 12, 12, 11, 11, 10, 9, 11, 6, 10, 5], 'pruned_params': 56240512, 'remaining_params': 28777088, 'pruned_model_sparsity': 0.6615161096055405, 'expected_sparsity': 0.65798, 'target_sparsity': 0.7434782608695653, 'step': 1900}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.33it/s][A04/23/2024 21:57:46 - INFO - trainer.trainer_mod - v4 Global step: 1900, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:24,  2.09it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.27it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.56it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.65it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.75it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.78it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.68it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.72it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.80it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.79it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.84it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.77it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.98it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  3.05it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:10,  3.10it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.98it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  3.05it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  3.04it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.91it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.93it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.89it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.03it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.82it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 21:58:03,474 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:58:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:58:03 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:58:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:58:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 21:58:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:58:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.861244019138756, 'combined_score': 0.8240043625105544, 'eval_loss': 0.8045689, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [684, 713, 859, 827, 567, 500, 545, 616, 441, 836, 270, 404], 'head_nums': [12, 12, 12, 12, 11, 11, 10, 9, 11, 6, 10, 5], 'pruned_params': 56686324, 'remaining_params': 28331276, 'pruned_model_sparsity': 0.6667598708973201, 'expected_sparsity': 0.66694, 'target_sparsity': 0.7641304347826087, 'step': 1950}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:02,  1.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.10it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.31it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s][A04/23/2024 21:58:06 - INFO - trainer.trainer_mod - Epoch 16 finished. Took 43.27 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  17%|█▋        | 17/100 [12:08<59:09, 42.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.77it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.85it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.94it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.99it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.97it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.04it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.89it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:26,  2.83it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:26,  2.68it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:26,  2.67it/s][A[INFO|trainer.py:570] 2024-04-23 21:58:21,896 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:58:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:58:21 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:58:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:58:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.74it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 21:58:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:58:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8723404255319148, 'combined_score': 0.8479349186483103, 'eval_loss': 0.6324551, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [645, 666, 804, 821, 538, 475, 524, 592, 420, 802, 267, 393], 'head_nums': [12, 12, 12, 12, 11, 11, 9, 8, 11, 5, 10, 5], 'pruned_params': 57674464, 'remaining_params': 27343136, 'pruned_model_sparsity': 0.6783826407708522, 'expected_sparsity': 0.67696, 'target_sparsity': 0.7847826086956522, 'step': 2000}


Iteration:  39%|███▉      | 45/115 [00:16<00:54,  1.29it/s][A04/23/2024 21:58:23 - INFO - trainer.trainer_mod - v4 Global step: 2000, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:17<00:44,  1.55it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:37,  1.80it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:33,  2.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:29,  2.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.42it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.58it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.69it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.78it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.89it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.91it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.86it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.87it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.97it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.99it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.96it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.93it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.83it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.91it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.90it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.89it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 21:58:40,246 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:58:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:58:40 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:58:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:58:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.91it/s]04/23/2024 21:58:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:58:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8710801393728224, 'combined_score': 0.8448537951766073, 'eval_loss': 0.6214765, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [609, 621, 751, 814, 509, 449, 504, 569, 400, 767, 263, 381], 'head_nums': [12, 12, 12, 12, 11, 10, 9, 8, 11, 5, 10, 5], 'pruned_params': 58256624, 'remaining_params': 26760976, 'pruned_model_sparsity': 0.6852301641071966, 'expected_sparsity': 0.69467, 'target_sparsity': 0.8054347826086956, 'step': 2050}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:11,  1.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.07it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.26it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.45it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.57it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.73it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.77it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.22it/s][A04/23/2024 21:58:48 - INFO - trainer.trainer_mod - Epoch 17 finished. Took 41.82 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  18%|█▊        | 18/100 [12:50<58:03, 42.48s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:42,  2.70it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.86it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.02it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.11it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.90it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.01it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.03it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.99it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.01it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 21:58:58,435 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:58:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:58:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:58:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:58:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.72it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.93it/s]04/23/2024 21:58:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:58:59 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8661157024793389, 'combined_score': 0.8337931453573165, 'eval_loss': 0.8252173, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [577, 580, 703, 807, 483, 426, 485, 548, 383, 730, 260, 369], 'head_nums': [12, 12, 12, 12, 11, 10, 8, 8, 11, 5, 10, 5], 'pruned_params': 60957540, 'remaining_params': 24060060, 'pruned_model_sparsity': 0.7169990684281843, 'expected_sparsity': 0.71097, 'target_sparsity': 0.826086956521739, 'step': 2100}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A04/23/2024 21:58:59 - INFO - trainer.trainer_mod - v4 Global step: 2100, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:54,  1.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:46,  1.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:40,  2.04it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:36,  2.24it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.43it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:29,  2.64it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.71it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.86it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.07it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.03it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.92it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.89it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.92it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.98it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.87it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.81it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.86it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.88it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:14,  2.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 21:59:16,815 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:59:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:59:16 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:59:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:59:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.75it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.75it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.94it/s]04/23/2024 21:59:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:59:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8663282571912013, 'combined_score': 0.8363504031054045, 'eval_loss': 0.72875136, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [547, 543, 657, 799, 458, 403, 468, 528, 366, 693, 256, 357], 'head_nums': [11, 12, 12, 12, 11, 10, 7, 8, 11, 5, 10, 5], 'pruned_params': 61679112, 'remaining_params': 23338488, 'pruned_model_sparsity': 0.7254863934056007, 'expected_sparsity': 0.72166, 'target_sparsity': 0.8467391304347825, 'step': 2150}


Iteration:  70%|██████▉   | 80/115 [00:29<00:26,  1.33it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.57it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:18,  1.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:15,  2.11it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.31it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.48it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:11,  2.61it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.66it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.76it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.68it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.75it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.83it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.10it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.03it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.11it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.05it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.01it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.05it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.89it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.78it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.82it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.05it/s][A04/23/2024 21:59:29 - INFO - trainer.trainer_mod - Epoch 18 finished. Took 41.72 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  19%|█▉        | 19/100 [13:32<57:02, 42.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.14it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.00it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 21:59:35,005 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:59:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:59:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:59:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:59:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.75it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.76it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.95it/s]04/23/2024 21:59:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:59:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8686868686868686, 'combined_score': 0.8387551990493167, 'eval_loss': 0.7677695, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [520, 509, 615, 791, 434, 382, 452, 510, 351, 655, 251, 345], 'head_nums': [10, 12, 12, 12, 10, 10, 6, 8, 11, 4, 9, 5], 'pruned_params': 62765300, 'remaining_params': 22252300, 'pruned_model_sparsity': 0.7382624303673593, 'expected_sparsity': 0.73271, 'target_sparsity': 0.867391304347826, 'step': 2200}


Iteration:  13%|█▎        | 15/115 [00:06<01:14,  1.34it/s][A04/23/2024 21:59:36 - INFO - trainer.trainer_mod - v4 Global step: 2200, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:00,  1.63it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:51,  1.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:45,  2.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.28it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:40,  2.36it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:37,  2.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.62it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:33,  2.74it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.81it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.04it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.02it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:26,  3.10it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.00it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.01it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.02it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.04it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.07it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.06it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.05it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.04it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.02it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.90it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.93it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.93it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.80it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.00it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:19,  2.76it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.80it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 21:59:53,285 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:59:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:59:53 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:59:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:59:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.75it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.77it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.77it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.77it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.96it/s]04/23/2024 21:59:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:59:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8372093023255814, 'combined_score': 0.8070850433196535, 'eval_loss': 0.7253846, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [495, 478, 575, 781, 413, 364, 439, 494, 337, 617, 247, 333], 'head_nums': [10, 11, 12, 12, 9, 10, 5, 8, 11, 4, 9, 5], 'pruned_params': 63626284, 'remaining_params': 21391316, 'pruned_model_sparsity': 0.7483895569858476, 'expected_sparsity': 0.74189, 'target_sparsity': 0.8880434782608696, 'step': 2250}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.33it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.56it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.81it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:23,  2.03it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.26it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.68it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.77it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.88it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.92it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.01it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.01it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.09it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  3.08it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.02it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.90it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.88it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.95it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.04it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.01it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.96it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.98it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.98it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:00:11,403 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:00:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:00:11 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:00:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:00:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.75it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.93it/s]04/23/2024 22:00:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:00:12 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8661157024793389, 'combined_score': 0.8337931453573165, 'eval_loss': 0.83271223, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [473, 450, 539, 771, 394, 347, 427, 479, 325, 579, 242, 322], 'head_nums': [10, 11, 12, 11, 8, 10, 5, 7, 11, 4, 9, 5], 'pruned_params': 64461224, 'remaining_params': 20556376, 'pruned_model_sparsity': 0.7582103470340259, 'expected_sparsity': 0.75246, 'target_sparsity': 0.908695652173913, 'step': 2300}


Iteration: 100%|██████████| 115/115 [00:42<00:00,  1.38it/s][A04/23/2024 22:00:12 - INFO - trainer.trainer_mod - Epoch 19 finished. Took 42.8 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.69it/s]
Epoch:  20%|██        | 20/100 [14:15<56:33, 42.42s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 22:00:12 - INFO - trainer.trainer_mod - v4 Global step: 2300, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:36,  3.16it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.06it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.03it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.02it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.01it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.92it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.05it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.05it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.98it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.82it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.84it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.88it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.83it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.86it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.89it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.99it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.00it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  2.99it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.07it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  3.05it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.09it/s][A[INFO|trainer.py:570] 2024-04-23 22:00:29,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:00:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:00:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:00:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:00:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.76it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.94it/s]04/23/2024 22:00:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:00:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.867430441898527, 'combined_score': 0.8344505150669106, 'eval_loss': 0.7242698, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [452, 425, 506, 760, 375, 332, 415, 464, 313, 541, 238, 310], 'head_nums': [10, 10, 12, 10, 8, 10, 5, 6, 11, 4, 9, 5], 'pruned_params': 65282376, 'remaining_params': 19735224, 'pruned_model_sparsity': 0.7678689588979223, 'expected_sparsity': 0.76283, 'target_sparsity': 0.9293478260869565, 'step': 2350}


Iteration:  43%|████▎     | 50/115 [00:18<00:47,  1.36it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.62it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:33,  1.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:30,  2.06it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:27,  2.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:25,  2.39it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.68it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.78it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.78it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.83it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.78it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:16,  2.86it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.95it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.07it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.09it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.00it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.06it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.05it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.04it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.01it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.89it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.04it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 22:00:47,896 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:00:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:00:47 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:00:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:00:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.75it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.76it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.95it/s]04/23/2024 22:00:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:00:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8461538461538461, 'combined_score': 0.8152337858220211, 'eval_loss': 0.7017296, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [434, 403, 475, 748, 358, 317, 405, 451, 301, 505, 233, 299], 'head_nums': [10, 9, 12, 10, 7, 10, 5, 6, 11, 4, 9, 5], 'pruned_params': 65885984, 'remaining_params': 19131616, 'pruned_model_sparsity': 0.7749687594098164, 'expected_sparsity': 0.77016, 'target_sparsity': 0.95, 'step': 2400}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.32it/s][A04/23/2024 22:00:49 - INFO - trainer.trainer_mod - v4 Global step: 2400, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:36<00:09,  1.54it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.80it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:04,  2.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.35it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.52it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:03,  2.66it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.69it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.78it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.15it/s][A04/23/2024 22:00:54 - INFO - trainer.trainer_mod - Epoch 20 finished. Took 41.57 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  21%|██        | 21/100 [14:56<55:30, 42.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.07it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.91it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.97it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.99it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.84it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:01:06,205 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:01:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:01:06 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:01:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:01:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.77it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.77it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.77it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.95it/s]04/23/2024 22:01:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:01:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.837696335078534, 'combined_score': 0.8048775793039729, 'eval_loss': 0.7515106, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [416, 383, 449, 736, 342, 303, 395, 439, 290, 471, 228, 288], 'head_nums': [9, 9, 12, 9, 7, 10, 5, 6, 11, 4, 8, 5], 'pruned_params': 66472740, 'remaining_params': 18544860, 'pruned_model_sparsity': 0.7818703421409214, 'expected_sparsity': 0.77666, 'target_sparsity': 0.95, 'step': 2450}


Iteration:  30%|███       | 35/115 [00:13<00:59,  1.34it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:36,  2.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:34,  2.20it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.67it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.78it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.81it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.83it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.90it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:19,  3.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.97it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:18,  3.07it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.04it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.99it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.04it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.03it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.02it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.13it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.00it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.01it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.96it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.95it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.89it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:01:24,327 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:01:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:01:24 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:01:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:01:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.75it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 22:01:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:01:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8374558303886926, 'combined_score': 0.8059828171551306, 'eval_loss': 0.727966, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [401, 365, 424, 723, 328, 291, 386, 428, 281, 439, 224, 278], 'head_nums': [9, 8, 12, 8, 7, 9, 5, 6, 11, 4, 8, 5], 'pruned_params': 67234144, 'remaining_params': 17783456, 'pruned_model_sparsity': 0.7908261818729299, 'expected_sparsity': 0.78354, 'target_sparsity': 0.95, 'step': 2500}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.35it/s][A04/23/2024 22:01:25 - INFO - trainer.trainer_mod - v4 Global step: 2500, Alignment: tensor([2, 3, 6, 7], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.41it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.56it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.64it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.70it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.75it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.89it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.01it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.02it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.83it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.07it/s][A04/23/2024 22:01:35 - INFO - trainer.trainer_mod - Epoch 21 finished. Took 41.51 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  22%|██▏       | 22/100 [15:38<54:33, 41.97s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.87it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.86it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.96it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.93it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.05it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.06it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.92it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.01it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:01:42,605 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:01:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:01:42 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:01:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:01:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.98it/s]04/23/2024 22:01:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:01:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8590604026845637, 'combined_score': 0.8265890248716936, 'eval_loss': 0.6437287, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [387, 351, 405, 710, 314, 281, 377, 418, 276, 410, 220, 269], 'head_nums': [9, 8, 12, 8, 7, 9, 5, 6, 11, 4, 8, 5], 'pruned_params': 67802516, 'remaining_params': 17215084, 'pruned_model_sparsity': 0.7975115270249925, 'expected_sparsity': 0.79085, 'target_sparsity': 0.95, 'step': 2550}


Iteration:  17%|█▋        | 20/115 [00:08<01:10,  1.35it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:58,  1.61it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:49,  1.88it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:43,  2.10it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.31it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:35,  2.54it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:33,  2.69it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.76it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.80it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.94it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.92it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.91it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  3.00it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.01it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.00it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.08it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.06it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.02it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.02it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.97it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.04it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.07it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.05it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.05it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.83it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:02:00,719 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:02:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:02:00 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:02:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:02:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/23/2024 22:02:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:02:02 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8230088495575222, 'combined_score': 0.7644456012493493, 'eval_loss': 1.262865, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [374, 338, 387, 696, 303, 272, 370, 409, 275, 385, 215, 260], 'head_nums': [9, 7, 12, 8, 7, 8, 5, 6, 11, 4, 7, 4], 'pruned_params': 68317268, 'remaining_params': 16700332, 'pruned_model_sparsity': 0.8035661792381813, 'expected_sparsity': 0.79548, 'target_sparsity': 0.95, 'step': 2600}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.33it/s][A04/23/2024 22:02:02 - INFO - trainer.trainer_mod - v4 Global step: 2600, Alignment: tensor([2, 3, 6, 7], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.60it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:23,  1.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.15it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:17,  2.35it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:15,  2.51it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.64it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.75it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:13,  2.82it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.87it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.87it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.98it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.07it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.13it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  3.04it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.04it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.03it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.86it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.82it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.90it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  2.84it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.93it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.09it/s][A04/23/2024 22:02:17 - INFO - trainer.trainer_mod - Epoch 22 finished. Took 41.29 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.79it/s]
Epoch:  23%|██▎       | 23/100 [16:19<53:35, 41.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.06it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.05it/s][A[INFO|trainer.py:570] 2024-04-23 22:02:18,765 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:02:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:02:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:02:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:02:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.81it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.81it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.81it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.00it/s]04/23/2024 22:02:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:02:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7107843137254902, 'f1': 0.8254437869822485, 'combined_score': 0.7681140503538694, 'eval_loss': 1.3947965, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [362, 326, 372, 682, 292, 264, 363, 400, 274, 361, 211, 253], 'head_nums': [9, 7, 12, 8, 7, 8, 5, 6, 11, 4, 7, 4], 'pruned_params': 68430636, 'remaining_params': 16586964, 'pruned_model_sparsity': 0.8048996443089431, 'expected_sparsity': 0.79912, 'target_sparsity': 0.95, 'step': 2650}


Iteration:   4%|▍         | 5/115 [00:02<01:29,  1.23it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:10,  1.54it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:57,  1.86it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:50,  2.11it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:45,  2.33it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:42,  2.49it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:40,  2.57it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.70it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:36,  2.82it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:35,  2.84it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.83it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.91it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:31,  2.97it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.91it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.83it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.04it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.08it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.04it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.02it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.01it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.07it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.05it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.87it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.93it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.99it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.00it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.11it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.04it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.04it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.92it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.96it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:02:36,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:02:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:02:36 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:02:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:02:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.75it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.98it/s]04/23/2024 22:02:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:02:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6862745098039216, 'f1': 0.8134110787172011, 'combined_score': 0.7498427942605613, 'eval_loss': 1.8245566, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [351, 316, 358, 668, 283, 258, 357, 392, 273, 340, 207, 246], 'head_nums': [9, 7, 12, 8, 6, 8, 5, 6, 11, 4, 7, 4], 'pruned_params': 68724780, 'remaining_params': 16292820, 'pruned_model_sparsity': 0.8083594455736224, 'expected_sparsity': 0.80209, 'target_sparsity': 0.95, 'step': 2700}


Iteration:  48%|████▊     | 55/115 [00:21<00:44,  1.34it/s][A04/23/2024 22:02:38 - INFO - trainer.trainer_mod - v4 Global step: 2700, Alignment: tensor([2, 3, 6, 7], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:31,  1.87it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.09it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:23,  2.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:21,  2.54it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:19,  2.74it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.83it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:16,  2.97it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  3.01it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  3.02it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  3.03it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.95it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.07it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  3.07it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.11it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  3.04it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.93it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.76it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.96it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.01it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.02it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.00it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  3.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:02:54,977 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:02:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:02:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:02:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:02:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.76it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.96it/s]04/23/2024 22:02:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:02:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.8772858, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [341, 307, 348, 654, 274, 252, 351, 385, 273, 322, 204, 239], 'head_nums': [8, 7, 12, 8, 6, 8, 5, 6, 11, 4, 6, 4], 'pruned_params': 69008200, 'remaining_params': 16009400, 'pruned_model_sparsity': 0.811693108250527, 'expected_sparsity': 0.80493, 'target_sparsity': 0.95, 'step': 2750}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.35it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:05,  1.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:04,  1.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.12it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.32it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:02,  2.49it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.55it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.70it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.74it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.82it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.10it/s][A04/23/2024 22:02:59 - INFO - trainer.trainer_mod - Epoch 23 finished. Took 42.5 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.71it/s]
Epoch:  24%|██▍       | 24/100 [17:02<53:10, 41.98s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.98it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.03it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.84it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.05it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  3.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.04it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.03it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  3.04it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.06it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.02it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.88it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:03:13,055 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:03:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:03:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:03:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:03:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.98it/s]04/23/2024 22:03:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:03:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65058696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [331, 299, 338, 640, 266, 246, 345, 377, 272, 305, 200, 233], 'head_nums': [7, 7, 12, 8, 6, 8, 5, 6, 11, 4, 6, 4], 'pruned_params': 69290088, 'remaining_params': 15727512, 'pruned_model_sparsity': 0.8150087511291779, 'expected_sparsity': 0.8089, 'target_sparsity': 0.95, 'step': 2800}


Iteration:  35%|███▍      | 40/115 [00:14<00:55,  1.36it/s][A04/23/2024 22:03:14 - INFO - trainer.trainer_mod - v4 Global step: 2800, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:45,  1.62it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:38,  1.89it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:30,  2.31it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.47it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.59it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.71it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.07it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.03it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.03it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.04it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.07it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.04it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.03it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.99it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.09it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.00it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.06it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.09it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.02it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.08it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.10it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.07it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.04it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.98it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:10,  2.80it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:03:31,076 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:03:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:03:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:03:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:03:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.81it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.81it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.81it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.00it/s]04/23/2024 22:03:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:03:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6592228, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [322, 292, 328, 626, 258, 241, 339, 371, 271, 290, 197, 227], 'head_nums': [7, 6, 12, 8, 5, 8, 5, 6, 11, 4, 6, 4], 'pruned_params': 69760412, 'remaining_params': 15257188, 'pruned_model_sparsity': 0.8205408291930142, 'expected_sparsity': 0.81299, 'target_sparsity': 0.95, 'step': 2850}


Iteration:  78%|███████▊  | 90/115 [00:32<00:18,  1.34it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:14,  1.61it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.86it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:10,  2.07it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.54it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:07,  2.68it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.76it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.83it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.75it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.86it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  3.03it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  3.06it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.22it/s][A04/23/2024 22:03:40 - INFO - trainer.trainer_mod - Epoch 24 finished. Took 41.13 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.80it/s]
Epoch:  25%|██▌       | 25/100 [17:43<52:09, 41.73s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.02it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.11it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.93it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.83it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.91it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.78it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.80it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:33,  2.72it/s][A[INFO|trainer.py:570] 2024-04-23 22:03:49,389 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:03:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:03:49 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:03:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:03:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.75it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.75it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.97it/s]04/23/2024 22:03:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:03:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6572155, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [313, 285, 320, 612, 251, 235, 333, 364, 271, 277, 194, 221], 'head_nums': [7, 6, 12, 8, 5, 8, 5, 6, 11, 4, 6, 4], 'pruned_params': 69837012, 'remaining_params': 15180588, 'pruned_model_sparsity': 0.821441819105691, 'expected_sparsity': 0.81681, 'target_sparsity': 0.95, 'step': 2900}


Iteration:  22%|██▏       | 25/115 [00:09<01:08,  1.31it/s][A04/23/2024 22:03:50 - INFO - trainer.trainer_mod - v4 Global step: 2900, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:56,  1.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.85it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.07it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:39,  2.19it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:32,  2.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.68it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.77it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.87it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.95it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.03it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.03it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.06it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:21,  3.13it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.08it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.06it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.03it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.05it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:18,  3.06it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:17,  3.18it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.11it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.10it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:16,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:16,  3.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.02it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.01it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:04:07,329 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:04:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:04:07 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:04:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:04:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.78it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.78it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.97it/s]04/23/2024 22:04:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:04:08 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7649786, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [304, 280, 312, 598, 245, 230, 326, 357, 270, 266, 191, 216], 'head_nums': [7, 6, 11, 8, 5, 8, 5, 6, 11, 3, 5, 4], 'pruned_params': 70301208, 'remaining_params': 14716392, 'pruned_model_sparsity': 0.8269018179765131, 'expected_sparsity': 0.82254, 'target_sparsity': 0.95, 'step': 2950}


Iteration:  65%|██████▌   | 75/115 [00:27<00:29,  1.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:19,  1.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:16,  2.18it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:14,  2.43it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:13,  2.59it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.76it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.88it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  3.02it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.03it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.02it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.03it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.08it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.09it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.01it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.04it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  2.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  2.85it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.87it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  3.00it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  3.05it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.30it/s][A04/23/2024 22:04:21 - INFO - trainer.trainer_mod - Epoch 25 finished. Took 41.08 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.80it/s]
Epoch:  26%|██▌       | 26/100 [18:24<51:13, 41.53s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.75it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.78it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.99it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 22:04:25,255 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:04:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:04:25 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:04:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:04:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/23/2024 22:04:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:04:26 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7099364, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [296, 275, 305, 584, 239, 225, 319, 349, 269, 255, 188, 212], 'head_nums': [6, 6, 11, 8, 4, 7, 5, 6, 11, 3, 5, 4], 'pruned_params': 70959968, 'remaining_params': 14057632, 'pruned_model_sparsity': 0.8346503312255344, 'expected_sparsity': 0.82971, 'target_sparsity': 0.95, 'step': 3000}


Iteration:   9%|▊         | 10/115 [00:04<01:19,  1.32it/s][A04/23/2024 22:04:26 - INFO - trainer.trainer_mod - v4 Global step: 3000, Alignment: tensor([1, 1, 2, 2], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:04,  1.60it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:48,  2.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:43,  2.32it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:40,  2.46it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:37,  2.62it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.67it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.81it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:34,  2.72it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.83it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.90it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.01it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.85it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.06it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.07it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.06it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.07it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:22,  3.10it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.11it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:21,  3.18it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.00it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.05it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.06it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.04it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.07it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.09it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.03it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:04:43,278 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:04:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:04:43 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:04:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:04:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/23/2024 22:04:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:04:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.64509255, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [288, 270, 299, 570, 233, 221, 312, 342, 269, 246, 186, 207], 'head_nums': [6, 6, 11, 7, 4, 7, 5, 6, 11, 3, 5, 4], 'pruned_params': 71221940, 'remaining_params': 13795660, 'pruned_model_sparsity': 0.8377317167268895, 'expected_sparsity': 0.84093, 'target_sparsity': 0.95, 'step': 3050}


Iteration:  52%|█████▏    | 60/115 [00:22<00:40,  1.36it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.63it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:24,  2.15it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:21,  2.33it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:19,  2.52it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:18,  2.62it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.75it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  3.04it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.07it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:12,  3.09it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.04it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.00it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.05it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  3.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  3.03it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.05it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.03it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.09it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.02it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.02it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.04it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.00it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.83it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.90it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  2.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.07it/s][A[INFO|trainer.py:570] 2024-04-23 22:05:01,218 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:05:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:05:01 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:05:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:05:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.81it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.82it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.83it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.83it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.83it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.01it/s]04/23/2024 22:05:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:05:02 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6589062, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [281, 266, 294, 557, 229, 216, 305, 334, 268, 238, 184, 203], 'head_nums': [6, 6, 11, 7, 3, 7, 4, 5, 11, 3, 5, 4], 'pruned_params': 73244180, 'remaining_params': 11773420, 'pruned_model_sparsity': 0.8615178504215598, 'expected_sparsity': 0.85209, 'target_sparsity': 0.95, 'step': 3100}


Iteration:  96%|█████████▌| 110/115 [00:40<00:03,  1.35it/s][A04/23/2024 22:05:02 - INFO - trainer.trainer_mod - v4 Global step: 3100, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.62it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  1.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.37it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.69it/s][A04/23/2024 22:05:04 - INFO - trainer.trainer_mod - Epoch 26 finished. Took 42.28 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.72it/s]
Epoch:  27%|██▋       | 27/100 [19:06<50:48, 41.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.91it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.06it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.13it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.07it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  2.99it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.87it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.87it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.78it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.80it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:35,  2.71it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.81it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.86it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.99it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.03it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.04it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.06it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.99it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.01it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.00it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  3.00it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.09it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.12it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.12it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.07it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:24,  3.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.03it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.07it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.09it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.04it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.06it/s][A[INFO|trainer.py:570] 2024-04-23 22:05:19,163 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:05:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:05:19 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:05:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:05:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.81it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.81it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.82it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.82it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.82it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.82it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.83it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.82it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.81it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.01it/s]04/23/2024 22:05:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:05:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6339423, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [274, 261, 289, 544, 224, 212, 297, 326, 267, 231, 182, 199], 'head_nums': [5, 6, 11, 7, 3, 7, 4, 5, 11, 3, 5, 4], 'pruned_params': 73504620, 'remaining_params': 11512980, 'pruned_model_sparsity': 0.8645812161246612, 'expected_sparsity': 0.85864, 'target_sparsity': 0.95, 'step': 3150}


Iteration:  39%|███▉      | 45/115 [00:16<00:51,  1.36it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:42,  1.64it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:35,  1.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:31,  2.12it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:27,  2.36it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:25,  2.55it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:23,  2.69it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:22,  2.77it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.78it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.88it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.89it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.05it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.03it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.00it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.03it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:17,  2.79it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.88it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.94it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.94it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.03it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.10it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.09it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.11it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.13it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.09it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.07it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.03it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.01it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.02it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.10it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.00it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.00it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:07,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:05:37,140 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:05:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:05:37 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:05:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:05:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.82it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.82it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.83it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.83it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.83it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.02it/s]04/23/2024 22:05:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:05:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6586573, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 257, 284, 531, 220, 208, 290, 317, 266, 225, 180, 196], 'head_nums': [5, 6, 11, 7, 2, 7, 4, 4, 11, 3, 4, 4], 'pruned_params': 73956560, 'remaining_params': 11061040, 'pruned_model_sparsity': 0.8698970566094549, 'expected_sparsity': 0.86317, 'target_sparsity': 0.95, 'step': 3200}


Iteration:  83%|████████▎ | 95/115 [00:34<00:14,  1.34it/s][A04/23/2024 22:05:38 - INFO - trainer.trainer_mod - v4 Global step: 3200, Alignment: tensor([1, 1, 1, 2], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:34<00:11,  1.60it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.85it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:08,  2.07it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:07,  2.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.45it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:05,  2.60it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.70it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.84it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  3.00it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.06it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  3.07it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.89it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.86it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.14it/s][A04/23/2024 22:05:45 - INFO - trainer.trainer_mod - Epoch 27 finished. Took 41.01 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.80it/s]
Epoch:  28%|██▊       | 28/100 [19:47<49:50, 41.53s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.07it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.04it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.07it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.12it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.02it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.03it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.05it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.08it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.05it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:30,  2.98it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.00it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.05it/s][A[INFO|trainer.py:570] 2024-04-23 22:05:55,086 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:05:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:05:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:05:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:05:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.81it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.82it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.83it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.84it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.84it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.84it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.03it/s]04/23/2024 22:05:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:05:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.73081666, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 254, 280, 518, 216, 204, 283, 306, 266, 219, 178, 193], 'head_nums': [5, 6, 11, 7, 2, 6, 4, 4, 11, 3, 4, 4], 'pruned_params': 74210872, 'remaining_params': 10806728, 'pruned_model_sparsity': 0.8728883431195423, 'expected_sparsity': 0.86874, 'target_sparsity': 0.95, 'step': 3250}


Iteration:  26%|██▌       | 30/115 [00:11<01:03,  1.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:52,  1.61it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:44,  1.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:38,  2.11it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:34,  2.37it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:30,  2.60it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.73it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:28,  2.77it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.77it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.87it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.88it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.85it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.84it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.87it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:22,  2.81it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.88it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  3.00it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.96it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.86it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.85it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.81it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.02it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.02it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  3.00it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.08it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.11it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.05it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.03it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.04it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:06:13,277 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:06:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:06:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:06:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:06:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.83it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.84it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.85it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.85it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.85it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.82it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.82it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.81it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.82it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.83it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.84it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.03it/s]04/23/2024 22:06:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:06:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.70172834, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [257, 250, 277, 506, 212, 201, 275, 295, 265, 213, 176, 190], 'head_nums': [5, 6, 11, 7, 2, 6, 4, 4, 11, 2, 4, 4], 'pruned_params': 75251100, 'remaining_params': 9766500, 'pruned_model_sparsity': 0.8851237861336947, 'expected_sparsity': 0.87676, 'target_sparsity': 0.95, 'step': 3300}


Iteration:  70%|██████▉   | 80/115 [00:29<00:25,  1.35it/s][A04/23/2024 22:06:14 - INFO - trainer.trainer_mod - v4 Global step: 3300, Alignment: tensor([1, 1, 1, 2], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:29<00:21,  1.61it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:15,  2.11it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:13,  2.34it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.46it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:11,  2.61it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:10,  2.71it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.77it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.87it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.93it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.04it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.04it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.11it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.05it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.07it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.06it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.08it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.09it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  3.09it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.05it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  3.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.05it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.13it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  3.05it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.87it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  3.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  3.05it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.23it/s][A04/23/2024 22:06:26 - INFO - trainer.trainer_mod - Epoch 28 finished. Took 40.95 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.81it/s]
Epoch:  29%|██▉       | 29/100 [20:28<48:56, 41.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.11it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.83it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.84it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.83it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.89it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:06:31,140 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:06:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:06:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:06:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:06:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.83it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.84it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.85it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.85it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.85it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.86it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.86it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.86it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.05it/s]04/23/2024 22:06:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:06:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65874124, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [252, 247, 273, 494, 209, 198, 268, 285, 264, 209, 175, 187], 'head_nums': [5, 6, 11, 7, 2, 6, 4, 4, 11, 2, 3, 4], 'pruned_params': 75304720, 'remaining_params': 9712880, 'pruned_model_sparsity': 0.8857544790725685, 'expected_sparsity': 0.88107, 'target_sparsity': 0.95, 'step': 3350}


Iteration:  13%|█▎        | 15/115 [00:06<01:13,  1.35it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:00,  1.63it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:51,  1.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:44,  2.16it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:40,  2.38it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.63it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.66it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:33,  2.76it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.01it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.10it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.04it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.00it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.03it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.12it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.12it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.09it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.07it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:23,  3.19it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.16it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.06it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.09it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.04it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.00it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.04it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.05it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.08it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  2.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:06:49,004 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:06:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:06:49 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:06:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:06:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.89it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.89it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.89it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.09it/s]04/23/2024 22:06:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:06:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.866335, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 244, 269, 482, 206, 195, 260, 276, 263, 204, 173, 184], 'head_nums': [5, 6, 11, 7, 2, 6, 4, 4, 11, 2, 3, 4], 'pruned_params': 75749000, 'remaining_params': 9268600, 'pruned_model_sparsity': 0.8909802205660946, 'expected_sparsity': 0.88423, 'target_sparsity': 0.95, 'step': 3400}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.35it/s][A04/23/2024 22:06:50 - INFO - trainer.trainer_mod - v4 Global step: 3400, Alignment: tensor([1, 1, 1, 2], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:24<00:30,  1.61it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:25,  1.88it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.13it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:20,  2.28it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:18,  2.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.55it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:16,  2.67it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.76it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.07it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:11,  3.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.16it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.11it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:10,  3.11it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:09,  3.13it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.09it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.04it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  3.07it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.09it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.10it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.02it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.02it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.08it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.15it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.13it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:04,  2.98it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  2.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  3.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.07it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.91it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:07:06,779 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:07:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:07:06 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:07:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:07:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.86it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.87it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.88it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.88it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.88it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.87it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.85it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.85it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.87it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.88it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.07it/s]04/23/2024 22:07:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:07:08 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6298722, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [243, 242, 266, 471, 203, 192, 252, 268, 262, 200, 172, 182], 'head_nums': [5, 6, 10, 7, 2, 6, 4, 4, 11, 1, 3, 4], 'pruned_params': 75994120, 'remaining_params': 9023480, 'pruned_model_sparsity': 0.8938633882866607, 'expected_sparsity': 0.88695, 'target_sparsity': 0.95, 'step': 3450}


Iteration: 100%|██████████| 115/115 [00:42<00:00,  1.40it/s][A04/23/2024 22:07:08 - INFO - trainer.trainer_mod - Epoch 29 finished. Took 42.03 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.74it/s]
Epoch:  30%|███       | 30/100 [21:10<48:29, 41.56s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.10it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  2.99it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.02it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.02it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.10it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.10it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.07it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.03it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.01it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  3.01it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.06it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.04it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.06it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.06it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.13it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.10it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.07it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.06it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.09it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.11it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.11it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.04it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.05it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:25,  3.07it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.08it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.05it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  3.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-04-23 22:07:24,471 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:07:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:07:24 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:07:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:07:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.87it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.90it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.90it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.09it/s]04/23/2024 22:07:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:07:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.676275, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [239, 239, 262, 460, 200, 190, 244, 259, 261, 197, 170, 180], 'head_nums': [5, 6, 10, 7, 2, 6, 4, 4, 11, 1, 2, 4], 'pruned_params': 76044676, 'remaining_params': 8972924, 'pruned_model_sparsity': 0.8944580416290274, 'expected_sparsity': 0.88973, 'target_sparsity': 0.95, 'step': 3500}


Iteration:  43%|████▎     | 50/115 [00:17<00:47,  1.38it/s][A04/23/2024 22:07:25 - INFO - trainer.trainer_mod - v4 Global step: 3500, Alignment: tensor([1, 1, 1, 2], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:38,  1.65it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:32,  1.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:28,  2.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:25,  2.40it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:23,  2.57it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:21,  2.72it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:20,  2.83it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  3.04it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.04it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.06it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.08it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.06it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.03it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.07it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.02it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.03it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.10it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.12it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:13,  3.07it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.92it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:13,  2.87it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:12,  2.87it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.06it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.14it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.04it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.02it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.95it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.01it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:07,  2.97it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:06,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.02it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:07:42,329 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:07:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:07:42 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:07:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:07:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.89it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.91it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.91it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.91it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.10it/s]04/23/2024 22:07:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:07:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6530611, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [236, 237, 259, 449, 197, 188, 238, 250, 261, 194, 169, 177], 'head_nums': [5, 6, 9, 6, 1, 6, 4, 4, 11, 1, 2, 4], 'pruned_params': 76479764, 'remaining_params': 8537836, 'pruned_model_sparsity': 0.8995756643330323, 'expected_sparsity': 0.89379, 'target_sparsity': 0.95, 'step': 3550}


Iteration:  87%|████████▋ | 100/115 [00:35<00:11,  1.35it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:08,  1.63it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:06,  1.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:05,  2.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:04,  2.35it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  2.58it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:03,  2.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:03,  2.60it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  2.73it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.81it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.24it/s][A04/23/2024 22:07:48 - INFO - trainer.trainer_mod - Epoch 30 finished. Took 40.47 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.84it/s]
Epoch:  31%|███       | 31/100 [21:51<47:25, 41.23s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.06it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.05it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.04it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.05it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.05it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.09it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.05it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.11it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.17it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.16it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.15it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.12it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.07it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.02it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.04it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.02it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.16it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.11it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:29,  3.13it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.18it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.08it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.03it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.91it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.04it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:27,  3.01it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 22:08:00,029 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:08:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:08:00 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:08:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:08:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.91it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.11it/s]04/23/2024 22:08:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:08:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6277081, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [232, 235, 255, 438, 193, 186, 232, 243, 260, 190, 168, 175], 'head_nums': [5, 6, 9, 6, 1, 6, 3, 4, 10, 1, 2, 3], 'pruned_params': 77092564, 'remaining_params': 7925036, 'pruned_model_sparsity': 0.9067835836344474, 'expected_sparsity': 0.89773, 'target_sparsity': 0.95, 'step': 3600}


Iteration:  30%|███       | 35/115 [00:12<00:58,  1.36it/s][A04/23/2024 22:08:01 - INFO - trainer.trainer_mod - v4 Global step: 3600, Alignment: tensor([1, 1, 1, 2], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:48,  1.64it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:40,  1.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:35,  2.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:31,  2.41it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:28,  2.59it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:27,  2.73it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.82it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.94it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.98it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.09it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.07it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.10it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.09it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.09it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.09it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.10it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.09it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.02it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  3.03it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.02it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.08it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.12it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.13it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.07it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.08it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.04it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.04it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.06it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.06it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  3.03it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  3.09it/s][A[INFO|trainer.py:570] 2024-04-23 22:08:17,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:08:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:08:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:08:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:08:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.94it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.94it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.13it/s]04/23/2024 22:08:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:08:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6609121, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [230, 233, 252, 428, 190, 184, 226, 241, 259, 188, 166, 174], 'head_nums': [5, 6, 9, 6, 1, 6, 3, 4, 10, 1, 2, 3], 'pruned_params': 77120140, 'remaining_params': 7897460, 'pruned_model_sparsity': 0.9071079400030111, 'expected_sparsity': 0.90096, 'target_sparsity': 0.95, 'step': 3650}


Iteration:  74%|███████▍  | 85/115 [00:30<00:21,  1.40it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:17,  1.67it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:14,  1.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:12,  2.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:11,  2.36it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:09,  2.56it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.78it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.02it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.01it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.05it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.05it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.10it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.12it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.07it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.08it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.08it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.02it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.04it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.29it/s][A04/23/2024 22:08:28 - INFO - trainer.trainer_mod - Epoch 31 finished. Took 40.09 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.87it/s]
Epoch:  32%|███▏      | 32/100 [22:31<46:20, 40.89s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.05it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.09it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.05it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.02it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.12it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.18it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.12it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.16it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.14it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.12it/s][A[INFO|trainer.py:570] 2024-04-23 22:08:35,152 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:08:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:08:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:08:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:08:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.89it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.90it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.91it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.10it/s]04/23/2024 22:08:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:08:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6751717, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 231, 249, 418, 187, 182, 220, 240, 258, 185, 165, 172], 'head_nums': [5, 6, 9, 6, 1, 5, 3, 4, 9, 1, 2, 3], 'pruned_params': 77345344, 'remaining_params': 7672256, 'pruned_model_sparsity': 0.9097568503462813, 'expected_sparsity': 0.90508, 'target_sparsity': 0.95, 'step': 3700}


Iteration:  17%|█▋        | 20/115 [00:07<01:08,  1.38it/s][A04/23/2024 22:08:36 - INFO - trainer.trainer_mod - v4 Global step: 3700, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:57,  1.64it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:48,  1.91it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:42,  2.18it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:37,  2.40it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:34,  2.57it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:32,  2.71it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.85it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.90it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.04it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.14it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.12it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.03it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.00it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.02it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.06it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.07it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.11it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.97it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.04it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.14it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.10it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  2.97it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.05it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.08it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.09it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.14it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.08it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.09it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:15,  3.21it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.04it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  3.05it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.09it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.02it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:08:52,849 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:08:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:08:52 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:08:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:08:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.94it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.94it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.13it/s]04/23/2024 22:08:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:08:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7027993, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [225, 229, 246, 408, 184, 180, 214, 239, 257, 183, 164, 170], 'head_nums': [5, 6, 8, 6, 1, 4, 3, 4, 9, 1, 2, 3], 'pruned_params': 77765112, 'remaining_params': 7252488, 'pruned_model_sparsity': 0.9146942750677507, 'expected_sparsity': 0.91072, 'target_sparsity': 0.95, 'step': 3750}


Iteration:  61%|██████    | 70/115 [00:25<00:32,  1.37it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:26,  1.64it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:22,  1.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:19,  2.20it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:17,  2.36it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:15,  2.58it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:14,  2.69it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.80it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  3.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.12it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.08it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.07it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.05it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.07it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.18it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.19it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.17it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.13it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.04it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.06it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.93it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.09it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.09it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.11it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.12it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.13it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.05it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.09it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.13it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.40it/s][A04/23/2024 22:09:08 - INFO - trainer.trainer_mod - Epoch 32 finished. Took 39.99 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s]
Epoch:  33%|███▎      | 33/100 [23:11<45:21, 40.62s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.79it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:09:10,350 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:09:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:09:10 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:09:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:09:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.91it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.11it/s]04/23/2024 22:09:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:09:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6489137, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [223, 228, 243, 399, 182, 178, 209, 238, 256, 180, 163, 169], 'head_nums': [4, 6, 7, 6, 1, 4, 3, 4, 8, 1, 2, 3], 'pruned_params': 78180284, 'remaining_params': 6837316, 'pruned_model_sparsity': 0.9195776403944596, 'expected_sparsity': 0.91537, 'target_sparsity': 0.95, 'step': 3800}


Iteration:   4%|▍         | 5/115 [00:03<01:29,  1.23it/s][A04/23/2024 22:09:11 - INFO - trainer.trainer_mod - v4 Global step: 3800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:10,  1.54it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:58,  1.85it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:50,  2.12it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:44,  2.36it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:41,  2.56it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:37,  2.75it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:36,  2.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:33,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:31,  3.04it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.09it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:30,  3.04it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.07it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:28,  3.15it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.09it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:27,  3.17it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.13it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.09it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.07it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:26,  3.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.06it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.06it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.11it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.10it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.22it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.17it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.13it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:22,  3.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.21it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.04it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.09it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.17it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.10it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.09it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 22:09:27,832 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:09:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:09:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:09:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:09:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.94it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.95it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.13it/s]04/23/2024 22:09:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:09:29 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.71481127, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [221, 227, 239, 390, 180, 176, 204, 238, 255, 178, 162, 167], 'head_nums': [4, 6, 6, 6, 1, 3, 3, 4, 8, 1, 2, 3], 'pruned_params': 78596988, 'remaining_params': 6420612, 'pruned_model_sparsity': 0.9244790255194218, 'expected_sparsity': 0.9184, 'target_sparsity': 0.95, 'step': 3850}


Iteration:  48%|████▊     | 55/115 [00:20<00:44,  1.35it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:36,  1.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:30,  1.91it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:26,  2.15it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:23,  2.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:21,  2.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.70it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:19,  2.79it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.02it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:15,  3.13it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.12it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.11it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.01it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.10it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.07it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.07it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.11it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.05it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.06it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.07it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.05it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.03it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.06it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.10it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.09it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.17it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.16it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.22it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.11it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.11it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.10it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.13it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.11it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:04,  2.98it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:09:45,388 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:09:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:09:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:09:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:09:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.88it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.94it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.11it/s]04/23/2024 22:09:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:09:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6765382, 'head_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [219, 226, 236, 381, 178, 175, 199, 237, 254, 176, 161, 166], 'head_nums': [4, 6, 6, 6, 1, 3, 3, 4, 8, 1, 1, 3], 'pruned_params': 78618436, 'remaining_params': 6399164, 'pruned_model_sparsity': 0.9247313026949714, 'expected_sparsity': 0.92277, 'target_sparsity': 0.95, 'step': 3900}


Iteration:  91%|█████████▏| 105/115 [00:38<00:07,  1.36it/s][A04/23/2024 22:09:46 - INFO - trainer.trainer_mod - v4 Global step: 3900, Alignment: tensor([0, 0, 0, 1], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:38<00:05,  1.63it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:04,  1.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:03,  2.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.37it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:02,  2.49it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.64it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.78it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.87it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.22it/s][A04/23/2024 22:09:49 - INFO - trainer.trainer_mod - Epoch 33 finished. Took 41.24 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.79it/s]
Epoch:  34%|███▍      | 34/100 [23:52<44:53, 40.81s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.23it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.22it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.14it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.13it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.12it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.11it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.11it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.05it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.16it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.10it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.09it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.04it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.18it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.08it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.18it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.20it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.12it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.14it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.10it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.10it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.22it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:25,  3.20it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.13it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.14it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.16it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.17it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:24,  3.15it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.15it/s][A[INFO|trainer.py:570] 2024-04-23 22:10:02,665 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:10:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:10:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:10:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:10:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.94it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.95it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.95it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.96it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.96it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.97it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.97it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.97it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.97it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.97it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.97it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.16it/s]04/23/2024 22:10:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:10:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.70491445, 'head_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [217, 225, 233, 373, 177, 174, 195, 237, 253, 175, 160, 165], 'head_nums': [4, 6, 6, 6, 1, 3, 3, 4, 8, 1, 1, 2], 'pruned_params': 79225108, 'remaining_params': 5792492, 'pruned_model_sparsity': 0.9318671428033725, 'expected_sparsity': 0.92742, 'target_sparsity': 0.95, 'step': 3950}


Iteration:  35%|███▍      | 40/115 [00:14<00:54,  1.37it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:45,  1.64it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:38,  1.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:32,  2.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:29,  2.40it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:28,  2.47it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.61it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.07it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.11it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.14it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.14it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.14it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.04it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.05it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.04it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.09it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.11it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.14it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:17,  2.99it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.03it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.07it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.21it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.18it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.11it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.08it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.06it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.09it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.22it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.18it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.21it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.13it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  3.10it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.20it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.14it/s][A[INFO|trainer.py:570] 2024-04-23 22:10:20,023 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:10:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:10:20 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:10:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:10:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.95it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.96it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.97it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.97it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.98it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.98it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.98it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.98it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.98it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.98it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.98it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.17it/s]04/23/2024 22:10:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:10:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.668602, 'head_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [215, 224, 229, 365, 175, 173, 192, 236, 252, 173, 159, 163], 'head_nums': [4, 6, 6, 6, 1, 2, 3, 4, 8, 1, 1, 2], 'pruned_params': 79441120, 'remaining_params': 5576480, 'pruned_model_sparsity': 0.9344079343571213, 'expected_sparsity': 0.9295, 'target_sparsity': 0.95, 'step': 4000}


Iteration:  78%|███████▊  | 90/115 [00:31<00:17,  1.39it/s][A04/23/2024 22:10:21 - INFO - trainer.trainer_mod - v4 Global step: 4000, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:31<00:14,  1.67it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:11,  1.94it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:10,  2.12it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:08,  2.35it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:07,  2.51it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:07,  2.63it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:06,  2.75it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:06,  2.77it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  2.85it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.02it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.05it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.08it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.12it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.20it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.28it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.26it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.32it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.58it/s][A04/23/2024 22:10:29 - INFO - trainer.trainer_mod - Epoch 34 finished. Took 39.45 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  35%|███▌      | 35/100 [24:31<43:45, 40.40s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.11it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.25it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.09it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.19it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.16it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.11it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.13it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.11it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.14it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.20it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.20it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.15it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.22it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:10:37,266 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:10:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:10:37 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:10:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:10:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.98it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.98it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.99it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.00it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.19it/s]04/23/2024 22:10:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:10:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66606766, 'head_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [213, 223, 226, 357, 174, 172, 189, 236, 251, 172, 158, 162], 'head_nums': [4, 6, 6, 6, 1, 2, 3, 4, 8, 1, 1, 2], 'pruned_params': 79724540, 'remaining_params': 5293060, 'pruned_model_sparsity': 0.9377415970340259, 'expected_sparsity': 0.93212, 'target_sparsity': 0.95, 'step': 4050}


Iteration:  22%|██▏       | 25/115 [00:09<01:04,  1.40it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:52,  1.68it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:45,  1.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:38,  2.24it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:35,  2.45it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:32,  2.62it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:30,  2.77it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.99it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.11it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.19it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.20it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.20it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.07it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.23it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.23it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.18it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.17it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.22it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.21it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.11it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.15it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  3.04it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.11it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.11it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.11it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.13it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.23it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.24it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.28it/s][A[INFO|trainer.py:570] 2024-04-23 22:10:54,471 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:10:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:10:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:10:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:10:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.96it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.97it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.02it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.21it/s]04/23/2024 22:10:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:10:55 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.62791437, 'head_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [211, 222, 222, 349, 174, 171, 186, 235, 250, 170, 158, 161], 'head_nums': [4, 6, 5, 6, 1, 2, 3, 4, 8, 1, 1, 2], 'pruned_params': 79937488, 'remaining_params': 5080112, 'pruned_model_sparsity': 0.9402463489912677, 'expected_sparsity': 0.9359, 'target_sparsity': 0.95, 'step': 4100}


Iteration:  65%|██████▌   | 75/115 [00:26<00:28,  1.41it/s][A04/23/2024 22:10:55 - INFO - trainer.trainer_mod - v4 Global step: 4100, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:26<00:23,  1.69it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:20,  1.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:17,  2.13it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:15,  2.35it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:13,  2.56it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:12,  2.66it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.78it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.04it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.07it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.09it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.14it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.16it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.06it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.04it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.06it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.04it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.08it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.02it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.14it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.16it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.22it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.13it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.25it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.11it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.16it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.12it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.35it/s][A04/23/2024 22:11:08 - INFO - trainer.trainer_mod - Epoch 35 finished. Took 39.27 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.93it/s]
Epoch:  36%|███▌      | 36/100 [25:11<42:43, 40.06s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.18it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.20it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.21it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.19it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:11:11,782 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:11:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:11:11 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:11:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:11:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.98it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.99it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.98it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.97it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.97it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.58it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.18it/s]04/23/2024 22:11:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:11:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6509673, 'head_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [210, 222, 218, 341, 174, 170, 183, 235, 249, 169, 157, 160], 'head_nums': [4, 6, 3, 6, 1, 2, 3, 4, 8, 1, 1, 2], 'pruned_params': 80343468, 'remaining_params': 4674132, 'pruned_model_sparsity': 0.9450215955284553, 'expected_sparsity': 0.94145, 'target_sparsity': 0.95, 'step': 4150}


Iteration:   9%|▊         | 10/115 [00:04<01:16,  1.37it/s][A
Iteration:  10%|▉         | 11/115 [00:04<01:02,  1.67it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:52,  1.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:46,  2.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:42,  2.39it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:38,  2.58it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:37,  2.61it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:35,  2.77it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.78it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:30,  3.05it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:29,  3.09it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.12it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.17it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.14it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.18it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.24it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.19it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.20it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.06it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.05it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.07it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.10it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.08it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:22,  3.14it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.11it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.12it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:21,  3.17it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.09it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.12it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.10it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.02it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.06it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.10it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 22:11:29,243 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:11:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:11:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:11:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:11:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.98it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.01it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.20it/s]04/23/2024 22:11:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:11:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68007946, 'head_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [208, 221, 215, 334, 174, 170, 180, 234, 248, 168, 156, 159], 'head_nums': [4, 6, 2, 5, 1, 1, 3, 4, 8, 1, 1, 2], 'pruned_params': 80749448, 'remaining_params': 4268152, 'pruned_model_sparsity': 0.9497968420656429, 'expected_sparsity': 0.9458, 'target_sparsity': 0.95, 'step': 4200}


Iteration:  52%|█████▏    | 60/115 [00:21<00:39,  1.39it/s][A04/23/2024 22:11:30 - INFO - trainer.trainer_mod - v4 Global step: 4200, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:22<00:32,  1.67it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:27,  1.95it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:21,  2.39it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:19,  2.58it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.75it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.98it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.12it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:12,  3.24it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.22it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:11,  3.23it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.12it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.10it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.19it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.07it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.11it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.13it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.05it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.03it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.02it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.04it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.04it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.03it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.07it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.14it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.16it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:04,  3.23it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.15it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.10it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.13it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.12it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.10it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.24it/s][A[INFO|trainer.py:570] 2024-04-23 22:11:46,490 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:11:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:11:46 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:11:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:11:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.01it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.20it/s]04/23/2024 22:11:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:11:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65193, 'head_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [207, 220, 212, 327, 174, 169, 177, 233, 247, 166, 155, 159], 'head_nums': [4, 6, 2, 5, 1, 1, 3, 4, 8, 1, 1, 2], 'pruned_params': 80763236, 'remaining_params': 4254364, 'pruned_model_sparsity': 0.9499590202499247, 'expected_sparsity': 0.94854, 'target_sparsity': 0.95, 'step': 4250}


Iteration:  96%|█████████▌| 110/115 [00:39<00:03,  1.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:02,  1.67it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  1.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.35it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.71it/s][A04/23/2024 22:11:49 - INFO - trainer.trainer_mod - Epoch 36 finished. Took 40.74 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.82it/s]
Epoch:  37%|███▋      | 37/100 [25:51<42:16, 40.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.24it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.21it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.23it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.21it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.16it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.18it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.14it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.22it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.19it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.13it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.10it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.04it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.03it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.11it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.12it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.10it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.08it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.10it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.15it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:28,  3.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.15it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.13it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.11it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.14it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.11it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.01it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:25,  3.00it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:24,  3.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.08it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:23,  3.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:23,  3.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.23it/s][A[INFO|trainer.py:570] 2024-04-23 22:12:03,777 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:12:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:12:03 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:12:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:12:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.98it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.01it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.20it/s]04/23/2024 22:12:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:12:05 - INFO - trainer.trainer_mod - Starting saving the best from epoch 37 and step 4300
04/23/2024 22:12:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.64877665, 'head_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [206, 220, 210, 321, 174, 169, 173, 233, 246, 165, 155, 158], 'head_nums': [4, 5, 1, 5, 1, 1, 3, 4, 7, 1, 1, 2], 'pruned_params': 81166152, 'remaining_params': 3851448, 'pruned_model_sparsity': 0.9546982271906053, 'expected_sparsity': 0.95069, 'target_sparsity': 0.95, 'step': 4300}
04/23/2024 22:12:05 - INFO - trainer.trainer_mod - Saving the best model so far: [Epoch 37 | Step: 4300 | Model size: 3851448 | Score: 0.68382]

[INFO|configuration_utils.py:439] 2024-04-23 22:12:05,118 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-23 22:12:06,129 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95/best/pytorch_model.bin

Iteration:  39%|███▉      | 45/115 [00:16<01:11,  1.02s/it][A04/23/2024 22:12:06 - INFO - trainer.trainer_mod - v4 Global step: 4300, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:17<00:55,  1.24it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:44,  1.52it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:37,  1.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:31,  2.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:27,  2.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:25,  2.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:22,  2.76it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.88it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.04it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.03it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:18,  3.09it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.10it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:17,  3.13it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.04it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.07it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:16,  3.06it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.10it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.10it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.06it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.13it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.20it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.09it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.11it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.13it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.11it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.12it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.16it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.06it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.08it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.14it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.06it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.10it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.12it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.13it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.11it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.13it/s][A[INFO|trainer.py:570] 2024-04-23 22:12:22,106 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:12:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:12:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:12:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:12:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.00it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.03it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.04it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.22it/s]04/23/2024 22:12:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:12:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7090712, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [205, 219, 207, 314, 174, 168, 171, 232, 245, 164, 154, 157], 'head_nums': [4, 5, 1, 5, 1, 1, 3, 4, 6, 1, 1, 2], 'pruned_params': 81374504, 'remaining_params': 3643096, 'pruned_model_sparsity': 0.9571489197530865, 'expected_sparsity': 0.95184, 'target_sparsity': 0.95, 'step': 4350}


Iteration:  83%|████████▎ | 95/115 [00:34<00:14,  1.38it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:11,  1.66it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:09,  1.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:07,  2.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:06,  2.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:05,  2.67it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  2.82it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.08it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  3.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.12it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.21it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  3.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.14it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  3.12it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.92it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.21it/s][A04/23/2024 22:12:29 - INFO - trainer.trainer_mod - Epoch 37 finished. Took 40.36 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.85it/s]
Epoch:  38%|███▊      | 38/100 [26:32<41:38, 40.29s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.25it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.14it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.09it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.09it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.94it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.04it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.04it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.17it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.18it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.21it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:32,  3.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.07it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.08it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.09it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.04it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.05it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.10it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.12it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.15it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:27,  3.14it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.22it/s][A[INFO|trainer.py:570] 2024-04-23 22:12:39,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:12:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:12:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:12:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:12:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.04it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.05it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.24it/s]04/23/2024 22:12:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:12:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6515687, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [204, 219, 205, 308, 173, 168, 169, 232, 243, 163, 153, 156], 'head_nums': [4, 5, 1, 5, 1, 1, 3, 3, 6, 1, 1, 2], 'pruned_params': 81382164, 'remaining_params': 3635436, 'pruned_model_sparsity': 0.9572390187443541, 'expected_sparsity': 0.95358, 'target_sparsity': 0.95, 'step': 4400}


Iteration:  26%|██▌       | 30/115 [00:10<01:01,  1.38it/s][A04/23/2024 22:12:40 - INFO - trainer.trainer_mod - v4 Global step: 4400, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:50,  1.66it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:42,  1.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:37,  2.18it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:33,  2.41it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:30,  2.60it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.76it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:28,  2.78it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.86it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.83it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.06it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.11it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.10it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.13it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.16it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:20,  3.17it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.14it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.18it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.16it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.26it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.18it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.11it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.20it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.16it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.15it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.14it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.11it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.11it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.14it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:14,  2.95it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.09it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.07it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.05it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.12it/s][A[INFO|trainer.py:570] 2024-04-23 22:12:56,758 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:12:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:12:56 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:12:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:12:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.02it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.95it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.97it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.97it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.02it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.20it/s]04/23/2024 22:12:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:12:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6881601, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [203, 218, 203, 302, 173, 168, 167, 231, 242, 162, 153, 156], 'head_nums': [4, 5, 1, 5, 1, 1, 3, 3, 6, 1, 1, 2], 'pruned_params': 81391356, 'remaining_params': 3626244, 'pruned_model_sparsity': 0.9573471375338753, 'expected_sparsity': 0.95449, 'target_sparsity': 0.95, 'step': 4450}


Iteration:  70%|██████▉   | 80/115 [00:28<00:25,  1.38it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:20,  1.67it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:17,  1.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:14,  2.20it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:12,  2.40it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:11,  2.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:11,  2.63it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:10,  2.77it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.11it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.08it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.14it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:05,  3.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.15it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.17it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.19it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.17it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.28it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.21it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.30it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.25it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.21it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.19it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.46it/s][A04/23/2024 22:13:09 - INFO - trainer.trainer_mod - Epoch 38 finished. Took 39.29 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.93it/s]
Epoch:  39%|███▉      | 39/100 [27:11<40:39, 39.99s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.20it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.20it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.02it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.07it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.17it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.15it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.11it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.13it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.15it/s][A[INFO|trainer.py:570] 2024-04-23 22:13:13,810 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:13:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:13:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:13:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:13:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.25it/s]04/23/2024 22:13:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:13:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6608546, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [203, 218, 200, 296, 173, 167, 166, 230, 241, 162, 152, 155], 'head_nums': [4, 5, 1, 5, 1, 1, 3, 3, 6, 1, 1, 2], 'pruned_params': 81399016, 'remaining_params': 3618584, 'pruned_model_sparsity': 0.957437236525143, 'expected_sparsity': 0.9558, 'target_sparsity': 0.95, 'step': 4500}


Iteration:  13%|█▎        | 15/115 [00:06<01:11,  1.39it/s][A04/23/2024 22:13:15 - INFO - trainer.trainer_mod - v4 Global step: 4500, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:59,  1.67it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:49,  1.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:44,  2.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:40,  2.40it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:37,  2.57it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:36,  2.61it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.74it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.85it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  3.05it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.09it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.07it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.08it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.13it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.14it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.06it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.12it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.10it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.05it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.11it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.14it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.14it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:21,  3.16it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.27it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.37it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.30it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:18,  3.29it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.22it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.21it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.30it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.17it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.27it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.19it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.20it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.21it/s][A[INFO|trainer.py:570] 2024-04-23 22:13:30,986 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:13:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:13:30 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:13:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:13:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.25it/s]04/23/2024 22:13:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:13:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66168195, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [202, 218, 198, 290, 173, 167, 166, 230, 240, 161, 152, 154], 'head_nums': [4, 5, 1, 5, 1, 1, 3, 3, 5, 1, 1, 2], 'pruned_params': 81657924, 'remaining_params': 3359676, 'pruned_model_sparsity': 0.960482582429991, 'expected_sparsity': 0.95717, 'target_sparsity': 0.95, 'step': 4550}


Iteration:  57%|█████▋    | 65/115 [00:23<00:35,  1.41it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:29,  1.69it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:20,  2.27it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.49it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:17,  2.64it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.80it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.09it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.17it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.13it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.12it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.15it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.17it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.14it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.21it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.16it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.10it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.07it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.20it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.20it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.07it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  2.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.11it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.17it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.18it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.17it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.19it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.19it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.19it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.19it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.19it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 22:13:48,039 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:13:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:13:48 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:13:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:13:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.09it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/23/2024 22:13:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:13:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67937857, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 217, 196, 285, 173, 167, 166, 229, 239, 160, 151, 154], 'head_nums': [4, 5, 1, 5, 1, 1, 2, 3, 4, 1, 1, 2], 'pruned_params': 81664052, 'remaining_params': 3353548, 'pruned_model_sparsity': 0.9605546616230051, 'expected_sparsity': 0.95771, 'target_sparsity': 0.95, 'step': 4600}


Iteration: 100%|██████████| 115/115 [00:40<00:00,  1.45it/s][A04/23/2024 22:13:49 - INFO - trainer.trainer_mod - Epoch 39 finished. Took 40.34 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.85it/s]
Epoch:  40%|████      | 40/100 [27:51<40:05, 40.10s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 22:13:49 - INFO - trainer.trainer_mod - v4 Global step: 4600, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:35,  3.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.12it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.11it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.09it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.12it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.13it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.16it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.21it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.19it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.19it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.04it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.11it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:28,  3.22it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.15it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.15it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.16it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.17it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.16it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.18it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.12it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.16it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.18it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.19it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.18it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.18it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.19it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:21,  3.20it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:21,  3.21it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:14:05,221 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:14:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:14:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:14:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:14:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/23/2024 22:14:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:14:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6652968, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 217, 194, 279, 173, 166, 166, 228, 238, 159, 151, 153], 'head_nums': [4, 5, 1, 5, 1, 1, 2, 3, 4, 1, 1, 2], 'pruned_params': 81668648, 'remaining_params': 3348952, 'pruned_model_sparsity': 0.9606087210177657, 'expected_sparsity': 0.95816, 'target_sparsity': 0.95, 'step': 4650}


Iteration:  43%|████▎     | 50/115 [00:17<00:46,  1.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:37,  1.69it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:31,  1.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:28,  2.20it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:26,  2.33it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:23,  2.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:21,  2.76it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:20,  2.88it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.10it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.16it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.19it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.10it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.16it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.17it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.17it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.12it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.16it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.15it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.19it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.17it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.19it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.07it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.12it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.11it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.15it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.14it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.14it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.20it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.10it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.11it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:07,  3.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:06,  3.14it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.01it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.07it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.05it/s][A[INFO|trainer.py:570] 2024-04-23 22:14:22,432 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:14:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:14:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:14:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:14:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.08it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/23/2024 22:14:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:14:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66248816, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 216, 192, 274, 173, 166, 166, 227, 237, 159, 150, 153], 'head_nums': [4, 5, 1, 5, 1, 1, 2, 3, 4, 1, 1, 2], 'pruned_params': 81674776, 'remaining_params': 3342824, 'pruned_model_sparsity': 0.9606808002107798, 'expected_sparsity': 0.95906, 'target_sparsity': 0.95, 'step': 4700}


Iteration:  87%|████████▋ | 100/115 [00:34<00:10,  1.38it/s][A04/23/2024 22:14:23 - INFO - trainer.trainer_mod - v4 Global step: 4700, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:34<00:08,  1.63it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:06,  1.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:05,  2.20it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:04,  2.39it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.60it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:03,  2.76it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  2.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.11it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.11it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.37it/s][A04/23/2024 22:14:28 - INFO - trainer.trainer_mod - Epoch 40 finished. Took 39.1 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  41%|████      | 41/100 [28:30<39:07, 39.80s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.19it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.11it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.12it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.11it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.15it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.09it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.13it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.13it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.15it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.16it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.23it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.21it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.12it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.13it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.22it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.20it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.17it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.15it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.28it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.24it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.21it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.06it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:27,  3.07it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.10it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.15it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.15it/s][A[INFO|trainer.py:570] 2024-04-23 22:14:39,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:14:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:14:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:14:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:14:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.09it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/23/2024 22:14:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:14:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.64413106, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [199, 216, 190, 270, 173, 166, 166, 227, 235, 158, 150, 153], 'head_nums': [3, 5, 1, 5, 1, 1, 2, 3, 4, 1, 1, 2], 'pruned_params': 81875468, 'remaining_params': 3142132, 'pruned_model_sparsity': 0.9630413937819934, 'expected_sparsity': 0.96081, 'target_sparsity': 0.95, 'step': 4750}


Iteration:  30%|███       | 35/115 [00:12<00:56,  1.42it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:46,  1.70it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:39,  1.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:34,  2.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:31,  2.42it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:28,  2.59it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.74it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.04it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.04it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.18it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.18it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.15it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.16it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.14it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.17it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.22it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.21it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.19it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.19it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.20it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.17it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.14it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.13it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.02it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.08it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.21it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.22it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.22it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.22it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.22it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.21it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.21it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.00it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:10,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:14:56,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:14:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:14:56 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:14:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:14:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.03it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/23/2024 22:14:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:14:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65066916, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [199, 216, 188, 265, 173, 165, 166, 226, 234, 157, 150, 152], 'head_nums': [3, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 2], 'pruned_params': 81880064, 'remaining_params': 3137536, 'pruned_model_sparsity': 0.9630954531767539, 'expected_sparsity': 0.96205, 'target_sparsity': 0.95, 'step': 4800}


Iteration:  74%|███████▍  | 85/115 [00:29<00:21,  1.38it/s][A04/23/2024 22:14:58 - INFO - trainer.trainer_mod - v4 Global step: 4800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:29<00:17,  1.65it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:14,  1.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:12,  2.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:09,  2.60it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.75it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.08it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.20it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.19it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.18it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.18it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.18it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.20it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.18it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.26it/s][A04/23/2024 22:15:07 - INFO - trainer.trainer_mod - Epoch 41 finished. Took 39.08 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  42%|████▏     | 42/100 [29:09<38:15, 39.58s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.37it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.23it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.24it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.17it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.19it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.11it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.13it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.16it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.16it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.27it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 22:15:13,793 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:15:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:15:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:15:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:15:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.09it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/23/2024 22:15:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:15:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6723962, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 215, 187, 260, 173, 165, 165, 225, 233, 157, 150, 152], 'head_nums': [3, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 2], 'pruned_params': 81884660, 'remaining_params': 3132940, 'pruned_model_sparsity': 0.9631495125715146, 'expected_sparsity': 0.9624, 'target_sparsity': 0.95, 'step': 4850}


Iteration:  17%|█▋        | 20/115 [00:07<01:07,  1.41it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:55,  1.68it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:47,  1.97it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:41,  2.23it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:37,  2.44it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:34,  2.61it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:32,  2.75it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  3.04it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.04it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.06it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.10it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.07it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.10it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.09it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.10it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.11it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.11it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.06it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.16it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.19it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.25it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.31it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:18,  3.34it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.21it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.26it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.28it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.23it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.15it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.21it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.21it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.15it/s][A[INFO|trainer.py:570] 2024-04-23 22:15:30,938 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:15:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:15:30 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:15:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:15:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/23/2024 22:15:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:15:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66296494, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 215, 185, 256, 173, 165, 165, 224, 232, 156, 149, 151], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 2], 'pruned_params': 82085352, 'remaining_params': 2932248, 'pruned_model_sparsity': 0.9655101061427281, 'expected_sparsity': 0.96257, 'target_sparsity': 0.95, 'step': 4900}


Iteration:  61%|██████    | 70/115 [00:24<00:32,  1.40it/s][A04/23/2024 22:15:32 - INFO - trainer.trainer_mod - v4 Global step: 4900, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:25<00:26,  1.69it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:22,  1.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:19,  2.18it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:17,  2.37it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:15,  2.56it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:14,  2.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:13,  2.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.95it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.07it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.10it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.16it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.09it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.03it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.20it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.32it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.28it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.28it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.25it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.23it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.22it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.22it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.08it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.08it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.13it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.14it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.15it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.16it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.17it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.12it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.14it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.17it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.16it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.41it/s][A04/23/2024 22:15:46 - INFO - trainer.trainer_mod - Epoch 42 finished. Took 38.9 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  43%|████▎     | 43/100 [29:48<37:24, 39.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.14it/s][A[INFO|trainer.py:570] 2024-04-23 22:15:48,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:15:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:15:48 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:15:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:15:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/23/2024 22:15:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:15:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.71045506, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 214, 184, 252, 173, 164, 165, 223, 231, 156, 149, 151], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 2], 'pruned_params': 82089948, 'remaining_params': 2927652, 'pruned_model_sparsity': 0.9655641655374887, 'expected_sparsity': 0.96264, 'target_sparsity': 0.95, 'step': 4950}


Iteration:   4%|▍         | 5/115 [00:02<01:28,  1.25it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:09,  1.58it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:57,  1.89it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:49,  2.14it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:44,  2.38it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:40,  2.57it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:38,  2.73it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:36,  2.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:33,  3.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:32,  3.10it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:31,  3.13it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:31,  3.12it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:31,  3.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:31,  3.12it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.01it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:31,  3.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:30,  3.10it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.12it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.16it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.15it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.17it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.20it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.21it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.21it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.21it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.15it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.14it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.22it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.07it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.17it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.29it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.33it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.30it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.30it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.33it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.39it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.33it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.32it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.21it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.15it/s][A[INFO|trainer.py:570] 2024-04-23 22:16:05,023 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:16:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:16:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:16:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:16:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.09it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/23/2024 22:16:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:16:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6663525, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [196, 214, 182, 248, 172, 164, 165, 222, 230, 156, 149, 151], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 2], 'pruned_params': 82094544, 'remaining_params': 2923056, 'pruned_model_sparsity': 0.9656182249322494, 'expected_sparsity': 0.9627, 'target_sparsity': 0.95, 'step': 5000}


Iteration:  48%|████▊     | 55/115 [00:19<00:43,  1.40it/s][A04/23/2024 22:16:06 - INFO - trainer.trainer_mod - v4 Global step: 5000, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:20<00:35,  1.64it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:30,  1.93it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:26,  2.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:23,  2.41it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:21,  2.61it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.76it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.03it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:15,  3.14it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.13it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.25it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.19it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.28it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.31it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.34it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.25it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.13it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.14it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.12it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.05it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.11it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.99it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.07it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.04it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.07it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.06it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.06it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.10it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.09it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.14it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.14it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.16it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.09it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.00it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.10it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.13it/s][A[INFO|trainer.py:570] 2024-04-23 22:16:22,320 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:16:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:16:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:16:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:16:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/23/2024 22:16:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:16:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6681513, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 213, 181, 244, 172, 164, 165, 221, 228, 155, 148, 150], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82096076, 'remaining_params': 2921524, 'pruned_model_sparsity': 0.9656362447305029, 'expected_sparsity': 0.96274, 'target_sparsity': 0.95, 'step': 5050}


Iteration:  91%|█████████▏| 105/115 [00:37<00:07,  1.39it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:05,  1.69it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:04,  1.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:03,  2.27it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.68it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.89it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.06it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.31it/s][A04/23/2024 22:16:26 - INFO - trainer.trainer_mod - Epoch 43 finished. Took 40.22 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.86it/s]
Epoch:  44%|████▍     | 44/100 [30:29<36:59, 39.63s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.07it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.21it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.15it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.16it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.29it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.26it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.21it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.17it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.21it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.16it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.13it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.16it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.15it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.28it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:25,  3.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.21it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.17it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.18it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.12it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.13it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:25,  3.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:24,  3.15it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:16:39,224 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:16:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:16:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:16:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:16:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.08it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/23/2024 22:16:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:16:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66829246, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [196, 213, 180, 241, 172, 164, 165, 220, 227, 155, 148, 150], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82099140, 'remaining_params': 2918460, 'pruned_model_sparsity': 0.9656722843270099, 'expected_sparsity': 0.9628, 'target_sparsity': 0.95, 'step': 5100}


Iteration:  35%|███▍      | 40/115 [00:13<00:53,  1.40it/s][A04/23/2024 22:16:40 - INFO - trainer.trainer_mod - v4 Global step: 5100, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:14<00:45,  1.64it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:38,  1.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:33,  2.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:29,  2.42it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:26,  2.60it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:24,  2.79it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.05it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.15it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.17it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.10it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.10it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.23it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.17it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.17it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.30it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.19it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.19it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.11it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.14it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.17it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.13it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.15it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.13it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.09it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.12it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.19it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:13,  3.04it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.08it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.13it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.12it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.13it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.04it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:10,  3.07it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.09it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.23it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.31it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.13it/s][A[INFO|trainer.py:570] 2024-04-23 22:16:56,414 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:16:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:16:56 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:16:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:16:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.04it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.04it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/23/2024 22:16:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:16:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6655033, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [196, 212, 179, 238, 172, 163, 165, 219, 226, 154, 148, 150], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82103736, 'remaining_params': 2913864, 'pruned_model_sparsity': 0.9657263437217706, 'expected_sparsity': 0.96285, 'target_sparsity': 0.95, 'step': 5150}


Iteration:  78%|███████▊  | 90/115 [00:31<00:17,  1.39it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:14,  1.68it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:12,  1.91it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:10,  2.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:08,  2.40it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:07,  2.59it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.73it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:06,  2.86it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  2.97it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.05it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.07it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.07it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.10it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.12it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.15it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.28it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.26it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.25it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.14it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.20it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.23it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.52it/s][A04/23/2024 22:17:05 - INFO - trainer.trainer_mod - Epoch 44 finished. Took 38.85 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  45%|████▌     | 45/100 [31:07<36:06, 39.40s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.11it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.19it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.14it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.10it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.13it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.09it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.06it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.32it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.12it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  3.00it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.09it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.13it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.12it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.15it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.02it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.06it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.11it/s][A[INFO|trainer.py:570] 2024-04-23 22:17:13,536 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:17:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:17:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:17:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:17:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/23/2024 22:17:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:17:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.64901614, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [196, 211, 178, 234, 172, 163, 165, 219, 225, 154, 148, 150], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82106800, 'remaining_params': 2910800, 'pruned_model_sparsity': 0.9657623833182776, 'expected_sparsity': 0.96289, 'target_sparsity': 0.95, 'step': 5200}


Iteration:  22%|██▏       | 25/115 [00:09<01:04,  1.39it/s][A04/23/2024 22:17:14 - INFO - trainer.trainer_mod - v4 Global step: 5200, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:09<00:53,  1.67it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:46,  1.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:40,  2.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:35,  2.40it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:33,  2.57it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:31,  2.71it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.06it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.11it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.14it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.12it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.16it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.15it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.27it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.25it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.17it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.04it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.11it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.13it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.15it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.16it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.25it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.23it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.24it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.12it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.16it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.14it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.10it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:13,  3.29it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.25it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:12,  3.32it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:17:30,587 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:17:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:17:30 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:17:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:17:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/23/2024 22:17:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:17:31 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.697076, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [196, 211, 178, 231, 172, 163, 165, 218, 223, 154, 148, 150], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82106800, 'remaining_params': 2910800, 'pruned_model_sparsity': 0.9657623833182776, 'expected_sparsity': 0.96295, 'target_sparsity': 0.95, 'step': 5250}


Iteration:  65%|██████▌   | 75/115 [00:26<00:28,  1.41it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:23,  1.68it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:19,  1.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:16,  2.19it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:14,  2.42it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:13,  2.62it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:12,  2.72it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.03it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.09it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.13it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.09it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.28it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.31it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.10it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.12it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.12it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.17it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.27it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.15it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.26it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.20it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.20it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.20it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.29it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.22it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.16it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.19it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.46it/s][A04/23/2024 22:17:44 - INFO - trainer.trainer_mod - Epoch 45 finished. Took 38.93 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.95it/s]
Epoch:  46%|████▌     | 46/100 [31:46<35:19, 39.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.21it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.04it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.10it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.08it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.12it/s][A[INFO|trainer.py:570] 2024-04-23 22:17:47,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:17:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:17:47 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:17:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:17:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/23/2024 22:17:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:17:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6703778, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [196, 210, 177, 228, 172, 162, 165, 217, 222, 153, 147, 149], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82111396, 'remaining_params': 2906204, 'pruned_model_sparsity': 0.9658164427130382, 'expected_sparsity': 0.963, 'target_sparsity': 0.95, 'step': 5300}


Iteration:   9%|▊         | 10/115 [00:04<01:16,  1.38it/s][A04/23/2024 22:17:49 - INFO - trainer.trainer_mod - v4 Global step: 5300, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:04<01:02,  1.67it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:52,  1.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:46,  2.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:41,  2.43it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:38,  2.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:35,  2.77it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.85it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.00it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:31,  3.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:30,  3.07it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.08it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.09it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.15it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.16it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  3.06it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.08it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.12it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.16it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.17it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.22it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.19it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.06it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.07it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.21it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.22it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.08it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.05it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.12it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.14it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.10it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.13it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.12it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.13it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.14it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.08it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.03it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.14it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.17it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.23it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.23it/s][A[INFO|trainer.py:570] 2024-04-23 22:18:04,844 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:18:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:18:04 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:18:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:18:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/23/2024 22:18:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:18:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6588552, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [195, 209, 176, 225, 172, 162, 165, 216, 221, 153, 147, 149], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82115992, 'remaining_params': 2901608, 'pruned_model_sparsity': 0.9658705021077989, 'expected_sparsity': 0.96306, 'target_sparsity': 0.95, 'step': 5350}


Iteration:  52%|█████▏    | 60/115 [00:21<00:38,  1.43it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:31,  1.71it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:26,  1.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:18,  2.76it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.76it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.01it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.03it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.02it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.08it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.11it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.17it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:11,  3.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.18it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.18it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.18it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.17it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.29it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.20it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.24it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.24it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.22it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.10it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.04it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.09it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.13it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.20it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.14it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.16it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.18it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.19it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.17it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.13it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.21it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.20it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.13it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.22it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.19it/s][A[INFO|trainer.py:570] 2024-04-23 22:18:21,951 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:18:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:18:21 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:18:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:18:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/23/2024 22:18:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:18:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66433734, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [195, 209, 176, 222, 172, 161, 165, 215, 219, 153, 147, 149], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82117524, 'remaining_params': 2900076, 'pruned_model_sparsity': 0.9658885219060523, 'expected_sparsity': 0.96315, 'target_sparsity': 0.95, 'step': 5400}


Iteration:  96%|█████████▌| 110/115 [00:38<00:03,  1.41it/s][A04/23/2024 22:18:23 - INFO - trainer.trainer_mod - v4 Global step: 5400, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:39<00:02,  1.69it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  1.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.41it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.78it/s][A04/23/2024 22:18:24 - INFO - trainer.trainer_mod - Epoch 46 finished. Took 40.35 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.85it/s]
Epoch:  47%|████▋     | 47/100 [32:27<34:57, 39.58s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.04it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.10it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.24it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.30it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.25it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.22it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.23it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.28it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.25it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.16it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:32,  2.99it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.03it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.08it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.10it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.13it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.16it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.15it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.12it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.16it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.13it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:27,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.03it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:27,  3.00it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:26,  3.06it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.10it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:25,  3.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.14it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:24,  3.16it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.13it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.15it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.18it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.21it/s][A[INFO|trainer.py:570] 2024-04-23 22:18:39,143 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:18:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:18:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:18:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:18:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/23/2024 22:18:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:18:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6680778, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [195, 209, 175, 220, 172, 161, 165, 215, 218, 153, 147, 149], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82119056, 'remaining_params': 2898544, 'pruned_model_sparsity': 0.9659065417043059, 'expected_sparsity': 0.9633, 'target_sparsity': 0.95, 'step': 5450}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.40it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:40,  1.69it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:34,  1.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:30,  2.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:24,  2.60it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:23,  2.73it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.86it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  2.99it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.05it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.06it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.07it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.11it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.17it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.21it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.21it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.26it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.10it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.10it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.14it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.12it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.05it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.24it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.13it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.06it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.21it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.15it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.15it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.10it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  3.09it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.05it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.06it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.08it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.12it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.25it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.26it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.25it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.23it/s][A[INFO|trainer.py:570] 2024-04-23 22:18:56,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:18:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:18:56 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:18:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:18:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.08it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/23/2024 22:18:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:18:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6516356, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [195, 208, 175, 217, 171, 161, 165, 214, 217, 152, 147, 148], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82120588, 'remaining_params': 2897012, 'pruned_model_sparsity': 0.9659245615025595, 'expected_sparsity': 0.96375, 'target_sparsity': 0.95, 'step': 5500}


Iteration:  83%|████████▎ | 95/115 [00:32<00:14,  1.43it/s][A04/23/2024 22:18:57 - INFO - trainer.trainer_mod - v4 Global step: 5500, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:33<00:11,  1.72it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:08,  2.01it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:07,  2.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:06,  2.55it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.71it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.83it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.00it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.14it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.16it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.17it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.15it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.22it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.21it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.33it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.48it/s][A04/23/2024 22:19:03 - INFO - trainer.trainer_mod - Epoch 47 finished. Took 38.88 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  48%|████▊     | 48/100 [33:06<34:07, 39.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.22it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.22it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.13it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.17it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.17it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.04it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.12it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.12it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.04it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.08it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.11it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.18it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.13it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.10it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:30,  3.01it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.09it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:27,  3.14it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 22:19:13,272 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:19:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:19:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:19:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:19:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/23/2024 22:19:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:19:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6860238, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [195, 208, 175, 215, 171, 160, 165, 213, 216, 152, 147, 148], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82367240, 'remaining_params': 2650360, 'pruned_model_sparsity': 0.9688257490213791, 'expected_sparsity': 0.96498, 'target_sparsity': 0.95, 'step': 5550}


Iteration:  26%|██▌       | 30/115 [00:10<00:59,  1.42it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:49,  1.71it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:41,  2.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:35,  2.29it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:31,  2.54it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:29,  2.70it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.82it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.05it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.15it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.17it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.18it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.31it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.10it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.13it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.16it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.19it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.15it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.14it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.14it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.17it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.20it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.27it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.29it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.16it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.17it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.19it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.15it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.26it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.24it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.20it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.28it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.15it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.17it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.10it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.15it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.29it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.31it/s][A[INFO|trainer.py:570] 2024-04-23 22:19:30,107 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:19:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:19:30 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:19:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:19:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/23/2024 22:19:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:19:31 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67533326, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [195, 207, 175, 212, 171, 160, 164, 212, 214, 152, 147, 148], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82372230, 'remaining_params': 2645370, 'pruned_model_sparsity': 0.9688844427506775, 'expected_sparsity': 0.96569, 'target_sparsity': 0.95, 'step': 5600}


Iteration:  70%|██████▉   | 80/115 [00:27<00:24,  1.41it/s][A04/23/2024 22:19:31 - INFO - trainer.trainer_mod - v4 Global step: 5600, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:28<00:20,  1.69it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.47it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:11,  2.63it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.79it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.08it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.09it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.09it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.31it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.38it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.37it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.35it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.35it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.31it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.32it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.39it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.46it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:02,  3.42it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.40it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.45it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.23it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.18it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.28it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.53it/s][A04/23/2024 22:19:42 - INFO - trainer.trainer_mod - Epoch 48 finished. Took 38.38 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  49%|████▉     | 49/100 [33:44<33:12, 39.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.34it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.37it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.33it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.26it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.20it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.21it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.28it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.38it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.35it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.24it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.06it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.09it/s][A[INFO|trainer.py:570] 2024-04-23 22:19:46,710 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:19:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:19:46 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:19:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:19:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.32it/s]04/23/2024 22:19:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:19:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7182683, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [195, 207, 174, 210, 171, 160, 164, 212, 213, 152, 147, 148], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82373760, 'remaining_params': 2643840, 'pruned_model_sparsity': 0.9689024390243902, 'expected_sparsity': 0.9659, 'target_sparsity': 0.95, 'step': 5650}


Iteration:  13%|█▎        | 15/115 [00:05<01:11,  1.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.69it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:51,  1.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:44,  2.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:39,  2.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:36,  2.59it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:34,  2.72it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.86it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.04it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.27it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:26,  3.27it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.27it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.23it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.22it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.26it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.29it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.27it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.29it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.36it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.33it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:21,  3.41it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.39it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.34it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.24it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.20it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.13it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.14it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.05it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.10it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.12it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.14it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.18it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.21it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.24it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.16it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.19it/s][A[INFO|trainer.py:570] 2024-04-23 22:20:03,592 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:20:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:20:03 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:20:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:20:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/23/2024 22:20:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:20:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68718445, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [195, 207, 174, 208, 171, 160, 164, 211, 211, 151, 146, 148], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82373760, 'remaining_params': 2643840, 'pruned_model_sparsity': 0.9689024390243902, 'expected_sparsity': 0.96598, 'target_sparsity': 0.95, 'step': 5700}


Iteration:  57%|█████▋    | 65/115 [00:22<00:35,  1.42it/s][A04/23/2024 22:20:05 - INFO - trainer.trainer_mod - v4 Global step: 5700, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:23<00:28,  1.70it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:20,  2.25it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.53it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:16,  2.78it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:15,  2.77it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.08it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.15it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.10it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.05it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.09it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.17it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.22it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.28it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.29it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.25it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.17it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.20it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.06it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.07it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.12it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.25it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.15it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.20it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.32it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.32it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.28it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.16it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.12it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.16it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.27it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.33it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.26it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.29it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.36it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.31it/s][A[INFO|trainer.py:570] 2024-04-23 22:20:20,353 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:20:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:20:20 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:20:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:20:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/23/2024 22:20:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:20:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6605512, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [195, 206, 174, 206, 171, 160, 164, 210, 210, 151, 146, 148], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82375290, 'remaining_params': 2642310, 'pruned_model_sparsity': 0.968920435298103, 'expected_sparsity': 0.96602, 'target_sparsity': 0.95, 'step': 5750}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.48it/s][A04/23/2024 22:20:21 - INFO - trainer.trainer_mod - Epoch 49 finished. Took 39.63 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.90it/s]
Epoch:  50%|█████     | 50/100 [34:24<32:42, 39.24s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.25it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.27it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.30it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.26it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.23it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.28it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.31it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.16it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.30it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.25it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.28it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.07it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.10it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.15it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.20it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.18it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.18it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.22it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.20it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.23it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.21it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.24it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.26it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:26,  3.02it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:25,  3.10it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:25,  3.15it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.13it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.27it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.35it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:21,  3.32it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.25it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:22,  3.13it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:21,  3.15it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:21,  3.14it/s][A
Iteration:  42%|████▏     | 48/115 [00:14<00:21,  3.12it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.19it/s][A[INFO|trainer.py:570] 2024-04-23 22:20:37,248 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:20:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:20:37 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:20:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:20:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.32it/s]04/23/2024 22:20:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:20:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7226534, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [195, 206, 174, 204, 171, 160, 164, 209, 208, 151, 146, 148], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82375290, 'remaining_params': 2642310, 'pruned_model_sparsity': 0.968920435298103, 'expected_sparsity': 0.96605, 'target_sparsity': 0.95, 'step': 5800}


Iteration:  43%|████▎     | 50/115 [00:16<00:45,  1.42it/s][A04/23/2024 22:20:38 - INFO - trainer.trainer_mod - v4 Global step: 5800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:17<00:37,  1.69it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:31,  1.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:27,  2.28it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:25,  2.43it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:22,  2.62it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:21,  2.80it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:20,  2.81it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.86it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  3.00it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.10it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.26it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.27it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.29it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.22it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.26it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.36it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.26it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.24it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.24it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.17it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.21it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.26it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.19it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.19it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.23it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.34it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.33it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.25it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.23it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.28it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:07,  3.24it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 95/115 [00:30<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:06,  3.10it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.18it/s][A
Iteration:  85%|████████▌ | 98/115 [00:31<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:04,  3.32it/s][A[INFO|trainer.py:570] 2024-04-23 22:20:54,125 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:20:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:20:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:20:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:20:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/23/2024 22:20:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:20:55 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6636441, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [195, 205, 174, 202, 171, 160, 164, 208, 207, 151, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82376820, 'remaining_params': 2640780, 'pruned_model_sparsity': 0.9689384315718157, 'expected_sparsity': 0.96607, 'target_sparsity': 0.95, 'step': 5850}


Iteration:  87%|████████▋ | 100/115 [00:33<00:10,  1.40it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:08,  1.70it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  1.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:05,  2.28it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:04,  2.56it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.74it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.73it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  2.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.10it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.11it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.11it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.44it/s][A04/23/2024 22:20:59 - INFO - trainer.trainer_mod - Epoch 50 finished. Took 38.32 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  51%|█████     | 51/100 [35:02<31:49, 38.96s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.24it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.29it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.23it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:32,  3.37it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.27it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.25it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.27it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.22it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.26it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.29it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.30it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.30it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.27it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.27it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.28it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.21it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.29it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.29it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.27it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.26it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:25,  3.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:24,  3.38it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:24,  3.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 22:21:10,681 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:21:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:21:10 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:21:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:21:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/23/2024 22:21:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:21:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66939276, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 205, 173, 200, 171, 160, 164, 208, 205, 151, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82379880, 'remaining_params': 2637720, 'pruned_model_sparsity': 0.9689744241192412, 'expected_sparsity': 0.9661, 'target_sparsity': 0.95, 'step': 5900}


Iteration:  30%|███       | 35/115 [00:12<00:55,  1.44it/s][A04/23/2024 22:21:12 - INFO - trainer.trainer_mod - v4 Global step: 5900, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:12<00:46,  1.71it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:39,  1.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:34,  2.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:30,  2.50it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:28,  2.66it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.13it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.21it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.11it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.17it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:20,  3.18it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.21it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.21it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.31it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.24it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.30it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.14it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.22it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.14it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.16it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.22it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.24it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.21it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.24it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.27it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.29it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.31it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.34it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:11,  3.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.25it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.23it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.22it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.33it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.26it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.13it/s][A[INFO|trainer.py:570] 2024-04-23 22:21:27,499 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:21:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:21:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:21:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:21:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.32it/s]04/23/2024 22:21:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:21:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6642042, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 205, 173, 198, 170, 160, 164, 207, 204, 151, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82379880, 'remaining_params': 2637720, 'pruned_model_sparsity': 0.9689744241192412, 'expected_sparsity': 0.96612, 'target_sparsity': 0.95, 'step': 5950}


Iteration:  74%|███████▍  | 85/115 [00:28<00:21,  1.40it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:17,  1.70it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:14,  1.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:11,  2.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.53it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.70it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.03it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.11it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.03it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.06it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.19it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.22it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.28it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.13it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.14it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.20it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.49it/s][A04/23/2024 22:21:38 - INFO - trainer.trainer_mod - Epoch 51 finished. Took 38.08 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.02it/s]
Epoch:  52%|█████▏    | 52/100 [35:40<30:57, 38.70s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.34it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.24it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.24it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.32it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.31it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.30it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.30it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.33it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.33it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.36it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.30it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.25it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.20it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.25it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.22it/s][A[INFO|trainer.py:570] 2024-04-23 22:21:44,201 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:21:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:21:44 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:21:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:21:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/23/2024 22:21:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:21:45 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67446345, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 204, 173, 196, 170, 160, 164, 206, 203, 151, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82381410, 'remaining_params': 2636190, 'pruned_model_sparsity': 0.968992420392954, 'expected_sparsity': 0.96615, 'target_sparsity': 0.95, 'step': 6000}


Iteration:  17%|█▋        | 20/115 [00:07<01:07,  1.41it/s][A04/23/2024 22:21:45 - INFO - trainer.trainer_mod - v4 Global step: 6000, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:07<00:55,  1.71it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:46,  1.99it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:40,  2.24it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:36,  2.49it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:33,  2.65it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:33,  2.67it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.90it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  3.02it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.07it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.13it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.25it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.24it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.25it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.35it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.17it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.06it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.20it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.29it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.28it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.34it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.39it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:17,  3.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.30it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.30it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.18it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.09it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.10it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.14it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:15,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 22:22:01,059 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:22:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:22:01 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:22:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:22:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/23/2024 22:22:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:22:02 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67920387, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 204, 173, 195, 170, 160, 164, 206, 202, 150, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82381410, 'remaining_params': 2636190, 'pruned_model_sparsity': 0.968992420392954, 'expected_sparsity': 0.96617, 'target_sparsity': 0.95, 'step': 6050}


Iteration:  61%|██████    | 70/115 [00:24<00:32,  1.39it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:26,  1.65it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:22,  1.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:19,  2.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:16,  2.42it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:15,  2.62it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:14,  2.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.05it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.07it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.11it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.03it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.13it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.12it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.24it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.25it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.21it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.17it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.30it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.19it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.20it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.21it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.13it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.17it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.21it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.27it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.29it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.36it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.34it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.27it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.27it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.47it/s][A04/23/2024 22:22:16 - INFO - trainer.trainer_mod - Epoch 52 finished. Took 38.32 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  53%|█████▎    | 53/100 [36:18<30:13, 38.58s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.30it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:22:17,928 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:22:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:22:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:22:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:22:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.12it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/23/2024 22:22:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:22:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6735503, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 204, 173, 193, 170, 160, 164, 205, 200, 150, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82381410, 'remaining_params': 2636190, 'pruned_model_sparsity': 0.968992420392954, 'expected_sparsity': 0.96619, 'target_sparsity': 0.95, 'step': 6100}


Iteration:   4%|▍         | 5/115 [00:02<01:26,  1.28it/s][A04/23/2024 22:22:19 - INFO - trainer.trainer_mod - v4 Global step: 6100, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:07,  1.61it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:56,  1.92it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:48,  2.19it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:43,  2.44it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:40,  2.60it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:37,  2.79it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:35,  2.88it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:33,  3.02it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:32,  3.11it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:31,  3.18it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:31,  3.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:30,  3.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:29,  3.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.27it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:28,  3.26it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:28,  3.27it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.28it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:27,  3.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:27,  3.27it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.20it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.24it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.31it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.20it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.24it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.28it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:24,  3.35it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.34it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.31it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.30it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.16it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.26it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.28it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.20it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.13it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.05it/s][A[INFO|trainer.py:570] 2024-04-23 22:22:34,817 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:22:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:22:34 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:22:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:22:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/23/2024 22:22:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:22:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.69008964, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 203, 172, 192, 170, 160, 164, 204, 199, 150, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82384470, 'remaining_params': 2633130, 'pruned_model_sparsity': 0.9690284129403794, 'expected_sparsity': 0.96623, 'target_sparsity': 0.95, 'step': 6150}


Iteration:  48%|████▊     | 55/115 [00:19<00:43,  1.39it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:35,  1.69it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:28,  2.01it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:26,  2.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:23,  2.43it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:21,  2.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.76it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:18,  2.83it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.04it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.14it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.21it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:14,  3.24it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.26it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.25it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.09it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.10it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.11it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.05it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.08it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.16it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.16it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.25it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.32it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:09,  3.32it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.31it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.40it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:08,  3.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.29it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.34it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.34it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.26it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.36it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:06,  3.36it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.20it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.20it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.23it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.26it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.18it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.19it/s][A[INFO|trainer.py:570] 2024-04-23 22:22:51,597 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:22:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:22:51 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:22:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:22:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.32it/s]04/23/2024 22:22:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:22:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6857152, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 203, 172, 190, 170, 160, 163, 203, 197, 150, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82384470, 'remaining_params': 2633130, 'pruned_model_sparsity': 0.9690284129403794, 'expected_sparsity': 0.96626, 'target_sparsity': 0.95, 'step': 6200}


Iteration:  91%|█████████▏| 105/115 [00:36<00:06,  1.43it/s][A04/23/2024 22:22:53 - INFO - trainer.trainer_mod - v4 Global step: 6200, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:36<00:05,  1.72it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:03,  2.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.48it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.57it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.76it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.04it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.29it/s][A04/23/2024 22:22:55 - INFO - trainer.trainer_mod - Epoch 53 finished. Took 39.58 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.91it/s]
Epoch:  54%|█████▍    | 54/100 [36:58<29:48, 38.88s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.29it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:32,  3.42it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.12it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.11it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.04it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.03it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.12it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.16it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.27it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.17it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.15it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.26it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.23it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.29it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.29it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.32it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.11it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.14it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.20it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.28it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.30it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:25,  3.39it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:25,  3.37it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.27it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.29it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.28it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.30it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.21it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.21it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.25it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.30it/s][A[INFO|trainer.py:570] 2024-04-23 22:23:08,323 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:23:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:23:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:23:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:23:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.32it/s]04/23/2024 22:23:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:23:09 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67089677, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 203, 172, 189, 170, 160, 163, 202, 195, 150, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82384470, 'remaining_params': 2633130, 'pruned_model_sparsity': 0.9690284129403794, 'expected_sparsity': 0.96629, 'target_sparsity': 0.95, 'step': 6250}


Iteration:  35%|███▍      | 40/115 [00:13<00:51,  1.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:43,  1.71it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:36,  2.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:31,  2.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:28,  2.53it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:25,  2.71it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:24,  2.84it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:21,  3.07it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.04it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.18it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.18it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.19it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.27it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.26it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.24it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.18it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.22it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.22it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.29it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.36it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.31it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.27it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.30it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.30it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.28it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.13it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.14it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.16it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.23it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.18it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.19it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.21it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.22it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.26it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:08,  3.28it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:07,  3.28it/s][A[INFO|trainer.py:570] 2024-04-23 22:23:25,195 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:23:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:23:25 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:23:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:23:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.12it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/23/2024 22:23:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:23:26 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67721736, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [194, 203, 172, 188, 170, 160, 163, 202, 194, 150, 146, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82384470, 'remaining_params': 2633130, 'pruned_model_sparsity': 0.9690284129403794, 'expected_sparsity': 0.96634, 'target_sparsity': 0.95, 'step': 6300}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.43it/s][A04/23/2024 22:23:26 - INFO - trainer.trainer_mod - v4 Global step: 6300, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:30<00:13,  1.73it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:11,  1.99it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:09,  2.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:08,  2.48it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:07,  2.67it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.78it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.23it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.26it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.27it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.22it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.22it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.22it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.21it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.30it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.07it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.15it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.16it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.43it/s][A04/23/2024 22:23:34 - INFO - trainer.trainer_mod - Epoch 54 finished. Took 38.21 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  55%|█████▌    | 55/100 [37:36<29:00, 38.68s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.28it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.19it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.06it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.26it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.34it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.26it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.22it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.25it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.26it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:27,  3.39it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:27,  3.36it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.29it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.23it/s][A[INFO|trainer.py:570] 2024-04-23 22:23:41,943 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:23:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:23:41 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:23:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:23:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.16it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.36it/s]04/23/2024 22:23:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:23:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.64921224, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [194, 203, 172, 186, 169, 160, 163, 201, 192, 150, 145, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 3, 1, 1, 1], 'pruned_params': 82387912, 'remaining_params': 2629688, 'pruned_model_sparsity': 0.9690688986750978, 'expected_sparsity': 0.9664, 'target_sparsity': 0.95, 'step': 6350}


Iteration:  22%|██▏       | 25/115 [00:09<01:03,  1.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:53,  1.66it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:45,  1.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:39,  2.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:34,  2.48it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:31,  2.72it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.88it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.93it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.09it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.13it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.14it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.19it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.23it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.10it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.14it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.27it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.25it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.33it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.24it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.17it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.21it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.19it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.07it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.21it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.33it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.28it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.29it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.29it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.31it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.26it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.27it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.22it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.26it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.29it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.10it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.18it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.28it/s][A[INFO|trainer.py:570] 2024-04-23 22:23:58,712 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:23:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:23:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:23:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:23:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:24:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:24:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6553932, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [194, 203, 172, 185, 169, 160, 163, 200, 190, 149, 145, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 2, 1, 1, 1], 'pruned_params': 82387912, 'remaining_params': 2629688, 'pruned_model_sparsity': 0.9690688986750978, 'expected_sparsity': 0.96647, 'target_sparsity': 0.95, 'step': 6400}


Iteration:  65%|██████▌   | 75/115 [00:25<00:27,  1.43it/s][A04/23/2024 22:24:00 - INFO - trainer.trainer_mod - v4 Global step: 6400, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:26<00:22,  1.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:18,  2.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:16,  2.29it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:14,  2.48it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:12,  2.73it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  2.84it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.02it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.08it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.09it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.10it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.01it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.08it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.07it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.19it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.19it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.24it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.28it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.24it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.28it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.31it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.39it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.32it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.31it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.32it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.25it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.30it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.58it/s][A04/23/2024 22:24:12 - INFO - trainer.trainer_mod - Epoch 55 finished. Took 38.18 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  56%|█████▌    | 56/100 [38:14<28:15, 38.53s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.21it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.16it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.08it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.17it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:24:15,504 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:24:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:24:15 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:24:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:24:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/23/2024 22:24:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:24:16 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68674093, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [194, 203, 172, 184, 169, 160, 163, 199, 189, 149, 145, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 2, 1, 1, 1], 'pruned_params': 82387912, 'remaining_params': 2629688, 'pruned_model_sparsity': 0.9690688986750978, 'expected_sparsity': 0.96654, 'target_sparsity': 0.95, 'step': 6450}


Iteration:   9%|▊         | 10/115 [00:04<01:14,  1.40it/s][A
Iteration:  10%|▉         | 11/115 [00:04<01:00,  1.72it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:51,  2.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:44,  2.29it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:41,  2.41it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:38,  2.62it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:35,  2.78it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.05it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.12it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.19it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.18it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.19it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.19it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.20it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.19it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.16it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.23it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.32it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.29it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.10it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.15it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.11it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.27it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.20it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:22,  3.34it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.28it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:21,  3.34it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.38it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.10it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.16it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.31it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:18,  3.39it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.36it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.29it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.30it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.27it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.22it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 22:24:32,212 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:24:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:24:32 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:24:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:24:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:24:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:24:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68602526, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [193, 203, 172, 183, 169, 160, 163, 199, 187, 149, 145, 147], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 3, 2, 1, 1, 1], 'pruned_params': 82389440, 'remaining_params': 2628160, 'pruned_model_sparsity': 0.9690868714242697, 'expected_sparsity': 0.96661, 'target_sparsity': 0.95, 'step': 6500}


Iteration:  52%|█████▏    | 60/115 [00:21<00:38,  1.43it/s][A04/23/2024 22:24:33 - INFO - trainer.trainer_mod - v4 Global step: 6500, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:21<00:31,  1.71it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:26,  1.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.45it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:18,  2.65it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.82it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.06it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.13it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.19it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.04it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.95it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.06it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.18it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.21it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.32it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:09,  3.33it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.12it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.04it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.18it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.22it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.09it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.13it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.11it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.15it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.21it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.21it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.24it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.14it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.13it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.08it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.17it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.27it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.21it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.23it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.30it/s][A[INFO|trainer.py:570] 2024-04-23 22:24:49,172 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:24:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:24:49 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:24:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:24:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:24:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:24:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6575215, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [193, 203, 172, 182, 169, 159, 163, 198, 186, 149, 145, 146], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 2, 2, 1, 1, 1], 'pruned_params': 82389440, 'remaining_params': 2628160, 'pruned_model_sparsity': 0.9690868714242697, 'expected_sparsity': 0.96667, 'target_sparsity': 0.95, 'step': 6550}


Iteration:  96%|█████████▌| 110/115 [00:38<00:03,  1.44it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.71it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  1.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.29it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.52it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.85it/s][A04/23/2024 22:24:51 - INFO - trainer.trainer_mod - Epoch 56 finished. Took 39.59 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.90it/s]
Epoch:  57%|█████▋    | 57/100 [38:54<27:50, 38.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.22it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.02it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.05it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.12it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.11it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.19it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.99it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.06it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.06it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.07it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.26it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.26it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.18it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:28,  3.18it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.18it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.24it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.27it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.23it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.27it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.29it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.12it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.22it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.17it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.26it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.24it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:23,  3.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.20it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.14it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:25:06,167 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:25:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:25:06 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:25:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:25:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:25:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:25:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6617593, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [193, 203, 172, 181, 169, 159, 163, 197, 184, 149, 145, 146], 'head_nums': [2, 5, 1, 5, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82389440, 'remaining_params': 2628160, 'pruned_model_sparsity': 0.9690868714242697, 'expected_sparsity': 0.96674, 'target_sparsity': 0.95, 'step': 6600}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.42it/s][A04/23/2024 22:25:07 - INFO - trainer.trainer_mod - v4 Global step: 6600, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:15<00:40,  1.71it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:33,  2.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:29,  2.26it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.46it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:24,  2.63it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:23,  2.77it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.89it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:21,  2.86it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  2.99it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.02it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.17it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.23it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.23it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.27it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.13it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.16it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.21it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.25it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.26it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.27it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.25it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.25it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.34it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.30it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.32it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.35it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.38it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.35it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.25it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.26it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.26it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.16it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.22it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.27it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.31it/s][A[INFO|trainer.py:570] 2024-04-23 22:25:22,896 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:25:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:25:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:25:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:25:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/23/2024 22:25:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:25:24 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6466657, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [193, 203, 172, 180, 169, 159, 163, 196, 183, 149, 145, 146], 'head_nums': [2, 5, 1, 4, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82389440, 'remaining_params': 2628160, 'pruned_model_sparsity': 0.9690868714242697, 'expected_sparsity': 0.96682, 'target_sparsity': 0.95, 'step': 6650}


Iteration:  83%|████████▎ | 95/115 [00:32<00:14,  1.42it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.71it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:08,  2.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:07,  2.30it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.54it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.70it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.04it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.03it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.08it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.16it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.15it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.15it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.17it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.46it/s][A04/23/2024 22:25:30 - INFO - trainer.trainer_mod - Epoch 57 finished. Took 38.39 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  58%|█████▊    | 58/100 [39:32<27:05, 38.71s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.05it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.23it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.28it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.24it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.24it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.21it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.22it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.27it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.15it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.07it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.09it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.22it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.21it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.14it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.25it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.19it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.25it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.30it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:26,  3.31it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.24it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 22:25:39,739 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:25:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:25:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:25:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:25:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.19it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:25:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:25:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.64798856, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [193, 202, 172, 179, 169, 159, 162, 195, 182, 148, 145, 146], 'head_nums': [2, 5, 1, 4, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82390968, 'remaining_params': 2626632, 'pruned_model_sparsity': 0.9691048441734418, 'expected_sparsity': 0.96689, 'target_sparsity': 0.95, 'step': 6700}


Iteration:  26%|██▌       | 30/115 [00:10<01:00,  1.40it/s][A04/23/2024 22:25:41 - INFO - trainer.trainer_mod - v4 Global step: 6700, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:50,  1.67it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:42,  1.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:37,  2.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:33,  2.44it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:30,  2.65it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.81it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.16it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:21,  3.34it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.31it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.30it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.21it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.21it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.19it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.15it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.20it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.25it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.28it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.31it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.33it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:17,  3.34it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.15it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.22it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.19it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.16it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.19it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.31it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.40it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.34it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.32it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.29it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.32it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.26it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:14,  3.16it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.28it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.20it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.21it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.23it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.26it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.32it/s][A[INFO|trainer.py:570] 2024-04-23 22:25:56,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:25:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:25:56 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:25:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:25:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/23/2024 22:25:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:25:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6859313, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [193, 202, 172, 178, 168, 159, 162, 194, 181, 148, 145, 146], 'head_nums': [2, 5, 1, 4, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82390968, 'remaining_params': 2626632, 'pruned_model_sparsity': 0.9691048441734418, 'expected_sparsity': 0.96694, 'target_sparsity': 0.95, 'step': 6750}


Iteration:  70%|██████▉   | 80/115 [00:27<00:24,  1.44it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:19,  1.70it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:16,  1.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.27it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:11,  2.54it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.74it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.02it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.12it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.15it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.22it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.16it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.20it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.18it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.19it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.23it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.04it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.22it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.33it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.30it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.25it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.33it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.35it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.26it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.28it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.53it/s][A04/23/2024 22:26:08 - INFO - trainer.trainer_mod - Epoch 58 finished. Took 38.12 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.02it/s]
Epoch:  59%|█████▉    | 59/100 [40:10<26:19, 38.54s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.05it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.12it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.11it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.25it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.31it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.29it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:30,  3.36it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.35it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:30,  3.32it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.32it/s][A[INFO|trainer.py:570] 2024-04-23 22:26:13,123 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:26:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:26:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:26:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:26:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/23/2024 22:26:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:26:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67942345, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [192, 202, 172, 177, 168, 159, 162, 193, 181, 148, 145, 146], 'head_nums': [2, 5, 1, 4, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82392496, 'remaining_params': 2625104, 'pruned_model_sparsity': 0.9691228169226137, 'expected_sparsity': 0.96699, 'target_sparsity': 0.95, 'step': 6800}


Iteration:  13%|█▎        | 15/115 [00:05<01:09,  1.44it/s][A04/23/2024 22:26:14 - INFO - trainer.trainer_mod - v4 Global step: 6800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:57,  1.73it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:48,  2.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:42,  2.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:37,  2.58it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:34,  2.77it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.89it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.14it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:28,  3.20it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.17it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.19it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.17it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.22it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:23,  3.32it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.32it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.26it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.17it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.19it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.09it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.08it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.15it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.15it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.12it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:21,  3.08it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.21it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.08it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.18it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.23it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.31it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.30it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.22it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.21it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.21it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.18it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.17it/s][A[INFO|trainer.py:570] 2024-04-23 22:26:29,994 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:26:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:26:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:26:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:26:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:26:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:26:31 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.658844, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [192, 202, 172, 176, 168, 159, 162, 192, 180, 148, 145, 146], 'head_nums': [2, 5, 1, 4, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82392496, 'remaining_params': 2625104, 'pruned_model_sparsity': 0.9691228169226137, 'expected_sparsity': 0.96706, 'target_sparsity': 0.95, 'step': 6850}


Iteration:  57%|█████▋    | 65/115 [00:22<00:35,  1.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:28,  1.72it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  2.00it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:20,  2.28it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.48it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:16,  2.67it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  2.91it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.11it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.15it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.24it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.28it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.25it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.11it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.23it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.31it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:06,  3.40it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.11it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.18it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.21it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.26it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.28it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.24it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.20it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.25it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.27it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.23it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.25it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.34it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.42it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.37it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:26:46,604 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:26:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:26:46 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:26:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:26:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/23/2024 22:26:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:26:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6669597, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [192, 202, 172, 175, 168, 159, 162, 191, 179, 148, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82392496, 'remaining_params': 2625104, 'pruned_model_sparsity': 0.9691228169226137, 'expected_sparsity': 0.9672, 'target_sparsity': 0.95, 'step': 6900}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.48it/s][A04/23/2024 22:26:47 - INFO - trainer.trainer_mod - Epoch 59 finished. Took 39.44 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  60%|██████    | 60/100 [40:50<25:52, 38.81s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 22:26:48 - INFO - trainer.trainer_mod - v4 Global step: 6900, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.31it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.13it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.19it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.23it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.27it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.27it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.13it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.18it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:31,  3.19it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.25it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.23it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.26it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.27it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.25it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.24it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.27it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.26it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.22it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.26it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:23,  3.33it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.34it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.28it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.25it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.29it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.20it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.19it/s][A
Iteration:  39%|███▉      | 45/115 [00:13<00:21,  3.24it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:21,  3.24it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:20,  3.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:14<00:20,  3.31it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:19,  3.33it/s][A[INFO|trainer.py:570] 2024-04-23 22:27:03,348 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:27:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:27:03 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:27:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:27:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.19it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:27:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:27:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7072658, 'head_layers': [1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [192, 202, 172, 175, 168, 159, 162, 190, 178, 148, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82392496, 'remaining_params': 2625104, 'pruned_model_sparsity': 0.9691228169226137, 'expected_sparsity': 0.96751, 'target_sparsity': 0.95, 'step': 6950}


Iteration:  43%|████▎     | 50/115 [00:16<00:45,  1.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:36,  1.74it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:31,  2.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:26,  2.31it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:23,  2.55it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:21,  2.74it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:20,  2.87it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.08it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.18it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.21it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.32it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.34it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.31it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.32it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.28it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.15it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.22it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:14,  3.19it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.27it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.12it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.14it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.14it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.19it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.25it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.10it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.18it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.19it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.24it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.29it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:08,  3.36it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.47it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.31it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.10it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.16it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.20it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:07,  3.19it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.20it/s][A
Iteration:  83%|████████▎ | 95/115 [00:30<00:06,  3.30it/s][A
Iteration:  83%|████████▎ | 96/115 [00:30<00:05,  3.28it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:31<00:05,  3.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:31<00:04,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:27:20,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:27:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:27:20 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:27:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:27:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:27:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:27:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.637739, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [192, 202, 172, 174, 168, 159, 162, 190, 177, 148, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82588080, 'remaining_params': 2429520, 'pruned_model_sparsity': 0.9714233288166215, 'expected_sparsity': 0.96792, 'target_sparsity': 0.95, 'step': 7000}


Iteration:  87%|████████▋ | 100/115 [00:33<00:10,  1.43it/s][A04/23/2024 22:27:21 - INFO - trainer.trainer_mod - v4 Global step: 7000, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:33<00:08,  1.72it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  2.02it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:05,  2.32it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:04,  2.54it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  2.71it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.82it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.21it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.24it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.28it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.29it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.44it/s][A04/23/2024 22:27:25 - INFO - trainer.trainer_mod - Epoch 60 finished. Took 37.94 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.03it/s]
Epoch:  61%|██████    | 61/100 [41:28<25:03, 38.55s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.36it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.24it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.23it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.23it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:31,  3.35it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.29it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.32it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.06it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.09it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.23it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.20it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.24it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.25it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.28it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.27it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.12it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.16it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.17it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:26,  3.17it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:27:36,711 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:27:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:27:36 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:27:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:27:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:27:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:27:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6531589, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [192, 202, 171, 173, 168, 159, 162, 189, 177, 148, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 2, 2, 1, 1, 1, 1], 'pruned_params': 82589608, 'remaining_params': 2427992, 'pruned_model_sparsity': 0.9714413015657934, 'expected_sparsity': 0.96815, 'target_sparsity': 0.95, 'step': 7050}


Iteration:  30%|███       | 35/115 [00:12<00:55,  1.43it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:46,  1.70it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:38,  2.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:34,  2.24it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:30,  2.49it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:27,  2.68it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.83it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.31it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.33it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.32it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.32it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.25it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.34it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.35it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.30it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.29it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.34it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.25it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.27it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.25it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.24it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.34it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.23it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.21it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.12it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:14,  3.13it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.23it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.27it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.31it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:10,  3.40it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.36it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.36it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.34it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.40it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.35it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.43it/s][A[INFO|trainer.py:570] 2024-04-23 22:27:53,207 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:27:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:27:53 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:27:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:27:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:27:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:27:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68709475, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 173, 168, 159, 162, 188, 175, 148, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96824, 'target_sparsity': 0.95, 'step': 7100}


Iteration:  74%|███████▍  | 85/115 [00:28<00:20,  1.46it/s][A04/23/2024 22:27:54 - INFO - trainer.trainer_mod - v4 Global step: 7100, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:28<00:16,  1.74it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:13,  2.02it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:11,  2.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:10,  2.46it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.54it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:08,  2.73it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.03it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.20it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.32it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.30it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:04,  3.32it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.02it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.18it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.19it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.23it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.27it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.25it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.22it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.36it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.37it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.60it/s][A04/23/2024 22:28:03 - INFO - trainer.trainer_mod - Epoch 61 finished. Took 37.89 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  62%|██████▏   | 62/100 [42:06<24:17, 38.35s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.34it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.33it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.35it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.29it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.25it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.29it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.37it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.27it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.30it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.37it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.36it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.33it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.30it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.37it/s][A[INFO|trainer.py:570] 2024-04-23 22:28:09,840 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:28:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:28:09 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:28:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:28:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:28:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:28:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6386159, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 172, 168, 159, 162, 187, 174, 148, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96829, 'target_sparsity': 0.95, 'step': 7150}


Iteration:  17%|█▋        | 20/115 [00:07<01:07,  1.41it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:55,  1.70it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:46,  1.99it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:42,  2.18it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:37,  2.40it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:34,  2.63it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.79it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.11it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.24it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.09it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.15it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.26it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.29it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:23,  3.31it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.34it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:22,  3.38it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.36it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.35it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:21,  3.35it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.33it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.30it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.36it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.33it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.27it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.36it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:19,  3.34it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.39it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.36it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.34it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.31it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|█████     | 58/115 [00:18<00:17,  3.29it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.30it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:19<00:17,  3.14it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.18it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.28it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.34it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.33it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.27it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:28:26,393 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:28:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:28:26 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:28:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:28:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/23/2024 22:28:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:28:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6804078, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 171, 167, 159, 162, 187, 173, 148, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96832, 'target_sparsity': 0.95, 'step': 7200}


Iteration:  61%|██████    | 70/115 [00:23<00:31,  1.42it/s][A04/23/2024 22:28:27 - INFO - trainer.trainer_mod - v4 Global step: 7200, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:24<00:25,  1.70it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:21,  1.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:19,  2.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:16,  2.45it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:14,  2.72it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.15it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.17it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.19it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.15it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.26it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.29it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.31it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.24it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.21it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.21it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.16it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.05it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.20it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.18it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.11it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  3.13it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.11it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.10it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.15it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.28it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.18it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.24it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.28it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.28it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.57it/s][A04/23/2024 22:28:41 - INFO - trainer.trainer_mod - Epoch 62 finished. Took 37.88 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  63%|██████▎   | 63/100 [42:44<23:33, 38.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.16it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.22it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.22it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:32,  3.37it/s][A[INFO|trainer.py:570] 2024-04-23 22:28:43,120 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:28:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:28:43 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:28:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:28:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:28:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:28:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6716072, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 171, 167, 159, 162, 186, 172, 148, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96835, 'target_sparsity': 0.95, 'step': 7250}


Iteration:   4%|▍         | 5/115 [00:02<01:24,  1.30it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:09,  1.58it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:57,  1.87it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:49,  2.17it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:43,  2.44it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:39,  2.66it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:37,  2.81it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:33,  2.99it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:32,  3.07it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.08it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.20it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.19it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:28,  3.24it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:27,  3.34it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:27,  3.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:26,  3.33it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.31it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:25,  3.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.32it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:24,  3.41it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.24it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.24it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.27it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.25it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:22,  3.35it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.19it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.30it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.32it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.14it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.27it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.28it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.25it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.27it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.22it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.25it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.22it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:28:59,936 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:28:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:28:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:28:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:28:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:29:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:29:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7012189, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 170, 167, 159, 162, 185, 171, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96837, 'target_sparsity': 0.95, 'step': 7300}


Iteration:  48%|████▊     | 55/115 [00:19<00:42,  1.42it/s][A04/23/2024 22:29:01 - INFO - trainer.trainer_mod - v4 Global step: 7300, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:19<00:34,  1.69it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:29,  1.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.25it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:22,  2.45it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:20,  2.65it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  2.95it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:16,  3.06it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.13it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.25it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.15it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.13it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.20it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.24it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:12,  3.35it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.36it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.34it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:11,  3.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:11,  3.33it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.29it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.29it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.25it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.35it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:09,  3.41it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.38it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.37it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:08,  3.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.32it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.05it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.09it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.23it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.23it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.28it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.39it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:05,  3.38it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.37it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.27it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.26it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.18it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.22it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.28it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:29:16,537 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:29:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:29:16 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:29:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:29:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:29:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:29:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.63863164, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 170, 167, 159, 161, 184, 170, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96839, 'target_sparsity': 0.95, 'step': 7350}


Iteration:  91%|█████████▏| 105/115 [00:36<00:06,  1.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:05,  1.75it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:03,  2.05it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.30it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.54it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  2.74it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.11it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.25it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.57it/s][A04/23/2024 22:29:20 - INFO - trainer.trainer_mod - Epoch 63 finished. Took 39.11 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  64%|██████▍   | 64/100 [43:23<23:05, 38.48s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.35it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.34it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.26it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.10it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.18it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.24it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.30it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.31it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:30,  3.41it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:30,  3.40it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.32it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.34it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.26it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:31,  3.13it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.14it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.20it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.27it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.26it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:25,  3.34it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.26it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.15it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.27it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:23,  3.31it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.26it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.30it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:23,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 22:29:33,020 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:29:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:29:33 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:29:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:29:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:29:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:29:34 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6822562, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 169, 167, 159, 161, 183, 169, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96841, 'target_sparsity': 0.95, 'step': 7400}


Iteration:  35%|███▍      | 40/115 [00:13<00:52,  1.43it/s][A04/23/2024 22:29:34 - INFO - trainer.trainer_mod - v4 Global step: 7400, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:13<00:42,  1.75it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:35,  2.04it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:31,  2.32it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:28,  2.53it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:26,  2.64it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:24,  2.80it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:21,  3.12it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.25it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:19,  3.34it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.33it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.34it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.34it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.25it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.30it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.27it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.26it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.28it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.28it/s][A
Iteration:  53%|█████▎    | 61/115 [00:19<00:16,  3.24it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.20it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.20it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.21it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.23it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.24it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.22it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.23it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.22it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.34it/s][A
Iteration:  62%|██████▏   | 71/115 [00:22<00:13,  3.35it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.32it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.31it/s][A
Iteration:  64%|██████▍   | 74/115 [00:23<00:12,  3.33it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:11,  3.35it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.31it/s][A
Iteration:  67%|██████▋   | 77/115 [00:24<00:11,  3.31it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.29it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.13it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.21it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:26<00:09,  3.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:08,  3.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:09,  3.12it/s][A
Iteration:  76%|███████▌  | 87/115 [00:27<00:08,  3.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:07,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:29:49,514 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:29:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:29:49 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:29:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:29:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:29:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:29:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7070244, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 168, 167, 159, 161, 182, 168, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96844, 'target_sparsity': 0.95, 'step': 7450}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.44it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:13,  1.74it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:11,  1.94it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:10,  2.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:08,  2.44it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:07,  2.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.77it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:06,  2.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.01it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.03it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.10it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.18it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  3.21it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.20it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.04it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.19it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.25it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.28it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.25it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.36it/s][A
Iteration:  97%|█████████▋| 112/115 [00:36<00:00,  3.37it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.32it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.34it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.59it/s][A04/23/2024 22:29:58 - INFO - trainer.trainer_mod - Epoch 64 finished. Took 37.75 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.05it/s]
Epoch:  65%|██████▌   | 65/100 [44:00<22:19, 38.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.25it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.29it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.26it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.25it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.27it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.28it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.23it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.27it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.26it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.31it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.32it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.27it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.30it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.28it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:28,  3.44it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.31it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.33it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.34it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:27,  3.33it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:27,  3.33it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A[INFO|trainer.py:570] 2024-04-23 22:30:06,134 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:30:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:30:06 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:30:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:30:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:30:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:30:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6449577, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 168, 167, 159, 161, 181, 168, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96846, 'target_sparsity': 0.95, 'step': 7500}


Iteration:  22%|██▏       | 25/115 [00:08<01:04,  1.40it/s][A04/23/2024 22:30:07 - INFO - trainer.trainer_mod - v4 Global step: 7500, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:09<00:52,  1.71it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:44,  2.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:40,  2.17it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:34,  2.47it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:31,  2.68it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:31,  2.69it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  3.01it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.12it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.15it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.20it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:24,  3.21it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.25it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.11it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.17it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.34it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.26it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.29it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.31it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.26it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:19,  3.29it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.28it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.19it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.08it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:19,  3.05it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.10it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.15it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.18it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.20it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.29it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.27it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.26it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.29it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.31it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.26it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:14,  3.20it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:30:22,929 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:30:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:30:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:30:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:30:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:30:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:30:24 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68707216, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 167, 167, 159, 161, 181, 167, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96846, 'target_sparsity': 0.95, 'step': 7550}


Iteration:  65%|██████▌   | 75/115 [00:25<00:27,  1.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:22,  1.74it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:18,  2.03it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:15,  2.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:14,  2.54it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:12,  2.74it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.11it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.21it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.27it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.31it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.30it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:06,  3.31it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.32it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.33it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.19it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.24it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.27it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.27it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:03,  3.31it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.32it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.24it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.27it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.37it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.32it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.33it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.30it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.26it/s][A
Iteration:  97%|█████████▋| 112/115 [00:36<00:00,  3.25it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.25it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.23it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.47it/s][A04/23/2024 22:30:36 - INFO - trainer.trainer_mod - Epoch 65 finished. Took 37.84 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  66%|██████▌   | 66/100 [44:38<21:36, 38.13s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.16it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.23it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.20it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.22it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.25it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.24it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.08it/s][A[INFO|trainer.py:570] 2024-04-23 22:30:39,478 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:30:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:30:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:30:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:30:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:30:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:30:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68538755, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 167, 167, 159, 161, 180, 167, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96848, 'target_sparsity': 0.95, 'step': 7600}


Iteration:   9%|▊         | 10/115 [00:04<01:15,  1.38it/s][A04/23/2024 22:30:40 - INFO - trainer.trainer_mod - v4 Global step: 7600, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:04<01:00,  1.71it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:51,  2.01it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:44,  2.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:40,  2.49it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:37,  2.70it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:31,  3.09it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.11it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.11it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.23it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:28,  3.27it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:28,  3.24it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.28it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:27,  3.31it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:26,  3.35it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:26,  3.31it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.32it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.26it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.28it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.29it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.13it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.16it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.23it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.25it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:23,  3.35it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:22,  3.44it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:22,  3.31it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.33it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.20it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.23it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.24it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.19it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.22it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.29it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:19,  3.32it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.24it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.28it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.10it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.18it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.19it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.23it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.30it/s][A[INFO|trainer.py:570] 2024-04-23 22:30:56,014 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:30:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:30:56 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:30:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:30:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.16it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:30:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:30:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6530189, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 167, 166, 159, 161, 179, 166, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96849, 'target_sparsity': 0.95, 'step': 7650}


Iteration:  52%|█████▏    | 60/115 [00:21<00:38,  1.43it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:32,  1.68it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:27,  1.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:23,  2.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:18,  2.65it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:18,  2.71it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.11it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.18it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.20it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.18it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.21it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.25it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.15it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.29it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.32it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:09,  3.33it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.42it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.40it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:08,  3.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.18it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.23it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.25it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.22it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.23it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.18it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.21it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  3.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.32it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.33it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.33it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.29it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.30it/s][A[INFO|trainer.py:570] 2024-04-23 22:31:12,700 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:31:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:31:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:31:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:31:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:31:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:31:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68734986, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 166, 166, 159, 161, 178, 165, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96849, 'target_sparsity': 0.95, 'step': 7700}


Iteration:  96%|█████████▌| 110/115 [00:37<00:03,  1.44it/s][A04/23/2024 22:31:14 - INFO - trainer.trainer_mod - v4 Global step: 7700, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.72it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  2.50it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s][A04/23/2024 22:31:15 - INFO - trainer.trainer_mod - Epoch 66 finished. Took 39.15 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  67%|██████▋   | 67/100 [45:17<21:08, 38.44s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.37it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.31it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.33it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.22it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.24it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.19it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.22it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.32it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.33it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.32it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.32it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.25it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.21it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.26it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.08it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.14it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.27it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.28it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.21it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.22it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.09it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.15it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.21it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.29it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.31it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:23,  3.33it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.31it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.30it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:22,  3.40it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.32it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:21,  3.32it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:21,  3.41it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 22:31:29,289 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:31:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:31:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:31:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:31:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:31:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:31:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6760384, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 166, 166, 159, 161, 178, 165, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.9685, 'target_sparsity': 0.95, 'step': 7750}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.43it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:40,  1.72it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:33,  2.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:29,  2.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.46it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:24,  2.68it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:23,  2.70it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:22,  2.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.02it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.05it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.10it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.15it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.20it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.25it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.24it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.16it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.18it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.15it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.22it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.28it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.11it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:14,  3.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.29it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.10it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.15it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.21it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.23it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.33it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.34it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.32it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.28it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.38it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.32it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.27it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:08,  3.40it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:08,  3.36it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.32it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.35it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:07,  3.31it/s][A
Iteration:  78%|███████▊  | 90/115 [00:28<00:07,  3.31it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.25it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:07,  3.23it/s][A
Iteration:  81%|████████  | 93/115 [00:29<00:06,  3.22it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 22:31:46,015 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:31:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:31:46 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:31:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:31:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:31:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:31:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6668834, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 165, 166, 159, 161, 177, 164, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96851, 'target_sparsity': 0.95, 'step': 7800}


Iteration:  83%|████████▎ | 95/115 [00:31<00:14,  1.43it/s][A04/23/2024 22:31:47 - INFO - trainer.trainer_mod - v4 Global step: 7800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.70it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:08,  2.02it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:07,  2.30it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.57it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.69it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  2.98it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.15it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.05it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.19it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.25it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.28it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.26it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.21it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.54it/s][A04/23/2024 22:31:53 - INFO - trainer.trainer_mod - Epoch 67 finished. Took 37.87 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  68%|██████▊   | 68/100 [45:55<20:24, 38.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:32,  3.46it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.11it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.12it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.02it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.23it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.27it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:30,  3.37it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.36it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:29,  3.42it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:31,  3.17it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.19it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.21it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.29it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.30it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.30it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.32it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:26,  3.34it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.29it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.24it/s][A[INFO|trainer.py:570] 2024-04-23 22:32:02,588 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:32:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:32:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:32:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:32:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:32:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:32:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68358046, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 165, 166, 159, 161, 176, 163, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96851, 'target_sparsity': 0.95, 'step': 7850}


Iteration:  26%|██▌       | 30/115 [00:10<00:59,  1.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:49,  1.70it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:42,  1.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:37,  2.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:32,  2.47it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:31,  2.50it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:29,  2.71it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.12it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.15it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.17it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.23it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.26it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.30it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.31it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:18,  3.38it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.41it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.29it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.30it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.25it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.18it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.15it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.18it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.24it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.27it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.23it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.17it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.25it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.25it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.28it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.28it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.31it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.32it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.34it/s][A[INFO|trainer.py:570] 2024-04-23 22:32:19,449 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:32:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:32:19 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:32:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:32:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:32:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:32:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6609374, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 165, 166, 159, 161, 176, 163, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96853, 'target_sparsity': 0.95, 'step': 7900}


Iteration:  70%|██████▉   | 80/115 [00:27<00:24,  1.44it/s][A04/23/2024 22:32:20 - INFO - trainer.trainer_mod - v4 Global step: 7900, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:27<00:19,  1.74it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  2.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.28it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:10,  2.76it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.89it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.02it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.16it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.21it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.18it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.17it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.21it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.15it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.18it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.28it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.17it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.27it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.32it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.32it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.32it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.26it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.26it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.29it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.30it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.25it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.29it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.51it/s][A04/23/2024 22:32:31 - INFO - trainer.trainer_mod - Epoch 68 finished. Took 38.05 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.02it/s]
Epoch:  69%|██████▉   | 69/100 [46:33<19:44, 38.20s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.27it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.27it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.21it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.24it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.20it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.21it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.31it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.28it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.32it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.33it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.33it/s][A[INFO|trainer.py:570] 2024-04-23 22:32:35,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:32:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:32:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:32:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:32:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:32:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:32:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6708605, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 164, 166, 159, 161, 175, 162, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96855, 'target_sparsity': 0.95, 'step': 7950}


Iteration:  13%|█▎        | 15/115 [00:05<01:08,  1.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:57,  1.73it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:49,  1.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:43,  2.25it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:38,  2.50it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:35,  2.69it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.86it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.07it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  2.99it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.05it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.15it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.20it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.31it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.20it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.07it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.12it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.21it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.25it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.10it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.14it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.21it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.22it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.27it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.30it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.31it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.29it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.25it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.28it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.26it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.31it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.31it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.31it/s][A[INFO|trainer.py:570] 2024-04-23 22:32:52,709 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:32:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:32:52 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:32:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:32:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:32:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:32:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.644117, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 164, 166, 159, 161, 174, 162, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96857, 'target_sparsity': 0.95, 'step': 8000}


Iteration:  57%|█████▋    | 65/115 [00:22<00:34,  1.43it/s][A04/23/2024 22:32:54 - INFO - trainer.trainer_mod - v4 Global step: 8000, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:22<00:28,  1.73it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:23,  2.02it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:20,  2.28it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:18,  2.52it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:16,  2.69it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:16,  2.69it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.84it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  2.99it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.08it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.11it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.12it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.16it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.18it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.20it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.26it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.29it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.29it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:06,  3.30it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.25it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.27it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.19it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.26it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.29it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.30it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.37it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.34it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.32it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.22it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.18it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.22it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.20it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.23it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.24it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.16it/s][A[INFO|trainer.py:570] 2024-04-23 22:33:09,437 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:33:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:33:09 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:33:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:33:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.16it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/23/2024 22:33:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:33:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.7085879, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 164, 166, 159, 161, 174, 161, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96859, 'target_sparsity': 0.95, 'step': 8050}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.45it/s][A04/23/2024 22:33:10 - INFO - trainer.trainer_mod - Epoch 69 finished. Took 39.39 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  70%|███████   | 70/100 [47:13<19:16, 38.56s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.34it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:32,  3.48it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.34it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.30it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.25it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.30it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.34it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.30it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.38it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:31,  3.34it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.33it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.32it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.30it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:32,  3.09it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.08it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.26it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.27it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.28it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:27,  3.25it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.20it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.20it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.23it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.23it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.25it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.24it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.27it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.29it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:22,  3.36it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.30it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:21,  3.37it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:21,  3.34it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.36it/s][A
Iteration:  39%|███▉      | 45/115 [00:13<00:20,  3.41it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:20,  3.38it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:20,  3.30it/s][A
Iteration:  42%|████▏     | 48/115 [00:14<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:14<00:20,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 22:33:26,069 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:33:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:33:26 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:33:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:33:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.15it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/23/2024 22:33:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:33:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66543394, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 163, 165, 159, 161, 173, 161, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96862, 'target_sparsity': 0.95, 'step': 8100}


Iteration:  43%|████▎     | 50/115 [00:16<00:45,  1.42it/s][A04/23/2024 22:33:27 - INFO - trainer.trainer_mod - v4 Global step: 8100, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:16<00:37,  1.72it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:31,  1.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:27,  2.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:24,  2.46it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:22,  2.61it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:21,  2.76it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.14it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:19<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.29it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.31it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.38it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.22it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.20it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.25it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.24it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:23<00:12,  3.36it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.31it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.40it/s][A
Iteration:  67%|██████▋   | 77/115 [00:24<00:11,  3.32it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:11,  3.07it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.24it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.30it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:08,  3.23it/s][A
Iteration:  76%|███████▌  | 87/115 [00:27<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:07,  3.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:28<00:07,  3.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.23it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:07,  3.25it/s][A
Iteration:  81%|████████  | 93/115 [00:29<00:06,  3.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:30<00:06,  3.25it/s][A
Iteration:  83%|████████▎ | 96/115 [00:30<00:05,  3.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:31<00:05,  3.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:31<00:05,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:33:42,830 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:33:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:33:42 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:33:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:33:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/23/2024 22:33:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:33:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6646115, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 163, 165, 159, 161, 172, 161, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96864, 'target_sparsity': 0.95, 'step': 8150}


Iteration:  87%|████████▋ | 100/115 [00:33<00:10,  1.39it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:08,  1.67it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  1.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:05,  2.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:04,  2.48it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  2.73it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.82it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.17it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.22it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.25it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.28it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.13it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.40it/s][A04/23/2024 22:33:48 - INFO - trainer.trainer_mod - Epoch 70 finished. Took 37.93 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.03it/s]
Epoch:  71%|███████   | 71/100 [47:51<18:32, 38.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:32,  3.46it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:32,  3.42it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.32it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.31it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:32,  3.32it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.31it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.32it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.12it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.15it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.18it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.20it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.20it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.29it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.21it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.23it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.27it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.24it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.35it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:27,  3.28it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.21it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.24it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.27it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.16it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.21it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 22:33:59,482 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:33:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:33:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:33:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:33:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:34:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:34:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66430753, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 163, 165, 159, 161, 171, 160, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96866, 'target_sparsity': 0.95, 'step': 8200}


Iteration:  30%|███       | 35/115 [00:12<00:55,  1.43it/s][A04/23/2024 22:34:00 - INFO - trainer.trainer_mod - v4 Global step: 8200, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:12<00:45,  1.74it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:38,  2.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:33,  2.28it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:30,  2.53it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:27,  2.72it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.02it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.08it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.13it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.15it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.14it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.25it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.23it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.24it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.27it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.09it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.11it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.26it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.35it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.24it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.25it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.21it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.21it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.25it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.29it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.28it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.31it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.36it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.17it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.22it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.15it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.23it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:11,  3.16it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.15it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.29it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 22:34:16,189 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:34:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:34:16 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:34:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:34:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:34:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:34:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6709285, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 162, 165, 159, 161, 171, 160, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96868, 'target_sparsity': 0.95, 'step': 8250}


Iteration:  74%|███████▍  | 85/115 [00:28<00:20,  1.43it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:16,  1.72it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:14,  2.00it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:11,  2.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.51it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.66it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:08,  2.84it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.04it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.27it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.27it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.23it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.15it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.21it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.25it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.28it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.27it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.24it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.29it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.38it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.62it/s][A04/23/2024 22:34:26 - INFO - trainer.trainer_mod - Epoch 71 finished. Took 37.89 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  72%|███████▏  | 72/100 [48:29<17:50, 38.23s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.06it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.13it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.21it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.27it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.28it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.24it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.28it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.25it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.27it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.26it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.25it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.11it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.05it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.14it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.13it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.13it/s][A[INFO|trainer.py:570] 2024-04-23 22:34:32,888 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:34:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:34:32 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:34:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:34:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:34:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:34:34 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6541781, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 162, 165, 159, 161, 170, 160, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.9687, 'target_sparsity': 0.95, 'step': 8300}


Iteration:  17%|█▋        | 20/115 [00:07<01:07,  1.42it/s][A04/23/2024 22:34:34 - INFO - trainer.trainer_mod - v4 Global step: 8300, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:07<00:55,  1.69it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:47,  1.97it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:42,  2.17it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:36,  2.47it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:33,  2.68it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.08it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.08it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.12it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.19it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.26it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.29it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.23it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.28it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.27it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.26it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.23it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.24it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.30it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.17it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.16it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.27it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.37it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:17,  3.36it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.34it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.34it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.43it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.37it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:15,  3.37it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.27it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.30it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.25it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.29it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.31it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.32it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.36it/s][A[INFO|trainer.py:570] 2024-04-23 22:34:49,446 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:34:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:34:49 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:34:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:34:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:34:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:34:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6870029, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 162, 165, 159, 161, 170, 159, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96871, 'target_sparsity': 0.95, 'step': 8350}


Iteration:  61%|██████    | 70/115 [00:24<00:30,  1.47it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:24,  1.77it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:20,  2.05it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:18,  2.32it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:16,  2.50it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:14,  2.70it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.81it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.18it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.24it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.28it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.24it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.27it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.20it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.19it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.24it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.22it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.29it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.31it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.28it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.09it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.11it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.28it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.10it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.17it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.30it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.32it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.38it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:03,  3.31it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.34it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:02,  3.39it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.35it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.31it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.26it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 112/115 [00:36<00:00,  3.37it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.39it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.64it/s][A04/23/2024 22:35:04 - INFO - trainer.trainer_mod - Epoch 72 finished. Took 37.77 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  73%|███████▎  | 73/100 [49:06<17:08, 38.09s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.37it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.29it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.35it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.35it/s][A[INFO|trainer.py:570] 2024-04-23 22:35:05,863 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:35:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:35:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:35:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:35:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:35:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:35:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6797641, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 162, 165, 159, 161, 170, 159, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96874, 'target_sparsity': 0.95, 'step': 8400}


Iteration:   4%|▍         | 5/115 [00:02<01:24,  1.30it/s][A04/23/2024 22:35:07 - INFO - trainer.trainer_mod - v4 Global step: 8400, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:07,  1.62it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:55,  1.95it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:47,  2.25it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:42,  2.49it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:38,  2.70it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:36,  2.83it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:33,  3.06it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:32,  3.12it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:31,  3.17it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:30,  3.20it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:29,  3.30it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:29,  3.30it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:29,  3.22it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.26it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.23it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.25it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.22it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.08it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:27,  3.17it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.17it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.23it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.27it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:24,  3.30it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.27it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.29it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.08it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.12it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.21it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.37it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.37it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:20,  3.33it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.35it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:20,  3.18it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.27it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.16it/s][A[INFO|trainer.py:570] 2024-04-23 22:35:22,579 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:35:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:35:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:35:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:35:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:35:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:35:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6810162, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 162, 165, 159, 161, 169, 159, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96876, 'target_sparsity': 0.95, 'step': 8450}


Iteration:  48%|████▊     | 55/115 [00:19<00:42,  1.43it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:34,  1.72it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:28,  2.01it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:24,  2.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:23,  2.43it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:20,  2.66it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.05it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.09it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.29it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:13,  3.32it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.25it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.25it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.27it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.06it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.13it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.19it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:11,  3.32it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.30it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:10,  3.41it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.35it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.34it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.30it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:09,  3.40it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.17it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.20it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.20it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.25it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.28it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.28it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.30it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.28it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.32it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.20it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.28it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:03,  3.36it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.35it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:35:39,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:35:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:35:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:35:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:35:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:35:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:35:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6768584, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 162, 165, 159, 161, 169, 159, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96879, 'target_sparsity': 0.95, 'step': 8500}


Iteration:  91%|█████████▏| 105/115 [00:36<00:07,  1.43it/s][A04/23/2024 22:35:40 - INFO - trainer.trainer_mod - v4 Global step: 8500, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:36<00:05,  1.71it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:03,  2.03it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.29it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.54it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  2.68it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.03it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.31it/s][A04/23/2024 22:35:43 - INFO - trainer.trainer_mod - Epoch 73 finished. Took 39.2 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.93it/s]
Epoch:  74%|███████▍  | 74/100 [49:46<16:38, 38.42s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:31,  3.58it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:31,  3.60it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.19it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.22it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.18it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.29it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.29it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.28it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.22it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.26it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.26it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:31,  3.17it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.34it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.28it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.27it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:27,  3.32it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:26,  3.42it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:26,  3.48it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:26,  3.42it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.30it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:25,  3.31it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.28it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.24it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.23it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:25,  3.10it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.17it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:23,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:35:55,831 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:35:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:35:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:35:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:35:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/23/2024 22:35:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:35:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6846032, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 161, 165, 159, 161, 169, 158, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96882, 'target_sparsity': 0.95, 'step': 8550}


Iteration:  35%|███▍      | 40/115 [00:13<00:52,  1.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:43,  1.70it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:37,  1.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:32,  2.25it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:28,  2.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:25,  2.76it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.05it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:21,  3.05it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:20,  3.12it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.11it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.18it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.06it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.11it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.17it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.17it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.31it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.11it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.12it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.25it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.09it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.22it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.33it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.35it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.22it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.26it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.30it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.28it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.32it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.34it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.34it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.35it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.33it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.40it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.33it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.21it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:08,  3.31it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:07,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 22:36:12,571 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:36:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:36:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:36:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:36:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:36:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:36:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6732818, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 161, 165, 159, 161, 169, 158, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96884, 'target_sparsity': 0.95, 'step': 8600}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.42it/s][A04/23/2024 22:36:14 - INFO - trainer.trainer_mod - v4 Global step: 8600, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:30<00:14,  1.71it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:11,  1.99it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:09,  2.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:08,  2.49it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:07,  2.71it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.12it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  3.19it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.20it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.23it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.28it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.24it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.33it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.36it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.31it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.26it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.52it/s][A04/23/2024 22:36:21 - INFO - trainer.trainer_mod - Epoch 74 finished. Took 37.89 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  75%|███████▌  | 75/100 [50:23<15:56, 38.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.31it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:32,  3.44it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:32,  3.38it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:32,  3.31it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.33it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.34it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.43it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:31,  3.38it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.34it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.24it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:31,  3.19it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.20it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.31it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.26it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:27,  3.37it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.17it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.28it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 22:36:29,062 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:36:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:36:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:36:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:36:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:36:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:36:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65549177, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 161, 165, 159, 160, 168, 158, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96884, 'target_sparsity': 0.95, 'step': 8650}


Iteration:  22%|██▏       | 25/115 [00:08<01:02,  1.44it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:51,  1.73it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:44,  1.99it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:38,  2.27it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:34,  2.51it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:31,  2.70it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.87it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.09it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.15it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:24,  3.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.24it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.24it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.24it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.29it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.30it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:21,  3.32it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.40it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.30it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.29it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:19,  3.25it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.27it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.15it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.29it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.27it/s][A
Iteration:  50%|█████     | 58/115 [00:18<00:17,  3.29it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.30it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:19<00:16,  3.27it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:15,  3.37it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.36it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.32it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.36it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.45it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.32it/s][A
Iteration:  59%|█████▉    | 68/115 [00:21<00:14,  3.34it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.43it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.27it/s][A
Iteration:  62%|██████▏   | 71/115 [00:22<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.12it/s][A
Iteration:  64%|██████▍   | 74/115 [00:23<00:13,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 22:36:45,671 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:36:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:36:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:36:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:36:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:36:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:36:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6729084, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 161, 165, 159, 161, 168, 157, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96886, 'target_sparsity': 0.95, 'step': 8700}


Iteration:  65%|██████▌   | 75/115 [00:25<00:28,  1.40it/s][A04/23/2024 22:36:47 - INFO - trainer.trainer_mod - v4 Global step: 8700, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:25<00:23,  1.69it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:19,  1.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:16,  2.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:14,  2.48it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:13,  2.63it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.19it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.31it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.32it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.27it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.20it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.32it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.28it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:06,  3.11it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.13it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.02it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.10it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  3.19it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.20it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.21it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.22it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.19it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.24it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.32it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.33it/s][A
Iteration:  97%|█████████▋| 112/115 [00:36<00:00,  3.34it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.24it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.35it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.61it/s][A04/23/2024 22:36:59 - INFO - trainer.trainer_mod - Epoch 75 finished. Took 37.76 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.05it/s]
Epoch:  76%|███████▌  | 76/100 [51:01<15:14, 38.11s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:31,  3.61it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:32,  3.44it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.39it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.33it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.33it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.27it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.27it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.15it/s][A[INFO|trainer.py:570] 2024-04-23 22:37:02,287 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:37:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:37:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:37:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:37:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:37:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:37:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.688088, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 201, 171, 161, 164, 159, 160, 168, 157, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82594192, 'remaining_params': 2423408, 'pruned_model_sparsity': 0.9714952198133092, 'expected_sparsity': 0.96888, 'target_sparsity': 0.95, 'step': 8750}


Iteration:   9%|▊         | 10/115 [00:04<01:15,  1.40it/s][A
Iteration:  10%|▉         | 11/115 [00:04<01:01,  1.70it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:51,  1.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:45,  2.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:40,  2.51it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:37,  2.66it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.84it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  3.02it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.09it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.18it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:31,  3.02it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.07it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.19it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:25,  3.37it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.35it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.33it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.30it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:24,  3.33it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.16it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.25it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.27it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:22,  3.32it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.27it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.26it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.28it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.25it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.29it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.26it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.29it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.38it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:19,  3.27it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.31it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.18it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.10it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:37:19,050 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:37:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:37:19 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:37:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:37:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:37:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:37:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6741671, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 161, 164, 159, 160, 168, 157, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.9689, 'target_sparsity': 0.95, 'step': 8800}


Iteration:  52%|█████▏    | 60/115 [00:21<00:38,  1.41it/s][A04/23/2024 22:37:20 - INFO - trainer.trainer_mod - v4 Global step: 8800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:21<00:31,  1.71it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:26,  1.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.46it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:18,  2.72it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.03it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.19it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.24it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.36it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.37it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:12,  3.35it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:11,  3.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.35it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.35it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.36it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.32it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.26it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.23it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.20it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.24it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.29it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.30it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:07,  3.39it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.30it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.32it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.19it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:06,  3.31it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.35it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.34it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:05,  3.34it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:05,  3.34it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.34it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.26it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.20it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:03,  3.28it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.31it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.29it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.23it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.25it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:35<00:01,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:37:35,462 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:37:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:37:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:37:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:37:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:37:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:37:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6725431, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 160, 164, 159, 160, 167, 157, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96891, 'target_sparsity': 0.95, 'step': 8850}


Iteration:  96%|█████████▌| 110/115 [00:37<00:03,  1.44it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:02,  1.73it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  2.54it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.90it/s][A04/23/2024 22:37:38 - INFO - trainer.trainer_mod - Epoch 76 finished. Took 38.98 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.95it/s]
Epoch:  77%|███████▋  | 77/100 [51:40<14:42, 38.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.83it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.22it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.29it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.22it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.25it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:32,  3.38it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.37it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:31,  3.36it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.27it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.35it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.27it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.30it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.40it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.35it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:29,  3.36it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.29it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.28it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.30it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.13it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.21it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.25it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.20it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.25it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.29it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:27,  3.28it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.30it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.28it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:25,  3.31it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.37it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:24,  3.37it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:24,  3.35it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:24,  3.30it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.34it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:23,  3.42it/s][A
Iteration:  31%|███▏      | 36/115 [00:10<00:23,  3.41it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.37it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:22,  3.38it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:22,  3.34it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.35it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:21,  3.34it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:21,  3.34it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 22:37:51,834 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:37:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:37:51 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:37:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:37:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:37:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:37:53 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6621011, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 202, 171, 160, 164, 159, 160, 167, 156, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96885, 'target_sparsity': 0.95, 'step': 8900}


Iteration:  39%|███▉      | 45/115 [00:14<00:49,  1.43it/s][A04/23/2024 22:37:53 - INFO - trainer.trainer_mod - v4 Global step: 8900, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:15<00:39,  1.73it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:34,  1.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:29,  2.26it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:23,  2.71it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:22,  2.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.17it/s][A
Iteration:  48%|████▊     | 55/115 [00:17<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.21it/s][A
Iteration:  50%|█████     | 58/115 [00:18<00:18,  3.16it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.20it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.11it/s][A
Iteration:  53%|█████▎    | 61/115 [00:19<00:17,  3.12it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.09it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:16,  3.16it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.20it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:15,  3.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.22it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.26it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:14,  3.19it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.23it/s][A
Iteration:  64%|██████▍   | 74/115 [00:23<00:12,  3.26it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.17it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.29it/s][A
Iteration:  67%|██████▋   | 77/115 [00:24<00:11,  3.33it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.34it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.31it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.28it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.21it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.23it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:09,  3.19it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:09,  3.05it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:28<00:08,  3.06it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.15it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:07,  3.15it/s][A
Iteration:  81%|████████  | 93/115 [00:29<00:07,  3.12it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.19it/s][A[INFO|trainer.py:570] 2024-04-23 22:38:08,712 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:38:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:38:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:38:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:38:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:38:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:38:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6750331, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 160, 164, 159, 160, 167, 156, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96885, 'target_sparsity': 0.95, 'step': 8950}


Iteration:  83%|████████▎ | 95/115 [00:31<00:14,  1.42it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.69it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:09,  1.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:07,  2.16it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.42it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.61it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:05,  2.76it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.10it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.17it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.23it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.23it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.24it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.36it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.32it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.34it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.33it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.40it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.24it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.49it/s][A04/23/2024 22:38:16 - INFO - trainer.trainer_mod - Epoch 77 finished. Took 37.87 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  78%|███████▊  | 78/100 [52:18<14:00, 38.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.27it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.27it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.22it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.25it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.27it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.30it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.28it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.27it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.25it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.29it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.26it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.29it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.32it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.29it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.30it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:29,  3.07it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.10it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.15it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.21it/s][A[INFO|trainer.py:570] 2024-04-23 22:38:25,346 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:38:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:38:25 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:38:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:38:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:38:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:38:26 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66343004, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 202, 171, 160, 164, 159, 160, 167, 156, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82592664, 'remaining_params': 2424936, 'pruned_model_sparsity': 0.9714772470641373, 'expected_sparsity': 0.96885, 'target_sparsity': 0.95, 'step': 9000}


Iteration:  26%|██▌       | 30/115 [00:10<00:59,  1.42it/s][A04/23/2024 22:38:26 - INFO - trainer.trainer_mod - v4 Global step: 9000, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:10<00:49,  1.70it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:41,  2.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:35,  2.30it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:31,  2.54it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:29,  2.73it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.03it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.12it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.18it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.26it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.29it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.28it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.09it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.14it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.19it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:21,  3.03it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.00it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.09it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.07it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.15it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.21it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.34it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.31it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.34it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.31it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:15,  3.32it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.18it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.23it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.21it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.26it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.27it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.26it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.28it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.31it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.31it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.33it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.33it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.16it/s][A[INFO|trainer.py:570] 2024-04-23 22:38:42,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:38:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:38:42 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:38:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:38:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:38:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:38:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.657071, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 203, 171, 160, 164, 159, 160, 167, 156, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96885, 'target_sparsity': 0.95, 'step': 9050}


Iteration:  70%|██████▉   | 80/115 [00:27<00:24,  1.41it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:19,  1.70it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:16,  2.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.26it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.48it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:11,  2.60it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.75it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.20it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.24it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.20it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.34it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.36it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.33it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.28it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.33it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.30it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.30it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.20it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.24it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.21it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.09it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.30it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.33it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.45it/s][A04/23/2024 22:38:54 - INFO - trainer.trainer_mod - Epoch 78 finished. Took 38.04 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.02it/s]
Epoch:  79%|███████▉  | 79/100 [52:56<13:21, 38.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.34it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.21it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.09it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.15it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.08it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.05it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.26it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:30,  3.31it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:38:58,809 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:38:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:38:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:38:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:38:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:39:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:39:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6899861, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 203, 171, 160, 164, 159, 160, 167, 155, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96886, 'target_sparsity': 0.95, 'step': 9100}


Iteration:  13%|█▎        | 15/115 [00:06<01:10,  1.42it/s][A04/23/2024 22:39:00 - INFO - trainer.trainer_mod - v4 Global step: 9100, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:57,  1.71it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:49,  2.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:42,  2.28it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:38,  2.50it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:36,  2.58it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:34,  2.73it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.82it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.06it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.10it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.08it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.12it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.24it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:25,  3.27it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.30it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:24,  3.31it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.33it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.31it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:23,  3.33it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.27it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.20it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.22it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.16it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.26it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.23it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.33it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.35it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.34it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.35it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.35it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.35it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.37it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.36it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.31it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.33it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.33it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.35it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.26it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.22it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.24it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:39:15,460 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:39:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:39:15 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:39:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:39:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:39:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:39:16 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6824773, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [190, 203, 171, 160, 164, 159, 160, 167, 155, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82591136, 'remaining_params': 2426464, 'pruned_model_sparsity': 0.9714592743149654, 'expected_sparsity': 0.96886, 'target_sparsity': 0.95, 'step': 9150}


Iteration:  57%|█████▋    | 65/115 [00:22<00:35,  1.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:28,  1.70it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:20,  2.27it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:18,  2.52it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:16,  2.69it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.16it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.22it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.29it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.20it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.17it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.17it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.31it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.27it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.29it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.31it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.31it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.41it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:06,  3.48it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.21it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.35it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.43it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:04,  3.42it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:04,  3.33it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.34it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  2.98it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.08it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.14it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.15it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.16it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.26it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.35it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.34it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.29it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.30it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.29it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 22:39:31,954 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:39:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:39:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:39:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:39:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:39:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:39:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66393435, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 203, 171, 161, 165, 159, 160, 167, 155, 146, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82589608, 'remaining_params': 2427992, 'pruned_model_sparsity': 0.9714413015657934, 'expected_sparsity': 0.96884, 'target_sparsity': 0.95, 'step': 9200}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.48it/s][A04/23/2024 22:39:33 - INFO - trainer.trainer_mod - Epoch 79 finished. Took 39.17 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  80%|████████  | 80/100 [53:35<12:49, 38.47s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 22:39:33 - INFO - trainer.trainer_mod - v4 Global step: 9200, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.35it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:32,  3.36it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:32,  3.31it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.28it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.30it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.33it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.34it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.23it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.28it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.30it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.33it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.27it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.26it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.25it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.19it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:26,  3.30it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.32it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.20it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.19it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.24it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.27it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:26,  3.18it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.26it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.28it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.24it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:23,  3.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.24it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:24,  3.07it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:13<00:21,  3.25it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:21,  3.21it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:20,  3.25it/s][A
Iteration:  42%|████▏     | 48/115 [00:14<00:20,  3.27it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 22:39:48,665 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:39:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:39:48 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:39:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:39:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:39:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:39:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6810999, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [191, 204, 171, 161, 165, 159, 160, 167, 155, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82588080, 'remaining_params': 2429520, 'pruned_model_sparsity': 0.9714233288166215, 'expected_sparsity': 0.96883, 'target_sparsity': 0.95, 'step': 9250}


Iteration:  43%|████▎     | 50/115 [00:16<00:45,  1.42it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:38,  1.66it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:32,  1.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:27,  2.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:24,  2.50it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:22,  2.66it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:21,  2.74it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:20,  2.85it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.08it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.15it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.25it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.27it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.26it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.28it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.29it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.13it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.13it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:14,  3.18it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.07it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.14it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.08it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.16it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.20it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.30it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.30it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.33it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.30it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.23it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.27it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.30it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:09,  3.14it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.34it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:06,  3.29it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.17it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 95/115 [00:30<00:06,  3.21it/s][A
Iteration:  83%|████████▎ | 96/115 [00:30<00:05,  3.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.28it/s][A
Iteration:  85%|████████▌ | 98/115 [00:31<00:05,  3.19it/s][A
Iteration:  86%|████████▌ | 99/115 [00:31<00:04,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 22:40:05,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:40:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:40:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:40:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:40:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:40:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:40:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6702095, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [192, 205, 171, 161, 165, 159, 160, 167, 155, 147, 145, 146], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82585024, 'remaining_params': 2432576, 'pruned_model_sparsity': 0.9713873833182777, 'expected_sparsity': 0.9688, 'target_sparsity': 0.95, 'step': 9300}


Iteration:  87%|████████▋ | 100/115 [00:33<00:10,  1.43it/s][A04/23/2024 22:40:06 - INFO - trainer.trainer_mod - v4 Global step: 9300, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:33<00:08,  1.72it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  2.02it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:05,  2.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:04,  2.56it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.75it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.15it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.21it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.27it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.29it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.38it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.63it/s][A04/23/2024 22:40:11 - INFO - trainer.trainer_mod - Epoch 80 finished. Took 37.92 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.03it/s]
Epoch:  81%|████████  | 81/100 [54:13<12:07, 38.30s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.35it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.35it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:32,  3.39it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:31,  3.48it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.27it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.32it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.26it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.26it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.30it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.33it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.26it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.30it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.30it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.32it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.27it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.25it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:28,  3.25it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:27,  3.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.28it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.23it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.21it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.28it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.30it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:24,  3.30it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.22it/s][A[INFO|trainer.py:570] 2024-04-23 22:40:21,865 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:40:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:40:21 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:40:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:40:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:40:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:40:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6615654, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [194, 207, 172, 162, 165, 159, 161, 167, 156, 148, 146, 148], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82577384, 'remaining_params': 2440216, 'pruned_model_sparsity': 0.9712975195724179, 'expected_sparsity': 0.96865, 'target_sparsity': 0.95, 'step': 9350}


Iteration:  30%|███       | 35/115 [00:12<00:56,  1.42it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:46,  1.71it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:39,  2.00it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:34,  2.26it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:30,  2.52it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:28,  2.67it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:26,  2.77it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.99it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.08it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.13it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.18it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.23it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.28it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:20,  3.11it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.25it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.28it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.18it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.23it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.10it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.15it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.17it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.30it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.31it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.29it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.28it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:16,  3.19it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.23it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.23it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.28it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.24it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.25it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.38it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.37it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:11,  3.37it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.35it/s][A
Iteration:  67%|██████▋   | 77/115 [00:24<00:11,  3.29it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.36it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.35it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.36it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.37it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:40:38,526 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:40:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:40:38 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:40:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:40:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:40:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:40:39 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.687975, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [198, 210, 176, 164, 166, 159, 162, 168, 158, 152, 150, 152], 'head_nums': [2, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82560576, 'remaining_params': 2457024, 'pruned_model_sparsity': 0.9710998193315267, 'expected_sparsity': 0.96828, 'target_sparsity': 0.95, 'step': 9400}


Iteration:  74%|███████▍  | 85/115 [00:28<00:20,  1.43it/s][A04/23/2024 22:40:39 - INFO - trainer.trainer_mod - v4 Global step: 9400, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:28<00:16,  1.72it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:14,  1.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:11,  2.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:10,  2.48it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.69it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:08,  2.86it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.03it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.20it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:05,  3.27it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.23it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.14it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.19it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.24it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  3.21it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.26it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.22it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.29it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.36it/s][A
Iteration:  95%|█████████▍| 109/115 [00:35<00:01,  3.36it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.36it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.11it/s][A
Iteration:  97%|█████████▋| 112/115 [00:36<00:00,  3.17it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.21it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.46it/s][A04/23/2024 22:40:48 - INFO - trainer.trainer_mod - Epoch 81 finished. Took 37.81 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  82%|████████▏ | 82/100 [54:51<11:26, 38.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.20it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.39it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.32it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.34it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.24it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.18it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.03it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.33it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.29it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.26it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.27it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.27it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.30it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.17it/s][A[INFO|trainer.py:570] 2024-04-23 22:40:55,172 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:40:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:40:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:40:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:40:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:40:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:40:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67573994, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [204, 217, 183, 167, 167, 160, 163, 171, 162, 159, 156, 159], 'head_nums': [3, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82334432, 'remaining_params': 2683168, 'pruned_model_sparsity': 0.96843985245408, 'expected_sparsity': 0.96764, 'target_sparsity': 0.95, 'step': 9450}


Iteration:  17%|█▋        | 20/115 [00:07<01:06,  1.43it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:54,  1.73it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:46,  2.01it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:40,  2.28it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:35,  2.53it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:33,  2.72it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.07it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.14it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.12it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.03it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.10it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.14it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.29it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.30it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.29it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.09it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.13it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.12it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.15it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.12it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.18it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.25it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.22it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.25it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.34it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:15,  3.34it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.27it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.26it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.34it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.34it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.26it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:41:11,916 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:41:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:41:11 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:41:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:41:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:41:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:41:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6854863, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [214, 226, 194, 172, 170, 162, 165, 174, 168, 170, 167, 172], 'head_nums': [3, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82288592, 'remaining_params': 2729008, 'pruned_model_sparsity': 0.967900669978922, 'expected_sparsity': 0.96665, 'target_sparsity': 0.95, 'step': 9500}


Iteration:  61%|██████    | 70/115 [00:24<00:31,  1.43it/s][A04/23/2024 22:41:13 - INFO - trainer.trainer_mod - v4 Global step: 9500, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:24<00:25,  1.71it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:21,  2.04it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:17,  2.35it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:16,  2.48it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:14,  2.70it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.84it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.05it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.13it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.17it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.22it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.27it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.29it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.28it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.32it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.27it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.28it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.30it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.30it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.17it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.20it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.19it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.15it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.08it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.21it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.25it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.23it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.26it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.34it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.33it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.16it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.50it/s][A04/23/2024 22:41:27 - INFO - trainer.trainer_mod - Epoch 82 finished. Took 38.03 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.02it/s]
Epoch:  83%|████████▎ | 83/100 [55:29<10:48, 38.12s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:42,  2.69it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.27it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 22:41:28,595 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:41:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:41:28 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:41:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:41:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:41:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:41:29 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6654425, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [228, 240, 210, 180, 173, 163, 168, 178, 177, 188, 185, 192], 'head_nums': [3, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82221360, 'remaining_params': 2796240, 'pruned_model_sparsity': 0.9671098690153568, 'expected_sparsity': 0.96516, 'target_sparsity': 0.95, 'step': 9550}


Iteration:   4%|▍         | 5/115 [00:02<01:26,  1.28it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:07,  1.60it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:55,  1.94it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:48,  2.23it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:41,  2.54it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:38,  2.75it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:33,  3.04it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:32,  3.11it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:31,  3.17it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:30,  3.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:29,  3.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:28,  3.28it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:28,  3.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:28,  3.28it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.13it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.18it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:27,  3.22it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:25,  3.37it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:25,  3.36it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.35it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.36it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.24it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.22it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.22it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.24it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.27it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.25it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.18it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.17it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.24it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.26it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.30it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.30it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.27it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:20,  3.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.19it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.08it/s][A[INFO|trainer.py:570] 2024-04-23 22:41:45,266 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:41:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:41:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:41:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:41:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:41:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:41:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6826522, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [246, 258, 231, 191, 177, 166, 172, 184, 190, 219, 214, 227], 'head_nums': [3, 5, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82134264, 'remaining_params': 2883336, 'pruned_model_sparsity': 0.9660854223125565, 'expected_sparsity': 0.963, 'target_sparsity': 0.95, 'step': 9600}


Iteration:  48%|████▊     | 55/115 [00:19<00:42,  1.41it/s][A04/23/2024 22:41:46 - INFO - trainer.trainer_mod - v4 Global step: 9600, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:19<00:34,  1.70it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:29,  1.99it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.25it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:22,  2.46it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:21,  2.60it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.77it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.01it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.19it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.23it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.20it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.25it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.31it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.26it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.21it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.23it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.20it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.21it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.32it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.13it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.22it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.23it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.26it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.28it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.28it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.15it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.08it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.12it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.21it/s][A[INFO|trainer.py:570] 2024-04-23 22:42:02,112 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:42:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:42:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:42:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:42:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:42:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:42:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67560625, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [271, 284, 261, 207, 184, 169, 177, 193, 211, 281, 273, 300], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 82010496, 'remaining_params': 3007104, 'pruned_model_sparsity': 0.9646296296296296, 'expected_sparsity': 0.95958, 'target_sparsity': 0.95, 'step': 9650}


Iteration:  91%|█████████▏| 105/115 [00:36<00:07,  1.42it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:05,  1.71it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:03,  2.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  2.66it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.99it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.34it/s][A04/23/2024 22:42:06 - INFO - trainer.trainer_mod - Epoch 83 finished. Took 39.42 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  84%|████████▍ | 84/100 [56:08<10:16, 38.51s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.08it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.23it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.25it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.11it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.01it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.07it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:29,  3.30it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.29it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.22it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.34it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:26,  3.37it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:26,  3.38it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:26,  3.37it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:25,  3.44it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:25,  3.38it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.30it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.26it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.19it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.24it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.31it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:22,  3.36it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:22,  3.36it/s][A[INFO|trainer.py:570] 2024-04-23 22:42:18,819 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:42:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:42:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:42:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:42:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:42:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:42:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6720953, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [305, 319, 302, 231, 192, 173, 184, 204, 243, 444, 426, 515], 'head_nums': [3, 6, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81646832, 'remaining_params': 3370768, 'pruned_model_sparsity': 0.9603521153267088, 'expected_sparsity': 0.95281, 'target_sparsity': 0.95, 'step': 9700}


Iteration:  35%|███▍      | 40/115 [00:13<00:53,  1.41it/s][A04/23/2024 22:42:20 - INFO - trainer.trainer_mod - v4 Global step: 9700, Alignment: tensor([0, 1, 1, 1], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:13<00:43,  1.71it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:36,  2.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:32,  2.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:29,  2.39it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:27,  2.56it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:24,  2.76it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.16it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.12it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.05it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.17it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.23it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.23it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.22it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.12it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.17it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.14it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.26it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.16it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.26it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.27it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.21it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.31it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.32it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:14,  3.07it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.28it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.28it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.23it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.05it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.19it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.23it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.21it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.25it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 22:42:35,695 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:42:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:42:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:42:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:42:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:42:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:42:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6896456, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [337, 354, 340, 259, 200, 176, 190, 215, 284, 915, 878, 1246], 'head_nums': [3, 6, 1, 4, 1, 1, 1, 1, 1, 1, 2, 2], 'pruned_params': 81486392, 'remaining_params': 3531208, 'pruned_model_sparsity': 0.9584649766636555, 'expected_sparsity': 0.9305, 'target_sparsity': 0.95, 'step': 9750}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:13,  1.71it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:11,  2.00it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:10,  2.17it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:08,  2.42it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:07,  2.62it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.75it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:06,  2.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  2.96it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.04it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.11it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.12it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.14it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.22it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.23it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.09it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.17it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.44it/s][A04/23/2024 22:42:44 - INFO - trainer.trainer_mod - Epoch 84 finished. Took 38.39 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  85%|████████▌ | 85/100 [56:47<09:37, 38.47s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.02it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.13it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.12it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.08it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.11it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.13it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.16it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.16it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.07it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.26it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.22it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.22it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.21it/s][A[INFO|trainer.py:570] 2024-04-23 22:42:52,737 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:42:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:42:52 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:42:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:42:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:42:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:42:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6689266, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [337, 359, 341, 259, 200, 176, 190, 215, 284, 900, 861, 1235], 'head_nums': [3, 6, 1, 4, 1, 1, 1, 1, 1, 1, 2, 2], 'pruned_params': 81477224, 'remaining_params': 3540376, 'pruned_model_sparsity': 0.9583571401686239, 'expected_sparsity': 0.93122, 'target_sparsity': 0.95, 'step': 9800}


Iteration:  22%|██▏       | 25/115 [00:09<01:03,  1.42it/s][A04/23/2024 22:42:54 - INFO - trainer.trainer_mod - v4 Global step: 9800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:09<00:51,  1.72it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:43,  2.02it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:37,  2.29it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:34,  2.50it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:31,  2.66it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:30,  2.77it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.08it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.07it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.09it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.12it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.11it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.08it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.21it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.22it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.17it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.16it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.19it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.22it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.22it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.21it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.35it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.16it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.19it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.24it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.05it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.14it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.19it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.27it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.19it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.13it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.22it/s][A[INFO|trainer.py:570] 2024-04-23 22:43:09,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:43:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:43:09 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:43:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:43:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:43:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:43:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6873938, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [334, 360, 336, 255, 199, 176, 189, 213, 277, 781, 755, 1076], 'head_nums': [3, 6, 1, 4, 1, 1, 1, 1, 1, 1, 2, 2], 'pruned_params': 81487920, 'remaining_params': 3529680, 'pruned_model_sparsity': 0.9584829494128274, 'expected_sparsity': 0.93758, 'target_sparsity': 0.95, 'step': 9850}


Iteration:  65%|██████▌   | 75/115 [00:26<00:28,  1.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:23,  1.66it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:19,  1.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:17,  2.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:15,  2.36it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:13,  2.60it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:12,  2.74it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.06it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.12it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.09it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.07it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.06it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.07it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.18it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.16it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.26it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.37it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.30it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.24it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.23it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.34it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.31it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.29it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.37it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.26it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.28it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.52it/s][A04/23/2024 22:43:23 - INFO - trainer.trainer_mod - Epoch 85 finished. Took 38.71 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.97it/s]
Epoch:  86%|████████▌ | 86/100 [57:25<08:59, 38.54s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:31,  3.61it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:32,  3.43it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.31it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:32,  3.41it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:32,  3.35it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.24it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.34it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.08it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A[INFO|trainer.py:570] 2024-04-23 22:43:26,636 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:43:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:43:26 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:43:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:43:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:43:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:43:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6729175, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [332, 360, 331, 251, 198, 175, 188, 212, 271, 700, 686, 970], 'head_nums': [3, 6, 1, 4, 1, 1, 1, 1, 1, 1, 2, 2], 'pruned_params': 81498616, 'remaining_params': 3518984, 'pruned_model_sparsity': 0.958608758657031, 'expected_sparsity': 0.94153, 'target_sparsity': 0.95, 'step': 9900}


Iteration:   9%|▊         | 10/115 [00:04<01:16,  1.38it/s][A04/23/2024 22:43:28 - INFO - trainer.trainer_mod - v4 Global step: 9900, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:04<01:02,  1.67it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:52,  1.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:45,  2.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:40,  2.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:37,  2.63it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:35,  2.75it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.99it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.13it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:30,  3.14it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.18it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:28,  3.21it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.18it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.16it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.23it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.20it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.20it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.17it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.13it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.19it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.12it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.10it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.10it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.17it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.20it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.23it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.21it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.33it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.32it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.22it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.16it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.28it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 22:43:43,526 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:43:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:43:43 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:43:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:43:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:43:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:43:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6729869, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [328, 361, 326, 247, 197, 175, 188, 210, 265, 643, 630, 891], 'head_nums': [3, 6, 1, 4, 1, 1, 1, 1, 1, 1, 2, 2], 'pruned_params': 81510840, 'remaining_params': 3506760, 'pruned_model_sparsity': 0.9587525406504065, 'expected_sparsity': 0.94439, 'target_sparsity': 0.95, 'step': 9950}


Iteration:  52%|█████▏    | 60/115 [00:21<00:38,  1.42it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:31,  1.72it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:26,  2.01it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:18,  2.63it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.79it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.88it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.13it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.11it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.15it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.28it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:11,  3.31it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.30it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:10,  3.29it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.23it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.22it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.15it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.14it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.12it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.07it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.16it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.22it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.20it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.23it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.01it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.06it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.05it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.04it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.13it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.20it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.13it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.21it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.19it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.11it/s][A[INFO|trainer.py:570] 2024-04-23 22:44:00,714 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:44:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:44:00 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:44:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:44:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:44:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:44:02 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6799698, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [326, 362, 321, 244, 196, 174, 187, 209, 260, 600, 589, 834], 'head_nums': [3, 6, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81520008, 'remaining_params': 3497592, 'pruned_model_sparsity': 0.9588603771454381, 'expected_sparsity': 0.94653, 'target_sparsity': 0.95, 'step': 10000}


Iteration:  96%|█████████▌| 110/115 [00:38<00:03,  1.40it/s][A04/23/2024 22:44:02 - INFO - trainer.trainer_mod - v4 Global step: 10000, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.67it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  1.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.46it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.85it/s][A04/23/2024 22:44:03 - INFO - trainer.trainer_mod - Epoch 86 finished. Took 39.96 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s]
Epoch:  87%|████████▋ | 87/100 [58:05<08:26, 38.97s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.20it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.20it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.30it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.26it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.27it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.28it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.19it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.21it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.22it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.25it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.28it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.29it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.31it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.21it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.20it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.26it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.10it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.18it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.20it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.25it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.22it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.29it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.32it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:23,  3.31it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.31it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.28it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.25it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.25it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:21,  3.35it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:44:17,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:44:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:44:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:44:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:44:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:44:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:44:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6825703, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [325, 364, 318, 241, 195, 174, 186, 208, 256, 570, 559, 793], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81718648, 'remaining_params': 3298952, 'pruned_model_sparsity': 0.9611968345377898, 'expected_sparsity': 0.94784, 'target_sparsity': 0.95, 'step': 10050}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.42it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:40,  1.72it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:34,  2.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:29,  2.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.52it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:25,  2.58it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:23,  2.74it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.12it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:19,  3.07it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.11it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.14it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.15it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.22it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.02it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.09it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.13it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.13it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.14it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.09it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.20it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.13it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.18it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.11it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.15it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.22it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.19it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.27it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.38it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.36it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.37it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.26it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.35it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:06,  3.35it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:44:34,346 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:44:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:44:34 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:44:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:44:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:44:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:44:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6734667, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [324, 366, 315, 238, 194, 174, 186, 207, 253, 549, 536, 764], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81721704, 'remaining_params': 3295896, 'pruned_model_sparsity': 0.9612327800361337, 'expected_sparsity': 0.94897, 'target_sparsity': 0.95, 'step': 10100}


Iteration:  83%|████████▎ | 95/115 [00:32<00:13,  1.43it/s][A04/23/2024 22:44:35 - INFO - trainer.trainer_mod - v4 Global step: 10100, Alignment: tensor([0, 0, 0, 1], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.69it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:09,  1.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:07,  2.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.41it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.60it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:05,  2.77it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.16it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.20it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.21it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.31it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.09it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.17it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.28it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.40it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.38it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.57it/s][A04/23/2024 22:44:41 - INFO - trainer.trainer_mod - Epoch 87 finished. Took 38.28 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  88%|████████▊ | 88/100 [58:44<07:45, 38.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.31it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.19it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.14it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.21it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.15it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.17it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.18it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.25it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.10it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.23it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.22it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.33it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.26it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.16it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.26it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:30,  3.02it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.08it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.17it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:44:51,213 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:44:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:44:51 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:44:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:44:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:44:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:44:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6810828, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [325, 368, 312, 237, 194, 173, 185, 206, 250, 535, 521, 744], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81721704, 'remaining_params': 3295896, 'pruned_model_sparsity': 0.9612327800361337, 'expected_sparsity': 0.94968, 'target_sparsity': 0.95, 'step': 10150}


Iteration:  26%|██▌       | 30/115 [00:10<01:00,  1.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:49,  1.69it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:43,  1.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:36,  2.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:32,  2.47it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:29,  2.70it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.07it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.12it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.16it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.29it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.25it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.25it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.32it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.36it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.33it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.30it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.22it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.13it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.16it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.20it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.18it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.16it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.21it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.19it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.26it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.25it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.28it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.39it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.34it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:11,  3.36it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.30it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.39it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.36it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.30it/s][A[INFO|trainer.py:570] 2024-04-23 22:45:07,860 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:45:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:45:07 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:45:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:45:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:45:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:45:09 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6647472, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [326, 372, 310, 236, 194, 173, 185, 206, 248, 525, 510, 729], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81717120, 'remaining_params': 3300480, 'pruned_model_sparsity': 0.9611788617886179, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 10200}


Iteration:  70%|██████▉   | 80/115 [00:27<00:24,  1.41it/s][A04/23/2024 22:45:09 - INFO - trainer.trainer_mod - v4 Global step: 10200, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:27<00:20,  1.67it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.98it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.44it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:11,  2.64it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.85it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.09it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.07it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.15it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.21it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.16it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.30it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.31it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.35it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.34it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.34it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.31it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.32it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.42it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.39it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.38it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:02,  3.35it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.38it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.38it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.19it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.22it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.24it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.27it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.41it/s][A04/23/2024 22:45:19 - INFO - trainer.trainer_mod - Epoch 88 finished. Took 38.0 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.03it/s]
Epoch:  89%|████████▉ | 89/100 [59:22<07:03, 38.53s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.22it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.20it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.22it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.05it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.20it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.25it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.24it/s][A[INFO|trainer.py:570] 2024-04-23 22:45:24,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:45:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:45:24 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:45:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:45:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:45:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:45:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.69417876, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [327, 374, 309, 235, 193, 173, 185, 205, 247, 519, 505, 721], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81714064, 'remaining_params': 3303536, 'pruned_model_sparsity': 0.961142916290274, 'expected_sparsity': 0.9504, 'target_sparsity': 0.95, 'step': 10250}


Iteration:  13%|█▎        | 15/115 [00:06<01:11,  1.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.70it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:49,  1.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:43,  2.25it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:38,  2.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:34,  2.73it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.90it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.09it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.06it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  3.07it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.12it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.26it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.24it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.29it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.31it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.22it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.25it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.24it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.25it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.29it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.27it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.30it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.16it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.15it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.26it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.27it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.32it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.34it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.29it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.23it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.23it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.15it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.26it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.27it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.29it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.01it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.08it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.13it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.19it/s][A[INFO|trainer.py:570] 2024-04-23 22:45:41,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:45:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:45:41 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:45:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:45:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:45:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:45:42 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.668618, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [329, 379, 309, 234, 193, 173, 185, 205, 247, 517, 504, 718], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81703368, 'remaining_params': 3314232, 'pruned_model_sparsity': 0.9610171070460705, 'expected_sparsity': 0.95042, 'target_sparsity': 0.95, 'step': 10300}


Iteration:  57%|█████▋    | 65/115 [00:22<00:35,  1.42it/s][A04/23/2024 22:45:42 - INFO - trainer.trainer_mod - v4 Global step: 10300, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:23<00:29,  1.66it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:21,  2.20it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.49it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:17,  2.60it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:16,  2.65it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.92it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.01it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.15it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.06it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.15it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.19it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.15it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.19it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.18it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.24it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.26it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.16it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.18it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.25it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.23it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.20it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.28it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.24it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.23it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.21it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.29it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.32it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.15it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.23it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.35it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.37it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.37it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.42it/s][A[INFO|trainer.py:570] 2024-04-23 22:45:58,046 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:45:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:45:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:45:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:45:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:45:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:45:59 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6829397, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [333, 384, 308, 234, 193, 173, 185, 205, 247, 518, 504, 718], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81691144, 'remaining_params': 3326456, 'pruned_model_sparsity': 0.960873325052695, 'expected_sparsity': 0.95025, 'target_sparsity': 0.95, 'step': 10350}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.51it/s][A04/23/2024 22:45:59 - INFO - trainer.trainer_mod - Epoch 89 finished. Took 39.58 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.91it/s]
Epoch:  90%|█████████ | 90/100 [1:00:01<06:28, 38.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:32,  3.46it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.21it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.27it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.23it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.27it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.30it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.10it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.10it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.17it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.26it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.27it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.26it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.20it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.18it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.19it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.22it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.17it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.22it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.22it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.22it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.27it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.27it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.27it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.27it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.37it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.26it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.28it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:13<00:22,  3.16it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:21,  3.19it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:21,  3.18it/s][A
Iteration:  42%|████▏     | 48/115 [00:14<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:19,  3.31it/s][A[INFO|trainer.py:570] 2024-04-23 22:46:14,811 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:46:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:46:14 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:46:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:46:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:46:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:46:16 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6827566, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [336, 389, 308, 235, 194, 173, 184, 205, 246, 518, 504, 716], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81678920, 'remaining_params': 3338680, 'pruned_model_sparsity': 0.9607295430593195, 'expected_sparsity': 0.95019, 'target_sparsity': 0.95, 'step': 10400}


Iteration:  43%|████▎     | 50/115 [00:16<00:45,  1.43it/s][A04/23/2024 22:46:16 - INFO - trainer.trainer_mod - v4 Global step: 10400, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:17<00:36,  1.75it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:30,  2.04it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:27,  2.30it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:24,  2.48it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:21,  2.75it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:20,  2.86it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.05it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.12it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.19it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.18it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.22it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:15,  3.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.15it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.29it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.25it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.21it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.19it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.25it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.22it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.23it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.06it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:11,  3.08it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.10it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:10,  3.05it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.11it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:09,  3.14it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.22it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.26it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:06,  3.37it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.42it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.38it/s][A
Iteration:  83%|████████▎ | 95/115 [00:30<00:06,  3.31it/s][A
Iteration:  83%|████████▎ | 96/115 [00:30<00:05,  3.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.34it/s][A
Iteration:  85%|████████▌ | 98/115 [00:31<00:05,  3.35it/s][A
Iteration:  86%|████████▌ | 99/115 [00:31<00:04,  3.38it/s][A[INFO|trainer.py:570] 2024-04-23 22:46:31,535 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:46:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:46:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:46:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:46:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:46:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:46:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66377306, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [339, 394, 308, 235, 194, 173, 184, 205, 246, 517, 504, 717], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81666696, 'remaining_params': 3350904, 'pruned_model_sparsity': 0.960585761065944, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 10450}


Iteration:  87%|████████▋ | 100/115 [00:33<00:10,  1.44it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:08,  1.73it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  2.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:05,  2.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:04,  2.47it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.67it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  2.84it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  2.82it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:02,  2.96it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.06it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.11it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.09it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.36it/s][A04/23/2024 22:46:37 - INFO - trainer.trainer_mod - Epoch 90 finished. Took 38.2 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  91%|█████████ | 91/100 [1:00:40<05:47, 38.65s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.30it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.03it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.10it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.12it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.14it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.17it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.30it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.31it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.29it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.21it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.33it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.28it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.31it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.32it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.25it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.21it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.16it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.25it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.22it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.21it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.14it/s][A[INFO|trainer.py:570] 2024-04-23 22:46:48,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:46:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:46:48 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:46:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:46:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:46:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:46:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6846586, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [343, 398, 308, 235, 194, 173, 184, 205, 246, 516, 503, 715], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81654472, 'remaining_params': 3363128, 'pruned_model_sparsity': 0.9604419790725685, 'expected_sparsity': 0.95004, 'target_sparsity': 0.95, 'step': 10500}


Iteration:  30%|███       | 35/115 [00:12<00:57,  1.40it/s][A04/23/2024 22:46:49 - INFO - trainer.trainer_mod - v4 Global step: 10500, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:12<00:47,  1.65it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:40,  1.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:35,  2.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:31,  2.43it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:28,  2.61it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.77it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.06it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.10it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.16it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.22it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.26it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.35it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.10it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.16it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.20it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.13it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.20it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.27it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:15,  3.37it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.19it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.31it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.34it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.28it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.38it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.13it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.16it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.22it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.28it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.38it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.38it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.31it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.41it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.32it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.42it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.33it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.30it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.27it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.21it/s][A[INFO|trainer.py:570] 2024-04-23 22:47:05,140 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:47:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:47:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:47:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:47:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:47:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:47:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67193097, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [347, 404, 309, 235, 194, 173, 184, 205, 246, 515, 502, 713], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81637664, 'remaining_params': 3379936, 'pruned_model_sparsity': 0.9602442788316772, 'expected_sparsity': 0.94973, 'target_sparsity': 0.95, 'step': 10550}


Iteration:  74%|███████▍  | 85/115 [00:28<00:20,  1.43it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:16,  1.72it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:14,  1.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:12,  2.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.68it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:08,  2.82it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.07it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.11it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.16it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.08it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.06it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.15it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.03it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.12it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.08it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.24it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.35it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.31it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.40it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.33it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.57it/s][A04/23/2024 22:47:15 - INFO - trainer.trainer_mod - Epoch 91 finished. Took 38.18 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  92%|█████████▏| 92/100 [1:01:18<05:08, 38.51s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.19it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.21it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.20it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.16it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.12it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.16it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.19it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.10it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.25it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:29,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:47:22,046 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:47:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:47:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:47:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:47:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:47:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:47:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6832713, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [348, 409, 308, 234, 193, 173, 184, 205, 245, 511, 497, 707], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1], 'pruned_params': 81630024, 'remaining_params': 3387576, 'pruned_model_sparsity': 0.9601544150858176, 'expected_sparsity': 0.94972, 'target_sparsity': 0.95, 'step': 10600}


Iteration:  17%|█▋        | 20/115 [00:07<01:06,  1.43it/s][A04/23/2024 22:47:23 - INFO - trainer.trainer_mod - v4 Global step: 10600, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:07<00:54,  1.71it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:46,  1.98it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:40,  2.26it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:36,  2.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:33,  2.70it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.81it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.03it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.06it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.13it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.19it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.19it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:22,  3.31it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.28it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.31it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:20,  3.41it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.31it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.32it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.30it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.31it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.13it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.16it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.06it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.14it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.21it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.14it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.28it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.28it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.34it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.28it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.29it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.30it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.30it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.31it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.27it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.28it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.30it/s][A[INFO|trainer.py:570] 2024-04-23 22:47:38,775 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:47:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:47:38 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:47:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:47:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:47:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:47:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68643373, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [352, 414, 307, 233, 193, 173, 184, 204, 244, 506, 492, 701], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81617800, 'remaining_params': 3399800, 'pruned_model_sparsity': 0.9600106330924421, 'expected_sparsity': 0.94975, 'target_sparsity': 0.95, 'step': 10650}


Iteration:  61%|██████    | 70/115 [00:24<00:31,  1.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:25,  1.74it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:21,  2.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:18,  2.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:15,  2.56it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:14,  2.74it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.86it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.08it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.16it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.23it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.26it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.28it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.24it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.27it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.03it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.17it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.09it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.09it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.16it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.20it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.22it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.18it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.17it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.04it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.09it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.24it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.32it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.33it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.30it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.31it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.27it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.35it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.36it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.34it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.28it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.46it/s][A04/23/2024 22:47:53 - INFO - trainer.trainer_mod - Epoch 92 finished. Took 38.18 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  93%|█████████▎| 93/100 [1:01:56<04:28, 38.41s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.11it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.13it/s][A[INFO|trainer.py:570] 2024-04-23 22:47:55,508 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:47:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:47:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:47:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:47:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:47:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:47:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6722911, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [354, 419, 305, 233, 193, 173, 184, 204, 243, 501, 486, 692], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81610160, 'remaining_params': 3407440, 'pruned_model_sparsity': 0.9599207693465823, 'expected_sparsity': 0.94993, 'target_sparsity': 0.95, 'step': 10700}


Iteration:   4%|▍         | 5/115 [00:02<01:26,  1.27it/s][A04/23/2024 22:47:56 - INFO - trainer.trainer_mod - v4 Global step: 10700, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:09,  1.58it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:57,  1.89it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:49,  2.18it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:43,  2.46it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:39,  2.67it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:36,  2.81it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:33,  3.01it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:32,  3.07it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:31,  3.16it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:31,  3.12it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:31,  3.12it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:30,  3.17it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:29,  3.22it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.17it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.18it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:26,  3.30it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.33it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.31it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.32it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.28it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.27it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.12it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.13it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.25it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.36it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:21,  3.36it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.28it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.17it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.21it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.21it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.24it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.22it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.26it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.20it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.23it/s][A[INFO|trainer.py:570] 2024-04-23 22:48:12,286 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:48:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:48:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:48:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:48:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:48:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:48:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.667523, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [357, 423, 304, 232, 193, 173, 183, 203, 242, 498, 482, 686], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81600992, 'remaining_params': 3416608, 'pruned_model_sparsity': 0.9598129328515508, 'expected_sparsity': 0.95003, 'target_sparsity': 0.95, 'step': 10750}


Iteration:  48%|████▊     | 55/115 [00:19<00:42,  1.43it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:34,  1.72it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:28,  2.02it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:22,  2.44it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:20,  2.66it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.09it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.13it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.17it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.03it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.18it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.27it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.27it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.14it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.28it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.08it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.14it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.25it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.23it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.23it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.23it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.13it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.13it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.16it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.26it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.27it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:06,  3.33it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.30it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:05,  3.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.27it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.26it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.24it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 22:48:29,035 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:48:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:48:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:48:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:48:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:48:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:48:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6801318, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [360, 427, 303, 231, 193, 173, 183, 203, 241, 494, 478, 682], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81591824, 'remaining_params': 3425776, 'pruned_model_sparsity': 0.9597050963565191, 'expected_sparsity': 0.9501, 'target_sparsity': 0.95, 'step': 10800}


Iteration:  91%|█████████▏| 105/115 [00:36<00:06,  1.44it/s][A04/23/2024 22:48:30 - INFO - trainer.trainer_mod - v4 Global step: 10800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:36<00:05,  1.73it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:04,  1.99it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.25it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.76it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.04it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.34it/s][A04/23/2024 22:48:33 - INFO - trainer.trainer_mod - Epoch 93 finished. Took 39.49 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.91it/s]
Epoch:  94%|█████████▍| 94/100 [1:02:35<03:52, 38.74s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.28it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.25it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.34it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.34it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:32,  3.36it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.30it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.31it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.17it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.30it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.38it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:30,  3.45it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.31it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.28it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.24it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:32,  3.08it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.05it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.10it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.13it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.14it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.11it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.13it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:26,  3.36it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:25,  3.43it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.26it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.29it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.25it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.29it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.30it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:22,  3.33it/s][A[INFO|trainer.py:570] 2024-04-23 22:48:45,706 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:48:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:48:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:48:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:48:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:48:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:48:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67904013, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [363, 432, 302, 231, 193, 173, 183, 203, 240, 491, 474, 679], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81581128, 'remaining_params': 3436472, 'pruned_model_sparsity': 0.9595792871123155, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 10850}


Iteration:  35%|███▍      | 40/115 [00:13<00:52,  1.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:42,  1.73it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:36,  2.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:31,  2.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:29,  2.39it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:26,  2.60it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:25,  2.75it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.17it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:19,  3.24it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.17it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.14it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.31it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.33it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.34it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.28it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.30it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.09it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.13it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.16it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:14,  3.20it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.25it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.25it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.31it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.30it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.30it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.28it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.26it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.30it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.31it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.32it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:10,  3.09it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:09,  3.15it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.12it/s][A[INFO|trainer.py:570] 2024-04-23 22:49:02,547 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:49:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:49:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:49:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:49:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:49:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:49:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6732472, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [366, 438, 302, 231, 193, 173, 183, 203, 239, 487, 471, 675], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81567376, 'remaining_params': 3450224, 'pruned_model_sparsity': 0.9594175323697681, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 10900}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.41it/s][A04/23/2024 22:49:03 - INFO - trainer.trainer_mod - v4 Global step: 10900, Alignment: tensor([0, 1, 1, 1], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:30<00:14,  1.70it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:11,  1.99it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:09,  2.30it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:08,  2.51it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:07,  2.71it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.82it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.02it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.03it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.02it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.19it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.25it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.25it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.29it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.22it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.24it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.51it/s][A04/23/2024 22:49:11 - INFO - trainer.trainer_mod - Epoch 94 finished. Took 38.16 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  95%|█████████▌| 95/100 [1:03:14<03:12, 38.56s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:42,  2.65it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.10it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.18it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.22it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.23it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.17it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.23it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.18it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.26it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.25it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.18it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.18it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:49:19,396 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:49:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:49:19 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:49:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:49:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/23/2024 22:49:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:49:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6776445, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [371, 443, 300, 230, 192, 173, 183, 203, 238, 484, 467, 672], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81555152, 'remaining_params': 3462448, 'pruned_model_sparsity': 0.9592737503763926, 'expected_sparsity': 0.94999, 'target_sparsity': 0.95, 'step': 10950}


Iteration:  22%|██▏       | 25/115 [00:09<01:02,  1.43it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:51,  1.71it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:43,  2.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:38,  2.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:34,  2.48it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:32,  2.63it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:30,  2.76it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.05it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.12it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.16it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:22,  3.33it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.36it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.32it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:21,  3.41it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.32it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.17it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.13it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.29it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.24it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.27it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.29it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.26it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.23it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.12it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.15it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.03it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.07it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.12it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.20it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.25it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.18it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.29it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.27it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.29it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.31it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.33it/s][A[INFO|trainer.py:570] 2024-04-23 22:49:36,161 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:49:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:49:36 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:49:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:49:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:49:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:49:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67393047, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [374, 448, 300, 229, 193, 173, 183, 203, 238, 482, 464, 668], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81542928, 'remaining_params': 3474672, 'pruned_model_sparsity': 0.9591299683830171, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 11000}


Iteration:  65%|██████▌   | 75/115 [00:25<00:27,  1.44it/s][A04/23/2024 22:49:37 - INFO - trainer.trainer_mod - v4 Global step: 11000, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:26<00:23,  1.69it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:19,  1.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:16,  2.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:14,  2.45it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:13,  2.67it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  2.85it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  3.08it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.30it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.28it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:06,  3.31it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.36it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.42it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:05,  3.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.36it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.32it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.30it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.31it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.28it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.29it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.15it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.28it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.26it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.21it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.18it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.01it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.15it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.35it/s][A04/23/2024 22:49:49 - INFO - trainer.trainer_mod - Epoch 95 finished. Took 38.24 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  96%|█████████▌| 96/100 [1:03:52<02:33, 38.47s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.26it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.22it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.19it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.26it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.28it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 22:49:52,915 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:49:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:49:52 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:49:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:49:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:49:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:49:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6724683, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [380, 454, 299, 229, 193, 173, 183, 202, 237, 479, 461, 666], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81526120, 'remaining_params': 3491480, 'pruned_model_sparsity': 0.9589322681421258, 'expected_sparsity': 0.94995, 'target_sparsity': 0.95, 'step': 11050}


Iteration:   9%|▊         | 10/115 [00:04<01:14,  1.40it/s][A
Iteration:  10%|▉         | 11/115 [00:04<01:01,  1.69it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:51,  2.01it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:45,  2.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:40,  2.49it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:37,  2.68it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.85it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.12it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:29,  3.25it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:31,  3.05it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:30,  3.13it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.15it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.09it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.18it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.19it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.26it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.35it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:25,  3.43it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:25,  3.41it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.18it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.24it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.19it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.24it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.24it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.24it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.15it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.19it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.36it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.17it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.19it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.28it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.10it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.15it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.17it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.21it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.22it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.26it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.37it/s][A[INFO|trainer.py:570] 2024-04-23 22:50:09,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:50:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:50:09 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:50:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:50:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:50:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:50:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6738091, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [382, 458, 298, 228, 193, 172, 183, 202, 236, 477, 459, 662], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81518480, 'remaining_params': 3499120, 'pruned_model_sparsity': 0.9588424043962662, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 11100}


Iteration:  52%|█████▏    | 60/115 [00:21<00:38,  1.44it/s][A04/23/2024 22:50:11 - INFO - trainer.trainer_mod - v4 Global step: 11100, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:21<00:31,  1.72it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:26,  2.01it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:22,  2.28it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.50it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:18,  2.66it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:17,  2.84it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.14it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.27it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.25it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:12,  3.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.32it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.29it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.39it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.43it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:10,  3.36it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.29it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.21it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.23it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.10it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.24it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.09it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.04it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.04it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.23it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.27it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.30it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.26it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.25it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.28it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.37it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:50:26,275 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:50:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:50:26 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:50:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:50:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/23/2024 22:50:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:50:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6826189, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [386, 464, 297, 228, 192, 172, 182, 202, 235, 474, 457, 658], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81504728, 'remaining_params': 3512872, 'pruned_model_sparsity': 0.9586806496537188, 'expected_sparsity': 0.94994, 'target_sparsity': 0.95, 'step': 11150}


Iteration:  96%|█████████▌| 110/115 [00:37<00:03,  1.43it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.73it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.26it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  2.50it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.85it/s][A04/23/2024 22:50:29 - INFO - trainer.trainer_mod - Epoch 96 finished. Took 39.23 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.93it/s]
Epoch:  97%|█████████▋| 97/100 [1:04:31<01:56, 38.70s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.29it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.37it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:32,  3.40it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:32,  3.34it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:31,  3.42it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:31,  3.39it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:31,  3.36it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.24it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.27it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.27it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.25it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.28it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.29it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.34it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.33it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:27,  3.33it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:27,  3.36it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.36it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:26,  3.42it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:25,  3.46it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:25,  3.40it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.22it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.23it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.19it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.19it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.22it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.26it/s][A
Iteration:  31%|███▏      | 36/115 [00:10<00:24,  3.24it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.28it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:22,  3.42it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:22,  3.37it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.34it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:23,  3.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:23,  3.08it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:23,  3.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 22:50:42,798 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:50:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:50:42 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:50:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:50:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:50:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:50:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68290794, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [390, 469, 296, 227, 192, 172, 182, 201, 234, 471, 453, 653], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81492504, 'remaining_params': 3525096, 'pruned_model_sparsity': 0.9585368676603433, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 11200}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.42it/s][A04/23/2024 22:50:44 - INFO - trainer.trainer_mod - v4 Global step: 11200, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:15<00:41,  1.65it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:34,  1.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:30,  2.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:24,  2.64it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:22,  2.81it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.11it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.10it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.26it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.15it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.03it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.10it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.09it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.24it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.16it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.16it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.12it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:15,  3.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.14it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.19it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.21it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.19it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.19it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.31it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.36it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.29it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.30it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.29it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.28it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.28it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.31it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:08,  3.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:08,  3.26it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.26it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:07,  3.09it/s][A
Iteration:  81%|████████  | 93/115 [00:29<00:06,  3.17it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.30it/s][A[INFO|trainer.py:570] 2024-04-23 22:50:59,621 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:50:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:50:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:50:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:50:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/23/2024 22:51:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:51:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68401533, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [394, 476, 294, 226, 192, 172, 182, 201, 233, 467, 450, 650], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81478752, 'remaining_params': 3538848, 'pruned_model_sparsity': 0.9583751129177959, 'expected_sparsity': 0.94992, 'target_sparsity': 0.95, 'step': 11250}


Iteration:  83%|████████▎ | 95/115 [00:31<00:14,  1.42it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.70it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:09,  2.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:07,  2.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.48it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.63it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:05,  2.79it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.04it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.06it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.03it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.13it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.07it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.21it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.25it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.17it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.42it/s][A04/23/2024 22:51:07 - INFO - trainer.trainer_mod - Epoch 97 finished. Took 38.1 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.02it/s]
Epoch:  98%|█████████▊| 98/100 [1:05:09<01:17, 38.52s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.38it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.31it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.14it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.12it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.33it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.33it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.31it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.26it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.22it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.06it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.02it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.11it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.06it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.14it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.07it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.13it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.18it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.32it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.34it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 22:51:16,496 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:51:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:51:16 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:51:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:51:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:51:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:51:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6802688, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [399, 480, 293, 226, 192, 172, 182, 201, 231, 463, 447, 644], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81466528, 'remaining_params': 3551072, 'pruned_model_sparsity': 0.9582313309244204, 'expected_sparsity': 0.94992, 'target_sparsity': 0.95, 'step': 11300}


Iteration:  26%|██▌       | 30/115 [00:10<00:59,  1.44it/s][A04/23/2024 22:51:17 - INFO - trainer.trainer_mod - v4 Global step: 11300, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:10<00:48,  1.73it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:41,  2.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:36,  2.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:32,  2.49it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:29,  2.70it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.08it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.16it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.20it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.21it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.17it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.09it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.13it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.18it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.30it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.34it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.31it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:17,  3.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.38it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.37it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:16,  3.36it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.13it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.15it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.25it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.26it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.22it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.20it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.25it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.25it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.22it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.23it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.28it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.33it/s][A[INFO|trainer.py:570] 2024-04-23 22:51:33,226 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:51:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:51:33 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:51:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:51:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:51:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:51:34 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67664933, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [402, 485, 291, 225, 191, 172, 181, 200, 230, 459, 443, 639], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81457360, 'remaining_params': 3560240, 'pruned_model_sparsity': 0.9581234944293887, 'expected_sparsity': 0.94994, 'target_sparsity': 0.95, 'step': 11350}


Iteration:  70%|██████▉   | 80/115 [00:27<00:23,  1.46it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:19,  1.74it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  2.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:11,  2.63it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.75it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.07it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.12it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.23it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.07it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.25it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.23it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.27it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.30it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.29it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.38it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.30it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.30it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.38it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.32it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.27it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.21it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.25it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.21it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.24it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.26it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.46it/s][A04/23/2024 22:51:45 - INFO - trainer.trainer_mod - Epoch 98 finished. Took 38.13 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.02it/s]
Epoch:  99%|█████████▉| 99/100 [1:05:47<00:38, 38.40s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.10it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.22it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.23it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.19it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.17it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.19it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.25it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.21it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.13it/s][A[INFO|trainer.py:570] 2024-04-23 22:51:50,021 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:51:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:51:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:51:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:51:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:51:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:51:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67884946, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [406, 489, 289, 224, 191, 172, 181, 200, 228, 454, 439, 632], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81448192, 'remaining_params': 3569408, 'pruned_model_sparsity': 0.9580156579343572, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 11400}


Iteration:  13%|█▎        | 15/115 [00:06<01:11,  1.39it/s][A04/23/2024 22:51:51 - INFO - trainer.trainer_mod - v4 Global step: 11400, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.69it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:49,  1.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:45,  2.14it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:40,  2.38it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:36,  2.59it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.64it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:34,  2.72it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:33,  2.79it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.07it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.16it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.21it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.24it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:25,  3.27it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.30it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.28it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:24,  3.25it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.21it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.24it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.17it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.04it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.11it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.17it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.16it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.16it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.25it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.31it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.31it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.32it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.28it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.28it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.35it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.30it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.29it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.30it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.31it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.39it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.38it/s][A[INFO|trainer.py:570] 2024-04-23 22:52:06,872 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:52:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:52:06 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:52:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:52:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:52:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:52:08 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6712711, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [410, 494, 287, 223, 191, 171, 181, 199, 227, 451, 435, 627], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81437496, 'remaining_params': 3580104, 'pruned_model_sparsity': 0.9578898486901536, 'expected_sparsity': 0.95003, 'target_sparsity': 0.95, 'step': 11450}


Iteration:  57%|█████▋    | 65/115 [00:22<00:34,  1.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:28,  1.70it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  2.00it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:20,  2.25it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.50it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:16,  2.68it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.15it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.23it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.20it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.26it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:10,  3.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.23it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.19it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.04it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.13it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.11it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.10it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.23it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.24it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.21it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.28it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.31it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.32it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.29it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.10it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.18it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.24it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.34it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.35it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.30it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.27it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.35it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.32it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.26it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.28it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.23it/s][A[INFO|trainer.py:570] 2024-04-23 22:52:23,501 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, idx, sentence1. If sentence2, idx, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:52:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:52:23 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:52:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:52:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/23/2024 22:52:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:52:24 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67911494, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 764, 'intermediate_dims': [413, 503, 287, 222, 190, 171, 180, 199, 226, 449, 432, 622], 'head_nums': [3, 5, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1], 'pruned_params': 81419160, 'remaining_params': 3598440, 'pruned_model_sparsity': 0.9576741757000903, 'expected_sparsity': 0.95003, 'target_sparsity': 0.95, 'step': 11500}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.47it/s][A04/23/2024 22:52:24 - INFO - trainer.trainer_mod - Epoch 99 finished. Took 39.53 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.91it/s]
Epoch: 100%|██████████| 100/100 [1:06:27<00:00, 38.74s/it]Epoch: 100%|██████████| 100/100 [1:06:27<00:00, 39.87s/it]
[INFO|configuration_utils.py:439] 2024-04-23 22:52:24,818 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95/config.json
[INFO|modeling_utils.py:1084] 2024-04-23 22:52:25,852 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-23 22:52:25,854 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-23 22:52:25,861 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.95/special_tokens_map.json
04/23/2024 22:52:25 - INFO - __main__ - Training took 3999.64 seconds.
