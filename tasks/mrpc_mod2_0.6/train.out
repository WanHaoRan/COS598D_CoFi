Sun Apr 28 21:09:18 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/mrpc_mod2_0.6
nvidia-smi output:
Sun Apr 28 21:09:18 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:17:00.0 Off |                    0 |
| N/A   32C    P0              34W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/28/2024 21:09:22 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/28/2024 21:09:22 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/runs/Apr28_21-09-22_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/28/2024 21:09:22 - INFO - __main__ - Model Arguments:
04/28/2024 21:09:22 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/28/2024 21:09:22 - INFO - __main__ - config_name = None
04/28/2024 21:09:22 - INFO - __main__ - tokenizer_name = None
04/28/2024 21:09:22 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/28/2024 21:09:22 - INFO - __main__ - use_fast_tokenizer = True
04/28/2024 21:09:22 - INFO - __main__ - model_revision = main
04/28/2024 21:09:22 - INFO - __main__ - use_auth_token = False
04/28/2024 21:09:22 - INFO - __main__ - Data Arguments:
04/28/2024 21:09:22 - INFO - __main__ - task_name = mrpc
04/28/2024 21:09:22 - INFO - __main__ - dataset_name = None
04/28/2024 21:09:22 - INFO - __main__ - t_name = None
04/28/2024 21:09:22 - INFO - __main__ - dataset_config_name = None
04/28/2024 21:09:22 - INFO - __main__ - max_seq_length = 128
04/28/2024 21:09:22 - INFO - __main__ - overwrite_cache = False
04/28/2024 21:09:22 - INFO - __main__ - pad_to_max_length = True
04/28/2024 21:09:22 - INFO - __main__ - max_train_samples = None
04/28/2024 21:09:22 - INFO - __main__ - max_eval_samples = None
04/28/2024 21:09:22 - INFO - __main__ - max_predict_samples = None
04/28/2024 21:09:22 - INFO - __main__ - train_file = None
04/28/2024 21:09:22 - INFO - __main__ - validation_file = None
04/28/2024 21:09:22 - INFO - __main__ - test_file = None
04/28/2024 21:09:22 - INFO - __main__ - Training Arguments:
04/28/2024 21:09:22 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6
04/28/2024 21:09:22 - INFO - __main__ - overwrite_output_dir = True
04/28/2024 21:09:22 - INFO - __main__ - do_train = True
04/28/2024 21:09:22 - INFO - __main__ - do_eval = True
04/28/2024 21:09:22 - INFO - __main__ - do_predict = False
04/28/2024 21:09:22 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/28/2024 21:09:22 - INFO - __main__ - prediction_loss_only = False
04/28/2024 21:09:22 - INFO - __main__ - per_device_train_batch_size = 32
04/28/2024 21:09:22 - INFO - __main__ - per_device_eval_batch_size = 32
04/28/2024 21:09:22 - INFO - __main__ - per_gpu_train_batch_size = None
04/28/2024 21:09:22 - INFO - __main__ - per_gpu_eval_batch_size = None
04/28/2024 21:09:22 - INFO - __main__ - gradient_accumulation_steps = 1
04/28/2024 21:09:22 - INFO - __main__ - eval_accumulation_steps = None
04/28/2024 21:09:22 - INFO - __main__ - learning_rate = 2e-05
04/28/2024 21:09:22 - INFO - __main__ - weight_decay = 0.0
04/28/2024 21:09:22 - INFO - __main__ - adam_beta1 = 0.9
04/28/2024 21:09:22 - INFO - __main__ - adam_beta2 = 0.999
04/28/2024 21:09:22 - INFO - __main__ - adam_epsilon = 1e-08
04/28/2024 21:09:22 - INFO - __main__ - max_grad_norm = 1.0
04/28/2024 21:09:22 - INFO - __main__ - num_train_epochs = 100.0
04/28/2024 21:09:22 - INFO - __main__ - max_steps = -1
04/28/2024 21:09:22 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/28/2024 21:09:22 - INFO - __main__ - warmup_ratio = 0.0
04/28/2024 21:09:22 - INFO - __main__ - warmup_steps = 0
04/28/2024 21:09:22 - INFO - __main__ - log_level = -1
04/28/2024 21:09:22 - INFO - __main__ - log_level_replica = -1
04/28/2024 21:09:22 - INFO - __main__ - log_on_each_node = True
04/28/2024 21:09:22 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/runs/Apr28_21-09-22_adroit-h11g2
04/28/2024 21:09:22 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/28/2024 21:09:22 - INFO - __main__ - logging_first_step = False
04/28/2024 21:09:22 - INFO - __main__ - logging_steps = 100
04/28/2024 21:09:22 - INFO - __main__ - logging_nan_inf_filter = True
04/28/2024 21:09:22 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/28/2024 21:09:22 - INFO - __main__ - save_steps = 0
04/28/2024 21:09:22 - INFO - __main__ - save_total_limit = None
04/28/2024 21:09:22 - INFO - __main__ - save_on_each_node = False
04/28/2024 21:09:22 - INFO - __main__ - no_cuda = False
04/28/2024 21:09:22 - INFO - __main__ - seed = 57
04/28/2024 21:09:22 - INFO - __main__ - bf16 = False
04/28/2024 21:09:22 - INFO - __main__ - fp16 = False
04/28/2024 21:09:22 - INFO - __main__ - fp16_opt_level = O1
04/28/2024 21:09:22 - INFO - __main__ - half_precision_backend = auto
04/28/2024 21:09:22 - INFO - __main__ - bf16_full_eval = False
04/28/2024 21:09:22 - INFO - __main__ - fp16_full_eval = False
04/28/2024 21:09:22 - INFO - __main__ - tf32 = None
04/28/2024 21:09:22 - INFO - __main__ - local_rank = -1
04/28/2024 21:09:22 - INFO - __main__ - xpu_backend = None
04/28/2024 21:09:22 - INFO - __main__ - tpu_num_cores = None
04/28/2024 21:09:22 - INFO - __main__ - tpu_metrics_debug = False
04/28/2024 21:09:22 - INFO - __main__ - debug = []
04/28/2024 21:09:22 - INFO - __main__ - dataloader_drop_last = False
04/28/2024 21:09:22 - INFO - __main__ - eval_steps = 50
04/28/2024 21:09:22 - INFO - __main__ - dataloader_num_workers = 0
04/28/2024 21:09:22 - INFO - __main__ - past_index = -1
04/28/2024 21:09:22 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6
04/28/2024 21:09:22 - INFO - __main__ - disable_tqdm = False
04/28/2024 21:09:22 - INFO - __main__ - remove_unused_columns = True
04/28/2024 21:09:22 - INFO - __main__ - label_names = None
04/28/2024 21:09:22 - INFO - __main__ - load_best_model_at_end = False
04/28/2024 21:09:22 - INFO - __main__ - metric_for_best_model = None
04/28/2024 21:09:22 - INFO - __main__ - greater_is_better = None
04/28/2024 21:09:22 - INFO - __main__ - ignore_data_skip = False
04/28/2024 21:09:22 - INFO - __main__ - sharded_ddp = []
04/28/2024 21:09:22 - INFO - __main__ - deepspeed = None
04/28/2024 21:09:22 - INFO - __main__ - label_smoothing_factor = 0.0
04/28/2024 21:09:22 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/28/2024 21:09:22 - INFO - __main__ - adafactor = False
04/28/2024 21:09:22 - INFO - __main__ - group_by_length = False
04/28/2024 21:09:22 - INFO - __main__ - length_column_name = length
04/28/2024 21:09:22 - INFO - __main__ - report_to = []
04/28/2024 21:09:22 - INFO - __main__ - ddp_find_unused_parameters = None
04/28/2024 21:09:22 - INFO - __main__ - ddp_bucket_cap_mb = None
04/28/2024 21:09:22 - INFO - __main__ - dataloader_pin_memory = True
04/28/2024 21:09:22 - INFO - __main__ - skip_memory_metrics = True
04/28/2024 21:09:22 - INFO - __main__ - use_legacy_prediction_loop = False
04/28/2024 21:09:22 - INFO - __main__ - push_to_hub = False
04/28/2024 21:09:22 - INFO - __main__ - resume_from_checkpoint = None
04/28/2024 21:09:22 - INFO - __main__ - hub_model_id = None
04/28/2024 21:09:22 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/28/2024 21:09:22 - INFO - __main__ - hub_token = None
04/28/2024 21:09:22 - INFO - __main__ - gradient_checkpointing = False
04/28/2024 21:09:22 - INFO - __main__ - fp16_backend = auto
04/28/2024 21:09:22 - INFO - __main__ - push_to_hub_model_id = None
04/28/2024 21:09:22 - INFO - __main__ - push_to_hub_organization = None
04/28/2024 21:09:22 - INFO - __main__ - push_to_hub_token = None
04/28/2024 21:09:22 - INFO - __main__ - mp_parameters = 
04/28/2024 21:09:22 - INFO - __main__ - _n_gpu = 1
04/28/2024 21:09:22 - INFO - __main__ - __cached__setup_devices = cuda:0
04/28/2024 21:09:22 - INFO - __main__ - Additional Arguments:
04/28/2024 21:09:22 - INFO - __main__ - test = False
04/28/2024 21:09:22 - INFO - __main__ - ex_name = MRPC_sparsity0.6
04/28/2024 21:09:22 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/28/2024 21:09:22 - INFO - __main__ - reg_learning_rate = 0.01
04/28/2024 21:09:22 - INFO - __main__ - scheduler_type = linear
04/28/2024 21:09:22 - INFO - __main__ - freeze_embeddings = True
04/28/2024 21:09:22 - INFO - __main__ - pretrained_pruned_model = None
04/28/2024 21:09:22 - INFO - __main__ - droprate_init = 0.5
04/28/2024 21:09:22 - INFO - __main__ - temperature = 0.6666666666666666
04/28/2024 21:09:22 - INFO - __main__ - prepruning_finetune_epochs = 4
04/28/2024 21:09:22 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/28/2024 21:09:22 - INFO - __main__ - target_sparsity = 0.6
04/28/2024 21:09:22 - INFO - __main__ - sparsity_epsilon = 0
04/28/2024 21:09:22 - INFO - __main__ - distillation_path = Intel/bert-base-uncased-mrpc
04/28/2024 21:09:22 - INFO - __main__ - do_distill = True
04/28/2024 21:09:22 - INFO - __main__ - do_layer_distill = True
04/28/2024 21:09:22 - INFO - __main__ - layer_distill_version = 4
04/28/2024 21:09:22 - INFO - __main__ - distill_loss_alpha = 0.9
04/28/2024 21:09:22 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/28/2024 21:09:22 - INFO - __main__ - distill_temp = 2.0
04/28/2024 21:09:22 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/28/2024 21:09:22 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/28/2024 21:09:22 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/28/2024 21:09:22 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 730.80it/s]
[INFO|configuration_utils.py:648] 2024-04-28 21:09:22,554 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 21:09:22,555 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "mrpc",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-28 21:09:22,557 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 21:09:22,557 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-28 21:09:22,561 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-28 21:09:22,561 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-28 21:09:22,561 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-28 21:09:22,561 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-28 21:09:22,564 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 21:09:22,565 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/28/2024 21:09:31 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/28/2024 21:09:31 - INFO - __main__ - Model size: 85054464
04/28/2024 21:09:31 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x145490a66550> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/28/2024 21:09:31 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/28/2024 21:09:31 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x145490a66040> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/28/2024 21:09:31 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/28/2024 21:09:31 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x145490a66550> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/28/2024 21:09:31 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/28/2024 21:09:31 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The Communicator can also consolidate e-mail from multiple screen names and other POP and IMAP accounts into a single application .', 'sentence2': 'AOL Communicator can consolidate e-mail from multiple AOL screen names , as well as from other POP and IMAP-based e-mail accounts .', 'label': 1, 'idx': 2338, 'input_ids': [101, 1996, 4012, 23041, 5555, 4263, 2064, 2036, 24939, 1041, 1011, 5653, 2013, 3674, 3898, 3415, 1998, 2060, 3769, 1998, 10047, 9331, 6115, 2046, 1037, 2309, 4646, 1012, 102, 20118, 2140, 4012, 23041, 5555, 4263, 2064, 24939, 1041, 1011, 5653, 2013, 3674, 20118, 2140, 3898, 3415, 1010, 2004, 2092, 2004, 2013, 2060, 3769, 1998, 10047, 9331, 1011, 2241, 1041, 1011, 5653, 6115, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/28/2024 21:09:31 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': 'The dollar gained against the euro , yen and Swiss franc after September U.S. retail sales figures came in slightly weaker than consensus forecasts .', 'sentence2': 'The greenback rose steeply against the euro , yen and Swiss franc despite weaker-than-expected September U.S. retail sales figures .', 'label': 1, 'idx': 1465, 'input_ids': [101, 1996, 7922, 4227, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2044, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 2234, 1999, 3621, 15863, 2084, 10465, 19939, 2015, 1012, 102, 1996, 2665, 5963, 3123, 9561, 2135, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2750, 15863, 1011, 2084, 1011, 3517, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/28/2024 21:09:31 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "But he said he had Dr Hollingworth 's legal advice that he had been denied natural justice by the church inquiry .", 'sentence2': "Senator Brandis backed Dr Hollingworth 's claims he had been denied natural justice by the Anglican Church inquiry into the claims against him .", 'label': 0, 'idx': 2170, 'input_ids': [101, 2021, 2002, 2056, 2002, 2018, 2852, 7570, 13112, 5172, 1005, 1055, 3423, 6040, 2008, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 2277, 9934, 1012, 102, 5205, 4435, 2483, 6153, 2852, 7570, 13112, 5172, 1005, 1055, 4447, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 9437, 2277, 9934, 2046, 1996, 4447, 2114, 2032, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/28/2024 21:09:31 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/28/2024 21:09:31 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/28/2024 21:09:31 - INFO - __main__ - ************* 3668 Training Examples Loaded *************
04/28/2024 21:09:31 - INFO - __main__ - ************* 408 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-28 21:09:32,171 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 - Prepruning finetune steps: 100
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 - Lagrangian warmup steps: 2300
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 - ***** Running training *****
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 -   Num examples = 3668
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 -   Num Epochs = 100
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 -   Instantaneous batch size per device = 32
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 -   Gradient Accumulation steps = 1
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 -   Total optimization steps = 11500
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-28 21:09:32,176 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:09:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32

Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A
Evaluation:   8%|▊         | 1/13 [00:00<00:01,  6.58it/s][A
Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.10it/s][A
Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A
Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.11it/s][A
Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.28it/s][A
Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.38it/s][A
Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.89it/s][AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/28/2024 21:09:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:09:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.3161764705882353, 'f1': 0.0, 'combined_score': 0.15808823529411764, 'eval_loss': 0.7583998, 'step': 0}


Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 21:09:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:39,  2.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.41it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:31,  3.51it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:31,  3.52it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:31,  3.53it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:30,  3.62it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:29,  3.69it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:27,  3.85it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:27,  3.84it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:27,  3.77it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:27,  3.79it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:27,  3.72it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:27,  3.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:25,  3.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:27,  3.68it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:27,  3.60it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.30it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.47it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:26,  3.59it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:26,  3.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:24,  3.75it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:24,  3.77it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.61it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.67it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:24,  3.66it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:24,  3.66it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:23,  3.73it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:22,  3.78it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:21,  3.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:21,  3.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:21,  3.85it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:20,  3.87it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:21,  3.73it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:10<00:20,  3.79it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:20,  3.72it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:20,  3.78it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:19,  3.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:11<00:18,  3.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:18,  3.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:18,  3.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:18,  3.89it/s][A
Iteration:  39%|███▉      | 45/115 [00:12<00:18,  3.86it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:17,  3.85it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:18,  3.75it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:17,  3.80it/s][A
Iteration:  43%|████▎     | 49/115 [00:13<00:18,  3.63it/s][A[INFO|trainer.py:570] 2024-04-28 21:09:46,925 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:09:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:09:46 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:09:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.58it/s]04/28/2024 21:09:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:09:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8482871125611746, 'combined_score': 0.8101729680452932, 'eval_loss': 0.47348246, 'step': 50}


Iteration:  43%|████▎     | 50/115 [00:14<00:42,  1.54it/s][A
Iteration:  44%|████▍     | 51/115 [00:14<00:34,  1.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:15<00:27,  2.26it/s][A
Iteration:  46%|████▌     | 53/115 [00:15<00:24,  2.52it/s][A
Iteration:  47%|████▋     | 54/115 [00:15<00:21,  2.81it/s][A
Iteration:  48%|████▊     | 55/115 [00:16<00:19,  3.04it/s][A
Iteration:  49%|████▊     | 56/115 [00:16<00:18,  3.23it/s][A
Iteration:  50%|████▉     | 57/115 [00:16<00:17,  3.38it/s][A
Iteration:  50%|█████     | 58/115 [00:16<00:16,  3.48it/s][A
Iteration:  51%|█████▏    | 59/115 [00:17<00:16,  3.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:17<00:15,  3.51it/s][A
Iteration:  53%|█████▎    | 61/115 [00:17<00:15,  3.57it/s][A
Iteration:  54%|█████▍    | 62/115 [00:17<00:15,  3.40it/s][A
Iteration:  55%|█████▍    | 63/115 [00:18<00:14,  3.52it/s][A
Iteration:  56%|█████▌    | 64/115 [00:18<00:14,  3.62it/s][A
Iteration:  57%|█████▋    | 65/115 [00:18<00:13,  3.68it/s][A
Iteration:  57%|█████▋    | 66/115 [00:19<00:13,  3.72it/s][A
Iteration:  58%|█████▊    | 67/115 [00:19<00:12,  3.70it/s][A
Iteration:  59%|█████▉    | 68/115 [00:19<00:12,  3.73it/s][A
Iteration:  60%|██████    | 69/115 [00:19<00:12,  3.78it/s][A
Iteration:  61%|██████    | 70/115 [00:20<00:12,  3.73it/s][A
Iteration:  62%|██████▏   | 71/115 [00:20<00:11,  3.73it/s][A
Iteration:  63%|██████▎   | 72/115 [00:20<00:11,  3.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:20<00:10,  3.83it/s][A
Iteration:  64%|██████▍   | 74/115 [00:21<00:10,  3.85it/s][A
Iteration:  65%|██████▌   | 75/115 [00:21<00:10,  3.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:21<00:10,  3.79it/s][A
Iteration:  67%|██████▋   | 77/115 [00:21<00:10,  3.74it/s][A
Iteration:  68%|██████▊   | 78/115 [00:22<00:09,  3.76it/s][A
Iteration:  69%|██████▊   | 79/115 [00:22<00:09,  3.75it/s][A
Iteration:  70%|██████▉   | 80/115 [00:22<00:09,  3.74it/s][A
Iteration:  70%|███████   | 81/115 [00:22<00:08,  3.79it/s][A
Iteration:  71%|███████▏  | 82/115 [00:23<00:08,  3.79it/s][A
Iteration:  72%|███████▏  | 83/115 [00:23<00:08,  3.82it/s][A
Iteration:  73%|███████▎  | 84/115 [00:23<00:08,  3.79it/s][A
Iteration:  74%|███████▍  | 85/115 [00:24<00:08,  3.75it/s][A
Iteration:  75%|███████▍  | 86/115 [00:24<00:07,  3.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:24<00:07,  3.72it/s][A
Iteration:  77%|███████▋  | 88/115 [00:24<00:06,  3.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:25<00:06,  3.86it/s][A
Iteration:  78%|███████▊  | 90/115 [00:25<00:06,  3.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:25<00:06,  3.84it/s][A
Iteration:  80%|████████  | 92/115 [00:25<00:05,  3.86it/s][A
Iteration:  81%|████████  | 93/115 [00:26<00:05,  3.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:26<00:05,  3.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:26<00:05,  3.80it/s][A
Iteration:  83%|████████▎ | 96/115 [00:26<00:04,  3.83it/s][A
Iteration:  84%|████████▍ | 97/115 [00:27<00:04,  3.71it/s][A
Iteration:  85%|████████▌ | 98/115 [00:27<00:04,  3.69it/s][A
Iteration:  86%|████████▌ | 99/115 [00:27<00:04,  3.68it/s][A[INFO|trainer.py:570] 2024-04-28 21:10:01,503 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:10:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:10:01 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:10:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.48it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.75it/s]04/28/2024 21:10:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:10:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8831168831168831, 'combined_score': 0.8533231474407945, 'eval_loss': 0.50392485, 'step': 100}


Iteration:  87%|████████▋ | 100/115 [00:29<00:09,  1.56it/s][A04/28/2024 21:10:02 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/28/2024 21:10:02 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/28/2024 21:10:02 - INFO - trainer.trainer_mod_2 - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/28/2024 21:10:02 - INFO - trainer.trainer_mod_2 - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/28/2024 21:10:02 - INFO - trainer.trainer_mod_2 - Starting l0 regularization!
04/28/2024 21:10:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:29<00:07,  1.78it/s][A
Iteration:  89%|████████▊ | 102/115 [00:30<00:06,  1.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:30<00:05,  2.15it/s][A
Iteration:  90%|█████████ | 104/115 [00:30<00:04,  2.30it/s][A
Iteration:  91%|█████████▏| 105/115 [00:31<00:04,  2.42it/s][A
Iteration:  92%|█████████▏| 106/115 [00:31<00:03,  2.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:31<00:02,  2.68it/s][A
Iteration:  94%|█████████▍| 108/115 [00:32<00:02,  2.71it/s][A
Iteration:  95%|█████████▍| 109/115 [00:32<00:02,  2.78it/s][A
Iteration:  96%|█████████▌| 110/115 [00:32<00:01,  2.76it/s][A
Iteration:  97%|█████████▋| 111/115 [00:33<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 112/115 [00:33<00:01,  2.67it/s][A
Iteration:  98%|█████████▊| 113/115 [00:33<00:00,  2.73it/s][A
Iteration:  99%|█████████▉| 114/115 [00:34<00:00,  2.83it/s][A
Iteration: 100%|██████████| 115/115 [00:34<00:00,  3.04it/s][A04/28/2024 21:10:08 - INFO - trainer.trainer_mod_2 - Epoch 0 finished. Took 34.56 seconds.
Iteration: 100%|██████████| 115/115 [00:34<00:00,  3.33it/s]
Epoch:   1%|          | 1/100 [00:35<59:08, 35.84s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.11it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.12it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.80it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.86it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.85it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.77it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.76it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.77it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.76it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.75it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.80it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.85it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.82it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.84it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.87it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.89it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 21:10:20,256 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:10:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:10:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:10:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:10:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.49it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:10:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:10:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8205882352941176, 'combined_score': 0.7607843137254902, 'eval_loss': 1.3557794, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2613, 2604, 2604, 2597, 2596, 2601, 2591, 2589, 2588, 2587, 2589, 2593], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9054912, 'remaining_params': 75962688, 'pruned_model_sparsity': 0.10650632339656729, 'expected_sparsity': 0.10807, 'target_sparsity': 0.013043478260869565, 'step': 150}


Iteration:  30%|███       | 35/115 [00:13<01:01,  1.30it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:50,  1.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:43,  1.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:38,  2.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:34,  2.23it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:31,  2.36it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:28,  2.55it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:27,  2.64it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:26,  2.71it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:25,  2.71it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.81it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.87it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.78it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.82it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.68it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.75it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.80it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.83it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.87it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.91it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.87it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.87it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  2.94it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.94it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.92it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.86it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.71it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.72it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:12,  2.60it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:11,  2.67it/s][A[INFO|trainer.py:570] 2024-04-28 21:10:39,313 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:10:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:10:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:10:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:10:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 21:10:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:10:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7450980392156863, 'f1': 0.7936507936507936, 'combined_score': 0.7693744164332399, 'eval_loss': 0.51881224, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2646, 2635, 2633, 2620, 2620, 2630, 2617, 2613, 2617, 2624, 2635, 2658], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8448240, 'remaining_params': 76569360, 'pruned_model_sparsity': 0.09937048328816621, 'expected_sparsity': 0.10093, 'target_sparsity': 0.02608695652173913, 'step': 200}


Iteration:  74%|███████▍  | 85/115 [00:32<00:23,  1.25it/s][A04/28/2024 21:10:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:33<00:19,  1.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:15,  1.76it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:13,  2.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:11,  2.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:10,  2.40it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:09,  2.54it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.59it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:08,  2.67it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:08,  2.59it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.66it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:07,  2.67it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.74it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.81it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.81it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.90it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.82it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.81it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.79it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.88it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.87it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.09it/s][A04/28/2024 21:10:51 - INFO - trainer.trainer_mod_2 - Epoch 1 finished. Took 43.12 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:   2%|▏         | 2/100 [01:18<1:05:32, 40.12s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.87it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.87it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:40,  2.67it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.73it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.72it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.73it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.77it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.80it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.88it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 21:10:58,205 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:10:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:10:58 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:10:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:10:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:10:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:10:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7549019607843137, 'f1': 0.8046875, 'combined_score': 0.7797947303921569, 'eval_loss': 0.53223747, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2674, 2662, 2660, 2645, 2647, 2661, 2645, 2643, 2653, 2669, 2690, 2725], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7795608, 'remaining_params': 77221992, 'pruned_model_sparsity': 0.09169404923215899, 'expected_sparsity': 0.09329, 'target_sparsity': 0.03913043478260869, 'step': 250}


Iteration:  17%|█▋        | 20/115 [00:08<01:13,  1.28it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<01:02,  1.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:52,  1.77it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:45,  2.03it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:41,  2.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:37,  2.38it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:37,  2.38it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:34,  2.56it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:33,  2.61it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:32,  2.69it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:30,  2.76it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.80it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:28,  2.84it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.87it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.89it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.89it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.88it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.94it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.88it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:24,  2.71it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.75it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.86it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.82it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.84it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.80it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.83it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.70it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.75it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.79it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.82it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.85it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.83it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.84it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.79it/s][A[INFO|trainer.py:570] 2024-04-28 21:11:17,184 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:11:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:11:17 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:11:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:11:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.39it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.43it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.66it/s]04/28/2024 21:11:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:11:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.4215686274509804, 'f1': 0.2760736196319018, 'combined_score': 0.3488211235414411, 'eval_loss': 1.3993055, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2698, 2686, 2685, 2667, 2671, 2687, 2672, 2671, 2685, 2709, 2736, 2780], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7224172, 'remaining_params': 77793428, 'pruned_model_sparsity': 0.08497266448358928, 'expected_sparsity': 0.08659, 'target_sparsity': 0.05217391304347826, 'step': 300}


Iteration:  61%|██████    | 70/115 [00:27<00:34,  1.29it/s][A04/28/2024 21:11:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:27<00:28,  1.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:24,  1.73it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:21,  1.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:18,  2.19it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:17,  2.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:15,  2.48it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.61it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.68it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:13,  2.74it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.80it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.84it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.84it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.84it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.88it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:07,  2.88it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.75it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.75it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.81it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.82it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.85it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.75it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.85it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.83it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.86it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.85it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.85it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.87it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  3.01it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.21it/s][A04/28/2024 21:11:34 - INFO - trainer.trainer_mod_2 - Epoch 2 finished. Took 43.04 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:   3%|▎         | 3/100 [02:02<1:07:01, 41.46s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:11:35,922 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:11:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:11:35 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:11:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:11:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:11:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:11:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.7208791208791208, 'combined_score': 0.7048023055375996, 'eval_loss': 0.6766067, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2720, 2709, 2707, 2690, 2694, 2711, 2696, 2695, 2715, 2745, 2775, 2825], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6710952, 'remaining_params': 78306648, 'pruned_model_sparsity': 0.07893603206865402, 'expected_sparsity': 0.08056, 'target_sparsity': 0.06521739130434782, 'step': 350}


Iteration:   4%|▍         | 5/115 [00:03<01:35,  1.16it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:14,  1.47it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:01,  1.76it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  2.01it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.25it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.40it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:39,  2.61it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.74it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.84it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.87it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.89it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.88it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:35,  2.71it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:35,  2.70it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:34,  2.73it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.80it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.89it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.89it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:29,  2.92it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.88it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.89it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.85it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.83it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.84it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.81it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:27,  2.72it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:26,  2.74it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.79it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.82it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.84it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.86it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.84it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:23,  2.73it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.75it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.81it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.79it/s][A[INFO|trainer.py:570] 2024-04-28 21:11:54,876 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:11:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:11:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:11:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:11:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:11:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:11:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6446078431372549, 'f1': 0.6604215456674474, 'combined_score': 0.6525146944023512, 'eval_loss': 0.7260567, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2740, 2730, 2728, 2711, 2715, 2734, 2717, 2717, 2742, 2775, 2808, 2859], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6260544, 'remaining_params': 78757056, 'pruned_model_sparsity': 0.07363821138211382, 'expected_sparsity': 0.07525, 'target_sparsity': 0.07826086956521738, 'step': 400}


Iteration:  48%|████▊     | 55/115 [00:22<00:47,  1.26it/s][A04/28/2024 21:11:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:22<00:38,  1.52it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:32,  1.76it/s][A
Iteration:  50%|█████     | 58/115 [00:23<00:28,  1.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:23<00:25,  2.21it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:23,  2.39it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:21,  2.52it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:20,  2.57it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.65it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:18,  2.78it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:18,  2.77it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:17,  2.75it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:17,  2.80it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:16,  2.77it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.80it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:16,  2.79it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.68it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.75it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.76it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:14,  2.63it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.70it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.76it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.80it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.87it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.89it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.85it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.87it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.93it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.89it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.79it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.78it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.84it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.83it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.86it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.83it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 21:12:13,858 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:12:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:12:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:12:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:12:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:12:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:12:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8551483420593368, 'combined_score': 0.8258584847551586, 'eval_loss': 0.4189579, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2757, 2747, 2743, 2727, 2732, 2752, 2736, 2737, 2764, 2800, 2833, 2885], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5897460, 'remaining_params': 79120140, 'pruned_model_sparsity': 0.0693675191960253, 'expected_sparsity': 0.07098, 'target_sparsity': 0.09130434782608696, 'step': 450}


Iteration:  91%|█████████▏| 105/115 [00:41<00:07,  1.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:41<00:05,  1.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:41<00:04,  1.78it/s][A
Iteration:  94%|█████████▍| 108/115 [00:42<00:03,  2.00it/s][A
Iteration:  95%|█████████▍| 109/115 [00:42<00:02,  2.20it/s][A
Iteration:  96%|█████████▌| 110/115 [00:42<00:02,  2.38it/s][A
Iteration:  97%|█████████▋| 111/115 [00:43<00:01,  2.52it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  2.59it/s][A
Iteration:  98%|█████████▊| 113/115 [00:43<00:00,  2.61it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.67it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.92it/s][A04/28/2024 21:12:18 - INFO - trainer.trainer_mod_2 - Epoch 3 finished. Took 44.55 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.58it/s]
Epoch:   4%|▍         | 4/100 [02:46<1:08:16, 42.68s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.76it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.86it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.87it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.87it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.89it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.83it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.84it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.91it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.88it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.88it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.91it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:30,  2.78it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.90it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:28,  2.85it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.80it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:27,  2.76it/s][A[INFO|trainer.py:570] 2024-04-28 21:12:32,644 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:12:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:12:32 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:12:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:12:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.47it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.49it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.50it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.68it/s]04/28/2024 21:12:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:12:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8710801393728224, 'combined_score': 0.8448537951766073, 'eval_loss': 0.41620913, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2771, 2761, 2757, 2741, 2746, 2766, 2750, 2753, 2782, 2818, 2852, 2903], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5610976, 'remaining_params': 79406624, 'pruned_model_sparsity': 0.06599781692261367, 'expected_sparsity': 0.06764, 'target_sparsity': 0.10434782608695652, 'step': 500}


Iteration:  35%|███▍      | 40/115 [00:15<00:58,  1.28it/s][A04/28/2024 21:12:34 - INFO - trainer.trainer_mod_2 - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:48,  1.53it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:40,  1.78it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:37,  1.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:33,  2.11it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:30,  2.29it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:28,  2.45it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:27,  2.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:27,  2.47it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:26,  2.53it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:24,  2.70it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:23,  2.72it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.83it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.87it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.86it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.86it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.84it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.92it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.88it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.84it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.82it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.85it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.85it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.80it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.84it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:13,  2.81it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.83it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.83it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.84it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.81it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.81it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.81it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:10,  2.78it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.78it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.79it/s][A[INFO|trainer.py:570] 2024-04-28 21:12:51,736 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:12:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:12:51 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:12:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:12:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:12:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:12:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8854166666666665, 'combined_score': 0.8618259803921569, 'eval_loss': 0.46488586, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2781, 2771, 2766, 2751, 2757, 2777, 2760, 2763, 2795, 2831, 2865, 2915], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5408752, 'remaining_params': 79608848, 'pruned_model_sparsity': 0.06361920355314664, 'expected_sparsity': 0.06528, 'target_sparsity': 0.11739130434782609, 'step': 550}


Iteration:  78%|███████▊  | 90/115 [00:34<00:19,  1.28it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:15,  1.53it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:12,  1.80it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:11,  1.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:09,  2.18it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:08,  2.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:07,  2.53it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.60it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.70it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.77it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.79it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.78it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.78it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.84it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.86it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.69it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.74it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.68it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.76it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.67it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.94it/s][A04/28/2024 21:13:01 - INFO - trainer.trainer_mod_2 - Epoch 4 finished. Took 43.21 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:   5%|▌         | 5/100 [03:29<1:07:52, 42.87s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:41,  2.71it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.75it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:41,  2.70it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.72it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.79it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:40,  2.64it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.72it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.78it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.72it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:38,  2.73it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:37,  2.72it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.77it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:35,  2.82it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.83it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.83it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.84it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.82it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:13:10,895 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:13:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:13:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:13:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:13:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 21:13:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:13:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.8635514018691589, 'combined_score': 0.8423149166208539, 'eval_loss': 0.43562815, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2788, 2778, 2774, 2757, 2763, 2784, 2766, 2770, 2802, 2838, 2872, 2922], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5283128, 'remaining_params': 79734472, 'pruned_model_sparsity': 0.06214158009635652, 'expected_sparsity': 0.06383, 'target_sparsity': 0.13043478260869565, 'step': 600}


Iteration:  22%|██▏       | 25/115 [00:10<01:10,  1.27it/s][A04/28/2024 21:13:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:58,  1.52it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:51,  1.72it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:44,  1.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:39,  2.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:35,  2.42it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:32,  2.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.62it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:30,  2.69it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.73it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.75it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.79it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.84it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.86it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.81it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.82it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:24,  2.83it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.79it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.78it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:23,  2.79it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.84it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.80it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.78it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:22,  2.68it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.80it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.84it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.87it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.86it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.85it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.80it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.82it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.72it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.80it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.81it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.81it/s][A[INFO|trainer.py:570] 2024-04-28 21:13:29,996 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:13:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:13:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:13:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:13:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:13:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:13:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.8814691151919867, 'combined_score': 0.8537247536744247, 'eval_loss': 0.44750342, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2791, 2782, 2778, 2761, 2767, 2787, 2768, 2772, 2805, 2838, 2873, 2923], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5235636, 'remaining_params': 79781964, 'pruned_model_sparsity': 0.061582966350496836, 'expected_sparsity': 0.06326, 'target_sparsity': 0.14347826086956522, 'step': 650}


Iteration:  65%|██████▌   | 75/115 [00:29<00:31,  1.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:25,  1.52it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:21,  1.77it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:18,  2.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:16,  2.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:14,  2.35it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:13,  2.46it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:12,  2.57it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:12,  2.64it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:11,  2.69it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.75it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.77it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.87it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.84it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.86it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.89it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.87it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.89it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.13it/s][A04/28/2024 21:13:45 - INFO - trainer.trainer_mod_2 - Epoch 5 finished. Took 43.27 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:   6%|▌         | 6/100 [04:13<1:07:22, 43.01s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.96it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.83it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.83it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.85it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.87it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.83it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.79it/s][A[INFO|trainer.py:570] 2024-04-28 21:13:48,726 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:13:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:13:48 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:13:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:13:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.50it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:13:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:13:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8808290155440415, 'combined_score': 0.855855684242609, 'eval_loss': 0.49847105, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2791, 2781, 2779, 2759, 2766, 2786, 2765, 2768, 2800, 2832, 2867, 2919], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5284660, 'remaining_params': 79732940, 'pruned_model_sparsity': 0.062159599894610056, 'expected_sparsity': 0.06387, 'target_sparsity': 0.15652173913043477, 'step': 700}


Iteration:   9%|▊         | 10/115 [00:04<01:22,  1.27it/s][A04/28/2024 21:13:50 - INFO - trainer.trainer_mod_2 - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:08,  1.51it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:58,  1.77it/s][A
Iteration:  11%|█▏        | 13/115 [00:06<00:51,  1.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:45,  2.20it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.41it/s][A
Iteration:  14%|█▍        | 16/115 [00:07<00:39,  2.52it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.62it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.70it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:34,  2.77it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.82it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.81it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.80it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.85it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.84it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:31,  2.80it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.84it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.86it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.87it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:30,  2.65it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.74it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.73it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.83it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.85it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.85it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.85it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.89it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.89it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.90it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.88it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.87it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.87it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.86it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.87it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.70it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.76it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.81it/s][A[INFO|trainer.py:570] 2024-04-28 21:14:07,709 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:14:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:14:07 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:14:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:14:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 21:14:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:14:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.88130081300813, 'combined_score': 0.8511896221903394, 'eval_loss': 0.6280489, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2786, 2776, 2774, 2753, 2759, 2778, 2754, 2757, 2788, 2814, 2849, 2904], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5470032, 'remaining_params': 79547568, 'pruned_model_sparsity': 0.06433999548328817, 'expected_sparsity': 0.06616, 'target_sparsity': 0.16956521739130434, 'step': 750}


Iteration:  52%|█████▏    | 60/115 [00:23<00:42,  1.29it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:34,  1.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:29,  1.79it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.02it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:22,  2.23it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.56it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:18,  2.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.64it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:17,  2.67it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:16,  2.70it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.61it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:16,  2.68it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.72it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.78it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.86it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:12,  2.88it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.88it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.90it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.95it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.86it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.73it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:10,  2.80it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.78it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.83it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.81it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.82it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.88it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.88it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.75it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.79it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.93it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:14:26,627 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:14:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:14:26 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:14:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:14:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:14:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:14:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8794788273615635, 'combined_score': 0.8490531391709778, 'eval_loss': 0.628118, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2774, 2763, 2763, 2740, 2747, 2766, 2736, 2735, 2764, 2777, 2810, 2871], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5846904, 'remaining_params': 79170696, 'pruned_model_sparsity': 0.06877286585365854, 'expected_sparsity': 0.0709, 'target_sparsity': 0.1826086956521739, 'step': 800}


Iteration:  96%|█████████▌| 110/115 [00:42<00:03,  1.31it/s][A04/28/2024 21:14:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:43<00:02,  1.56it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  1.80it/s][A
Iteration:  98%|█████████▊| 113/115 [00:43<00:00,  2.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.13it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.46it/s][A04/28/2024 21:14:29 - INFO - trainer.trainer_mod_2 - Epoch 6 finished. Took 44.54 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.58it/s]
Epoch:   7%|▋         | 7/100 [04:57<1:07:26, 43.51s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.86it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:41,  2.68it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.75it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.82it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.69it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:40,  2.64it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:39,  2.69it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.75it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:37,  2.77it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.82it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:35,  2.82it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.79it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.83it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.90it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.95it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.90it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.78it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:29,  2.79it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.89it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.87it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.89it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.90it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.85it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.92it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:26,  2.72it/s][A[INFO|trainer.py:570] 2024-04-28 21:14:45,539 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:14:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:14:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:14:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:14:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 21:14:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:14:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.8768971332209106, 'combined_score': 0.8489877822967298, 'eval_loss': 0.58681625, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2755, 2743, 2746, 2718, 2726, 2744, 2705, 2696, 2719, 2704, 2726, 2793], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6568476, 'remaining_params': 78449124, 'pruned_model_sparsity': 0.07726019083107498, 'expected_sparsity': 0.07994, 'target_sparsity': 0.1956521739130435, 'step': 850}


Iteration:  39%|███▉      | 45/115 [00:17<00:54,  1.29it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:44,  1.54it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:38,  1.79it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:33,  2.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:29,  2.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.43it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:24,  2.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:24,  2.59it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.74it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.79it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.77it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:21,  2.80it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.91it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.89it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.90it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:19,  2.71it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.74it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.79it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.76it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.78it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:17,  2.74it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.74it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:16,  2.80it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.80it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.79it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.82it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.85it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.86it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.88it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.88it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.83it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.94it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.72it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.73it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.78it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.76it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.77it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.79it/s][A[INFO|trainer.py:570] 2024-04-28 21:15:04,558 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:15:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:15:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:15:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:15:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 21:15:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:15:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8870703764320785, 'combined_score': 0.8589763646866275, 'eval_loss': 0.77514124, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2723, 2711, 2721, 2685, 2693, 2710, 2658, 2634, 2645, 2548, 2522, 2585], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8008556, 'remaining_params': 77009044, 'pruned_model_sparsity': 0.09419880118940079, 'expected_sparsity': 0.09816, 'target_sparsity': 0.20869565217391303, 'step': 900}


Iteration:  83%|████████▎ | 95/115 [00:36<00:15,  1.29it/s][A04/28/2024 21:15:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:36<00:12,  1.53it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:10,  1.79it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:08,  2.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:07,  2.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:06,  2.37it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.52it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.62it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.67it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:04,  2.70it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.81it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.84it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.82it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.84it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.83it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.87it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.88it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.08it/s][A04/28/2024 21:15:12 - INFO - trainer.trainer_mod_2 - Epoch 7 finished. Took 43.11 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:   8%|▊         | 8/100 [05:40<1:06:31, 43.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.72it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.81it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.86it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.82it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:37,  2.73it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.78it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.77it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.84it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:34,  2.73it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.83it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.86it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.83it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.87it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.83it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.85it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 21:15:23,374 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:15:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:15:23 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:15:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:15:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 21:15:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:15:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8811881188118812, 'combined_score': 0.8523587652882936, 'eval_loss': 0.85458314, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2678, 2665, 2682, 2638, 2647, 2660, 2586, 2534, 2515, 2234, 2078, 2101], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 10792200, 'remaining_params': 74225400, 'pruned_model_sparsity': 0.1269407746160795, 'expected_sparsity': 0.13676, 'target_sparsity': 0.22173913043478258, 'step': 950}


Iteration:  26%|██▌       | 30/115 [00:11<01:05,  1.30it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:45,  1.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:36,  2.23it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:33,  2.40it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:31,  2.52it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.67it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.74it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.77it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.76it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:27,  2.72it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:26,  2.79it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.92it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.90it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.89it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.87it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.88it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:20,  2.92it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.77it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.81it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.87it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.94it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.87it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.84it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:15,  2.68it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.76it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:14,  2.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.80it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.86it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 21:15:42,133 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:15:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:15:42 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:15:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:15:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 21:15:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:15:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8926174496644296, 'combined_score': 0.8678773522831952, 'eval_loss': 0.6424039, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2617, 2607, 2635, 2579, 2587, 2596, 2485, 2391, 2315, 1866, 1527, 1556], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11], 'pruned_params': 14446020, 'remaining_params': 70571580, 'pruned_model_sparsity': 0.16991799345076783, 'expected_sparsity': 0.19994, 'target_sparsity': 0.23478260869565218, 'step': 1000}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.31it/s][A04/28/2024 21:15:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:18,  1.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.09it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:13,  2.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:12,  2.45it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:11,  2.50it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:10,  2.58it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.69it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:09,  2.66it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.76it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.81it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.85it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.86it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.87it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.74it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.85it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.90it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.86it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.74it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.76it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.82it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.03it/s][A04/28/2024 21:15:55 - INFO - trainer.trainer_mod_2 - Epoch 8 finished. Took 42.82 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.69it/s]
Epoch:   9%|▉         | 9/100 [06:23<1:05:31, 43.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.96it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.94it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.02it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:16:00,749 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:16:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:16:00 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:16:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:16:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/28/2024 21:16:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:16:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9047619047619047, 'combined_score': 0.8837535014005602, 'eval_loss': 0.57015294, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2548, 2541, 2581, 2510, 2517, 2522, 2365, 2219, 2087, 1678, 1114, 1283], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 12, 10], 'pruned_params': 22125936, 'remaining_params': 62891664, 'pruned_model_sparsity': 0.2602512420957543, 'expected_sparsity': 0.25024, 'target_sparsity': 0.24782608695652172, 'step': 1050}


Iteration:  13%|█▎        | 15/115 [00:06<01:16,  1.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:41,  2.30it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.48it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.61it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:34,  2.72it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.79it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.85it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.77it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.83it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.78it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:29,  2.66it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.71it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.77it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.77it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.83it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.88it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.83it/s][A[INFO|trainer.py:570] 2024-04-28 21:16:19,367 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:16:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:16:19 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:16:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:16:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:16:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:16:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.61490196, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2470, 2466, 2520, 2435, 2439, 2437, 2232, 2042, 1866, 1600, 845, 1181], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 12, 11, 10], 'pruned_params': 24632288, 'remaining_params': 60385312, 'pruned_model_sparsity': 0.28973163203854263, 'expected_sparsity': 0.28472, 'target_sparsity': 0.2608695652173913, 'step': 1100}


Iteration:  57%|█████▋    | 65/115 [00:25<00:39,  1.28it/s][A04/28/2024 21:16:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 1100, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:27,  1.73it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:24,  1.93it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:21,  2.15it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:19,  2.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:17,  2.49it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.62it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.67it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.79it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.90it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.97it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.83it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.89it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.90it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.87it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.88it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.84it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.75it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.81it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.89it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.92it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.77it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.83it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:16:38,013 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:16:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:16:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:16:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:16:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/28/2024 21:16:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:16:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8885135135135136, 'combined_score': 0.8633744038155804, 'eval_loss': 0.7540847, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2389, 2389, 2456, 2358, 2362, 2350, 2100, 1878, 1674, 1556, 672, 1130], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 11, 11, 9], 'pruned_params': 26942544, 'remaining_params': 58075056, 'pruned_model_sparsity': 0.31690548780487804, 'expected_sparsity': 0.31364, 'target_sparsity': 0.27391304347826084, 'step': 1150}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.36it/s][A04/28/2024 21:16:39 - INFO - trainer.trainer_mod_2 - Epoch 9 finished. Took 43.72 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.63it/s]
Epoch:  10%|█         | 10/100 [07:07<1:05:02, 43.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.84it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.87it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.99it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.80it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.77it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.84it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.87it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.78it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.81it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.86it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.89it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.00it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.78it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.84it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.93it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.89it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.90it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.86it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:25,  2.84it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 21:16:56,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:16:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:16:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:16:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:16:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:16:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:16:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9006849315068494, 'combined_score': 0.8792640343808756, 'eval_loss': 0.73471534, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2306, 2313, 2392, 2285, 2286, 2267, 1979, 1734, 1517, 1527, 561, 1098], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 11, 10, 9], 'pruned_params': 28652256, 'remaining_params': 56365344, 'pruned_model_sparsity': 0.33701558265582654, 'expected_sparsity': 0.33689, 'target_sparsity': 0.28695652173913044, 'step': 1200}


Iteration:  43%|████▎     | 50/115 [00:18<00:49,  1.31it/s][A04/28/2024 21:16:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 1200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:40,  1.56it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:34,  1.83it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:30,  2.07it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:27,  2.18it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:25,  2.35it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:22,  2.62it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.71it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.77it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:20,  2.66it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.85it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.88it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.90it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.74it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.89it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.95it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.91it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.88it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.93it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.91it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.92it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:17:15,297 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:17:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:17:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:17:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:17:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:17:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:17:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.70286936, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2232, 2247, 2334, 2216, 2217, 2191, 1873, 1612, 1391, 1507, 488, 1076], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 11, 10, 8], 'pruned_params': 30133700, 'remaining_params': 54883900, 'pruned_model_sparsity': 0.3544407275669979, 'expected_sparsity': 0.35558, 'target_sparsity': 0.3, 'step': 1250}


Iteration:  87%|████████▋ | 100/115 [00:37<00:11,  1.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.57it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:05,  2.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.26it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:04,  2.40it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.56it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.62it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.71it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.76it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.74it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.91it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.92it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.17it/s][A04/28/2024 21:17:21 - INFO - trainer.trainer_mod_2 - Epoch 10 finished. Took 42.34 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.72it/s]
Epoch:  11%|█         | 11/100 [07:49<1:03:51, 43.05s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.89it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:41,  2.72it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.79it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.85it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.70it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.78it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.84it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.84it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.88it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.75it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.79it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.85it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.79it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.83it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.98it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.04it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.87it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.92it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.94it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 21:17:33,927 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:17:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:17:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:17:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:17:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:17:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:17:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.883415435139573, 'combined_score': 0.8546979136482178, 'eval_loss': 0.8440833, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2167, 2188, 2282, 2154, 2156, 2126, 1785, 1514, 1290, 1491, 438, 1059], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 11, 9, 8], 'pruned_params': 31403728, 'remaining_params': 53613872, 'pruned_model_sparsity': 0.36937914031918095, 'expected_sparsity': 0.37224, 'target_sparsity': 0.31304347826086953, 'step': 1300}


Iteration:  30%|███       | 35/115 [00:13<01:01,  1.30it/s][A04/28/2024 21:17:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 1300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:50,  1.55it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:43,  1.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:38,  2.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:31,  2.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.55it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.71it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:26,  2.75it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.79it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.81it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.86it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.00it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.98it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.80it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.79it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.03it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:16,  2.80it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.85it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.86it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.94it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.90it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.91it/s][A[INFO|trainer.py:570] 2024-04-28 21:17:52,455 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:17:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:17:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:17:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:17:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:17:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:17:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8939130434782607, 'combined_score': 0.872201619778346, 'eval_loss': 0.79127276, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2115, 2140, 2240, 2102, 2105, 2071, 1713, 1436, 1213, 1479, 404, 1047], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 9, 7], 'pruned_params': 32655372, 'remaining_params': 52362228, 'pruned_model_sparsity': 0.38410131549232157, 'expected_sparsity': 0.38543, 'target_sparsity': 0.3260869565217391, 'step': 1350}


Iteration:  74%|███████▍  | 85/115 [00:32<00:22,  1.33it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:18,  1.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:13,  2.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:11,  2.20it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.38it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:09,  2.53it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.69it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.75it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.91it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.86it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.87it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.86it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.10it/s][A04/28/2024 21:18:04 - INFO - trainer.trainer_mod_2 - Epoch 11 finished. Took 42.32 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.72it/s]
Epoch:  12%|█▏        | 12/100 [08:31<1:02:48, 42.83s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.05it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.04it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.76it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.89it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.75it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.81it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.87it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:18:10,913 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:18:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:18:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:18:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:18:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 21:18:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:18:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8877374784110534, 'combined_score': 0.8642118764604287, 'eval_loss': 0.7867103, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2073, 2104, 2208, 2064, 2064, 2027, 1656, 1375, 1154, 1469, 381, 1037], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 9, 7], 'pruned_params': 33318728, 'remaining_params': 51698872, 'pruned_model_sparsity': 0.3919038881361036, 'expected_sparsity': 0.39562, 'target_sparsity': 0.3391304347826087, 'step': 1400}


Iteration:  17%|█▋        | 20/115 [00:08<01:12,  1.31it/s][A04/28/2024 21:18:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 1400, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:51,  1.82it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.07it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:41,  2.18it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:38,  2.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:35,  2.49it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:33,  2.62it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:32,  2.72it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.75it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.82it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:30,  2.76it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.83it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.82it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.87it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.92it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.00it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  3.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.87it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.88it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.95it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.77it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.79it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.82it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 21:18:29,568 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:18:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:18:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:18:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:18:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:18:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:18:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8972602739726027, 'combined_score': 0.8751007252215954, 'eval_loss': 0.8049921, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2041, 2074, 2181, 2031, 2032, 1991, 1611, 1328, 1109, 1460, 365, 1029], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 9, 6], 'pruned_params': 34040300, 'remaining_params': 50977300, 'pruned_model_sparsity': 0.40039121311352005, 'expected_sparsity': 0.40346, 'target_sparsity': 0.3521739130434783, 'step': 1450}


Iteration:  61%|██████    | 70/115 [00:26<00:34,  1.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:28,  1.57it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:24,  1.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:18,  2.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.39it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.54it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.63it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.71it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.79it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.83it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.75it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.79it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.84it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.87it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.95it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.92it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.91it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.04it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.83it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.92it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.14it/s][A04/28/2024 21:18:46 - INFO - trainer.trainer_mod_2 - Epoch 12 finished. Took 42.27 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.72it/s]
Epoch:  13%|█▎        | 13/100 [09:14<1:01:51, 42.66s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.82it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.81it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 21:18:48,068 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:18:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:18:48 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:18:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:18:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:18:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:18:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8972602739726027, 'combined_score': 0.8751007252215954, 'eval_loss': 0.8002074, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2017, 2050, 2159, 2006, 2006, 1964, 1578, 1291, 1075, 1453, 353, 1022], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 8, 6], 'pruned_params': 34640844, 'remaining_params': 50376756, 'pruned_model_sparsity': 0.40745497402890696, 'expected_sparsity': 0.4091, 'target_sparsity': 0.3652173913043478, 'step': 1500}


Iteration:   4%|▍         | 5/115 [00:03<01:33,  1.18it/s][A04/28/2024 21:18:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 1500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.78it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  2.01it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.22it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:45,  2.29it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:42,  2.46it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:39,  2.60it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:38,  2.67it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.85it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.86it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.88it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  3.00it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:24,  3.03it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.94it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.75it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.87it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 21:19:06,497 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:19:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:19:06 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:19:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:19:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/28/2024 21:19:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:19:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9016949152542373, 'combined_score': 0.8797690262545697, 'eval_loss': 0.7974219, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1996, 2031, 2141, 1984, 1986, 1944, 1550, 1261, 1046, 1447, 344, 1017], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 8, 6], 'pruned_params': 34971756, 'remaining_params': 50045844, 'pruned_model_sparsity': 0.4113472504516712, 'expected_sparsity': 0.41359, 'target_sparsity': 0.3782608695652174, 'step': 1550}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:36,  1.60it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:30,  1.88it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:26,  2.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.31it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.46it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.54it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:20,  2.63it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.67it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.91it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.77it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.80it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.84it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.86it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.92it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.94it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.94it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.84it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.82it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.83it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.83it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.79it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.83it/s][A[INFO|trainer.py:570] 2024-04-28 21:19:25,030 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:19:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:19:25 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:19:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:19:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/28/2024 21:19:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:19:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8970331588132635, 'combined_score': 0.8762126578380043, 'eval_loss': 0.7578647, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1980, 2015, 2127, 1970, 1971, 1926, 1523, 1236, 1022, 1442, 336, 1012], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 8, 6], 'pruned_params': 35242920, 'remaining_params': 49774680, 'pruned_model_sparsity': 0.4145367547425474, 'expected_sparsity': 0.41763, 'target_sparsity': 0.391304347826087, 'step': 1600}


Iteration:  91%|█████████▏| 105/115 [00:40<00:07,  1.31it/s][A04/28/2024 21:19:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 1600, Alignment: tensor([ 2,  4,  7, 10], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:03,  2.06it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.26it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.44it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.48it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.60it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.59it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.66it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.87it/s][A04/28/2024 21:19:29 - INFO - trainer.trainer_mod_2 - Epoch 13 finished. Took 43.55 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s]
Epoch:  14%|█▍        | 14/100 [09:57<1:01:31, 42.93s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.01it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.03it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.03it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.83it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.83it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.85it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.79it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.91it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.92it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.92it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.90it/s][A[INFO|trainer.py:570] 2024-04-28 21:19:43,570 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:19:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:19:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:19:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:19:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:19:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:19:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8916083916083916, 'combined_score': 0.869823803647333, 'eval_loss': 0.790072, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1966, 2000, 2114, 1954, 1956, 1910, 1502, 1214, 1002, 1437, 329, 1007], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 8, 6], 'pruned_params': 35486508, 'remaining_params': 49531092, 'pruned_model_sparsity': 0.41740190266486, 'expected_sparsity': 0.4212, 'target_sparsity': 0.4043478260869565, 'step': 1650}


Iteration:  35%|███▍      | 40/115 [00:15<00:57,  1.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:36,  2.00it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:32,  2.20it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.37it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:27,  2.49it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:26,  2.60it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:25,  2.66it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:24,  2.74it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.79it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.82it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.74it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.76it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.85it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.86it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.92it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.77it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.84it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.95it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.84it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.74it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.81it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.88it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.76it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.80it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 21:20:02,337 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:20:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:20:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:20:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:20:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 21:20:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:20:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.897391304347826, 'combined_score': 0.8763917306052855, 'eval_loss': 0.73576975, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1951, 1986, 2101, 1938, 1940, 1894, 1480, 1190, 979, 1431, 322, 1002], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 8, 6], 'pruned_params': 35740820, 'remaining_params': 49276780, 'pruned_model_sparsity': 0.4203931891749473, 'expected_sparsity': 0.4254, 'target_sparsity': 0.41739130434782606, 'step': 1700}


Iteration:  78%|███████▊  | 90/115 [00:33<00:19,  1.31it/s][A04/28/2024 21:20:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 1700, Alignment: tensor([ 2,  5,  7, 10], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:34<00:15,  1.56it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.80it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.05it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:09,  2.27it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.44it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.56it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.66it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.80it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.97it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.02it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.23it/s][A04/28/2024 21:20:12 - INFO - trainer.trainer_mod_2 - Epoch 14 finished. Took 42.2 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.72it/s]
Epoch:  15%|█▌        | 15/100 [10:39<1:00:30, 42.71s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.90it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.89it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.94it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.96it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.86it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.89it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.79it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.99it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.04it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:20:20,620 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:20:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:20:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:20:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:20:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 21:20:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:20:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8979591836734693, 'combined_score': 0.8754501800720287, 'eval_loss': 0.729613, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1934, 1970, 2086, 1921, 1923, 1874, 1456, 1165, 955, 1425, 316, 996], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 8, 6], 'pruned_params': 36018112, 'remaining_params': 48999488, 'pruned_model_sparsity': 0.4236547726588377, 'expected_sparsity': 0.43013, 'target_sparsity': 0.4304347826086956, 'step': 1750}


Iteration:  22%|██▏       | 25/115 [00:09<01:08,  1.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:38,  2.26it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.66it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.75it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:29,  2.76it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.70it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.77it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.81it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.84it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.91it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.92it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.99it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.87it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.00it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  3.00it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:20:39,006 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:20:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:20:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:20:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:20:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/28/2024 21:20:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:20:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8927335640138409, 'combined_score': 0.8703863898500577, 'eval_loss': 0.7097392, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1914, 1950, 2068, 1900, 1902, 1850, 1428, 1136, 928, 1418, 309, 990], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 7, 6], 'pruned_params': 36543588, 'remaining_params': 48474012, 'pruned_model_sparsity': 0.4298355634598013, 'expected_sparsity': 0.43634, 'target_sparsity': 0.44347826086956516, 'step': 1800}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.32it/s][A04/28/2024 21:20:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 1800, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:20,  1.83it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:14,  2.36it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.52it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.54it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:12,  2.66it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.72it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.79it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.84it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.90it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.78it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.78it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.89it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.91it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.93it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.79it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.81it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.08it/s][A04/28/2024 21:20:54 - INFO - trainer.trainer_mod_2 - Epoch 15 finished. Took 42.14 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  16%|█▌        | 16/100 [11:22<59:33, 42.54s/it]  
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.93it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.74it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.84it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.02it/s][A[INFO|trainer.py:570] 2024-04-28 21:20:57,632 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:20:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:20:57 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:20:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:20:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 21:20:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:20:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8977469670710572, 'combined_score': 0.8765695619669012, 'eval_loss': 0.7372287, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1891, 1927, 2047, 1875, 1878, 1824, 1396, 1103, 898, 1409, 301, 982], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 7, 6], 'pruned_params': 38291600, 'remaining_params': 46726000, 'pruned_model_sparsity': 0.4503961532670882, 'expected_sparsity': 0.44416, 'target_sparsity': 0.4565217391304348, 'step': 1850}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.30it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.57it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.07it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.27it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:40,  2.47it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:38,  2.57it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:36,  2.64it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.77it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.80it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.82it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.80it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.00it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.89it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.88it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.90it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.81it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.89it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.86it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.89it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.82it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.84it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.96it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:21:16,200 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:21:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:21:16 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:21:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:21:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 21:21:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:21:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8943661971830987, 'combined_score': 0.8736536868268434, 'eval_loss': 0.7547872, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1864, 1899, 2022, 1846, 1850, 1793, 1359, 1066, 865, 1399, 294, 973], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 7, 6], 'pruned_params': 38723624, 'remaining_params': 46293976, 'pruned_model_sparsity': 0.455477736374586, 'expected_sparsity': 0.45227, 'target_sparsity': 0.46956521739130436, 'step': 1900}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.32it/s][A04/28/2024 21:21:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 1900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:34,  1.57it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:29,  1.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.05it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:20,  2.40it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.53it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.63it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.74it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.75it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.67it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.73it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.77it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:14,  2.74it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.95it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  3.02it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.06it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.98it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  3.03it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  3.02it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.97it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.91it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.92it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.95it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.96it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.95it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.92it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.01it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.83it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 21:21:34,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:21:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:21:34 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:21:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:21:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 21:21:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:21:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8949152542372881, 'combined_score': 0.8714772349617813, 'eval_loss': 0.8299649, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1831, 1865, 1991, 1812, 1816, 1757, 1316, 1024, 828, 1388, 286, 963], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 7, 6], 'pruned_params': 39232248, 'remaining_params': 45785352, 'pruned_model_sparsity': 0.4614603093947606, 'expected_sparsity': 0.46051, 'target_sparsity': 0.4826086956521739, 'step': 1950}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.32it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:02,  1.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.30it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.61it/s][A04/28/2024 21:21:37 - INFO - trainer.trainer_mod_2 - Epoch 16 finished. Took 43.5 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s]
Epoch:  17%|█▋        | 17/100 [12:05<59:14, 42.83s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.90it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.74it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.82it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.89it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.89it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.92it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.86it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.90it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.00it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:26,  2.83it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:26,  2.74it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:26,  2.68it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:26,  2.68it/s][A[INFO|trainer.py:570] 2024-04-28 21:21:53,295 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:21:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:21:53 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:21:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:21:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 21:21:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:21:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8912280701754387, 'combined_score': 0.8696336429308567, 'eval_loss': 0.80777323, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1795, 1828, 1954, 1774, 1777, 1717, 1269, 979, 789, 1373, 277, 950], 'head_nums': [12, 11, 12, 12, 12, 12, 11, 9, 12, 10, 7, 6], 'pruned_params': 39990588, 'remaining_params': 45027012, 'pruned_model_sparsity': 0.470380109530262, 'expected_sparsity': 0.46932, 'target_sparsity': 0.49565217391304345, 'step': 2000}


Iteration:  39%|███▉      | 45/115 [00:16<00:54,  1.28it/s][A04/28/2024 21:21:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 2000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:17<00:44,  1.54it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:38,  1.79it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:33,  2.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:29,  2.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:27,  2.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:25,  2.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.68it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.76it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.82it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.86it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.86it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.86it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.99it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.88it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.96it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.82it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.92it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.88it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.82it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 21:22:11,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:22:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:22:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:22:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:22:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 21:22:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:22:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8828522920203735, 'combined_score': 0.856867322480775, 'eval_loss': 0.84965926, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1752, 1784, 1911, 1727, 1732, 1671, 1217, 930, 746, 1356, 269, 935], 'head_nums': [12, 11, 12, 12, 12, 12, 11, 9, 12, 10, 7, 6], 'pruned_params': 40634028, 'remaining_params': 44383572, 'pruned_model_sparsity': 0.477948424796748, 'expected_sparsity': 0.47919, 'target_sparsity': 0.508695652173913, 'step': 2050}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.31it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:09,  1.82it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.07it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.26it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:06,  2.43it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.71it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.75it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.79it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.89it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.88it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.18it/s][A04/28/2024 21:22:19 - INFO - trainer.trainer_mod_2 - Epoch 17 finished. Took 42.21 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.72it/s]
Epoch:  18%|█▊        | 18/100 [12:47<58:16, 42.64s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:43,  2.65it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.79it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.85it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.87it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.83it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.90it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.91it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.90it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.88it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:22:30,233 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:22:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:22:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:22:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:22:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.79it/s]04/28/2024 21:22:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:22:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.891846921797005, 'combined_score': 0.8662665981534045, 'eval_loss': 0.8593575, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1702, 1733, 1861, 1674, 1682, 1618, 1160, 880, 701, 1337, 260, 918], 'head_nums': [12, 11, 12, 12, 12, 12, 11, 9, 12, 10, 7, 5], 'pruned_params': 41547100, 'remaining_params': 43470500, 'pruned_model_sparsity': 0.48868822455585664, 'expected_sparsity': 0.49111, 'target_sparsity': 0.5217391304347826, 'step': 2100}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.31it/s][A04/28/2024 21:22:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 2100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:12<00:54,  1.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:46,  1.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:40,  2.04it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:36,  2.23it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.43it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.66it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.72it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.84it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.94it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.99it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.86it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.99it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.96it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.84it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:14,  2.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 21:22:48,720 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:22:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:22:48 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:22:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:22:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.77it/s]04/28/2024 21:22:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:22:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8884892086330936, 'combined_score': 0.868264212159684, 'eval_loss': 0.77428913, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1648, 1679, 1806, 1616, 1626, 1561, 1100, 834, 657, 1315, 252, 898], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 9, 12, 9, 7, 5], 'pruned_params': 42693036, 'remaining_params': 42324564, 'pruned_model_sparsity': 0.5021670336495032, 'expected_sparsity': 0.5059, 'target_sparsity': 0.5347826086956521, 'step': 2150}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.30it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:18,  1.80it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.07it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.46it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.66it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.75it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.66it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.72it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.81it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.00it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  3.00it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.06it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.03it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.05it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.78it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.84it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.07it/s][A04/28/2024 21:23:01 - INFO - trainer.trainer_mod_2 - Epoch 18 finished. Took 42.0 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.74it/s]
Epoch:  19%|█▉        | 19/100 [13:29<57:18, 42.45s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.05it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.94it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.00it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.98it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.90it/s][A[INFO|trainer.py:570] 2024-04-28 21:23:06,990 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:23:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:23:06 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:23:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:23:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 21:23:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:23:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8896321070234114, 'combined_score': 0.8639337005705292, 'eval_loss': 0.78221494, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1592, 1622, 1748, 1557, 1570, 1506, 1042, 804, 617, 1290, 245, 878], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 9, 12, 9, 7, 5], 'pruned_params': 44653996, 'remaining_params': 40363604, 'pruned_model_sparsity': 0.5252323754140319, 'expected_sparsity': 0.52179, 'target_sparsity': 0.5478260869565217, 'step': 2200}


Iteration:  13%|█▎        | 15/115 [00:06<01:15,  1.32it/s][A04/28/2024 21:23:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 2200, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:01,  1.60it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:51,  1.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:45,  2.12it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.25it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:40,  2.35it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:37,  2.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.59it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.70it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.76it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.90it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.06it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:26,  3.11it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.03it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.03it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.99it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.90it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.81it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.85it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:19,  2.75it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.80it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 21:23:25,368 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:23:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:23:25 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:23:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:23:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 21:23:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:23:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8993055555555555, 'combined_score': 0.8785743464052287, 'eval_loss': 0.75152004, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1534, 1562, 1688, 1496, 1514, 1446, 984, 790, 579, 1264, 239, 856], 'head_nums': [12, 11, 12, 12, 12, 11, 10, 9, 12, 9, 7, 5], 'pruned_params': 45550216, 'remaining_params': 39467384, 'pruned_model_sparsity': 0.5357739573923517, 'expected_sparsity': 0.53644, 'target_sparsity': 0.5608695652173913, 'step': 2250}


Iteration:  57%|█████▋    | 65/115 [00:24<00:38,  1.31it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.80it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:23,  2.03it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.25it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.66it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.76it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.82it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.85it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.88it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.93it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.98it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.06it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  3.02it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.01it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.90it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.96it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.04it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.02it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.99it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.99it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.05it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:23:43,551 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:23:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:23:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:23:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:23:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:23:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:23:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8944723618090453, 'combined_score': 0.8700302985515815, 'eval_loss': 0.6602774, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1478, 1503, 1628, 1435, 1455, 1386, 927, 782, 544, 1235, 233, 833], 'head_nums': [12, 11, 12, 12, 12, 11, 9, 9, 12, 9, 7, 4], 'pruned_params': 47420788, 'remaining_params': 37596812, 'pruned_model_sparsity': 0.5577761310599217, 'expected_sparsity': 0.55116, 'target_sparsity': 0.5739130434782609, 'step': 2300}


Iteration: 100%|██████████| 115/115 [00:42<00:00,  1.37it/s][A04/28/2024 21:23:44 - INFO - trainer.trainer_mod_2 - Epoch 19 finished. Took 42.99 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.67it/s]
Epoch:  20%|██        | 20/100 [14:12<56:49, 42.61s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 21:23:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 2300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.06it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.04it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.03it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.01it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.03it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.04it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.04it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.82it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.85it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.81it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.85it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.01it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.01it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.07it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  3.05it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 21:24:01,734 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:24:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:24:01 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:24:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:24:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:24:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:24:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8874172185430463, 'combined_score': 0.8603752759381899, 'eval_loss': 0.75197273, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1420, 1442, 1568, 1375, 1396, 1330, 873, 777, 512, 1205, 228, 809], 'head_nums': [12, 11, 12, 12, 12, 11, 9, 8, 12, 9, 7, 4], 'pruned_params': 48298624, 'remaining_params': 36718976, 'pruned_model_sparsity': 0.5681014754591991, 'expected_sparsity': 0.56313, 'target_sparsity': 0.5869565217391304, 'step': 2350}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:33,  1.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:30,  2.04it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:27,  2.23it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:25,  2.39it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.68it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.77it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.77it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.80it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:16,  2.87it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  3.00it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.05it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.99it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.07it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.07it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.01it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.02it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.01it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.07it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.06it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.05it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.02it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.97it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.02it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  2.90it/s][A[INFO|trainer.py:570] 2024-04-28 21:24:20,022 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:24:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:24:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:24:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:24:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:24:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:24:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8986013986013986, 'combined_score': 0.8782222679281503, 'eval_loss': 0.66728145, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1361, 1381, 1505, 1312, 1338, 1271, 820, 773, 482, 1172, 223, 783], 'head_nums': [12, 11, 12, 12, 12, 11, 9, 8, 12, 9, 7, 4], 'pruned_params': 48989556, 'remaining_params': 36028044, 'pruned_model_sparsity': 0.5762284044715447, 'expected_sparsity': 0.57263, 'target_sparsity': 0.6, 'step': 2400}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.31it/s][A04/28/2024 21:24:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 2400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:36<00:09,  1.53it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.79it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.04it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:04,  2.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.34it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.52it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:03,  2.65it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.69it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.76it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.89it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.10it/s][A04/28/2024 21:24:26 - INFO - trainer.trainer_mod_2 - Epoch 20 finished. Took 41.59 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  21%|██        | 21/100 [14:54<55:42, 42.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.99it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.90it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.99it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.84it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:24:38,334 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:24:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:24:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:24:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:24:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:24:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:24:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8885191347753744, 'combined_score': 0.8621517242504323, 'eval_loss': 0.76135933, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1302, 1319, 1440, 1251, 1280, 1214, 770, 769, 455, 1138, 219, 757], 'head_nums': [12, 11, 12, 12, 12, 11, 9, 8, 12, 9, 7, 4], 'pruned_params': 49668232, 'remaining_params': 35349368, 'pruned_model_sparsity': 0.5842111750978621, 'expected_sparsity': 0.58155, 'target_sparsity': 0.6, 'step': 2450}


Iteration:  30%|███       | 35/115 [00:13<00:59,  1.34it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:36,  2.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:34,  2.20it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.67it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.77it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.82it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.85it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.05it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:19,  3.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:18,  3.06it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.03it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.02it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.05it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.06it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.08it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.01it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 21:24:56,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:24:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:24:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:24:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:24:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/28/2024 21:24:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:24:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8853046594982079, 'combined_score': 0.8642209572000843, 'eval_loss': 0.7281835, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1246, 1260, 1378, 1191, 1226, 1160, 725, 765, 433, 1103, 215, 730], 'head_nums': [12, 11, 12, 12, 12, 11, 9, 8, 12, 9, 7, 4], 'pruned_params': 50305544, 'remaining_params': 34712056, 'pruned_model_sparsity': 0.591707411171334, 'expected_sparsity': 0.59024, 'target_sparsity': 0.6, 'step': 2500}


Iteration:  74%|███████▍  | 85/115 [00:31<00:25,  1.18it/s][A04/28/2024 21:24:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 2500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:32<00:20,  1.41it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:16,  1.68it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:14,  1.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:12,  2.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.33it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.48it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.59it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.69it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.76it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.89it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.89it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.01it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.98it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.91it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.83it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.06it/s][A04/28/2024 21:25:08 - INFO - trainer.trainer_mod_2 - Epoch 21 finished. Took 41.78 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  22%|██▏       | 22/100 [15:36<54:47, 42.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.91it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.88it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:25:15,048 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:25:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:25:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:25:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:25:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:25:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:25:16 - INFO - trainer.trainer_mod_2 - Starting saving the best from epoch 22 and step 2550
04/28/2024 21:25:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8873949579831933, 'combined_score': 0.8615896358543418, 'eval_loss': 0.8082839, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1195, 1206, 1320, 1137, 1174, 1111, 688, 760, 413, 1069, 213, 706], 'head_nums': [12, 11, 12, 12, 12, 11, 9, 8, 12, 9, 7, 4], 'pruned_params': 50883108, 'remaining_params': 34134492, 'pruned_model_sparsity': 0.5985008751129178, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 2550}
04/28/2024 21:25:16 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 22 | Step: 2550 | Model size: 34134492 | Score: 0.83578]

[INFO|configuration_utils.py:439] 2024-04-28 21:25:16,438 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:25:19,341 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  17%|█▋        | 20/115 [00:11<02:33,  1.62s/it][A
Iteration:  18%|█▊        | 21/115 [00:11<01:56,  1.24s/it][A
Iteration:  19%|█▉        | 22/115 [00:11<01:29,  1.04it/s][A
Iteration:  20%|██        | 23/115 [00:12<01:11,  1.28it/s][A
Iteration:  21%|██        | 24/115 [00:12<00:58,  1.55it/s][A
Iteration:  22%|██▏       | 25/115 [00:12<00:49,  1.83it/s][A
Iteration:  23%|██▎       | 26/115 [00:13<00:42,  2.08it/s][A
Iteration:  23%|██▎       | 27/115 [00:13<00:38,  2.27it/s][A
Iteration:  24%|██▍       | 28/115 [00:13<00:35,  2.44it/s][A
Iteration:  25%|██▌       | 29/115 [00:14<00:33,  2.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:14<00:31,  2.71it/s][A
Iteration:  27%|██▋       | 31/115 [00:14<00:30,  2.77it/s][A
Iteration:  28%|██▊       | 32/115 [00:15<00:29,  2.83it/s][A
Iteration:  29%|██▊       | 33/115 [00:15<00:28,  2.84it/s][A
Iteration:  30%|██▉       | 34/115 [00:15<00:28,  2.89it/s][A
Iteration:  30%|███       | 35/115 [00:16<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:16<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:16<00:26,  2.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:17<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:17<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:17<00:24,  3.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:18<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:18<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:18<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:19<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:19<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:19<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:20<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:20<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:20<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:21<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:21<00:21,  2.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:21<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:22<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:22<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:22<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:23<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:23<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:23<00:18,  3.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:24<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:24<00:18,  3.00it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:17,  3.01it/s][A
Iteration:  54%|█████▍    | 62/115 [00:25<00:17,  3.03it/s][A
Iteration:  55%|█████▍    | 63/115 [00:25<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:26<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:17,  2.84it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:17,  2.74it/s][A
Iteration:  59%|█████▉    | 68/115 [00:27<00:16,  2.81it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:15,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 21:25:36,263 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:25:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:25:36 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:25:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:25:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:25:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:25:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8910891089108912, 'combined_score': 0.8646622015142691, 'eval_loss': 0.8002064, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1149, 1159, 1269, 1089, 1130, 1068, 665, 756, 397, 1037, 210, 682], 'head_nums': [12, 11, 12, 12, 12, 11, 9, 8, 11, 9, 7, 4], 'pruned_params': 52589756, 'remaining_params': 32427844, 'pruned_model_sparsity': 0.6185749303673592, 'expected_sparsity': 0.61207, 'target_sparsity': 0.6, 'step': 2600}
04/28/2024 21:25:37 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 22 | Step: 2600 | Model size: 32427844 | Score: 0.83824]

[INFO|configuration_utils.py:439] 2024-04-28 21:25:37,650 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:25:38,393 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  61%|██████    | 70/115 [00:30<00:44,  1.01it/s][A04/28/2024 21:25:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 2600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:30<00:34,  1.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:30<00:28,  1.53it/s][A
Iteration:  63%|██████▎   | 73/115 [00:31<00:23,  1.82it/s][A
Iteration:  64%|██████▍   | 74/115 [00:31<00:19,  2.07it/s][A
Iteration:  65%|██████▌   | 75/115 [00:31<00:17,  2.28it/s][A
Iteration:  66%|██████▌   | 76/115 [00:32<00:15,  2.45it/s][A
Iteration:  67%|██████▋   | 77/115 [00:32<00:14,  2.58it/s][A
Iteration:  68%|██████▊   | 78/115 [00:32<00:13,  2.71it/s][A
Iteration:  69%|██████▊   | 79/115 [00:33<00:12,  2.79it/s][A
Iteration:  70%|██████▉   | 80/115 [00:33<00:12,  2.85it/s][A
Iteration:  70%|███████   | 81/115 [00:33<00:11,  2.84it/s][A
Iteration:  71%|███████▏  | 82/115 [00:34<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:34<00:11,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:34<00:10,  3.00it/s][A
Iteration:  74%|███████▍  | 85/115 [00:35<00:09,  3.06it/s][A
Iteration:  75%|███████▍  | 86/115 [00:35<00:09,  3.10it/s][A
Iteration:  76%|███████▌  | 87/115 [00:35<00:09,  3.00it/s][A
Iteration:  77%|███████▋  | 88/115 [00:36<00:08,  3.01it/s][A
Iteration:  77%|███████▋  | 89/115 [00:36<00:08,  3.02it/s][A
Iteration:  78%|███████▊  | 90/115 [00:36<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:37<00:07,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:37<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:37<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:38<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:38<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:38<00:06,  2.84it/s][A
Iteration:  84%|████████▍ | 97/115 [00:39<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:39<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:39<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:40<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:40<00:04,  2.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:40<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:41<00:04,  2.81it/s][A
Iteration:  90%|█████████ | 104/115 [00:41<00:03,  2.87it/s][A
Iteration:  91%|█████████▏| 105/115 [00:41<00:03,  2.85it/s][A
Iteration:  92%|█████████▏| 106/115 [00:42<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:42<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:42<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:43<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:43<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 111/115 [00:43<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:44<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:44<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.89it/s][A
Iteration: 100%|██████████| 115/115 [00:45<00:00,  3.07it/s][A04/28/2024 21:25:53 - INFO - trainer.trainer_mod_2 - Epoch 22 finished. Took 45.22 seconds.
Iteration: 100%|██████████| 115/115 [00:45<00:00,  2.54it/s]
Epoch:  23%|██▎       | 23/100 [16:21<55:16, 43.07s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.24it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 21:25:55,151 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:25:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:25:55 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:25:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:25:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:25:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:25:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8934010152284263, 'combined_score': 0.869494625261272, 'eval_loss': 0.70765424, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1111, 1119, 1227, 1050, 1093, 1030, 656, 752, 385, 1007, 207, 662], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 10, 9, 7, 4], 'pruned_params': 53363416, 'remaining_params': 31654184, 'pruned_model_sparsity': 0.627674928485396, 'expected_sparsity': 0.62106, 'target_sparsity': 0.6, 'step': 2650}
04/28/2024 21:25:56 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 23 | Step: 2650 | Model size: 31654184 | Score: 0.84559]

[INFO|configuration_utils.py:439] 2024-04-28 21:25:56,537 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:25:57,850 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:   4%|▍         | 5/115 [00:04<02:22,  1.30s/it][A
Iteration:   5%|▌         | 6/115 [00:04<01:45,  1.03it/s][A
Iteration:   6%|▌         | 7/115 [00:04<01:21,  1.32it/s][A
Iteration:   7%|▋         | 8/115 [00:05<01:06,  1.61it/s][A
Iteration:   8%|▊         | 9/115 [00:05<00:56,  1.89it/s][A
Iteration:   9%|▊         | 10/115 [00:05<00:49,  2.13it/s][A
Iteration:  10%|▉         | 11/115 [00:06<00:45,  2.29it/s][A
Iteration:  10%|█         | 12/115 [00:06<00:41,  2.47it/s][A
Iteration:  11%|█▏        | 13/115 [00:06<00:38,  2.62it/s][A
Iteration:  12%|█▏        | 14/115 [00:07<00:37,  2.70it/s][A
Iteration:  13%|█▎        | 15/115 [00:07<00:36,  2.73it/s][A
Iteration:  14%|█▍        | 16/115 [00:08<00:35,  2.81it/s][A
Iteration:  15%|█▍        | 17/115 [00:08<00:34,  2.88it/s][A
Iteration:  16%|█▌        | 18/115 [00:08<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:09<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 20/115 [00:09<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:09<00:31,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:10<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:10<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:10<00:31,  2.85it/s][A
Iteration:  22%|██▏       | 25/115 [00:11<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 26/115 [00:11<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:12<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:12<00:28,  3.01it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:28,  3.02it/s][A
Iteration:  27%|██▋       | 31/115 [00:13<00:27,  3.03it/s][A
Iteration:  28%|██▊       | 32/115 [00:13<00:27,  3.00it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:14<00:27,  2.98it/s][A
Iteration:  30%|███       | 35/115 [00:14<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:26,  2.99it/s][A
Iteration:  32%|███▏      | 37/115 [00:15<00:25,  3.06it/s][A
Iteration:  33%|███▎      | 38/115 [00:15<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.84it/s][A
Iteration:  35%|███▍      | 40/115 [00:16<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:16<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:17<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:18<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:19<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:21,  2.95it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:20<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:20,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:26:14,674 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:26:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:26:14 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:26:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:26:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:26:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:26:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8972602739726027, 'combined_score': 0.8751007252215954, 'eval_loss': 0.77777225, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1080, 1086, 1191, 1016, 1061, 998, 652, 748, 376, 981, 205, 643], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 10, 9, 7, 4], 'pruned_params': 53683604, 'remaining_params': 31333996, 'pruned_model_sparsity': 0.6314410663203854, 'expected_sparsity': 0.62723, 'target_sparsity': 0.6, 'step': 2700}
04/28/2024 21:26:16 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 23 | Step: 2700 | Model size: 31333996 | Score: 0.85294]

[INFO|configuration_utils.py:439] 2024-04-28 21:26:16,057 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:26:16,755 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  48%|████▊     | 55/115 [00:23<00:57,  1.04it/s][A04/28/2024 21:26:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 2700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:23<00:45,  1.29it/s][A
Iteration:  50%|████▉     | 57/115 [00:23<00:37,  1.56it/s][A
Iteration:  50%|█████     | 58/115 [00:24<00:31,  1.81it/s][A
Iteration:  51%|█████▏    | 59/115 [00:24<00:26,  2.09it/s][A
Iteration:  52%|█████▏    | 60/115 [00:24<00:23,  2.31it/s][A
Iteration:  53%|█████▎    | 61/115 [00:25<00:21,  2.52it/s][A
Iteration:  54%|█████▍    | 62/115 [00:25<00:20,  2.64it/s][A
Iteration:  55%|█████▍    | 63/115 [00:25<00:18,  2.74it/s][A
Iteration:  56%|█████▌    | 64/115 [00:26<00:18,  2.80it/s][A
Iteration:  57%|█████▋    | 65/115 [00:26<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:27<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:27<00:15,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:28<00:15,  2.89it/s][A
Iteration:  62%|██████▏   | 71/115 [00:28<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:14,  2.91it/s][A
Iteration:  63%|██████▎   | 73/115 [00:29<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:29<00:13,  3.01it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:13,  3.02it/s][A
Iteration:  66%|██████▌   | 76/115 [00:30<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:31<00:12,  2.98it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:11,  3.06it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  3.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:32<00:11,  2.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:11,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:33<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:09,  2.92it/s][A
Iteration:  76%|███████▌  | 87/115 [00:34<00:10,  2.79it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.76it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:35<00:08,  2.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.86it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:36<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.93it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:37<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:38<00:05,  3.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:39<00:04,  3.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:26:33,645 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:26:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:26:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:26:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:26:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:26:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:26:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8981001727115717, 'combined_score': 0.8767461647871584, 'eval_loss': 0.7676363, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1054, 1059, 1162, 990, 1035, 972, 649, 745, 368, 959, 204, 628], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 10, 9, 7, 4], 'pruned_params': 53942512, 'remaining_params': 31075088, 'pruned_model_sparsity': 0.6344864122252334, 'expected_sparsity': 0.63201, 'target_sparsity': 0.6, 'step': 2750}
04/28/2024 21:26:35 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 23 | Step: 2750 | Model size: 31075088 | Score: 0.85539]

[INFO|configuration_utils.py:439] 2024-04-28 21:26:35,030 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:26:35,696 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  91%|█████████▏| 105/115 [00:42<00:09,  1.05it/s][A
Iteration:  92%|█████████▏| 106/115 [00:42<00:06,  1.31it/s][A
Iteration:  93%|█████████▎| 107/115 [00:42<00:05,  1.58it/s][A
Iteration:  94%|█████████▍| 108/115 [00:43<00:03,  1.83it/s][A
Iteration:  95%|█████████▍| 109/115 [00:43<00:02,  2.08it/s][A
Iteration:  96%|█████████▌| 110/115 [00:43<00:02,  2.30it/s][A
Iteration:  97%|█████████▋| 111/115 [00:44<00:01,  2.40it/s][A
Iteration:  97%|█████████▋| 112/115 [00:44<00:01,  2.55it/s][A
Iteration:  98%|█████████▊| 113/115 [00:44<00:00,  2.63it/s][A
Iteration:  99%|█████████▉| 114/115 [00:45<00:00,  2.75it/s][A
Iteration: 100%|██████████| 115/115 [00:45<00:00,  3.02it/s][A04/28/2024 21:26:39 - INFO - trainer.trainer_mod_2 - Epoch 23 finished. Took 45.47 seconds.
Iteration: 100%|██████████| 115/115 [00:45<00:00,  2.53it/s]
Epoch:  24%|██▍       | 24/100 [17:06<55:28, 43.79s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.06it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.81it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.86it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.79it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.99it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.01it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 21:26:52,574 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:26:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:26:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:26:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:26:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:26:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:26:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8854700854700854, 'combined_score': 0.8606271995977879, 'eval_loss': 0.7875942, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1033, 1038, 1138, 968, 1014, 952, 648, 742, 362, 940, 203, 615], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 7, 4], 'pruned_params': 54543056, 'remaining_params': 30474544, 'pruned_model_sparsity': 0.6415501731406204, 'expected_sparsity': 0.63604, 'target_sparsity': 0.6, 'step': 2800}


Iteration:  35%|███▍      | 40/115 [00:14<00:55,  1.34it/s][A04/28/2024 21:26:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 2800, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.61it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.08it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:31,  2.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.45it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.59it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.72it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.97it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.04it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.09it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.03it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.95it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.99it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.07it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.03it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.08it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.08it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.06it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 21:27:10,683 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:27:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:27:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:27:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:27:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/28/2024 21:27:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:27:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8924162257495591, 'combined_score': 0.8714532109139952, 'eval_loss': 0.7004052, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1019, 1024, 1121, 953, 999, 938, 647, 740, 358, 925, 202, 605], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 7, 4], 'pruned_params': 54687064, 'remaining_params': 30330536, 'pruned_model_sparsity': 0.6432440341764529, 'expected_sparsity': 0.63867, 'target_sparsity': 0.6, 'step': 2850}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.34it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:14,  1.60it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.06it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.29it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.50it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.65it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.75it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:06,  2.81it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.73it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.82it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.90it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.91it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.02it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.16it/s][A04/28/2024 21:27:20 - INFO - trainer.trainer_mod_2 - Epoch 24 finished. Took 41.47 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  25%|██▌       | 25/100 [17:48<53:52, 43.10s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.12it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.04it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.10it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.88it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.90it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.94it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.83it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.79it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.84it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:33,  2.74it/s][A[INFO|trainer.py:570] 2024-04-28 21:27:29,097 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:27:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:27:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:27:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:27:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:27:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:27:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8888888888888888, 'combined_score': 0.863562091503268, 'eval_loss': 0.8083006, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1009, 1013, 1109, 942, 988, 928, 646, 738, 355, 914, 202, 597], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 6, 4], 'pruned_params': 54791240, 'remaining_params': 30226360, 'pruned_model_sparsity': 0.6444693804576934, 'expected_sparsity': 0.64022, 'target_sparsity': 0.6, 'step': 2900}


Iteration:  22%|██▏       | 25/115 [00:09<01:09,  1.30it/s][A04/28/2024 21:27:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 2900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:56,  1.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.83it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:42,  2.07it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:39,  2.18it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.38it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:33,  2.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.67it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.75it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.84it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.90it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.91it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:21,  3.09it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.06it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.04it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.02it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.02it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:17,  3.13it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.10it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.06it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.01it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.00it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.96it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:27:47,171 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:27:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:27:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:27:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:27:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:27:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:27:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8851913477537438, 'combined_score': 0.8580368503474601, 'eval_loss': 0.9093167, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1004, 1008, 1103, 936, 984, 923, 646, 737, 354, 907, 202, 592], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 6, 4], 'pruned_params': 54840264, 'remaining_params': 30177336, 'pruned_model_sparsity': 0.6450460140018067, 'expected_sparsity': 0.64096, 'target_sparsity': 0.6, 'step': 2950}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.33it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.60it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.15it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:13,  2.54it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.72it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.81it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.84it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  3.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.02it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.01it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.85it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.89it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.88it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.90it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.01it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.25it/s][A04/28/2024 21:28:01 - INFO - trainer.trainer_mod_2 - Epoch 25 finished. Took 41.35 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.78it/s]
Epoch:  26%|██▌       | 26/100 [18:29<52:30, 42.57s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.03it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.75it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:28:05,220 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:28:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:28:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:28:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:28:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:28:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:28:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8934010152284263, 'combined_score': 0.869494625261272, 'eval_loss': 0.8211785, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1004, 1008, 1103, 935, 983, 923, 645, 737, 354, 904, 202, 590], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 6, 4], 'pruned_params': 54843328, 'remaining_params': 30174272, 'pruned_model_sparsity': 0.6450820535983137, 'expected_sparsity': 0.641, 'target_sparsity': 0.6, 'step': 3000}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.31it/s][A04/28/2024 21:28:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 3000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:05,  1.59it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:48,  2.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:43,  2.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:40,  2.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.66it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.77it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:34,  2.72it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.81it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.88it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.90it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.89it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.00it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.94it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.93it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.85it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.89it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.88it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.02it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.04it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.02it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.08it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.99it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.00it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  3.00it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:28:23,446 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:28:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:28:23 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:28:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:28:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:28:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:28:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8884955752212389, 'combined_score': 0.8670419052576783, 'eval_loss': 0.76762897, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1009, 1013, 1108, 939, 988, 927, 646, 737, 356, 905, 204, 590], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 6, 4], 'pruned_params': 54794304, 'remaining_params': 30223296, 'pruned_model_sparsity': 0.6445054200542005, 'expected_sparsity': 0.64029, 'target_sparsity': 0.6, 'step': 3050}


Iteration:  52%|█████▏    | 60/115 [00:22<00:40,  1.35it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.62it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:24,  2.14it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:21,  2.32it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.49it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:18,  2.60it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.71it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.81it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.88it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.01it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.04it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  3.04it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.01it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.01it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.02it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.01it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.96it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.04it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.81it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.93it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:28:41,595 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:28:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:28:41 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:28:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:28:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/28/2024 21:28:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:28:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8842105263157894, 'combined_score': 0.8612229102167183, 'eval_loss': 0.8598395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1019, 1024, 1119, 948, 998, 936, 646, 738, 362, 910, 212, 594], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 7, 4], 'pruned_params': 54680936, 'remaining_params': 30336664, 'pruned_model_sparsity': 0.6431719549834387, 'expected_sparsity': 0.63835, 'target_sparsity': 0.6, 'step': 3100}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.33it/s][A04/28/2024 21:28:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 3100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  1.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.10it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.32it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.63it/s][A04/28/2024 21:28:44 - INFO - trainer.trainer_mod_2 - Epoch 26 finished. Took 42.73 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.69it/s]
Epoch:  27%|██▋       | 27/100 [19:12<51:51, 42.62s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.03it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.04it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.09it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.07it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.88it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.89it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.86it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.89it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.81it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:35,  2.73it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.81it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.81it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.86it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.05it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.05it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.05it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.00it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.02it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.04it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:28:59,752 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:28:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:28:59 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:28:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:28:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:29:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:29:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.888135593220339, 'combined_score': 0.863185443668993, 'eval_loss': 0.8623328, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1033, 1038, 1135, 962, 1011, 950, 647, 740, 373, 920, 228, 601], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 7, 4], 'pruned_params': 54509352, 'remaining_params': 30508248, 'pruned_model_sparsity': 0.6411537375790425, 'expected_sparsity': 0.6353, 'target_sparsity': 0.6, 'step': 3150}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.35it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:42,  1.62it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:31,  2.11it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:28,  2.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:25,  2.50it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.63it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:23,  2.73it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.78it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.87it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.79it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.86it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.90it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.06it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.02it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  3.00it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.01it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.04it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.03it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.02it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.99it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.05it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.00it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:29:17,916 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:29:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:29:17 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:29:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:29:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.74it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 21:29:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:29:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8946459412780656, 'combined_score': 0.8725680686782484, 'eval_loss': 0.7547099, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1052, 1058, 1156, 981, 1029, 969, 648, 743, 390, 936, 256, 611], 'head_nums': [12, 11, 11, 12, 12, 10, 9, 8, 9, 9, 7, 4], 'pruned_params': 54262700, 'remaining_params': 30754900, 'pruned_model_sparsity': 0.6382525500602229, 'expected_sparsity': 0.63045, 'target_sparsity': 0.6, 'step': 3200}


Iteration:  83%|████████▎ | 95/115 [00:34<00:15,  1.33it/s][A04/28/2024 21:29:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 3200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:35<00:11,  1.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:08,  2.09it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.29it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.48it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:05,  2.61it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.72it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.86it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.89it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.88it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.12it/s][A04/28/2024 21:29:25 - INFO - trainer.trainer_mod_2 - Epoch 27 finished. Took 41.35 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.78it/s]
Epoch:  28%|██▊       | 28/100 [19:53<50:41, 42.24s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  3.00it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.02it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  3.00it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.01it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.02it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:29:35,970 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:29:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:29:35 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:29:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:29:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:29:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:29:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8957264957264958, 'combined_score': 0.8731083459024636, 'eval_loss': 0.8401924, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1075, 1082, 1181, 1004, 1052, 992, 650, 747, 415, 959, 305, 625], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 7, 4], 'pruned_params': 53737224, 'remaining_params': 31280376, 'pruned_model_sparsity': 0.6320717592592593, 'expected_sparsity': 0.62292, 'target_sparsity': 0.6, 'step': 3250}


Iteration:  26%|██▌       | 30/115 [00:11<01:03,  1.33it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:52,  1.60it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:34,  2.33it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:31,  2.56it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:29,  2.68it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:28,  2.75it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.77it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.85it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.84it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.90it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.83it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.77it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.82it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.87it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.72it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.79it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.78it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.83it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.87it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.77it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.98it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.05it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:29:54,426 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:29:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:29:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:29:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:29:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:29:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:29:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8926746166950595, 'combined_score': 0.8691314259945886, 'eval_loss': 0.8271731, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1102, 1107, 1208, 1030, 1078, 1019, 652, 754, 450, 991, 392, 644], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 9, 10, 10, 7, 4], 'pruned_params': 52719976, 'remaining_params': 32297624, 'pruned_model_sparsity': 0.6201066132189099, 'expected_sparsity': 0.61054, 'target_sparsity': 0.6, 'step': 3300}


Iteration:  70%|██████▉   | 80/115 [00:29<00:26,  1.33it/s][A04/28/2024 21:29:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 3300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:15,  2.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.44it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:11,  2.57it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.66it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.73it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.81it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.87it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.06it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.06it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.02it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.03it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.06it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.99it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.83it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  3.00it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.99it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.20it/s][A04/28/2024 21:30:07 - INFO - trainer.trainer_mod_2 - Epoch 28 finished. Took 41.57 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  29%|██▉       | 29/100 [20:35<49:44, 42.04s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.77it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.80it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.81it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.87it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.84it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:30:12,631 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:30:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:30:12 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:30:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:30:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:30:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:30:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8991452991452993, 'combined_score': 0.8772687280040221, 'eval_loss': 0.6876391, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1128, 1133, 1235, 1055, 1102, 1045, 655, 765, 496, 1031, 539, 667], 'head_nums': [12, 11, 11, 12, 12, 11, 10, 9, 10, 10, 7, 4], 'pruned_params': 50619604, 'remaining_params': 34397996, 'pruned_model_sparsity': 0.5954014698133092, 'expected_sparsity': 0.59217, 'target_sparsity': 0.6, 'step': 3350}


Iteration:  13%|█▎        | 15/115 [00:06<01:15,  1.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:52,  1.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.11it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:41,  2.32it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.45it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:36,  2.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.60it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.69it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.77it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.90it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.93it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.02it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.99it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.05it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.05it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.98it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.89it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.86it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.87it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.81it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 21:30:30,966 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:30:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:30:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:30:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:30:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:30:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:30:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8957264957264958, 'combined_score': 0.8731083459024636, 'eval_loss': 0.7485885, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1148, 1152, 1256, 1073, 1120, 1064, 658, 778, 543, 1071, 716, 688], 'head_nums': [12, 11, 11, 12, 12, 11, 10, 9, 10, 11, 7, 4], 'pruned_params': 49904160, 'remaining_params': 35113440, 'pruned_model_sparsity': 0.586986224028907, 'expected_sparsity': 0.57464, 'target_sparsity': 0.6, 'step': 3400}


Iteration:  57%|█████▋    | 65/115 [00:24<00:38,  1.32it/s][A04/28/2024 21:30:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 3400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.82it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.06it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.22it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.40it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.64it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.74it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.80it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.06it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.04it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.03it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.04it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.03it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  3.04it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.01it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.92it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.96it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.97it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.03it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.83it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.77it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.84it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.83it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.85it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.79it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 21:30:49,247 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:30:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:30:49 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:30:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:30:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:30:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:30:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8989547038327526, 'combined_score': 0.8783989205438272, 'eval_loss': 0.6958958, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1159, 1163, 1267, 1084, 1130, 1075, 660, 786, 570, 1093, 820, 699], 'head_nums': [12, 11, 11, 12, 12, 11, 10, 10, 10, 11, 8, 4], 'pruned_params': 49211696, 'remaining_params': 35805904, 'pruned_model_sparsity': 0.5788412752183077, 'expected_sparsity': 0.56559, 'target_sparsity': 0.6, 'step': 3450}
04/28/2024 21:30:50 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 30 | Step: 3450 | Model size: 35805904 | Score: 0.85784]

[INFO|configuration_utils.py:439] 2024-04-28 21:30:50,634 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:30:51,284 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.07it/s][A04/28/2024 21:30:51 - INFO - trainer.trainer_mod_2 - Epoch 29 finished. Took 43.81 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.63it/s]
Epoch:  30%|███       | 30/100 [21:19<49:39, 42.57s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.84it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.89it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.83it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.82it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.00it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.00it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.00it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.95it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.96it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.94it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:31:08,220 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:31:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:31:08 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:31:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:31:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:31:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:31:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.896551724137931, 'combined_score': 0.8747464503042597, 'eval_loss': 0.7068942, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1161, 1164, 1268, 1084, 1131, 1076, 659, 785, 567, 1088, 802, 697], 'head_nums': [12, 12, 11, 12, 12, 11, 10, 9, 10, 11, 7, 4], 'pruned_params': 49430772, 'remaining_params': 35586828, 'pruned_model_sparsity': 0.5814181063685637, 'expected_sparsity': 0.56613, 'target_sparsity': 0.6, 'step': 3500}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.34it/s][A04/28/2024 21:31:09 - INFO - trainer.trainer_mod_2 - v4 Global step: 3500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:33,  1.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.31it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:24,  2.49it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.62it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.74it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.95it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.98it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.81it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.82it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.76it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:13,  2.82it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:13,  2.76it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.80it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.02it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.87it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 21:31:26,686 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:31:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:31:26 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:31:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:31:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:31:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:31:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8904347826086957, 'combined_score': 0.8680115089514067, 'eval_loss': 0.745131, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1158, 1160, 1265, 1079, 1126, 1071, 658, 777, 543, 1064, 701, 686], 'head_nums': [12, 11, 11, 12, 12, 11, 10, 9, 10, 11, 7, 4], 'pruned_params': 49856668, 'remaining_params': 35160932, 'pruned_model_sparsity': 0.5864276102830472, 'expected_sparsity': 0.57338, 'target_sparsity': 0.6, 'step': 3550}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.07it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.49it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.54it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.66it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.73it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.76it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.78it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.88it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.89it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.12it/s][A04/28/2024 21:31:33 - INFO - trainer.trainer_mod_2 - Epoch 30 finished. Took 41.88 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  31%|███       | 31/100 [22:00<48:43, 42.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.99it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.99it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.05it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.02it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.03it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.05it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.99it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.03it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.06it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.80it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.85it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:29,  2.83it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:31:45,027 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:31:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:31:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:31:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:31:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:31:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:31:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8888888888888888, 'combined_score': 0.8672385620915033, 'eval_loss': 0.73303145, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1151, 1153, 1258, 1072, 1118, 1062, 656, 767, 513, 1035, 582, 672], 'head_nums': [12, 11, 11, 12, 12, 11, 10, 9, 10, 11, 7, 4], 'pruned_params': 50153876, 'remaining_params': 34863724, 'pruned_model_sparsity': 0.5899234511442336, 'expected_sparsity': 0.58278, 'target_sparsity': 0.6, 'step': 3600}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.33it/s][A04/28/2024 21:31:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 3600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:36,  2.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.30it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.47it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.61it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.71it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:26,  2.76it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.82it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.85it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.96it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.95it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:21,  2.78it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.81it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.91it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.83it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.99it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.01it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.95it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.97it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.89it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.95it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:32:03,334 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:32:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:32:03 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:32:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:32:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:32:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:32:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8877374784110534, 'combined_score': 0.8642118764604287, 'eval_loss': 0.7890789, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1144, 1146, 1250, 1065, 1111, 1054, 654, 759, 487, 1009, 486, 660], 'head_nums': [12, 11, 11, 12, 12, 11, 10, 9, 10, 10, 7, 4], 'pruned_params': 50604284, 'remaining_params': 34413316, 'pruned_model_sparsity': 0.5952212718307739, 'expected_sparsity': 0.59121, 'target_sparsity': 0.6, 'step': 3650}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:12,  2.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.26it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.64it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.73it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.73it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.87it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.87it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.79it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.17it/s][A04/28/2024 21:32:14 - INFO - trainer.trainer_mod_2 - Epoch 31 finished. Took 41.72 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  32%|███▏      | 32/100 [22:42<47:47, 42.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.81it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.07it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.03it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:32,  3.04it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.02it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 21:32:21,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:32:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:32:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:32:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:32:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:32:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:32:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8919382504288165, 'combined_score': 0.8687632428614671, 'eval_loss': 0.8028053, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1137, 1139, 1244, 1058, 1106, 1047, 652, 752, 468, 988, 421, 650], 'head_nums': [12, 11, 11, 12, 12, 11, 10, 9, 10, 10, 7, 4], 'pruned_params': 50792720, 'remaining_params': 34224880, 'pruned_model_sparsity': 0.597437707015959, 'expected_sparsity': 0.59786, 'target_sparsity': 0.6, 'step': 3700}


Iteration:  17%|█▋        | 20/115 [00:08<01:10,  1.34it/s][A04/28/2024 21:32:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 3700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:58,  1.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:49,  1.86it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:43,  2.11it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.31it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.49it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:33,  2.63it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.74it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.81it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.86it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.89it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.90it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:26,  3.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.03it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.93it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.93it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.93it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.81it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.90it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.89it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.87it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:21,  2.85it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.85it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.95it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.02it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:32:39,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:32:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:32:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:32:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:32:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:32:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:32:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8939130434782607, 'combined_score': 0.872201619778346, 'eval_loss': 0.7127409, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1132, 1134, 1239, 1052, 1100, 1041, 651, 747, 453, 973, 378, 642], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51520420, 'remaining_params': 33497180, 'pruned_model_sparsity': 0.6059971111863897, 'expected_sparsity': 0.60283, 'target_sparsity': 0.6, 'step': 3750}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.59it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:22,  1.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.12it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:17,  2.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:15,  2.51it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:14,  2.71it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.81it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.84it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.01it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.03it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.05it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.80it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.95it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.96it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.98it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.97it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.98it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.93it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.90it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.99it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.24it/s][A04/28/2024 21:32:56 - INFO - trainer.trainer_mod_2 - Epoch 32 finished. Took 41.5 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  33%|███▎      | 33/100 [23:24<46:51, 41.97s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.85it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:42,  2.67it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.78it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 21:32:58,136 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:32:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:32:58 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:32:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:32:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:32:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:32:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8958333333333334, 'combined_score': 0.8743872549019608, 'eval_loss': 0.73642343, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1129, 1131, 1236, 1048, 1097, 1037, 651, 745, 444, 962, 351, 637], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51606212, 'remaining_params': 33411388, 'pruned_model_sparsity': 0.6070062198885878, 'expected_sparsity': 0.606, 'target_sparsity': 0.6, 'step': 3800}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A04/28/2024 21:32:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 3800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.79it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.06it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:46,  2.28it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:42,  2.46it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:39,  2.65it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:37,  2.74it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:36,  2.81it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.82it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.85it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.86it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:31,  3.01it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.90it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.91it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.02it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.95it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.01it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.08it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.03it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.06it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:22,  3.11it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.07it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.88it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 21:33:16,358 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:33:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:33:16 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:33:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:33:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/28/2024 21:33:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:33:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8983050847457628, 'combined_score': 0.8756231306081754, 'eval_loss': 0.84999526, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1129, 1131, 1236, 1047, 1095, 1035, 650, 744, 439, 955, 336, 634], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 53017184, 'remaining_params': 32000416, 'pruned_model_sparsity': 0.6236024540800964, 'expected_sparsity': 0.60752, 'target_sparsity': 0.6, 'step': 3850}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.56it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.85it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.30it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.49it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:20,  2.61it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.68it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.78it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.85it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.89it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  2.95it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.96it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.92it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.94it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.99it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.99it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.05it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.03it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.06it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.01it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.02it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.82it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.86it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.91it/s][A[INFO|trainer.py:570] 2024-04-28 21:33:34,629 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:33:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:33:34 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:33:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:33:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 21:33:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:33:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.897391304347826, 'combined_score': 0.8763917306052855, 'eval_loss': 0.78316903, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1130, 1132, 1238, 1048, 1096, 1035, 650, 743, 437, 952, 330, 632], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 53020248, 'remaining_params': 31997352, 'pruned_model_sparsity': 0.6236384936766034, 'expected_sparsity': 0.60768, 'target_sparsity': 0.6, 'step': 3900}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.31it/s][A04/28/2024 21:33:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 3900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:39<00:05,  1.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.29it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.54it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.66it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.76it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.83it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.09it/s][A04/28/2024 21:33:39 - INFO - trainer.trainer_mod_2 - Epoch 33 finished. Took 42.92 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.68it/s]
Epoch:  34%|███▍      | 34/100 [24:07<46:28, 42.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.05it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.10it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.05it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.04it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.02it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  3.01it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.02it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:31,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.04it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.06it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.05it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.03it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:27,  3.03it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:26,  3.01it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.00it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:25,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 21:33:52,643 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:33:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:33:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:33:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:33:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:33:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:33:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8986486486486487, 'combined_score': 0.8757949125596185, 'eval_loss': 0.7185671, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1133, 1136, 1242, 1050, 1099, 1038, 650, 743, 438, 953, 330, 632], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51616936, 'remaining_params': 33400664, 'pruned_model_sparsity': 0.6071323584763625, 'expected_sparsity': 0.60698, 'target_sparsity': 0.6, 'step': 3950}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:30,  2.30it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.37it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:27,  2.51it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.69it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.78it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.87it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.95it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.97it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.87it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.02it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.02it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.91it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.89it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.95it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.94it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:34:10,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:34:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:34:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:34:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:34:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:34:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:34:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8943661971830987, 'combined_score': 0.8736536868268434, 'eval_loss': 0.6864711, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1137, 1140, 1246, 1053, 1103, 1042, 650, 744, 441, 955, 336, 633], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51567912, 'remaining_params': 33449688, 'pruned_model_sparsity': 0.6065557249322493, 'expected_sparsity': 0.60529, 'target_sparsity': 0.6, 'step': 4000}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.33it/s][A04/28/2024 21:34:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 4000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:33<00:14,  1.60it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.86it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.03it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:08,  2.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.52it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.63it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:06,  2.64it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.72it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.77it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.82it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.84it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:04,  2.71it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.82it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.87it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.91it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.12it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  3.09it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.12it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.34it/s][A04/28/2024 21:34:20 - INFO - trainer.trainer_mod_2 - Epoch 34 finished. Took 41.44 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.78it/s]
Epoch:  35%|███▌      | 35/100 [24:48<45:30, 42.01s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.04it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.03it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.02it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.03it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.02it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.02it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.99it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.05it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:30,  3.02it/s][A[INFO|trainer.py:570] 2024-04-28 21:34:29,078 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:34:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:34:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:34:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:34:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:34:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:34:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8989547038327526, 'combined_score': 0.8783989205438272, 'eval_loss': 0.68646336, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1142, 1145, 1252, 1057, 1107, 1047, 651, 745, 446, 959, 345, 635], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.6031, 'target_sparsity': 0.6, 'step': 4050}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.34it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.61it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.85it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:40,  2.13it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:36,  2.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:33,  2.50it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:31,  2.63it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.73it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.82it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.87it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.89it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.03it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.02it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.94it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.02it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.02it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.05it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.06it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.00it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.98it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.82it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.72it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.80it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.82it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.03it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.04it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 21:34:47,256 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:34:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:34:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:34:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:34:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:34:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:34:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8979591836734693, 'combined_score': 0.8754501800720287, 'eval_loss': 0.74438775, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1147, 1150, 1258, 1061, 1111, 1052, 652, 747, 451, 964, 355, 637], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51434628, 'remaining_params': 33582972, 'pruned_model_sparsity': 0.6049880024841915, 'expected_sparsity': 0.60065, 'target_sparsity': 0.6, 'step': 4100}


Iteration:  65%|██████▌   | 75/115 [00:27<00:29,  1.35it/s][A04/28/2024 21:34:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 4100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:21,  1.81it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:18,  2.04it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:14,  2.45it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:13,  2.57it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.66it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.76it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.88it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.89it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.83it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.01it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.04it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.00it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.17it/s][A04/28/2024 21:35:02 - INFO - trainer.trainer_mod_2 - Epoch 35 finished. Took 41.39 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.78it/s]
Epoch:  36%|███▌      | 36/100 [25:29<44:36, 41.82s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.92it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.02it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.02it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:35:05,466 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:35:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:35:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:35:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:35:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:35:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:35:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9028960817717206, 'combined_score': 0.8815950997093898, 'eval_loss': 0.7468338, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1151, 1155, 1263, 1065, 1116, 1056, 652, 749, 455, 967, 363, 638], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51374880, 'remaining_params': 33642720, 'pruned_model_sparsity': 0.6042852303523035, 'expected_sparsity': 0.59846, 'target_sparsity': 0.6, 'step': 4150}
04/28/2024 21:35:06 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 36 | Step: 4150 | Model size: 33642720 | Score: 0.86029]

[INFO|configuration_utils.py:439] 2024-04-28 21:35:06,855 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:35:08,147 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:   9%|▊         | 10/115 [00:06<02:01,  1.16s/it][A
Iteration:  10%|▉         | 11/115 [00:06<01:34,  1.10it/s][A
Iteration:  10%|█         | 12/115 [00:06<01:15,  1.36it/s][A
Iteration:  11%|█▏        | 13/115 [00:07<01:02,  1.63it/s][A
Iteration:  12%|█▏        | 14/115 [00:07<00:53,  1.87it/s][A
Iteration:  13%|█▎        | 15/115 [00:07<00:47,  2.09it/s][A
Iteration:  14%|█▍        | 16/115 [00:08<00:44,  2.21it/s][A
Iteration:  15%|█▍        | 17/115 [00:08<00:40,  2.41it/s][A
Iteration:  16%|█▌        | 18/115 [00:08<00:38,  2.49it/s][A
Iteration:  17%|█▋        | 19/115 [00:09<00:36,  2.64it/s][A
Iteration:  17%|█▋        | 20/115 [00:09<00:35,  2.70it/s][A
Iteration:  18%|█▊        | 21/115 [00:09<00:34,  2.76it/s][A
Iteration:  19%|█▉        | 22/115 [00:10<00:33,  2.80it/s][A
Iteration:  20%|██        | 23/115 [00:10<00:32,  2.86it/s][A
Iteration:  21%|██        | 24/115 [00:10<00:31,  2.90it/s][A
Iteration:  22%|██▏       | 25/115 [00:11<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:11<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:12<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:12<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:27,  3.06it/s][A
Iteration:  27%|██▋       | 31/115 [00:13<00:27,  3.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:13<00:27,  3.03it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:14<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:14<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.90it/s][A
Iteration:  32%|███▏      | 37/115 [00:15<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:15<00:26,  2.87it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.89it/s][A
Iteration:  35%|███▍      | 40/115 [00:16<00:25,  2.93it/s][A
Iteration:  36%|███▌      | 41/115 [00:16<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:24,  2.93it/s][A
Iteration:  37%|███▋      | 43/115 [00:17<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:18<00:23,  2.99it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.88it/s][A
Iteration:  43%|████▎     | 49/115 [00:19<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:20<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:21<00:21,  2.80it/s][A
Iteration:  48%|████▊     | 55/115 [00:21<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.91it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.82it/s][A[INFO|trainer.py:570] 2024-04-28 21:35:25,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:35:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:35:25 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:35:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:35:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:35:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:35:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.69887286, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1154, 1159, 1267, 1068, 1119, 1059, 652, 749, 457, 968, 365, 638], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51338112, 'remaining_params': 33679488, 'pruned_model_sparsity': 0.6038527551942187, 'expected_sparsity': 0.5973, 'target_sparsity': 0.6, 'step': 4200}
04/28/2024 21:35:26 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 36 | Step: 4200 | Model size: 33679488 | Score: 0.86765]

[INFO|configuration_utils.py:439] 2024-04-28 21:35:26,638 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:35:27,286 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  52%|█████▏    | 60/115 [00:25<00:52,  1.05it/s][A04/28/2024 21:35:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 4200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:25<00:41,  1.30it/s][A
Iteration:  54%|█████▍    | 62/115 [00:25<00:33,  1.57it/s][A
Iteration:  55%|█████▍    | 63/115 [00:26<00:28,  1.81it/s][A
Iteration:  56%|█████▌    | 64/115 [00:26<00:24,  2.05it/s][A
Iteration:  57%|█████▋    | 65/115 [00:26<00:22,  2.27it/s][A
Iteration:  57%|█████▋    | 66/115 [00:27<00:19,  2.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:27<00:18,  2.57it/s][A
Iteration:  59%|█████▉    | 68/115 [00:27<00:17,  2.67it/s][A
Iteration:  60%|██████    | 69/115 [00:28<00:16,  2.74it/s][A
Iteration:  61%|██████    | 70/115 [00:28<00:15,  2.85it/s][A
Iteration:  62%|██████▏   | 71/115 [00:28<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:29<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:29<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:29<00:13,  3.04it/s][A
Iteration:  65%|██████▌   | 75/115 [00:30<00:13,  3.03it/s][A
Iteration:  66%|██████▌   | 76/115 [00:30<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:12,  3.03it/s][A
Iteration:  68%|██████▊   | 78/115 [00:31<00:12,  3.02it/s][A
Iteration:  69%|██████▊   | 79/115 [00:31<00:11,  3.06it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:11,  2.99it/s][A
Iteration:  70%|███████   | 81/115 [00:32<00:11,  2.96it/s][A
Iteration:  71%|███████▏  | 82/115 [00:32<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:33<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:33<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:34<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:35<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:07,  2.90it/s][A
Iteration:  81%|████████  | 93/115 [00:36<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:37<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  3.02it/s][A
Iteration:  86%|████████▌ | 99/115 [00:38<00:05,  3.08it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:04,  3.06it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  3.02it/s][A
Iteration:  89%|████████▊ | 102/115 [00:39<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.84it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:40<00:03,  2.97it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:01,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 21:35:44,031 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:35:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:35:44 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:35:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:35:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:35:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:35:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9047619047619047, 'combined_score': 0.8837535014005602, 'eval_loss': 0.7338674, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1156, 1161, 1270, 1069, 1121, 1061, 652, 750, 457, 966, 363, 638], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51322792, 'remaining_params': 33694808, 'pruned_model_sparsity': 0.6036725572116832, 'expected_sparsity': 0.59696, 'target_sparsity': 0.6, 'step': 4250}


Iteration:  96%|█████████▌| 110/115 [00:43<00:03,  1.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:43<00:02,  1.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  1.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:44<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.21it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.54it/s][A04/28/2024 21:35:47 - INFO - trainer.trainer_mod_2 - Epoch 36 finished. Took 44.96 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.56it/s]
Epoch:  37%|███▋      | 37/100 [26:14<44:54, 42.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.06it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.91it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.03it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.04it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.97it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.80it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.88it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.95it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 21:36:02,260 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:36:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:36:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:36:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:36:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 21:36:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:36:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.7389455, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1158, 1163, 1272, 1070, 1122, 1062, 652, 749, 455, 962, 356, 636], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51322792, 'remaining_params': 33694808, 'pruned_model_sparsity': 0.6036725572116832, 'expected_sparsity': 0.59708, 'target_sparsity': 0.6, 'step': 4300}


Iteration:  39%|███▉      | 45/115 [00:16<00:51,  1.35it/s][A04/28/2024 21:36:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 4300, Alignment: tensor([2, 5, 8, 9], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:16<00:42,  1.62it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:31,  2.13it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:28,  2.34it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:25,  2.52it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.65it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:22,  2.79it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.86it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.04it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.90it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.90it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.93it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:12,  2.98it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.83it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.02it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.99it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:36:20,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:36:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:36:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:36:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:36:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:36:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:36:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.7176981, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1157, 1163, 1272, 1070, 1123, 1063, 652, 747, 453, 957, 345, 634], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51341176, 'remaining_params': 33676424, 'pruned_model_sparsity': 0.6038887947907257, 'expected_sparsity': 0.59779, 'target_sparsity': 0.6, 'step': 4350}


Iteration:  83%|████████▎ | 95/115 [00:34<00:15,  1.32it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.86it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:08,  2.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.31it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.52it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:05,  2.65it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.75it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.80it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.91it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.02it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.04it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.00it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.75it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.76it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.04it/s][A04/28/2024 21:36:28 - INFO - trainer.trainer_mod_2 - Epoch 37 finished. Took 41.45 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  38%|███▊      | 38/100 [26:56<43:46, 42.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.06it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.98it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.94it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.76it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.83it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.88it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.84it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.89it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.91it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.03it/s][A[INFO|trainer.py:570] 2024-04-28 21:36:38,784 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:36:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:36:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:36:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:36:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:36:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:36:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.894736842105263, 'combined_score': 0.8738390092879256, 'eval_loss': 0.6837405, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1156, 1163, 1272, 1069, 1122, 1063, 651, 745, 449, 950, 333, 631], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 10, 7, 4], 'pruned_params': 51370284, 'remaining_params': 33647316, 'pruned_model_sparsity': 0.6042311709575429, 'expected_sparsity': 0.59886, 'target_sparsity': 0.6, 'step': 4400}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A04/28/2024 21:36:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 4400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:53,  1.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:35,  2.29it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.47it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.62it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.62it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.68it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:28,  2.65it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.70it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.82it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.92it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.94it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.06it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.11it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.96it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.96it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.04it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.03it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.04it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.91it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.94it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.80it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.85it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.88it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:36:57,222 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:36:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:36:57 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:36:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:36:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:36:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:36:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8982456140350877, 'combined_score': 0.8780443756449948, 'eval_loss': 0.70543545, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1156, 1163, 1273, 1069, 1122, 1063, 651, 743, 444, 944, 322, 628], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 7, 4], 'pruned_params': 51589360, 'remaining_params': 33428240, 'pruned_model_sparsity': 0.6068080021077988, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 4450}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.31it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.43it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.48it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.60it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:10,  2.69it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.78it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.95it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.92it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.96it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.00it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.07it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.12it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.07it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.00it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.02it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.99it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.23it/s][A04/28/2024 21:37:10 - INFO - trainer.trainer_mod_2 - Epoch 38 finished. Took 41.71 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  39%|███▉      | 39/100 [27:38<42:52, 42.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.02it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.02it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.83it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.87it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.92it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:37:15,329 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:37:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:37:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:37:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:37:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:37:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:37:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8966725043782837, 'combined_score': 0.8760323306205144, 'eval_loss': 0.7547763, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1157, 1163, 1273, 1069, 1122, 1063, 650, 742, 441, 939, 312, 626], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 7, 4], 'pruned_params': 51607744, 'remaining_params': 33409856, 'pruned_model_sparsity': 0.6070242396868413, 'expected_sparsity': 0.60067, 'target_sparsity': 0.6, 'step': 4500}


Iteration:  13%|█▎        | 15/115 [00:06<01:15,  1.33it/s][A04/28/2024 21:37:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 4500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:52,  1.88it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.09it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.28it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:39,  2.43it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:38,  2.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.58it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.69it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.76it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.84it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.85it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.88it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.90it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.78it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.81it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.84it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.04it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.06it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.10it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.04it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.04it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.03it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.04it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:37:33,685 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:37:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:37:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:37:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:37:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:37:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:37:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9090909090909091, 'combined_score': 0.8895944741532977, 'eval_loss': 0.70118177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1157, 1164, 1274, 1069, 1122, 1063, 650, 740, 439, 934, 304, 624], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 7, 4], 'pruned_params': 51620000, 'remaining_params': 33397600, 'pruned_model_sparsity': 0.6071683980728696, 'expected_sparsity': 0.60111, 'target_sparsity': 0.6, 'step': 4550}
04/28/2024 21:37:35 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 39 | Step: 4550 | Model size: 33397600 | Score: 0.8701]

[INFO|configuration_utils.py:439] 2024-04-28 21:37:35,073 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:37:35,944 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  57%|█████▋    | 65/115 [00:25<00:50,  1.01s/it][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:39,  1.24it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:31,  1.50it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:26,  1.79it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:22,  2.04it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:20,  2.23it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:18,  2.42it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:16,  2.56it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.69it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.75it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.81it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.89it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.89it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:12,  2.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.93it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.97it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.96it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  3.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.89it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.87it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.78it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  3.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 21:37:52,745 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:37:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:37:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:37:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:37:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:37:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:37:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.68617517, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1159, 1165, 1276, 1069, 1123, 1064, 650, 739, 437, 930, 299, 623], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51816096, 'remaining_params': 33201504, 'pruned_model_sparsity': 0.6094749322493225, 'expected_sparsity': 0.60136, 'target_sparsity': 0.6, 'step': 4600}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.37it/s][A04/28/2024 21:37:54 - INFO - trainer.trainer_mod_2 - Epoch 39 finished. Took 43.87 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.62it/s]
Epoch:  40%|████      | 40/100 [28:21<42:40, 42.68s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 21:37:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 4600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:39,  2.91it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:41,  2.68it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.79it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  3.00it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.84it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.80it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.78it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.01it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.01it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.95it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  3.00it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.87it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  2.99it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.02it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  3.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 21:38:11,067 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:38:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:38:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:38:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:38:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 21:38:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:38:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8952702702702703, 'combined_score': 0.8716547429782724, 'eval_loss': 0.76425207, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1161, 1167, 1279, 1072, 1125, 1066, 650, 738, 436, 928, 295, 622], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51802308, 'remaining_params': 33215292, 'pruned_model_sparsity': 0.6093127540650406, 'expected_sparsity': 0.60121, 'target_sparsity': 0.6, 'step': 4650}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:33,  1.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:27,  2.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:24,  2.47it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.73it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.86it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.06it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.97it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.96it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.96it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.05it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.97it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.99it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.80it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 21:38:29,327 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:38:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:38:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:38:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:38:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:38:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:38:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.901023890784983, 'combined_score': 0.8794335140199425, 'eval_loss': 0.7639184, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1163, 1169, 1282, 1073, 1127, 1068, 650, 738, 436, 926, 293, 621], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51786988, 'remaining_params': 33230612, 'pruned_model_sparsity': 0.6091325560825053, 'expected_sparsity': 0.60086, 'target_sparsity': 0.6, 'step': 4700}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.31it/s][A04/28/2024 21:38:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 4700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:36<00:09,  1.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:04,  2.23it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.60it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:03,  2.66it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.75it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.81it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.92it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.14it/s][A04/28/2024 21:38:35 - INFO - trainer.trainer_mod_2 - Epoch 40 finished. Took 41.61 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  41%|████      | 41/100 [29:03<41:39, 42.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.84it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.87it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.85it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.02it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:30,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.01it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.02it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.02it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.85it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 21:38:47,564 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:38:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:38:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:38:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:38:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:38:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:38:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8907563025210083, 'combined_score': 0.8657212885154062, 'eval_loss': 0.82408696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1166, 1172, 1285, 1075, 1129, 1070, 650, 738, 436, 925, 291, 621], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51767072, 'remaining_params': 33250528, 'pruned_model_sparsity': 0.6088982987052093, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 4750}


Iteration:  30%|███       | 35/115 [00:13<00:59,  1.34it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.61it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:41,  1.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:36,  2.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.82it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.85it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:25,  2.74it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.80it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.89it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.95it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.98it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.96it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.01it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.00it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.00it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.99it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.83it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.97it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.86it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 21:39:05,878 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:39:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:39:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:39:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:39:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:39:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:39:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8938356164383561, 'combined_score': 0.8709374160623153, 'eval_loss': 0.75342155, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1169, 1174, 1289, 1077, 1131, 1072, 650, 738, 437, 924, 290, 620], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51744092, 'remaining_params': 33273508, 'pruned_model_sparsity': 0.6086280017314062, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 4800}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.32it/s][A04/28/2024 21:39:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 4800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.58it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.06it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.58it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.69it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.79it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.93it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.02it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.04it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.98it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.01it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.82it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.72it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.79it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.81it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.06it/s][A04/28/2024 21:39:17 - INFO - trainer.trainer_mod_2 - Epoch 41 finished. Took 41.66 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  42%|████▏     | 42/100 [29:45<40:44, 42.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.30it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.07it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.04it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.99it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.04it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.02it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:39:24,065 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:39:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:39:24 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:39:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:39:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:39:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:39:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9026548672566371, 'combined_score': 0.8839254728440049, 'eval_loss': 0.7302813, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1171, 1177, 1290, 1078, 1133, 1074, 650, 738, 437, 923, 288, 620], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51730304, 'remaining_params': 33287296, 'pruned_model_sparsity': 0.6084658235471243, 'expected_sparsity': 0.59963, 'target_sparsity': 0.6, 'step': 4850}


Iteration:  17%|█▋        | 20/115 [00:08<01:11,  1.34it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:58,  1.60it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.86it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:43,  2.10it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.72it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.81it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.79it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.84it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.83it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.78it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:29,  2.75it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.84it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.88it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.92it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.91it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.93it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.02it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.08it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:19,  3.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:19,  3.06it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.04it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.11it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.00it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.03it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.99it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.99it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.02it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 21:39:42,349 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:39:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:39:42 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:39:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:39:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:39:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:39:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8970331588132635, 'combined_score': 0.8762126578380043, 'eval_loss': 0.70823073, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1173, 1179, 1293, 1080, 1135, 1076, 650, 737, 436, 920, 285, 619], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51716516, 'remaining_params': 33301084, 'pruned_model_sparsity': 0.6083036453628425, 'expected_sparsity': 0.59922, 'target_sparsity': 0.6, 'step': 4900}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.34it/s][A04/28/2024 21:39:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 4900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.60it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.81it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.57it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:14,  2.68it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.76it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.83it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.88it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.75it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.86it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.75it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.03it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.02it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.03it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  3.00it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.02it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.03it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.01it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.05it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.97it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.91it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.96it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.16it/s][A04/28/2024 21:39:58 - INFO - trainer.trainer_mod_2 - Epoch 42 finished. Took 41.53 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  43%|████▎     | 43/100 [30:26<39:52, 41.97s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 21:40:00,626 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:40:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:40:00 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:40:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:40:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:40:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:40:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8939130434782607, 'combined_score': 0.872201619778346, 'eval_loss': 0.74101555, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1174, 1181, 1296, 1081, 1137, 1078, 650, 736, 435, 917, 280, 617], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51708856, 'remaining_params': 33308744, 'pruned_model_sparsity': 0.6082135463715749, 'expected_sparsity': 0.59913, 'target_sparsity': 0.6, 'step': 4950}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:12,  1.50it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.80it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.03it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.25it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.43it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.58it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.71it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:36,  2.83it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.81it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.93it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.01it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.96it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.85it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.08it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.07it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.05it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.06it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.03it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:20,  3.11it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.07it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A[INFO|trainer.py:570] 2024-04-28 21:40:18,808 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:40:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:40:18 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:40:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:40:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:40:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:40:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.891156462585034, 'combined_score': 0.8671468587434974, 'eval_loss': 0.7628923, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1175, 1182, 1297, 1081, 1137, 1079, 649, 735, 433, 913, 274, 616], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51714984, 'remaining_params': 33302616, 'pruned_model_sparsity': 0.608285625564589, 'expected_sparsity': 0.599, 'target_sparsity': 0.6, 'step': 5000}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A04/28/2024 21:40:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 5000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:21<00:38,  1.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:32,  1.81it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.05it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.27it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:22,  2.45it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:20,  2.59it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.70it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.80it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.98it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  3.05it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.12it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  3.07it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.79it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.83it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.87it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.95it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.80it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.90it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.77it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:05,  2.79it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 21:40:37,250 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:40:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:40:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:40:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:40:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:40:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:40:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9006849315068494, 'combined_score': 0.8792640343808756, 'eval_loss': 0.76425076, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1176, 1182, 1298, 1081, 1137, 1079, 649, 733, 431, 908, 267, 614], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51725708, 'remaining_params': 33291892, 'pruned_model_sparsity': 0.6084117641523638, 'expected_sparsity': 0.59938, 'target_sparsity': 0.6, 'step': 5050}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.85it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.12it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.33it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.51it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.62it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.71it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.80it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.87it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.11it/s][A04/28/2024 21:40:41 - INFO - trainer.trainer_mod_2 - Epoch 43 finished. Took 42.92 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.68it/s]
Epoch:  44%|████▍     | 44/100 [31:09<39:26, 42.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.93it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.96it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.94it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.98it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:34,  3.05it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.86it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.91it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.88it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.05it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.01it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:40:55,400 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:40:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:40:55 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:40:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:40:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:40:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:40:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8971631205673759, 'combined_score': 0.8775031289111389, 'eval_loss': 0.7140139, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1176, 1183, 1299, 1081, 1137, 1081, 649, 730, 428, 903, 259, 611], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51736432, 'remaining_params': 33281168, 'pruned_model_sparsity': 0.6085379027401385, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 5100}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.32it/s][A04/28/2024 21:40:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 5100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:47,  1.55it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:40,  1.80it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:35,  2.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:31,  2.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.46it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.65it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.80it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.89it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  3.00it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.96it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.90it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:12,  2.78it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.88it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.91it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.07it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.02it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 21:41:13,743 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:41:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:41:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:41:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:41:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:41:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:41:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8939130434782607, 'combined_score': 0.872201619778346, 'eval_loss': 0.74925905, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1176, 1183, 1301, 1082, 1137, 1082, 648, 729, 425, 898, 253, 609], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51744092, 'remaining_params': 33273508, 'pruned_model_sparsity': 0.6086280017314062, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 5150}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.33it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.59it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.81it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:11,  1.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.42it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.55it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.69it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.77it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.83it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.86it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.04it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.05it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.05it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.04it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.01it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.26it/s][A04/28/2024 21:41:23 - INFO - trainer.trainer_mod_2 - Epoch 44 finished. Took 41.6 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  45%|████▌     | 45/100 [31:51<38:33, 42.06s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.91it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.96it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.82it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.84it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.06it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.88it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.77it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.79it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.83it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.88it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A[INFO|trainer.py:570] 2024-04-28 21:41:32,075 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:41:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:41:32 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:41:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:41:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:41:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:41:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.7237434, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1177, 1184, 1302, 1082, 1138, 1082, 648, 727, 423, 893, 247, 607], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51750220, 'remaining_params': 33267380, 'pruned_model_sparsity': 0.6087000809244204, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 5200}


Iteration:  22%|██▏       | 25/115 [00:09<01:08,  1.32it/s][A04/28/2024 21:41:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 5200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:56,  1.58it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.80it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:42,  2.03it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:38,  2.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.41it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:32,  2.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.65it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:30,  2.73it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.77it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.85it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.88it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.94it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.98it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.04it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.99it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.06it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.05it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.06it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 21:41:50,269 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:41:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:41:50 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:41:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:41:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:41:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:41:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8987993138936535, 'combined_score': 0.8770957353781993, 'eval_loss': 0.7387808, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1177, 1186, 1303, 1083, 1138, 1083, 648, 726, 423, 889, 243, 606], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51748688, 'remaining_params': 33268912, 'pruned_model_sparsity': 0.6086820611261669, 'expected_sparsity': 0.60087, 'target_sparsity': 0.6, 'step': 5250}


Iteration:  65%|██████▌   | 75/115 [00:28<00:29,  1.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.07it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:14,  2.46it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.68it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.78it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.91it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.02it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.92it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.96it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.02it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.04it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.23it/s][A04/28/2024 21:42:05 - INFO - trainer.trainer_mod_2 - Epoch 45 finished. Took 41.6 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  46%|████▌     | 46/100 [32:32<37:43, 41.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.81it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.83it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A[INFO|trainer.py:570] 2024-04-28 21:42:08,491 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:42:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:42:08 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:42:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:42:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:42:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:42:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8952702702702703, 'combined_score': 0.8716547429782724, 'eval_loss': 0.7939684, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1179, 1188, 1305, 1084, 1140, 1084, 648, 725, 422, 886, 240, 604], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51739496, 'remaining_params': 33278104, 'pruned_model_sparsity': 0.6085739423366456, 'expected_sparsity': 0.60062, 'target_sparsity': 0.6, 'step': 5300}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.30it/s][A04/28/2024 21:42:10 - INFO - trainer.trainer_mod_2 - v4 Global step: 5300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.57it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.42it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.65it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.74it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.87it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.86it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.89it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.89it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.80it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.89it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.02it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.01it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.87it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.87it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.84it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.84it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.90it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.88it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.98it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 21:42:26,874 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:42:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:42:26 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:42:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:42:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:42:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:42:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.905982905982906, 'combined_score': 0.8855894922071392, 'eval_loss': 0.7045387, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1181, 1190, 1308, 1085, 1142, 1086, 648, 724, 422, 884, 238, 603], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51724176, 'remaining_params': 33293424, 'pruned_model_sparsity': 0.6083937443541102, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 5350}


Iteration:  52%|█████▏    | 60/115 [00:23<00:40,  1.36it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.62it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:24,  2.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:21,  2.35it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:19,  2.55it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.64it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:17,  2.74it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.79it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.82it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.76it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.76it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.86it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.07it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.00it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.01it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  3.02it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.02it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.90it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.91it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.01it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.05it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.02it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.02it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.08it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 21:42:45,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:42:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:42:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:42:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:42:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 21:42:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:42:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.6945387, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1183, 1192, 1312, 1087, 1143, 1089, 648, 723, 422, 882, 236, 603], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51705792, 'remaining_params': 33311808, 'pruned_model_sparsity': 0.6081775067750678, 'expected_sparsity': 0.59978, 'target_sparsity': 0.6, 'step': 5400}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.34it/s][A04/28/2024 21:42:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 5400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.61it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.28it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.60it/s][A04/28/2024 21:42:48 - INFO - trainer.trainer_mod_2 - Epoch 46 finished. Took 43.03 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  47%|████▋     | 47/100 [33:15<37:19, 42.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.74it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.77it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.83it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.85it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:32,  3.04it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  3.00it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.83it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.79it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.85it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.83it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:29,  2.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:29,  2.80it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.90it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.88it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:43:03,459 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:43:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:43:03 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:43:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:43:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:43:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:43:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8993055555555555, 'combined_score': 0.8785743464052287, 'eval_loss': 0.68788254, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1185, 1194, 1314, 1089, 1145, 1091, 648, 722, 421, 879, 234, 601], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51692004, 'remaining_params': 33325596, 'pruned_model_sparsity': 0.6080153285907859, 'expected_sparsity': 0.59954, 'target_sparsity': 0.6, 'step': 5450}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.33it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:43,  1.60it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:31,  2.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:28,  2.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.45it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.57it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.68it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.73it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.81it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.87it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.85it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.89it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.98it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.01it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.01it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.91it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.83it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.89it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.80it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.95it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.94it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.87it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 21:43:21,829 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:43:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:43:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:43:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:43:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:43:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:43:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.901360544217687, 'combined_score': 0.8796018407362944, 'eval_loss': 0.74813, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1195, 1316, 1090, 1146, 1092, 648, 720, 420, 875, 230, 600], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51688940, 'remaining_params': 33328660, 'pruned_model_sparsity': 0.6079792889942788, 'expected_sparsity': 0.59923, 'target_sparsity': 0.6, 'step': 5500}


Iteration:  83%|████████▎ | 95/115 [00:35<00:14,  1.35it/s][A04/28/2024 21:43:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 5500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:35<00:11,  1.61it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.11it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.36it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.50it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.64it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.75it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.82it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.90it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.03it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.23it/s][A04/28/2024 21:43:29 - INFO - trainer.trainer_mod_2 - Epoch 47 finished. Took 41.7 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  48%|████▊     | 48/100 [33:57<36:28, 42.09s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.89it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.96it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.82it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.90it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.80it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.82it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.77it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.84it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.87it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.91it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.90it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.84it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:33,  2.73it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.80it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.88it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:43:40,151 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:43:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:43:40 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:43:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:43:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:43:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:43:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8977469670710572, 'combined_score': 0.8765695619669012, 'eval_loss': 0.704885, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1185, 1196, 1317, 1091, 1147, 1093, 647, 717, 419, 870, 227, 598], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51688940, 'remaining_params': 33328660, 'pruned_model_sparsity': 0.6079792889942788, 'expected_sparsity': 0.59971, 'target_sparsity': 0.6, 'step': 5550}


Iteration:  26%|██▌       | 30/115 [00:11<01:03,  1.33it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:52,  1.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:38,  2.11it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:34,  2.32it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.49it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.62it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.73it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.81it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.93it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.93it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.85it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.03it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.02it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.88it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.94it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:14,  2.85it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:43:58,451 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:43:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:43:58 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:43:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:43:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:43:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:43:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8977469670710572, 'combined_score': 0.8765695619669012, 'eval_loss': 0.72549754, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1197, 1319, 1092, 1147, 1094, 647, 714, 417, 865, 223, 596], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51688940, 'remaining_params': 33328660, 'pruned_model_sparsity': 0.6079792889942788, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 5600}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.32it/s][A04/28/2024 21:43:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 5600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:18,  1.83it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.45it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.58it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.68it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.77it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.83it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.73it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.81it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.96it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.97it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.03it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.08it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.05it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.04it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.01it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.02it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.07it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.12it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.05it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.06it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.02it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/28/2024 21:44:11 - INFO - trainer.trainer_mod_2 - Epoch 48 finished. Took 41.67 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  49%|████▉     | 49/100 [34:39<35:40, 41.96s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.75it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.03it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.02it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.05it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.81it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 21:44:16,539 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:44:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:44:16 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:44:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:44:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:44:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:44:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9027777777777778, 'combined_score': 0.8827614379084967, 'eval_loss': 0.70674926, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1197, 1320, 1091, 1147, 1095, 647, 711, 416, 860, 220, 593], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51693536, 'remaining_params': 33324064, 'pruned_model_sparsity': 0.6080333483890394, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 5650}


Iteration:  13%|█▎        | 15/115 [00:06<01:16,  1.31it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:55,  1.78it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:47,  2.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.24it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:39,  2.41it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:37,  2.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.62it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.69it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.79it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.00it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.03it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.07it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.04it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.79it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.88it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.82it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.88it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.96it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 21:44:34,920 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:44:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:44:34 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:44:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:44:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:44:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:44:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9015544041450777, 'combined_score': 0.8809242608960683, 'eval_loss': 0.73650855, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1187, 1198, 1321, 1092, 1147, 1095, 647, 709, 414, 855, 218, 591], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51693536, 'remaining_params': 33324064, 'pruned_model_sparsity': 0.6080333483890394, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 5700}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.33it/s][A04/28/2024 21:44:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 5700, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:30,  1.59it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.11it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:19,  2.35it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:17,  2.55it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:16,  2.59it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.71it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.79it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.88it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.76it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.84it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.84it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.93it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.98it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.91it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.81it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.81it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.02it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.01it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.02it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.99it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.00it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.02it/s][A[INFO|trainer.py:570] 2024-04-28 21:44:53,154 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:44:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:44:53 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:44:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:44:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 21:44:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:44:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9078498293515359, 'combined_score': 0.8877484440875327, 'eval_loss': 0.7580626, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1188, 1199, 1323, 1092, 1148, 1096, 646, 706, 414, 851, 216, 589], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51687408, 'remaining_params': 33330192, 'pruned_model_sparsity': 0.6079612691960253, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 5750}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.38it/s][A04/28/2024 21:44:54 - INFO - trainer.trainer_mod_2 - Epoch 49 finished. Took 43.07 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  50%|█████     | 50/100 [35:22<35:14, 42.30s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.89it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.01it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.02it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.04it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  3.00it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.88it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.83it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.87it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.95it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:29,  2.78it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:28,  2.83it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.86it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.95it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:24,  2.90it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:45:11,518 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:45:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:45:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:45:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:45:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:45:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:45:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9003436426116839, 'combined_score': 0.8790933899332929, 'eval_loss': 0.7442204, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1189, 1200, 1325, 1092, 1149, 1097, 646, 704, 414, 847, 216, 587], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51678216, 'remaining_params': 33339384, 'pruned_model_sparsity': 0.6078531504065041, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 5800}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.33it/s][A04/28/2024 21:45:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 5800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:40,  1.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:33,  1.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:24,  2.45it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:22,  2.58it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.63it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.72it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.78it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.86it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.03it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  3.00it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.92it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.88it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.90it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.03it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.00it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.97it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:45:29,863 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:45:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:45:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:45:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:45:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:45:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:45:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.901360544217687, 'combined_score': 0.8796018407362944, 'eval_loss': 0.75655866, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1190, 1201, 1326, 1093, 1150, 1099, 647, 702, 413, 842, 215, 585], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51670556, 'remaining_params': 33347044, 'pruned_model_sparsity': 0.6077630514152363, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 5850}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.30it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.34it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.50it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.65it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.78it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.85it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.86it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.14it/s][A04/28/2024 21:45:36 - INFO - trainer.trainer_mod_2 - Epoch 50 finished. Took 41.7 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  51%|█████     | 51/100 [36:04<34:23, 42.12s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.07it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.99it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.84it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.00it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.02it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.88it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.05it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.05it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.07it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:45:47,946 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:45:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:45:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:45:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:45:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:45:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:45:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9018932874354562, 'combined_score': 0.8810937025412575, 'eval_loss': 0.7198313, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1190, 1202, 1328, 1093, 1150, 1099, 646, 699, 412, 838, 214, 582], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51669024, 'remaining_params': 33348576, 'pruned_model_sparsity': 0.6077450316169828, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 5900}


Iteration:  30%|███       | 35/115 [00:13<00:59,  1.35it/s][A04/28/2024 21:45:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 5900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.60it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:41,  1.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:36,  2.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:32,  2.33it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.48it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.62it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.72it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.79it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.87it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.82it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.92it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.02it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.02it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.86it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.86it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.02it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.06it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.04it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.03it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.91it/s][A[INFO|trainer.py:570] 2024-04-28 21:46:06,243 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:46:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:46:06 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:46:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:46:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:46:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:46:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9052631578947367, 'combined_score': 0.886455108359133, 'eval_loss': 0.6893801, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1192, 1203, 1330, 1094, 1151, 1100, 646, 696, 412, 834, 213, 580], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51658300, 'remaining_params': 33359300, 'pruned_model_sparsity': 0.607618893029208, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 5950}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.58it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:12,  2.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.32it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.67it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.75it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.77it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.85it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.89it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.84it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.97it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.91it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.78it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.89it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.20it/s][A04/28/2024 21:46:17 - INFO - trainer.trainer_mod_2 - Epoch 51 finished. Took 41.51 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  52%|█████▏    | 52/100 [36:45<33:32, 41.93s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:34,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.01it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.01it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.99it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 21:46:24,461 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:46:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:46:24 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:46:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:46:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:46:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:46:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9015544041450777, 'combined_score': 0.8809242608960683, 'eval_loss': 0.7061829, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1192, 1204, 1331, 1092, 1151, 1101, 646, 694, 412, 829, 212, 578], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51658300, 'remaining_params': 33359300, 'pruned_model_sparsity': 0.607618893029208, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 6000}


Iteration:  17%|█▋        | 20/115 [00:08<01:11,  1.32it/s][A04/28/2024 21:46:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 6000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.83it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.08it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.44it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:36,  2.46it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:34,  2.58it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:32,  2.66it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.75it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.82it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.04it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.83it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.92it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.02it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.03it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.04it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.05it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.04it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.09it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:19,  3.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:19,  3.10it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.86it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:16,  2.80it/s][A[INFO|trainer.py:570] 2024-04-28 21:46:42,785 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:46:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:46:42 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:46:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:46:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:46:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:46:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8987993138936535, 'combined_score': 0.8770957353781993, 'eval_loss': 0.7341663, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1206, 1333, 1093, 1152, 1103, 646, 691, 412, 825, 212, 575], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51642980, 'remaining_params': 33374620, 'pruned_model_sparsity': 0.6074386950466727, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 6050}


Iteration:  61%|██████    | 70/115 [00:26<00:34,  1.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:28,  1.55it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.26it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.43it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.54it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:14,  2.71it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.80it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:13,  2.72it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.80it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.87it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.71it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.80it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.00it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  3.00it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.92it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.06it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.02it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.02it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.16it/s][A04/28/2024 21:46:59 - INFO - trainer.trainer_mod_2 - Epoch 52 finished. Took 41.65 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  53%|█████▎    | 53/100 [37:27<32:46, 41.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:47:01,094 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:47:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:47:01 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:47:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:47:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:47:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:47:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.678576, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1207, 1335, 1093, 1152, 1103, 645, 689, 411, 821, 212, 573], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51639916, 'remaining_params': 33377684, 'pruned_model_sparsity': 0.6074026554501656, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 6100}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A04/28/2024 21:47:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 6100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.78it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.02it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.24it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.41it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.65it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.74it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.78it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.85it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.85it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.85it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:31,  2.97it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  2.96it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:26,  3.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.04it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.06it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.05it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.02it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.78it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.85it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.04it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.90it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.80it/s][A[INFO|trainer.py:570] 2024-04-28 21:47:19,442 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:47:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:47:19 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:47:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:47:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:47:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:47:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9025641025641027, 'combined_score': 0.8814291101055808, 'eval_loss': 0.73017883, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1193, 1208, 1336, 1092, 1151, 1103, 645, 685, 411, 816, 211, 570], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51642980, 'remaining_params': 33374620, 'pruned_model_sparsity': 0.6074386950466727, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 6150}


Iteration:  48%|████▊     | 55/115 [00:21<00:46,  1.30it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.57it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.84it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:28,  2.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:25,  2.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:23,  2.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:20,  2.64it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.75it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.98it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:14,  3.06it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.89it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.88it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.93it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.96it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.04it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.06it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.05it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.02it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.03it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.03it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.06it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.04it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.96it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.92it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:47:37,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:47:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:47:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:47:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:47:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:47:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:47:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9075342465753423, 'combined_score': 0.8875906526994359, 'eval_loss': 0.710694, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1208, 1336, 1091, 1151, 1103, 645, 682, 411, 811, 211, 567], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51642980, 'remaining_params': 33374620, 'pruned_model_sparsity': 0.6074386950466727, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 6200}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.34it/s][A04/28/2024 21:47:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 6200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.60it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.30it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.39it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.54it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.67it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.77it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.79it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.01it/s][A04/28/2024 21:47:42 - INFO - trainer.trainer_mod_2 - Epoch 53 finished. Took 43.03 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  54%|█████▍    | 54/100 [38:10<32:21, 42.20s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.05it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.84it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.85it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.83it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.88it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.01it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.99it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.82it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.99it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.03it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  3.00it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.01it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.03it/s][A[INFO|trainer.py:570] 2024-04-28 21:47:55,894 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:47:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:47:55 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:47:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:47:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:47:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:47:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9068541300527241, 'combined_score': 0.8884760846342052, 'eval_loss': 0.6798199, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1209, 1337, 1091, 1151, 1103, 644, 680, 411, 807, 211, 564], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51639916, 'remaining_params': 33377684, 'pruned_model_sparsity': 0.6074026554501656, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 6250}


Iteration:  35%|███▍      | 40/115 [00:14<00:55,  1.35it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:45,  1.61it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:30,  2.34it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.49it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.59it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.62it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:25,  2.58it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:24,  2.68it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.80it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.79it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.02it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.08it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.06it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.03it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.03it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.02it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.85it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.91it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.95it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.96it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:48:14,193 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:48:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:48:14 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:48:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:48:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:48:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:48:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9097222222222222, 'combined_score': 0.8911356209150327, 'eval_loss': 0.6869686, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1209, 1338, 1091, 1151, 1104, 644, 677, 410, 802, 210, 561], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51639916, 'remaining_params': 33377684, 'pruned_model_sparsity': 0.6074026554501656, 'expected_sparsity': 0.59983, 'target_sparsity': 0.6, 'step': 6300}
04/28/2024 21:48:15 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 54 | Step: 6300 | Model size: 33377684 | Score: 0.87255]

[INFO|configuration_utils.py:439] 2024-04-28 21:48:15,581 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 21:48:16,268 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  78%|███████▊  | 90/115 [00:33<00:24,  1.04it/s][A04/28/2024 21:48:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 6300, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:34<00:18,  1.29it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:14,  1.55it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:12,  1.81it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:10,  2.06it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.42it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:07,  2.57it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.70it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.82it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.87it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.89it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.92it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.13it/s][A04/28/2024 21:48:24 - INFO - trainer.trainer_mod_2 - Epoch 54 finished. Took 42.25 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.72it/s]
Epoch:  55%|█████▌    | 55/100 [38:52<31:39, 42.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.87it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.91it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.93it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.84it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.84it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.05it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.99it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.02it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.00it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:30,  3.08it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.07it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 21:48:33,125 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:48:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:48:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:48:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:48:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:48:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:48:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.901023890784983, 'combined_score': 0.8794335140199425, 'eval_loss': 0.7050113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1209, 1340, 1091, 1149, 1104, 644, 673, 410, 797, 210, 558], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51639916, 'remaining_params': 33377684, 'pruned_model_sparsity': 0.6074026554501656, 'expected_sparsity': 0.59929, 'target_sparsity': 0.6, 'step': 6350}


Iteration:  22%|██▏       | 25/115 [00:09<01:08,  1.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:57,  1.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.82it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:42,  2.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.28it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.50it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:31,  2.63it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.68it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.78it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.81it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.84it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.93it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.95it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.82it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.86it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.86it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.04it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.93it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.97it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.80it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.01it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.02it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.01it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.03it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.03it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.98it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.99it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.83it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:48:51,428 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:48:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:48:51 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:48:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:48:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:48:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:48:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9018932874354562, 'combined_score': 0.8810937025412575, 'eval_loss': 0.6999181, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1193, 1208, 1338, 1089, 1147, 1103, 643, 668, 409, 790, 210, 554], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51655236, 'remaining_params': 33362364, 'pruned_model_sparsity': 0.607582853432701, 'expected_sparsity': 0.59962, 'target_sparsity': 0.6, 'step': 6400}


Iteration:  65%|██████▌   | 75/115 [00:28<00:29,  1.34it/s][A04/28/2024 21:48:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 6400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.87it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.11it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.30it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:13,  2.50it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.62it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.57it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.68it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.73it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.80it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.83it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.86it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.88it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.78it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.81it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.92it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.07it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.04it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.23it/s][A04/28/2024 21:49:06 - INFO - trainer.trainer_mod_2 - Epoch 55 finished. Took 41.65 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  56%|█████▌    | 56/100 [39:34<30:50, 42.05s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.93it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.94it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.90it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:49:09,713 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:49:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:49:09 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:49:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:49:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:49:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:49:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.9001692047377327, 'combined_score': 0.8777806808002389, 'eval_loss': 0.749458, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1192, 1207, 1338, 1088, 1146, 1103, 643, 662, 408, 783, 210, 549], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51662896, 'remaining_params': 33354704, 'pruned_model_sparsity': 0.6076729524239687, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 6450}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.31it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:05,  1.60it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:48,  2.10it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:45,  2.22it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:39,  2.51it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.69it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.75it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.90it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.89it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.90it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.82it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.87it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.83it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.05it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.05it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.04it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.86it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.03it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.08it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.04it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.05it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.01it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:49:27,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:49:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:49:27 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:49:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:49:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 21:49:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:49:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8993288590604027, 'combined_score': 0.8761350177654954, 'eval_loss': 0.7853377, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1191, 1206, 1337, 1086, 1144, 1102, 642, 657, 407, 776, 209, 545], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51678216, 'remaining_params': 33339384, 'pruned_model_sparsity': 0.6078531504065041, 'expected_sparsity': 0.60018, 'target_sparsity': 0.6, 'step': 6500}


Iteration:  52%|█████▏    | 60/115 [00:22<00:40,  1.34it/s][A04/28/2024 21:49:29 - INFO - trainer.trainer_mod_2 - v4 Global step: 6500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:24,  2.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:18,  2.60it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.71it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.79it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.86it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.76it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.70it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.79it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.91it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.91it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.04it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.88it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.86it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.87it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.01it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.90it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.89it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.02it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.97it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 21:49:46,310 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:49:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:49:46 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:49:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:49:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:49:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:49:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8958333333333334, 'combined_score': 0.8743872549019608, 'eval_loss': 0.7168726, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1190, 1205, 1336, 1083, 1143, 1100, 642, 653, 406, 770, 209, 541], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51693536, 'remaining_params': 33324064, 'pruned_model_sparsity': 0.6080333483890394, 'expected_sparsity': 0.601, 'target_sparsity': 0.6, 'step': 6550}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.11it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.30it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.61it/s][A04/28/2024 21:49:49 - INFO - trainer.trainer_mod_2 - Epoch 56 finished. Took 43.0 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.67it/s]
Epoch:  57%|█████▋    | 57/100 [40:17<30:20, 42.33s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.89it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.83it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.84it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.79it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.83it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:40,  2.68it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.74it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.82it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.78it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.02it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.02it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.99it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  3.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.86it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.91it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.97it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 21:50:04,770 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:50:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:50:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:50:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:50:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:50:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:50:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9008695652173914, 'combined_score': 0.8805818414322251, 'eval_loss': 0.7339022, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1191, 1207, 1337, 1083, 1143, 1101, 641, 651, 406, 767, 209, 538], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51685876, 'remaining_params': 33331724, 'pruned_model_sparsity': 0.6079432493977718, 'expected_sparsity': 0.60055, 'target_sparsity': 0.6, 'step': 6600}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.33it/s][A04/28/2024 21:50:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 6600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:17<00:43,  1.60it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:31,  2.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:28,  2.30it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.46it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.60it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.68it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:23,  2.64it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:22,  2.74it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.80it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.01it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.01it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.00it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.05it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.99it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.99it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.08it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.08it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.02it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.00it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 21:50:22,969 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:50:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:50:22 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:50:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:50:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:50:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:50:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.899488926746167, 'combined_score': 0.877440541804456, 'eval_loss': 0.75877553, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1192, 1208, 1339, 1083, 1144, 1103, 641, 649, 407, 764, 209, 536], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51673620, 'remaining_params': 33343980, 'pruned_model_sparsity': 0.6077990910117435, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 6650}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.32it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:11,  1.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.86it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:07,  2.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.34it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.50it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:05,  2.63it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.73it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.70it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.77it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.77it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.83it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.89it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.17it/s][A04/28/2024 21:50:31 - INFO - trainer.trainer_mod_2 - Epoch 57 finished. Took 41.73 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  58%|█████▊    | 58/100 [40:58<29:30, 42.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.77it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.82it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.87it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.79it/s][A[INFO|trainer.py:570] 2024-04-28 21:50:41,316 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:50:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:50:41 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:50:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:50:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:50:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:50:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.7441785, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1193, 1210, 1342, 1085, 1146, 1105, 641, 648, 408, 761, 209, 534], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51653704, 'remaining_params': 33363896, 'pruned_model_sparsity': 0.6075648336344475, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 6700}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.31it/s][A04/28/2024 21:50:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 6700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:45,  1.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:35,  2.26it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.45it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.69it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.83it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.89it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.91it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.89it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.90it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.95it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.01it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.88it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.01it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.06it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.02it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.01it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.89it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.95it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.05it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 21:50:59,500 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:50:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:50:59 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:50:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:50:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:51:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:51:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8989547038327526, 'combined_score': 0.8783989205438272, 'eval_loss': 0.74435407, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1195, 1212, 1343, 1085, 1146, 1106, 641, 646, 408, 757, 209, 531], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51644512, 'remaining_params': 33373088, 'pruned_model_sparsity': 0.6074567148449262, 'expected_sparsity': 0.59945, 'target_sparsity': 0.6, 'step': 6750}


Iteration:  70%|██████▉   | 80/115 [00:29<00:26,  1.34it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:15,  2.09it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:11,  2.53it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.65it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.76it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.84it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.92it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.93it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.95it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.78it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.97it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.04it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.99it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.89it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/28/2024 21:51:12 - INFO - trainer.trainer_mod_2 - Epoch 58 finished. Took 41.67 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  59%|█████▉    | 59/100 [41:40<28:42, 42.01s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.90it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:42,  2.66it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.79it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.73it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.81it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.87it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.88it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.98it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.01it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.02it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 21:51:17,828 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:51:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:51:17 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:51:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:51:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.83it/s]04/28/2024 21:51:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:51:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8983050847457628, 'combined_score': 0.8756231306081754, 'eval_loss': 0.77130353, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1195, 1212, 1344, 1085, 1145, 1106, 641, 643, 408, 752, 209, 528], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51644512, 'remaining_params': 33373088, 'pruned_model_sparsity': 0.6074567148449262, 'expected_sparsity': 0.59949, 'target_sparsity': 0.6, 'step': 6800}


Iteration:  13%|█▎        | 15/115 [00:06<01:14,  1.33it/s][A04/28/2024 21:51:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 6800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:01,  1.60it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:52,  1.85it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:40,  2.34it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:37,  2.51it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.63it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.77it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.84it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.88it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.89it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.91it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.78it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.89it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.85it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.86it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.87it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.88it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.87it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.86it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.82it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.86it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.89it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A[INFO|trainer.py:570] 2024-04-28 21:51:36,320 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:51:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:51:36 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:51:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:51:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 21:51:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:51:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8941176470588236, 'combined_score': 0.8698529411764706, 'eval_loss': 0.79902565, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1211, 1345, 1085, 1145, 1107, 640, 639, 407, 746, 208, 523], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51647576, 'remaining_params': 33370024, 'pruned_model_sparsity': 0.6074927544414334, 'expected_sparsity': 0.59971, 'target_sparsity': 0.6, 'step': 6850}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.33it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:30,  1.59it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:25,  1.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.10it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.28it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.46it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.58it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.66it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.81it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.97it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.98it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.00it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.85it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.04it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.08it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.96it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.05it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.10it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.06it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A[INFO|trainer.py:570] 2024-04-28 21:51:54,372 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:51:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:51:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:51:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:51:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:51:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:51:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.7150272, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1192, 1209, 1346, 1085, 1144, 1107, 639, 635, 407, 739, 208, 519], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51653704, 'remaining_params': 33363896, 'pruned_model_sparsity': 0.6075648336344475, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 6900}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.38it/s][A04/28/2024 21:51:55 - INFO - trainer.trainer_mod_2 - Epoch 59 finished. Took 43.04 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  60%|██████    | 60/100 [42:23<28:12, 42.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 21:51:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 6900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.91it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.87it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.91it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.91it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.92it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.95it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.04it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.00it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.94it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.02it/s][A[INFO|trainer.py:570] 2024-04-28 21:52:12,678 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:52:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:52:12 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:52:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:52:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:52:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:52:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.902229845626072, 'combined_score': 0.8812619816365654, 'eval_loss': 0.7064508, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1191, 1207, 1345, 1083, 1142, 1106, 639, 630, 406, 732, 208, 514], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51669024, 'remaining_params': 33348576, 'pruned_model_sparsity': 0.6077450316169828, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 6950}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:33,  1.86it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.32it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:24,  2.49it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:22,  2.61it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.72it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.76it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.82it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.85it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.99it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.98it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.86it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.83it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.93it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.05it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.11it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:09,  2.85it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.88it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.96it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:52:31,046 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:52:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:52:31 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:52:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:52:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:52:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:52:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9018932874354562, 'combined_score': 0.8810937025412575, 'eval_loss': 0.700154, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1189, 1206, 1345, 1081, 1142, 1105, 638, 625, 406, 725, 208, 509], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51678216, 'remaining_params': 33339384, 'pruned_model_sparsity': 0.6078531504065041, 'expected_sparsity': 0.60055, 'target_sparsity': 0.6, 'step': 7000}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.32it/s][A04/28/2024 21:52:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 7000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.59it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:06,  1.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:04,  2.32it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.48it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.68it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.76it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.08it/s][A04/28/2024 21:52:37 - INFO - trainer.trainer_mod_2 - Epoch 60 finished. Took 41.62 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  61%|██████    | 61/100 [43:05<27:22, 42.11s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.78it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.83it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.02it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.80it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.83it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.89it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.91it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.89it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.98it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.86it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.90it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 21:52:49,321 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:52:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:52:49 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:52:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:52:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:52:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:52:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9052631578947367, 'combined_score': 0.886455108359133, 'eval_loss': 0.6932707, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1189, 1206, 1346, 1082, 1141, 1105, 638, 622, 406, 719, 208, 505], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 4], 'pruned_params': 51676684, 'remaining_params': 33340916, 'pruned_model_sparsity': 0.6078351306082506, 'expected_sparsity': 0.60049, 'target_sparsity': 0.6, 'step': 7050}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.33it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:50,  1.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:42,  1.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:30,  2.45it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.69it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:26,  2.75it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.87it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.97it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.02it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  3.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.00it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.89it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.94it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.92it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.93it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.04it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.01it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.97it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 21:53:07,517 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:53:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:53:07 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:53:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:53:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:53:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:53:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9037800687285222, 'combined_score': 0.883262583383869, 'eval_loss': 0.71663016, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1190, 1206, 1348, 1083, 1141, 1106, 637, 620, 406, 715, 207, 502], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51670556, 'remaining_params': 33347044, 'pruned_model_sparsity': 0.6077630514152363, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 7100}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.35it/s][A04/28/2024 21:53:09 - INFO - trainer.trainer_mod_2 - v4 Global step: 7100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:12,  2.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.32it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.50it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.62it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.72it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.80it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.87it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.97it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.80it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.73it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.78it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.85it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.90it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.00it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/28/2024 21:53:19 - INFO - trainer.trainer_mod_2 - Epoch 61 finished. Took 41.73 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  62%|██████▏   | 62/100 [43:46<26:35, 41.99s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:34,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:33,  3.03it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.02it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.99it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 21:53:25,863 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:53:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:53:25 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:53:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:53:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:53:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:53:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9094076655052264, 'combined_score': 0.8909783425565347, 'eval_loss': 0.6817796, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1191, 1207, 1349, 1083, 1142, 1108, 637, 618, 407, 711, 207, 499], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51659832, 'remaining_params': 33357768, 'pruned_model_sparsity': 0.6076369128274616, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 7150}


Iteration:  17%|█▋        | 20/115 [00:08<01:12,  1.31it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.85it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:45,  2.01it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:41,  2.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:37,  2.40it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.69it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.75it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.82it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.81it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.99it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.02it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.07it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.05it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.10it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.06it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.04it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.87it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.01it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.02it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:53:44,096 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:53:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:53:44 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:53:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:53:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:53:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:53:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.904109589041096, 'combined_score': 0.8834273435401558, 'eval_loss': 0.71374345, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1193, 1209, 1352, 1084, 1143, 1110, 637, 617, 408, 708, 207, 497], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51641448, 'remaining_params': 33376152, 'pruned_model_sparsity': 0.6074206752484191, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 7200}


Iteration:  61%|██████    | 70/115 [00:26<00:34,  1.32it/s][A04/28/2024 21:53:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 7200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.58it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.83it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.00it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.46it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.63it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:14,  2.69it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.77it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.85it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.87it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.97it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.99it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.84it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.95it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.96it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.89it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.97it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.84it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.88it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.99it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.23it/s][A04/28/2024 21:54:00 - INFO - trainer.trainer_mod_2 - Epoch 62 finished. Took 41.62 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  63%|██████▎   | 63/100 [44:28<25:49, 41.88s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 21:54:02,385 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:54:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:54:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:54:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:54:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:54:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:54:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9016949152542373, 'combined_score': 0.8797690262545697, 'eval_loss': 0.7499388, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1210, 1353, 1084, 1143, 1110, 636, 615, 408, 704, 207, 495], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51636852, 'remaining_params': 33380748, 'pruned_model_sparsity': 0.6073666158536586, 'expected_sparsity': 0.59932, 'target_sparsity': 0.6, 'step': 7250}


Iteration:   4%|▍         | 5/115 [00:03<01:30,  1.21it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:14,  1.46it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:02,  1.73it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  1.99it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.24it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.42it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.55it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:39,  2.63it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.72it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.75it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.82it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:36,  2.72it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:35,  2.74it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.81it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.90it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.89it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.93it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.99it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.02it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.00it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.02it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:26,  3.08it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.82it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.86it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.88it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.97it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:54:20,851 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:54:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:54:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:54:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:54:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:54:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:54:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9016949152542373, 'combined_score': 0.8797690262545697, 'eval_loss': 0.72716, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1193, 1210, 1354, 1083, 1143, 1110, 636, 611, 408, 698, 207, 490], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51638384, 'remaining_params': 33379216, 'pruned_model_sparsity': 0.607384635651912, 'expected_sparsity': 0.59924, 'target_sparsity': 0.6, 'step': 7300}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A04/28/2024 21:54:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 7300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.56it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.83it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.07it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.24it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.42it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:20,  2.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.67it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.77it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.86it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.87it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  3.04it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  3.02it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.95it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.03it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.02it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.02it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.78it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.91it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.03it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.03it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.96it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:54:39,135 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:54:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:54:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:54:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:54:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:54:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:54:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8993055555555555, 'combined_score': 0.8785743464052287, 'eval_loss': 0.6924036, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1191, 1209, 1353, 1080, 1141, 1108, 635, 604, 407, 689, 207, 485], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51656768, 'remaining_params': 33360832, 'pruned_model_sparsity': 0.6076008732309546, 'expected_sparsity': 0.59953, 'target_sparsity': 0.6, 'step': 7350}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.08it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.46it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.70it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.81it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.93it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.18it/s][A04/28/2024 21:54:43 - INFO - trainer.trainer_mod_2 - Epoch 63 finished. Took 43.02 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  64%|██████▍   | 64/100 [45:11<25:20, 42.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.93it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.02it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 21:54:57,299 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:54:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:54:57 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:54:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:54:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:54:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:54:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.6772024, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1189, 1206, 1349, 1076, 1138, 1105, 634, 597, 406, 678, 207, 478], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51687408, 'remaining_params': 33330192, 'pruned_model_sparsity': 0.6079612691960253, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 7400}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.32it/s][A04/28/2024 21:54:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 7400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:38,  1.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:33,  2.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:30,  2.32it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.44it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.58it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.74it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.03it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.98it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.00it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.01it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.99it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.87it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.95it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.03it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.87it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 21:55:15,428 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:55:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:55:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:55:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:55:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:55:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:55:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9078498293515359, 'combined_score': 0.8877484440875327, 'eval_loss': 0.688354, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1203, 1347, 1073, 1135, 1102, 633, 591, 405, 668, 207, 471], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51714984, 'remaining_params': 33302616, 'pruned_model_sparsity': 0.608285625564589, 'expected_sparsity': 0.60094, 'target_sparsity': 0.6, 'step': 7450}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.33it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:14,  1.60it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.80it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.03it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.23it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:08,  2.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.54it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.63it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:06,  2.73it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.75it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.81it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.78it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.89it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.93it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.03it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.01it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.23it/s][A04/28/2024 21:55:25 - INFO - trainer.trainer_mod_2 - Epoch 64 finished. Took 41.51 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  65%|██████▌   | 65/100 [45:53<24:30, 42.01s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.04it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.04it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:30,  3.04it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.04it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:55:33,714 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:55:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:55:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:55:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:55:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/28/2024 21:55:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:55:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9006849315068494, 'combined_score': 0.8792640343808756, 'eval_loss': 0.69804585, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1203, 1347, 1071, 1134, 1102, 632, 588, 405, 662, 206, 467], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51721112, 'remaining_params': 33296488, 'pruned_model_sparsity': 0.6083577047576031, 'expected_sparsity': 0.60112, 'target_sparsity': 0.6, 'step': 7500}


Iteration:  22%|██▏       | 25/115 [00:09<01:09,  1.30it/s][A04/28/2024 21:55:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 7500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:56,  1.58it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.85it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:43,  2.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:38,  2.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.42it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:34,  2.44it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.61it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:30,  2.73it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:29,  2.79it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.82it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.90it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.94it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.84it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.98it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.99it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.99it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.85it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.74it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:21,  2.80it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.86it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.87it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.88it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.88it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.87it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:55:52,214 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:55:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:55:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:55:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:55:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:55:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:55:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9068541300527241, 'combined_score': 0.8884760846342052, 'eval_loss': 0.66645604, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1205, 1350, 1073, 1136, 1104, 632, 587, 406, 659, 207, 465], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51701196, 'remaining_params': 33316404, 'pruned_model_sparsity': 0.6081234473803071, 'expected_sparsity': 0.60049, 'target_sparsity': 0.6, 'step': 7550}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.33it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.60it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.87it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.32it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:14,  2.50it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.64it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.67it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.78it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.83it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.93it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.95it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.97it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.92it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.98it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.02it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.17it/s][A04/28/2024 21:56:06 - INFO - trainer.trainer_mod_2 - Epoch 65 finished. Took 41.71 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  66%|██████▌   | 66/100 [46:34<23:45, 41.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.90it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.78it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.80it/s][A[INFO|trainer.py:570] 2024-04-28 21:56:10,441 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:56:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:56:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:56:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:56:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/28/2024 21:56:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:56:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9087779690189328, 'combined_score': 0.8894380041173096, 'eval_loss': 0.68651634, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1190, 1209, 1354, 1076, 1139, 1107, 632, 588, 409, 659, 208, 465], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50762080, 'remaining_params': 34255520, 'pruned_model_sparsity': 0.5970773110508882, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 7600}


Iteration:   9%|▊         | 10/115 [00:04<01:21,  1.28it/s][A04/28/2024 21:56:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 7600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:05,  1.58it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.27it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:40,  2.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:37,  2.63it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:35,  2.77it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.84it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.93it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.98it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.84it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.03it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.08it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.81it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 21:56:28,682 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:56:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:56:28 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:56:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:56:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 21:56:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:56:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9100346020761245, 'combined_score': 0.8912918108419838, 'eval_loss': 0.6686675, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1193, 1212, 1358, 1077, 1142, 1110, 632, 588, 410, 657, 207, 463], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50736036, 'remaining_params': 34281564, 'pruned_model_sparsity': 0.5967709744805781, 'expected_sparsity': 0.59881, 'target_sparsity': 0.6, 'step': 7650}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:34,  1.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:29,  1.81it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.04it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.23it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.41it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:20,  2.44it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.59it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:17,  2.71it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.79it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  2.95it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.97it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.03it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.05it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.91it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.97it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:56:47,074 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:56:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:56:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:56:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:56:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.79it/s]04/28/2024 21:56:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:56:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9106529209621993, 'combined_score': 0.8916009702850212, 'eval_loss': 0.6799601, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1193, 1211, 1358, 1076, 1141, 1109, 631, 583, 409, 650, 207, 459], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50751356, 'remaining_params': 34266244, 'pruned_model_sparsity': 0.5969511724631135, 'expected_sparsity': 0.59887, 'target_sparsity': 0.6, 'step': 7700}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.32it/s][A04/28/2024 21:56:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 7700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.29it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.63it/s][A04/28/2024 21:56:50 - INFO - trainer.trainer_mod_2 - Epoch 66 finished. Took 43.1 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  67%|██████▋   | 67/100 [47:17<23:15, 42.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.05it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.02it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.77it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.81it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.02it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:30,  2.83it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.99it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.97it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:57:05,339 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:57:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:57:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:57:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:57:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 21:57:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:57:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.901360544217687, 'combined_score': 0.8796018407362944, 'eval_loss': 0.7158558, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1189, 1208, 1355, 1073, 1137, 1106, 630, 575, 407, 639, 206, 452], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50798848, 'remaining_params': 34218752, 'pruned_model_sparsity': 0.5975097862089732, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 7750}


Iteration:  39%|███▉      | 45/115 [00:16<00:53,  1.32it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:43,  1.58it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.85it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:29,  2.27it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.45it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:25,  2.47it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:24,  2.58it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.75it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.79it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.85it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.86it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.88it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:16,  2.85it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.85it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.85it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.96it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.05it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.02it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.00it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.02it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.99it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.99it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 21:57:23,683 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:57:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:57:23 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:57:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:57:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 21:57:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:57:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.7159105, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1185, 1205, 1352, 1069, 1134, 1103, 629, 567, 406, 626, 206, 444], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50843276, 'remaining_params': 34174324, 'pruned_model_sparsity': 0.5980323603583259, 'expected_sparsity': 0.60066, 'target_sparsity': 0.6, 'step': 7800}


Iteration:  83%|████████▎ | 95/115 [00:34<00:15,  1.33it/s][A04/28/2024 21:57:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 7800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.86it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.33it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.46it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.61it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.70it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.79it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.83it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.77it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.90it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.95it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.92it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.88it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.17it/s][A04/28/2024 21:57:31 - INFO - trainer.trainer_mod_2 - Epoch 67 finished. Took 41.68 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  68%|██████▊   | 68/100 [47:59<22:27, 42.10s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.81it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.85it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.81it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.05it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.86it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.88it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.01it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.99it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 21:57:41,960 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:57:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:57:41 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:57:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:57:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:57:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:57:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8976109215017065, 'combined_score': 0.8752760489861473, 'eval_loss': 0.7348259, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1183, 1202, 1350, 1067, 1131, 1102, 628, 561, 406, 616, 205, 438], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 51733368, 'remaining_params': 33284232, 'pruned_model_sparsity': 0.6085018631436314, 'expected_sparsity': 0.60125, 'target_sparsity': 0.6, 'step': 7850}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:53,  1.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:45,  1.81it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:35,  2.28it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:34,  2.34it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:31,  2.47it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.61it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.68it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:28,  2.67it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.74it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:27,  2.70it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.73it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.79it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.83it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.84it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.03it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.03it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.82it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.94it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.95it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 21:58:00,491 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:58:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:58:00 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:58:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:58:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 21:58:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:58:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9072164948453608, 'combined_score': 0.8874317768344451, 'eval_loss': 0.70351696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1184, 1203, 1351, 1067, 1131, 1102, 628, 559, 407, 610, 205, 435], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50870852, 'remaining_params': 34146748, 'pruned_model_sparsity': 0.5983567167268895, 'expected_sparsity': 0.60098, 'target_sparsity': 0.6, 'step': 7900}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.33it/s][A04/28/2024 21:58:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 7900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.71it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.79it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.83it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.91it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.88it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.14it/s][A04/28/2024 21:58:13 - INFO - trainer.trainer_mod_2 - Epoch 68 finished. Took 41.89 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  69%|██████▉   | 69/100 [48:41<21:43, 42.03s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.02it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 21:58:18,639 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:58:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:58:18 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:58:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:58:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 21:58:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:58:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9053356282271946, 'combined_score': 0.8852658533292836, 'eval_loss': 0.7120735, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1187, 1207, 1356, 1070, 1134, 1106, 628, 560, 409, 610, 206, 435], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50831020, 'remaining_params': 34186580, 'pruned_model_sparsity': 0.5978882019722975, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 7950}


Iteration:  13%|█▎        | 15/115 [00:06<01:14,  1.35it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:01,  1.60it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.08it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:41,  2.30it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.46it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.61it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.78it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.89it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.89it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:32,  2.78it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:32,  2.72it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.79it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.86it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.82it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.87it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.90it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.92it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.94it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.82it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.84it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.96it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.00it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.00it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.00it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 21:58:37,037 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:58:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:58:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:58:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:58:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 21:58:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:58:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8981001727115717, 'combined_score': 0.8767461647871584, 'eval_loss': 0.73322874, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1190, 1210, 1359, 1073, 1137, 1109, 628, 562, 411, 610, 207, 435], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50795784, 'remaining_params': 34221816, 'pruned_model_sparsity': 0.5974737466124661, 'expected_sparsity': 0.59905, 'target_sparsity': 0.6, 'step': 8000}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.33it/s][A04/28/2024 21:58:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 8000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:30,  1.60it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:25,  1.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.09it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.29it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.45it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.57it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:16,  2.59it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:15,  2.70it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.79it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.74it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.81it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.79it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.81it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.84it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.93it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.95it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.96it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.95it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.96it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.00it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.00it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.05it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.04it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.02it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.93it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 21:58:55,423 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:58:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:58:55 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:58:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:58:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 21:58:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:58:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.905982905982906, 'combined_score': 0.8855894922071392, 'eval_loss': 0.72692376, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1191, 1210, 1361, 1073, 1137, 1110, 627, 559, 411, 605, 206, 432], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50795784, 'remaining_params': 34221816, 'pruned_model_sparsity': 0.5974737466124661, 'expected_sparsity': 0.59881, 'target_sparsity': 0.6, 'step': 8050}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.36it/s][A04/28/2024 21:58:56 - INFO - trainer.trainer_mod_2 - Epoch 69 finished. Took 43.18 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  70%|███████   | 70/100 [49:24<21:11, 42.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.99it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.98it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.99it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.01it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.01it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.83it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.81it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.83it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.96it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.90it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.93it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.08it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.04it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  3.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 21:59:13,721 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:59:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:59:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:59:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:59:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 21:59:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:59:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903448275862069, 'combined_score': 0.8830966869506424, 'eval_loss': 0.7295101, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1207, 1358, 1069, 1135, 1108, 626, 552, 409, 595, 206, 425], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50838680, 'remaining_params': 34178920, 'pruned_model_sparsity': 0.5979783009635652, 'expected_sparsity': 0.59942, 'target_sparsity': 0.6, 'step': 8100}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.33it/s][A04/28/2024 21:59:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 8100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:40,  1.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:34,  1.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:25,  2.39it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.52it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.65it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.71it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.82it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.99it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.05it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.07it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:13,  2.80it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:13,  2.72it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.78it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.90it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:06,  2.82it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 21:59:32,194 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:59:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:59:32 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:59:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:59:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 21:59:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:59:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.71606463, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1182, 1203, 1354, 1065, 1131, 1103, 625, 543, 407, 581, 205, 417], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50895364, 'remaining_params': 34122236, 'pruned_model_sparsity': 0.5986450334989462, 'expected_sparsity': 0.60063, 'target_sparsity': 0.6, 'step': 8150}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.08it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.30it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.51it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.69it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.77it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.82it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.83it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.08it/s][A04/28/2024 21:59:38 - INFO - trainer.trainer_mod_2 - Epoch 70 finished. Took 41.74 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  71%|███████   | 71/100 [50:06<20:23, 42.19s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.06it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.91it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.05it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.85it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.89it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.89it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.92it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.06it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.95it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 21:59:50,384 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 21:59:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 21:59:50 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 21:59:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 21:59:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 21:59:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 21:59:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.71227026, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1178, 1200, 1352, 1061, 1128, 1101, 623, 536, 407, 570, 205, 411], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51129760, 'remaining_params': 33887840, 'pruned_model_sparsity': 0.6014020626317375, 'expected_sparsity': 0.60138, 'target_sparsity': 0.6, 'step': 8200}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.33it/s][A04/28/2024 21:59:51 - INFO - trainer.trainer_mod_2 - v4 Global step: 8200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.61it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:36,  2.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.29it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.46it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.72it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:26,  2.68it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.77it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.82it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.86it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.95it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.84it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.91it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.94it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.95it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.87it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.87it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.90it/s][A[INFO|trainer.py:570] 2024-04-28 22:00:08,818 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:00:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:00:08 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:00:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:00:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:00:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:00:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9050086355785838, 'combined_score': 0.8851023570049782, 'eval_loss': 0.72316235, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1179, 1201, 1354, 1062, 1129, 1102, 623, 534, 408, 566, 205, 408], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51120568, 'remaining_params': 33897032, 'pruned_model_sparsity': 0.6012939438422162, 'expected_sparsity': 0.60103, 'target_sparsity': 0.6, 'step': 8250}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.58it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.40it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.56it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.63it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.74it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.90it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.02it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.24it/s][A04/28/2024 22:00:20 - INFO - trainer.trainer_mod_2 - Epoch 71 finished. Took 41.75 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  72%|███████▏  | 72/100 [50:48<19:37, 42.06s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.73it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.85it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.96it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.83it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:36,  2.75it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.85it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:35,  2.75it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A[INFO|trainer.py:570] 2024-04-28 22:00:27,230 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:00:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:00:27 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:00:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:00:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:00:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:00:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9001751313485115, 'combined_score': 0.8802346244977852, 'eval_loss': 0.716723, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1184, 1206, 1360, 1066, 1132, 1107, 623, 539, 412, 567, 210, 409], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51056224, 'remaining_params': 33961376, 'pruned_model_sparsity': 0.6005371123155676, 'expected_sparsity': 0.59946, 'target_sparsity': 0.6, 'step': 8300}


Iteration:  17%|█▋        | 20/115 [00:08<01:12,  1.31it/s][A04/28/2024 22:00:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 8300, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<01:00,  1.56it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:51,  1.81it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:45,  2.01it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:40,  2.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:36,  2.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.69it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:31,  2.74it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.81it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.82it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.85it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.92it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.94it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.93it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.94it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.05it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.02it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.02it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.01it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.01it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.00it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 22:00:45,473 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:00:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:00:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:00:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:00:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:00:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:00:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9084628670120898, 'combined_score': 0.889280453113888, 'eval_loss': 0.7027003, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1188, 1210, 1365, 1069, 1136, 1111, 623, 541, 414, 567, 210, 409], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51013328, 'remaining_params': 34004272, 'pruned_model_sparsity': 0.6000325579644685, 'expected_sparsity': 0.59849, 'target_sparsity': 0.6, 'step': 8350}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.35it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.62it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:22,  1.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.12it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.25it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:14,  2.70it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.83it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.84it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.93it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.82it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.00it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.05it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.02it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.06it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.01it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.27it/s][A04/28/2024 22:01:01 - INFO - trainer.trainer_mod_2 - Epoch 72 finished. Took 41.65 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  73%|███████▎  | 73/100 [51:29<18:52, 41.94s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 22:01:03,671 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:01:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:01:03 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:01:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:01:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:01:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:01:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.6778153, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1208, 1363, 1066, 1134, 1110, 622, 534, 411, 559, 206, 404], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51053160, 'remaining_params': 33964440, 'pruned_model_sparsity': 0.6005010727190605, 'expected_sparsity': 0.59897, 'target_sparsity': 0.6, 'step': 8400}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A04/28/2024 22:01:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 8400, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.78it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.04it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.25it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.42it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.66it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.85it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.83it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.88it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.85it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.95it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.96it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.81it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.83it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.85it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.88it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.02it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.01it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.89it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 22:01:22,140 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:01:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:01:22 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:01:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:01:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:01:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:01:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9059233449477352, 'combined_score': 0.8867852018856324, 'eval_loss': 0.68820655, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1181, 1203, 1358, 1061, 1129, 1104, 620, 523, 409, 544, 205, 396], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51122100, 'remaining_params': 33895500, 'pruned_model_sparsity': 0.6013119636404698, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 8450}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.85it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.09it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:25,  2.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.41it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.56it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.65it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.68it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.76it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.82it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:17,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  3.00it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  3.05it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.96it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.85it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.88it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.91it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.91it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.95it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.96it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.04it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.02it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 22:01:40,497 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:01:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:01:40 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:01:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:01:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:01:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:01:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9072164948453608, 'combined_score': 0.8874317768344451, 'eval_loss': 0.7156143, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1175, 1197, 1351, 1055, 1123, 1099, 617, 512, 407, 527, 205, 386], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51197168, 'remaining_params': 33820432, 'pruned_model_sparsity': 0.6021949337548931, 'expected_sparsity': 0.60068, 'target_sparsity': 0.6, 'step': 8500}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.32it/s][A04/28/2024 22:01:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 8500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.44it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.66it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.72it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.71it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.99it/s][A04/28/2024 22:01:45 - INFO - trainer.trainer_mod_2 - Epoch 73 finished. Took 43.25 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  74%|███████▍  | 74/100 [52:13<18:20, 42.33s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.22it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.87it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.91it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.98it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.01it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.96it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.98it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.04it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.09it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.05it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.95it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.81it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 22:01:58,790 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:01:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:01:58 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:01:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:01:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:02:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:02:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9078498293515359, 'combined_score': 0.8877484440875327, 'eval_loss': 0.7318632, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1171, 1193, 1347, 1050, 1119, 1096, 615, 504, 407, 515, 205, 379], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51246192, 'remaining_params': 33771408, 'pruned_model_sparsity': 0.6027715672990063, 'expected_sparsity': 0.60122, 'target_sparsity': 0.6, 'step': 8550}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.83it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.07it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:31,  2.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.50it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.62it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.69it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.75it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.78it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.87it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.79it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.81it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.85it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.87it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.81it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.81it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.79it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.83it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.89it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.94it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.95it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.99it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.03it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.95it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  3.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 22:02:17,223 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:02:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:02:17 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:02:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:02:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.58it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 22:02:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:02:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.6949477, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1171, 1193, 1347, 1049, 1120, 1097, 614, 502, 407, 509, 205, 375], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51247724, 'remaining_params': 33769876, 'pruned_model_sparsity': 0.6027895870972598, 'expected_sparsity': 0.60101, 'target_sparsity': 0.6, 'step': 8600}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.33it/s][A04/28/2024 22:02:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 8600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.59it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.84it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.06it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.49it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.62it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.67it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.74it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.82it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.82it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.86it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.89it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.95it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.15it/s][A04/28/2024 22:02:27 - INFO - trainer.trainer_mod_2 - Epoch 74 finished. Took 41.79 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  75%|███████▌  | 75/100 [52:54<17:34, 42.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.03it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.01it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.00it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.06it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.87it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.02it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.84it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 22:02:35,477 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:02:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:02:35 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:02:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:02:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:02:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:02:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.7122007, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1174, 1199, 1353, 1053, 1124, 1101, 614, 505, 411, 509, 208, 375], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51191040, 'remaining_params': 33826560, 'pruned_model_sparsity': 0.602122854561879, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 8650}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.83it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:42,  2.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.45it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.70it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.79it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.90it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.89it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.92it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.99it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.05it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.89it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.01it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.99it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.07it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.05it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.88it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.86it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.76it/s][A[INFO|trainer.py:570] 2024-04-28 22:02:53,777 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:02:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:02:53 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:02:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:02:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:02:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:02:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9075043630017452, 'combined_score': 0.8888012011087157, 'eval_loss': 0.69479716, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1178, 1204, 1359, 1057, 1128, 1105, 615, 509, 415, 510, 211, 376], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51132824, 'remaining_params': 33884776, 'pruned_model_sparsity': 0.6014381022282445, 'expected_sparsity': 0.59899, 'target_sparsity': 0.6, 'step': 8700}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.30it/s][A04/28/2024 22:02:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 8700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.56it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.81it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:14,  2.41it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.64it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.73it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.81it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.80it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.85it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.95it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.89it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.97it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.79it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.74it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.77it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.84it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.89it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.86it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.86it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.89it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.04it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.26it/s][A04/28/2024 22:03:08 - INFO - trainer.trainer_mod_2 - Epoch 75 finished. Took 41.75 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  76%|███████▌  | 76/100 [53:36<16:49, 42.04s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.24it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.83it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 22:03:12,159 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:03:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:03:12 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:03:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:03:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:03:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:03:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8982456140350877, 'combined_score': 0.8780443756449948, 'eval_loss': 0.69812185, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1179, 1204, 1360, 1057, 1129, 1105, 614, 507, 414, 506, 206, 373], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51140484, 'remaining_params': 33877116, 'pruned_model_sparsity': 0.6015282012195122, 'expected_sparsity': 0.59912, 'target_sparsity': 0.6, 'step': 8750}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.30it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.57it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.28it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.42it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.72it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.75it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:35,  2.67it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.68it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.74it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.80it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:33,  2.71it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:32,  2.77it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.00it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.00it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.00it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.83it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.90it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.92it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.92it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.87it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.91it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.76it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.81it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 22:03:30,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:03:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:03:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:03:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:03:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:03:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:03:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.902439024390244, 'combined_score': 0.8825920612147299, 'eval_loss': 0.69207674, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1175, 1201, 1357, 1053, 1125, 1102, 612, 500, 411, 495, 205, 367], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51189508, 'remaining_params': 33828092, 'pruned_model_sparsity': 0.6021048347636254, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 8800}


Iteration:  52%|█████▏    | 60/115 [00:23<00:42,  1.31it/s][A04/28/2024 22:03:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 8800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:34,  1.57it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:29,  1.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.07it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.27it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:20,  2.48it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:18,  2.66it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.74it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:16,  2.86it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.04it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.01it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.96it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.95it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.06it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.99it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.99it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.85it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.97it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.88it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.97it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.91it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:03:48,913 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:03:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:03:48 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:03:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:03:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:03:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:03:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.71425396, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1171, 1196, 1353, 1048, 1120, 1099, 610, 493, 409, 483, 205, 360], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51243128, 'remaining_params': 33774472, 'pruned_model_sparsity': 0.6027355277024993, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 8850}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.33it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.11it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.31it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.62it/s][A04/28/2024 22:03:51 - INFO - trainer.trainer_mod_2 - Epoch 76 finished. Took 43.13 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  77%|███████▋  | 77/100 [54:19<16:14, 42.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:42,  2.67it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.98it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.96it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:35,  3.03it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.01it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.82it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.91it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.03it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.03it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.03it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.00it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.00it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 22:04:07,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:04:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:04:07 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:04:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:04:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:04:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:04:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9015544041450777, 'combined_score': 0.8809242608960683, 'eval_loss': 0.71965593, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1167, 1194, 1351, 1044, 1117, 1095, 607, 488, 408, 472, 204, 354], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51282960, 'remaining_params': 33734640, 'pruned_model_sparsity': 0.6032040424570912, 'expected_sparsity': 0.6007, 'target_sparsity': 0.6, 'step': 8900}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.33it/s][A04/28/2024 22:04:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 8900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:16<00:43,  1.60it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:37,  1.83it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:28,  2.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.62it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:23,  2.73it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.80it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.85it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:21,  2.85it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.86it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.87it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:19,  2.74it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.81it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.82it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.80it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.88it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.90it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.98it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.95it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:10,  2.76it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:09,  2.86it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:09,  2.77it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.83it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:08,  2.83it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.85it/s][A[INFO|trainer.py:570] 2024-04-28 22:04:25,667 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:04:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:04:25 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:04:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:04:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:04:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:04:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.902229845626072, 'combined_score': 0.8812619816365654, 'eval_loss': 0.74840456, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1167, 1193, 1351, 1043, 1116, 1095, 606, 486, 409, 465, 204, 351], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51289088, 'remaining_params': 33728512, 'pruned_model_sparsity': 0.6032761216501054, 'expected_sparsity': 0.6007, 'target_sparsity': 0.6, 'step': 8950}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.31it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.56it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.82it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  1.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.38it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.52it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.64it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.78it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.89it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.00it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.88it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.10it/s][A04/28/2024 22:04:33 - INFO - trainer.trainer_mod_2 - Epoch 77 finished. Took 41.88 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  78%|███████▊  | 78/100 [55:01<15:28, 42.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.80it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.87it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.91it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.96it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:32,  2.79it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.86it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 22:04:44,066 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:04:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:04:44 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:04:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:04:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:04:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:04:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.904109589041096, 'combined_score': 0.8834273435401558, 'eval_loss': 0.7258428, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1169, 1195, 1354, 1045, 1118, 1098, 605, 487, 410, 464, 205, 349], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51263044, 'remaining_params': 33754556, 'pruned_model_sparsity': 0.6029697850797953, 'expected_sparsity': 0.60035, 'target_sparsity': 0.6, 'step': 9000}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A04/28/2024 22:04:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 9000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.86it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:34,  2.32it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.48it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.60it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.70it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.74it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.82it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.86it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.92it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.81it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.88it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.78it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:23,  2.75it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.81it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.82it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.87it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.90it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 22:05:02,495 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:05:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:05:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:05:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:05:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:05:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:05:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.7177256, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1174, 1200, 1359, 1049, 1121, 1102, 606, 492, 414, 466, 208, 350], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51204828, 'remaining_params': 33812772, 'pruned_model_sparsity': 0.6022850327461607, 'expected_sparsity': 0.59949, 'target_sparsity': 0.6, 'step': 9050}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.32it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.07it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.40it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.54it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.64it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.72it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.77it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.88it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.90it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.91it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.79it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.79it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.95it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.15it/s][A04/28/2024 22:05:15 - INFO - trainer.trainer_mod_2 - Epoch 78 finished. Took 41.98 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  79%|███████▉  | 79/100 [55:43<14:45, 42.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.86it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.80it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.84it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.89it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.78it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.78it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.85it/s][A[INFO|trainer.py:570] 2024-04-28 22:05:20,964 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:05:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:05:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:05:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:05:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:05:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:05:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9001751313485115, 'combined_score': 0.8802346244977852, 'eval_loss': 0.7178728, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1176, 1202, 1362, 1051, 1124, 1105, 606, 493, 415, 465, 206, 349], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51181848, 'remaining_params': 33835752, 'pruned_model_sparsity': 0.6020147357723578, 'expected_sparsity': 0.5992, 'target_sparsity': 0.6, 'step': 9100}


Iteration:  13%|█▎        | 15/115 [00:06<01:16,  1.31it/s][A04/28/2024 22:05:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 9100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:03,  1.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:41,  2.31it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:38,  2.45it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:36,  2.55it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.63it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:33,  2.73it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:32,  2.81it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.80it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.98it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.97it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.86it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.99it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.00it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.99it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 22:05:39,384 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:05:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:05:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:05:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:05:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:05:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:05:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9008695652173914, 'combined_score': 0.8805818414322251, 'eval_loss': 0.73094004, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1174, 1201, 1361, 1049, 1122, 1104, 605, 488, 413, 459, 205, 345], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51207892, 'remaining_params': 33809708, 'pruned_model_sparsity': 0.6023210723426679, 'expected_sparsity': 0.59952, 'target_sparsity': 0.6, 'step': 9150}


Iteration:  57%|█████▋    | 65/115 [00:25<00:37,  1.32it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.83it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:22,  2.08it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.29it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:17,  2.58it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.69it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.78it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.84it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.91it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.95it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.90it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.95it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.96it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.02it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  3.07it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.93it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.02it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.83it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.72it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.79it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.83it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.85it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.00it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 22:05:57,658 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:05:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:05:57 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:05:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:05:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:05:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:05:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8986013986013986, 'combined_score': 0.8782222679281503, 'eval_loss': 0.6987929, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1170, 1198, 1358, 1045, 1118, 1100, 602, 482, 411, 448, 205, 339], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51253852, 'remaining_params': 33763748, 'pruned_model_sparsity': 0.602861666290274, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 9200}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.37it/s][A04/28/2024 22:05:59 - INFO - trainer.trainer_mod_2 - Epoch 79 finished. Took 43.29 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  80%|████████  | 80/100 [56:26<14:09, 42.49s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 22:05:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 9200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.98it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.99it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.84it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.95it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.95it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.80it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 22:06:16,103 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:06:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:06:16 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:06:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:06:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.61it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.61it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.80it/s]04/28/2024 22:06:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:06:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8959435626102292, 'combined_score': 0.8756678597364871, 'eval_loss': 0.7087887, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1166, 1194, 1354, 1040, 1115, 1097, 600, 478, 410, 438, 205, 333], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51296748, 'remaining_params': 33720852, 'pruned_model_sparsity': 0.6033662206413731, 'expected_sparsity': 0.60057, 'target_sparsity': 0.6, 'step': 9250}


Iteration:  43%|████▎     | 50/115 [00:18<00:49,  1.32it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:41,  1.54it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:35,  1.78it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:30,  2.06it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:24,  2.43it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:22,  2.63it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.74it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.80it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.82it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.80it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.81it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.82it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.87it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.83it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  3.02it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.98it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.94it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.81it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.90it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.99it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 22:06:34,710 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:06:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:06:34 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:06:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:06:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:06:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:06:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8989547038327526, 'combined_score': 0.8783989205438272, 'eval_loss': 0.7143431, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1165, 1193, 1353, 1038, 1113, 1096, 598, 475, 410, 431, 205, 330], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51313600, 'remaining_params': 33704000, 'pruned_model_sparsity': 0.603564438422162, 'expected_sparsity': 0.60075, 'target_sparsity': 0.6, 'step': 9300}


Iteration:  87%|████████▋ | 100/115 [00:37<00:11,  1.32it/s][A04/28/2024 22:06:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 9300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.85it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:05,  2.11it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.31it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.48it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.69it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.82it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.88it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.95it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.01it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.24it/s][A04/28/2024 22:06:41 - INFO - trainer.trainer_mod_2 - Epoch 80 finished. Took 41.96 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  81%|████████  | 81/100 [57:08<13:24, 42.33s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.01it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.10it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.91it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.91it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.88it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.84it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.95it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 22:06:52,895 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:06:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:06:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:06:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:06:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:06:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:06:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.70225203, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1167, 1195, 1356, 1040, 1115, 1098, 598, 477, 411, 430, 205, 329], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51289088, 'remaining_params': 33728512, 'pruned_model_sparsity': 0.6032761216501054, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 9350}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.32it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.45it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.53it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.64it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:26,  2.76it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.82it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.85it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.80it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.93it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.78it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.84it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.79it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.84it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.94it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 22:07:11,300 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:07:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:07:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:07:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:07:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:07:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:07:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9036777583187391, 'combined_score': 0.8844369183750558, 'eval_loss': 0.7022852, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1172, 1200, 1362, 1045, 1120, 1103, 598, 484, 416, 432, 213, 331], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51210956, 'remaining_params': 33806644, 'pruned_model_sparsity': 0.602357111939175, 'expected_sparsity': 0.59928, 'target_sparsity': 0.6, 'step': 9400}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.32it/s][A04/28/2024 22:07:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 9400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:32<00:18,  1.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.80it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:11,  2.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.60it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.72it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.77it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.80it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.86it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.12it/s][A04/28/2024 22:07:22 - INFO - trainer.trainer_mod_2 - Epoch 81 finished. Took 41.82 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  82%|████████▏ | 82/100 [57:50<12:39, 42.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.04it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.02it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.75it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.77it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.81it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 22:07:29,663 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:07:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:07:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:07:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:07:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:07:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:07:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9012131715771231, 'combined_score': 0.8807536446120909, 'eval_loss': 0.68495524, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1174, 1202, 1366, 1047, 1122, 1106, 598, 484, 416, 431, 207, 329], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51197168, 'remaining_params': 33820432, 'pruned_model_sparsity': 0.6021949337548931, 'expected_sparsity': 0.59924, 'target_sparsity': 0.6, 'step': 9450}


Iteration:  17%|█▋        | 20/115 [00:08<01:11,  1.33it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:58,  1.60it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.84it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.08it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.48it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.68it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.76it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.82it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.77it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.82it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.77it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.81it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.87it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.77it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.83it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.84it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.82it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.87it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  3.00it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.00it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 22:07:48,200 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:07:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:07:48 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:07:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:07:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:07:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:07:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8977469670710572, 'combined_score': 0.8765695619669012, 'eval_loss': 0.71941435, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1170, 1199, 1363, 1044, 1119, 1103, 596, 478, 412, 424, 205, 324], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51244660, 'remaining_params': 33772940, 'pruned_model_sparsity': 0.6027535475007528, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 9500}


Iteration:  61%|██████    | 70/115 [00:26<00:34,  1.32it/s][A04/28/2024 22:07:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 9500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:27<00:27,  1.57it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.85it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.12it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:18,  2.24it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.54it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.65it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.73it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.80it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.85it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.83it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.88it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.95it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  3.02it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.99it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.96it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.87it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.85it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.79it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:00,  3.01it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.81it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.85it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.16it/s][A04/28/2024 22:08:04 - INFO - trainer.trainer_mod_2 - Epoch 82 finished. Took 42.04 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.74it/s]
Epoch:  83%|████████▎ | 83/100 [58:32<11:56, 42.14s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:46,  2.45it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.83it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.91it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 22:08:06,599 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:08:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:08:06 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:08:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:08:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:08:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:08:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.904109589041096, 'combined_score': 0.8834273435401558, 'eval_loss': 0.72482455, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1166, 1196, 1360, 1040, 1115, 1099, 593, 473, 411, 414, 205, 318], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51287556, 'remaining_params': 33730044, 'pruned_model_sparsity': 0.6032581018518518, 'expected_sparsity': 0.60031, 'target_sparsity': 0.6, 'step': 9550}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.78it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.03it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:46,  2.28it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:42,  2.47it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:39,  2.61it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.71it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:36,  2.78it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.84it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.89it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  2.96it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.83it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.94it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.93it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.99it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.03it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.85it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.80it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.81it/s][A[INFO|trainer.py:570] 2024-04-28 22:08:24,995 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:08:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:08:25 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:08:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:08:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:08:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:08:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9037800687285222, 'combined_score': 0.883262583383869, 'eval_loss': 0.7170144, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1164, 1193, 1357, 1037, 1112, 1097, 590, 469, 410, 406, 205, 313], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51319728, 'remaining_params': 33697872, 'pruned_model_sparsity': 0.6036365176151761, 'expected_sparsity': 0.60068, 'target_sparsity': 0.6, 'step': 9600}


Iteration:  48%|████▊     | 55/115 [00:21<00:46,  1.30it/s][A04/28/2024 22:08:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 9600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.56it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.83it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.25it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.39it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.66it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.74it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.94it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.91it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.96it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.95it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.84it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.92it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.00it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.80it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.83it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.91it/s][A[INFO|trainer.py:570] 2024-04-28 22:08:43,481 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:08:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:08:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:08:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:08:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:08:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:08:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.904109589041096, 'combined_score': 0.8834273435401558, 'eval_loss': 0.7220251, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1164, 1193, 1358, 1036, 1113, 1098, 589, 469, 410, 403, 205, 311], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51316664, 'remaining_params': 33700936, 'pruned_model_sparsity': 0.6036004780186691, 'expected_sparsity': 0.6006, 'target_sparsity': 0.6, 'step': 9650}


Iteration:  91%|█████████▏| 105/115 [00:40<00:07,  1.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:03,  2.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.26it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.54it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.64it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.66it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.73it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.00it/s][A04/28/2024 22:08:48 - INFO - trainer.trainer_mod_2 - Epoch 83 finished. Took 43.38 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:  84%|████████▍ | 84/100 [59:16<11:20, 42.51s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.84it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.82it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.81it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.82it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.84it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.94it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.80it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.85it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.02it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.00it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.04it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.04it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.02it/s][A[INFO|trainer.py:570] 2024-04-28 22:09:01,826 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:09:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:09:01 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:09:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:09:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:09:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:09:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.70748496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1169, 1198, 1362, 1040, 1117, 1103, 590, 475, 415, 404, 211, 312], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51249256, 'remaining_params': 33768344, 'pruned_model_sparsity': 0.6028076068955134, 'expected_sparsity': 0.59964, 'target_sparsity': 0.6, 'step': 9700}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.32it/s][A04/28/2024 22:09:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 9700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.84it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:35,  2.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:32,  2.20it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.36it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:27,  2.53it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.65it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.74it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.81it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:23,  2.72it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.77it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.81it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.86it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.89it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.91it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.00it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.06it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.83it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.93it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 22:09:20,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:09:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:09:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:09:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:09:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:09:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:09:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.7145882, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1172, 1202, 1367, 1044, 1120, 1107, 590, 478, 417, 405, 212, 312], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51204828, 'remaining_params': 33812772, 'pruned_model_sparsity': 0.6022850327461607, 'expected_sparsity': 0.59902, 'target_sparsity': 0.6, 'step': 9750}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.34it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.60it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.23it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.42it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.68it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.74it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.79it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.84it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.89it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.95it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.18it/s][A04/28/2024 22:09:30 - INFO - trainer.trainer_mod_2 - Epoch 84 finished. Took 41.84 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  85%|████████▌ | 85/100 [59:57<10:34, 42.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.82it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.89it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.90it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.94it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.02it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.99it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 22:09:38,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:09:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:09:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:09:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:09:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:09:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:09:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9053356282271946, 'combined_score': 0.8852658533292836, 'eval_loss': 0.7128131, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1170, 1199, 1365, 1040, 1117, 1104, 588, 471, 413, 399, 205, 308], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51258448, 'remaining_params': 33759152, 'pruned_model_sparsity': 0.6029157256850346, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 9800}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.32it/s][A04/28/2024 22:09:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 9800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:56,  1.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.85it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.45it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.68it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.78it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.83it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.84it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.90it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.77it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.93it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.90it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.86it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.89it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.96it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.80it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.82it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.87it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.83it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.92it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:09:57,043 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:09:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:09:57 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:09:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:09:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:09:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:09:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.902229845626072, 'combined_score': 0.8812619816365654, 'eval_loss': 0.7308443, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1166, 1195, 1362, 1036, 1114, 1100, 585, 466, 411, 390, 205, 302], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51302876, 'remaining_params': 33714724, 'pruned_model_sparsity': 0.6034382998343872, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 9850}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.33it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:25,  1.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:21,  1.79it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:18,  1.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:14,  2.39it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.54it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.63it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.72it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.80it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.83it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.84it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.87it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.85it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.74it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.79it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.96it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.02it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:00,  3.03it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.00it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.20it/s][A04/28/2024 22:10:12 - INFO - trainer.trainer_mod_2 - Epoch 85 finished. Took 41.96 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  86%|████████▌ | 86/100 [1:00:39<09:50, 42.20s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.16it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.04it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.09it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.05it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.02it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.07it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.86it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 22:10:15,404 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:10:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:10:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:10:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:10:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:10:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:10:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9003436426116839, 'combined_score': 0.8790933899332929, 'eval_loss': 0.7270427, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1164, 1193, 1360, 1033, 1112, 1099, 582, 464, 411, 384, 205, 298], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51324324, 'remaining_params': 33693276, 'pruned_model_sparsity': 0.6036905770099368, 'expected_sparsity': 0.60069, 'target_sparsity': 0.6, 'step': 9900}


Iteration:   9%|▊         | 10/115 [00:04<01:21,  1.30it/s][A04/28/2024 22:10:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 9900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.82it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.06it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.27it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.42it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.54it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.63it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.72it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.84it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.89it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.91it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.85it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.05it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.03it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 22:10:33,705 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:10:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:10:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:10:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:10:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:10:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:10:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.904109589041096, 'combined_score': 0.8834273435401558, 'eval_loss': 0.7328598, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1165, 1195, 1362, 1035, 1113, 1101, 581, 466, 413, 382, 205, 297], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51302876, 'remaining_params': 33714724, 'pruned_model_sparsity': 0.6034382998343872, 'expected_sparsity': 0.60037, 'target_sparsity': 0.6, 'step': 9950}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.08it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.26it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.65it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:17,  2.71it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.73it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.75it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.87it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.85it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.89it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.77it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.94it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.87it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.76it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.81it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.69it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.75it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.83it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.84it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.97it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.87it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 22:10:52,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:10:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:10:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:10:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:10:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:10:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:10:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.902439024390244, 'combined_score': 0.8825920612147299, 'eval_loss': 0.7050044, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1170, 1200, 1369, 1040, 1119, 1107, 582, 474, 419, 385, 217, 300], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51210956, 'remaining_params': 33806644, 'pruned_model_sparsity': 0.602357111939175, 'expected_sparsity': 0.59897, 'target_sparsity': 0.6, 'step': 10000}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.31it/s][A04/28/2024 22:10:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 10000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:42<00:02,  1.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.82it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.07it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.28it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.62it/s][A04/28/2024 22:10:55 - INFO - trainer.trainer_mod_2 - Epoch 86 finished. Took 43.29 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  87%|████████▋ | 87/100 [1:01:23<09:12, 42.53s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.91it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.02it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.01it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.99it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.99it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.90it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.92it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.95it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 22:11:10,545 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:11:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:11:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:11:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:11:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:11:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:11:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.70080745, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1170, 1200, 1369, 1040, 1119, 1108, 581, 471, 416, 381, 206, 296], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51235468, 'remaining_params': 33782132, 'pruned_model_sparsity': 0.6026454287112316, 'expected_sparsity': 0.59953, 'target_sparsity': 0.6, 'step': 10050}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.33it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:43,  1.59it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.85it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.09it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:28,  2.30it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:27,  2.37it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:25,  2.53it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:23,  2.66it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.80it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:22,  2.72it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:21,  2.81it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.89it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.84it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.86it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.86it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.76it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.83it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.84it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.80it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.86it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.88it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.87it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.90it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.84it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.91it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.91it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  3.03it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.03it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.03it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.03it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.03it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 22:11:29,092 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:11:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:11:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:11:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:11:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:11:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:11:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7082979, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1165, 1196, 1364, 1034, 1114, 1103, 578, 464, 412, 373, 205, 291], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51299812, 'remaining_params': 33717788, 'pruned_model_sparsity': 0.6034022602378801, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 10100}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.33it/s][A04/28/2024 22:11:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 10100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:10,  1.77it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  1.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.39it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.54it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.65it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.74it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.99it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.83it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/28/2024 22:11:37 - INFO - trainer.trainer_mod_2 - Epoch 87 finished. Took 41.91 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  88%|████████▊ | 88/100 [1:02:05<08:28, 42.34s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.82it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.85it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.01it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.88it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.81it/s][A[INFO|trainer.py:570] 2024-04-28 22:11:47,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:11:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:11:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:11:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:11:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:11:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:11:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.7123192, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1161, 1193, 1362, 1031, 1111, 1100, 574, 461, 411, 366, 205, 286], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51333516, 'remaining_params': 33684084, 'pruned_model_sparsity': 0.603798695799458, 'expected_sparsity': 0.60082, 'target_sparsity': 0.6, 'step': 10150}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.31it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:53,  1.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:46,  1.77it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:40,  2.04it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:35,  2.26it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.48it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.74it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.80it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.86it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.01it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.93it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.88it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.00it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.04it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.91it/s][A[INFO|trainer.py:570] 2024-04-28 22:12:05,862 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:12:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:12:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:12:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:12:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:12:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:12:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.70621777, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1164, 1195, 1365, 1033, 1113, 1102, 574, 464, 414, 365, 207, 286], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51299812, 'remaining_params': 33717788, 'pruned_model_sparsity': 0.6034022602378801, 'expected_sparsity': 0.60038, 'target_sparsity': 0.6, 'step': 10200}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.30it/s][A04/28/2024 22:12:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 10200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:18,  1.81it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.43it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.62it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.71it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.80it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.86it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.97it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.97it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.03it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.01it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.01it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.04it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.03it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.07it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.88it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.91it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.09it/s][A04/28/2024 22:12:18 - INFO - trainer.trainer_mod_2 - Epoch 88 finished. Took 41.74 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  89%|████████▉ | 89/100 [1:02:46<07:43, 42.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.89it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.80it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A[INFO|trainer.py:570] 2024-04-28 22:12:24,149 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:12:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:12:24 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:12:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:12:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:12:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:12:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.900523560209424, 'combined_score': 0.8804088389282414, 'eval_loss': 0.72036445, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1171, 1201, 1373, 1039, 1120, 1110, 577, 473, 423, 369, 226, 289], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51178784, 'remaining_params': 33838816, 'pruned_model_sparsity': 0.6019786961758506, 'expected_sparsity': 0.59851, 'target_sparsity': 0.6, 'step': 10250}


Iteration:  13%|█▎        | 15/115 [00:06<01:17,  1.30it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:03,  1.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.82it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.28it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.62it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:34,  2.68it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:33,  2.75it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.80it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:32,  2.76it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.85it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.99it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.88it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.98it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.90it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.76it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.79it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.83it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 22:12:42,538 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:12:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:12:42 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:12:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:12:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:12:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:12:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9040139616055847, 'combined_score': 0.8846050200184786, 'eval_loss': 0.70917773, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1168, 1200, 1371, 1036, 1118, 1107, 574, 466, 415, 362, 206, 284], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51253852, 'remaining_params': 33763748, 'pruned_model_sparsity': 0.602861666290274, 'expected_sparsity': 0.59983, 'target_sparsity': 0.6, 'step': 10300}


Iteration:  57%|█████▋    | 65/115 [00:24<00:38,  1.32it/s][A04/28/2024 22:12:44 - INFO - trainer.trainer_mod_2 - v4 Global step: 10300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.79it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:23,  2.03it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.28it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.40it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:18,  2.44it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.56it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.65it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:15,  2.73it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.76it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.82it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.86it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.88it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.90it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.94it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.98it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:00,  3.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 22:13:00,902 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:13:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:13:00 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:13:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:13:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:13:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:13:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.7183598, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1162, 1194, 1365, 1029, 1112, 1101, 569, 460, 412, 353, 205, 278], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51325856, 'remaining_params': 33691744, 'pruned_model_sparsity': 0.6037085968081903, 'expected_sparsity': 0.60075, 'target_sparsity': 0.6, 'step': 10350}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.39it/s][A04/28/2024 22:13:02 - INFO - trainer.trainer_mod_2 - Epoch 89 finished. Took 43.33 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:  90%|█████████ | 90/100 [1:03:30<07:05, 42.51s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.79it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.82it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.84it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.89it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.94it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.04it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.02it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:24,  2.87it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.89it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 22:13:19,334 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:13:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:13:19 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:13:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:13:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:13:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:13:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9040139616055847, 'combined_score': 0.8846050200184786, 'eval_loss': 0.7073173, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1161, 1192, 1364, 1027, 1110, 1099, 567, 458, 412, 348, 205, 274], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51344240, 'remaining_params': 33673360, 'pruned_model_sparsity': 0.6039248343872328, 'expected_sparsity': 0.60097, 'target_sparsity': 0.6, 'step': 10400}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.33it/s][A04/28/2024 22:13:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 10400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:33,  1.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.09it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.26it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:24,  2.49it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.72it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.79it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.84it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.88it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.95it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.81it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.78it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.83it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.83it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.84it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.89it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.94it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.05it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.07it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.03it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.03it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.06it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.04it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 22:13:37,674 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:13:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:13:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:13:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:13:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:13:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:13:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.70179945, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1167, 1199, 1370, 1033, 1116, 1106, 568, 467, 421, 351, 222, 278], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51232404, 'remaining_params': 33785196, 'pruned_model_sparsity': 0.6026093891147245, 'expected_sparsity': 0.59925, 'target_sparsity': 0.6, 'step': 10450}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.34it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.60it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.08it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.60it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.61it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.58it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.69it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.75it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.70it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.75it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.80it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.06it/s][A04/28/2024 22:13:44 - INFO - trainer.trainer_mod_2 - Epoch 90 finished. Took 41.93 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  91%|█████████ | 91/100 [1:04:12<06:21, 42.34s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.96it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.75it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.83it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.84it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.86it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.87it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.88it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.99it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:13:56,157 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:13:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:13:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:13:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:13:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:13:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:13:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.902439024390244, 'combined_score': 0.8825920612147299, 'eval_loss': 0.71136355, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1171, 1202, 1375, 1037, 1120, 1110, 569, 470, 423, 352, 223, 278], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51186444, 'remaining_params': 33831156, 'pruned_model_sparsity': 0.6020687951671183, 'expected_sparsity': 0.59861, 'target_sparsity': 0.6, 'step': 10500}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.33it/s][A04/28/2024 22:13:57 - INFO - trainer.trainer_mod_2 - v4 Global step: 10500, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:50,  1.57it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.07it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:30,  2.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.69it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:26,  2.71it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.78it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.84it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.05it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.86it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.86it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.04it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.01it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.83it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.88it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.04it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.97it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.04it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.07it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.04it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.08it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:14:14,433 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:14:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:14:14 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:14:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:14:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:14:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:14:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.7127104, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1162, 1193, 1366, 1028, 1111, 1102, 562, 458, 413, 340, 205, 269], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51328920, 'remaining_params': 33688680, 'pruned_model_sparsity': 0.6037446364046973, 'expected_sparsity': 0.60078, 'target_sparsity': 0.6, 'step': 10550}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.33it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.26it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.44it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.57it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.73it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.81it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.87it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.75it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.78it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.83it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.76it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.76it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.67it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.73it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.80it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.07it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.22it/s][A04/28/2024 22:14:26 - INFO - trainer.trainer_mod_2 - Epoch 91 finished. Took 41.82 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  92%|█████████▏| 92/100 [1:04:53<05:37, 42.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.81it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.88it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.88it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.90it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.86it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.76it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.91it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 22:14:32,917 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:14:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:14:32 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:14:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:14:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:14:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:14:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.70404375, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1159, 1189, 1363, 1024, 1107, 1098, 558, 454, 412, 334, 205, 265], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51370284, 'remaining_params': 33647316, 'pruned_model_sparsity': 0.6042311709575429, 'expected_sparsity': 0.60129, 'target_sparsity': 0.6, 'step': 10600}


Iteration:  17%|█▋        | 20/115 [00:08<01:11,  1.33it/s][A04/28/2024 22:14:34 - INFO - trainer.trainer_mod_2 - v4 Global step: 10600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.83it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.07it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.44it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.55it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.67it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.77it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.70it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.75it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:30,  2.80it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.78it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.85it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.88it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.91it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.90it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.90it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.93it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.02it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.87it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.79it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.88it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.89it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.03it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.02it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.98it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.97it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.98it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 22:14:51,327 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:14:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:14:51 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:14:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:14:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:14:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:14:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.7056645, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1165, 1195, 1369, 1030, 1112, 1104, 559, 462, 420, 337, 223, 268], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51264576, 'remaining_params': 33753024, 'pruned_model_sparsity': 0.6029878048780488, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 10650}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.60it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:17,  2.33it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.63it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.74it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.80it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.74it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.86it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.96it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.90it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.81it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.72it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.81it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.98it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.20it/s][A04/28/2024 22:15:07 - INFO - trainer.trainer_mod_2 - Epoch 92 finished. Took 41.86 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  93%|█████████▎| 93/100 [1:05:35<04:54, 42.09s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.86it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 22:15:09,661 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:15:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:15:09 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:15:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:15:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:15:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:15:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9078260869565218, 'combined_score': 0.888962063086104, 'eval_loss': 0.6958998, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1172, 1202, 1377, 1036, 1118, 1111, 561, 472, 430, 342, 246, 273], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51135888, 'remaining_params': 33881712, 'pruned_model_sparsity': 0.6014741418247516, 'expected_sparsity': 0.59749, 'target_sparsity': 0.6, 'step': 10700}


Iteration:   4%|▍         | 5/115 [00:03<01:33,  1.17it/s][A04/28/2024 22:15:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 10700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:14,  1.46it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:01,  1.74it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  2.01it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.24it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.43it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.65it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.81it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.87it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.02it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.93it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.92it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.87it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.76it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.94it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:24,  3.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.82it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.86it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.90it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A[INFO|trainer.py:570] 2024-04-28 22:15:28,085 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:15:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:15:28 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:15:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:15:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:15:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:15:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7029879, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1160, 1191, 1366, 1023, 1107, 1099, 553, 454, 412, 326, 206, 260], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51359560, 'remaining_params': 33658040, 'pruned_model_sparsity': 0.6041050323697681, 'expected_sparsity': 0.60118, 'target_sparsity': 0.6, 'step': 10750}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.84it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.24it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.43it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.57it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.68it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.76it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.82it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.75it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.95it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.85it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.04it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.97it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 22:15:46,481 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:15:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:15:46 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:15:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:15:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:15:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:15:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.7060506, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1155, 1186, 1361, 1017, 1101, 1095, 547, 450, 411, 318, 206, 255], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51414712, 'remaining_params': 33602888, 'pruned_model_sparsity': 0.6047537451068955, 'expected_sparsity': 0.60186, 'target_sparsity': 0.6, 'step': 10800}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.33it/s][A04/28/2024 22:15:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 10800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.82it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.06it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.27it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.35it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.60it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.69it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.77it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.02it/s][A04/28/2024 22:15:51 - INFO - trainer.trainer_mod_2 - Epoch 93 finished. Took 43.35 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:  94%|█████████▍| 94/100 [1:06:19<04:14, 42.46s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.06it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.00it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.89it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.08it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.80it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.87it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.88it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.07it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.04it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.02it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 22:16:04,789 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:16:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:16:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:16:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:16:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:16:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:16:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.906896551724138, 'combined_score': 0.8872718052738338, 'eval_loss': 0.70127726, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1163, 1194, 1369, 1025, 1109, 1104, 550, 462, 425, 324, 235, 261], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51255384, 'remaining_params': 33762216, 'pruned_model_sparsity': 0.6028796860885276, 'expected_sparsity': 0.59927, 'target_sparsity': 0.6, 'step': 10850}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.61it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:32,  2.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.40it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:27,  2.52it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.65it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.75it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.78it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.85it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.03it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.98it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.82it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.88it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:09,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 22:16:23,192 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:16:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:16:23 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:16:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:16:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:16:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:16:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9078260869565218, 'combined_score': 0.888962063086104, 'eval_loss': 0.69907725, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1172, 1203, 1378, 1033, 1117, 1112, 554, 475, 440, 331, 270, 268], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51080736, 'remaining_params': 33936864, 'pruned_model_sparsity': 0.6008254290876243, 'expected_sparsity': 0.59637, 'target_sparsity': 0.6, 'step': 10900}


Iteration:  78%|███████▊  | 90/115 [00:33<00:19,  1.31it/s][A04/28/2024 22:16:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 10900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.58it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.84it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.29it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:08,  2.47it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.66it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.76it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.78it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.69it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.74it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.81it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.81it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.78it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.89it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.89it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.92it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.93it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.16it/s][A04/28/2024 22:16:33 - INFO - trainer.trainer_mod_2 - Epoch 94 finished. Took 41.8 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  95%|█████████▌| 95/100 [1:07:00<03:31, 42.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:45,  2.51it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.79it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.87it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.85it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.89it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 22:16:41,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:16:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:16:41 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:16:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:16:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:16:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:16:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9078260869565218, 'combined_score': 0.888962063086104, 'eval_loss': 0.6963195, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1155, 1186, 1362, 1016, 1100, 1096, 542, 449, 411, 311, 206, 249], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51416244, 'remaining_params': 33601356, 'pruned_model_sparsity': 0.6047717649051491, 'expected_sparsity': 0.60187, 'target_sparsity': 0.6, 'step': 10950}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.34it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.60it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:42,  2.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.68it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.77it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.83it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.00it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.01it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.05it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.00it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.97it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.90it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.78it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.81it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.85it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.00it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.96it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 22:16:59,945 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:16:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:16:59 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:16:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:16:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:17:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:17:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9018932874354562, 'combined_score': 0.8810937025412575, 'eval_loss': 0.7107182, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1150, 1179, 1357, 1010, 1094, 1091, 535, 445, 411, 304, 205, 244], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.60259, 'target_sparsity': 0.6, 'step': 11000}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.33it/s][A04/28/2024 22:17:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 11000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:25,  1.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:21,  1.80it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:18,  2.03it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:14,  2.44it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.64it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.72it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.77it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:11,  2.70it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.78it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.90it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.95it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.02it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.07it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.04it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.02it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.80it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.81it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.86it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.07it/s][A04/28/2024 22:17:14 - INFO - trainer.trainer_mod_2 - Epoch 95 finished. Took 41.93 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  96%|█████████▌| 96/100 [1:07:42<02:48, 42.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 22:17:18,377 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:17:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:17:18 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:17:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:17:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:17:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:17:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9078260869565218, 'combined_score': 0.888962063086104, 'eval_loss': 0.69595957, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1159, 1189, 1367, 1019, 1104, 1101, 539, 461, 429, 312, 241, 253], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51279896, 'remaining_params': 33737704, 'pruned_model_sparsity': 0.6031680028605841, 'expected_sparsity': 0.59946, 'target_sparsity': 0.6, 'step': 11050}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.30it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.05it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.27it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:40,  2.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.70it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.83it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:34,  2.79it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.84it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.84it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:33,  2.79it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.84it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.88it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.06it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.89it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.89it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.90it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.78it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.84it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.85it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.91it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.02it/s][A[INFO|trainer.py:570] 2024-04-28 22:17:36,847 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:17:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:17:36 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:17:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:17:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:17:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:17:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.6932825, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1172, 1201, 1379, 1031, 1117, 1114, 546, 484, 458, 325, 313, 268], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50778932, 'remaining_params': 34238668, 'pruned_model_sparsity': 0.5972755288316772, 'expected_sparsity': 0.5943, 'target_sparsity': 0.6, 'step': 11100}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.33it/s][A04/28/2024 22:17:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 11100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.59it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:24,  2.08it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.68it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.82it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:13,  3.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.02it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.01it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.05it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.90it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.00it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.84it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.89it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.83it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.74it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.77it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.78it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.81it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.83it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.92it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 22:17:55,230 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:17:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:17:55 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:17:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:17:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:17:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:17:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9081455805892548, 'combined_score': 0.8891218099024705, 'eval_loss': 0.6957074, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1152, 1182, 1361, 1011, 1097, 1094, 530, 446, 411, 299, 205, 241], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51449948, 'remaining_params': 33567652, 'pruned_model_sparsity': 0.6051682004667269, 'expected_sparsity': 0.60227, 'target_sparsity': 0.6, 'step': 11150}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.33it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.07it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.26it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.58it/s][A04/28/2024 22:17:58 - INFO - trainer.trainer_mod_2 - Epoch 96 finished. Took 43.25 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  97%|█████████▋| 97/100 [1:08:26<02:07, 42.49s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.03it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.03it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.06it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.03it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.00it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.02it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.02it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.01it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.06it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.08it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.06it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.92it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.90it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.84it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.04it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.02it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.93it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:26,  2.81it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.91it/s][A[INFO|trainer.py:570] 2024-04-28 22:18:13,433 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:18:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:18:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:18:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:18:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:18:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:18:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.6956963, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1145, 1175, 1354, 1003, 1089, 1087, 521, 441, 410, 291, 205, 234], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51526548, 'remaining_params': 33491052, 'pruned_model_sparsity': 0.6060691903794038, 'expected_sparsity': 0.6032, 'target_sparsity': 0.6, 'step': 11200}


Iteration:  39%|███▉      | 45/115 [00:16<00:53,  1.32it/s][A04/28/2024 22:18:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 11200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:16<00:44,  1.54it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:37,  1.80it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.04it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:29,  2.24it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:27,  2.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:25,  2.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.65it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.78it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.82it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.85it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.76it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.82it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.88it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.05it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.04it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.04it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.00it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.01it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.99it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.89it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 22:18:31,849 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:18:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:18:31 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:18:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:18:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/28/2024 22:18:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:18:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9097222222222222, 'combined_score': 0.8911356209150327, 'eval_loss': 0.6941176, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1151, 1181, 1360, 1009, 1095, 1094, 523, 450, 420, 295, 223, 240], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51413180, 'remaining_params': 33604420, 'pruned_model_sparsity': 0.604735725308642, 'expected_sparsity': 0.60141, 'target_sparsity': 0.6, 'step': 11250}


Iteration:  83%|████████▎ | 95/115 [00:34<00:15,  1.32it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:08,  2.08it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.27it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.42it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.65it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.75it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.82it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.84it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.83it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.76it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.83it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.95it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.92it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.13it/s][A04/28/2024 22:18:40 - INFO - trainer.trainer_mod_2 - Epoch 97 finished. Took 41.77 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  98%|█████████▊| 98/100 [1:09:07<01:24, 42.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.96it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.88it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.82it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.79it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.82it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.81it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.85it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 22:18:50,286 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:18:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:18:50 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:18:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:18:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:18:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:18:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9081455805892548, 'combined_score': 0.8891218099024705, 'eval_loss': 0.6976952, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1171, 1200, 1379, 1027, 1114, 1114, 535, 486, 468, 319, 329, 267], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 6, 3], 'pruned_params': 50749824, 'remaining_params': 34267776, 'pruned_model_sparsity': 0.59693315266486, 'expected_sparsity': 0.59345, 'target_sparsity': 0.6, 'step': 11300}


Iteration:  26%|██▌       | 30/115 [00:11<01:03,  1.33it/s][A04/28/2024 22:18:51 - INFO - trainer.trainer_mod_2 - v4 Global step: 11300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:12<00:52,  1.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:35,  2.27it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.44it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:30,  2.54it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:29,  2.65it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:28,  2.69it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.76it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.83it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.83it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.87it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.89it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.89it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.76it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.88it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.96it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.95it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.04it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.85it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.95it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 22:19:08,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:19:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:19:08 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:19:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:19:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.62it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.81it/s]04/28/2024 22:19:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:19:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.6864808, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1158, 1188, 1368, 1014, 1101, 1101, 522, 455, 424, 291, 221, 239], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51341176, 'remaining_params': 33676424, 'pruned_model_sparsity': 0.6038887947907257, 'expected_sparsity': 0.60051, 'target_sparsity': 0.6, 'step': 11350}


Iteration:  70%|██████▉   | 80/115 [00:30<00:25,  1.35it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.61it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.65it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.72it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.80it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.83it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.87it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.81it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.90it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.92it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.95it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.01it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.00it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.95it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.12it/s][A04/28/2024 22:19:21 - INFO - trainer.trainer_mod_2 - Epoch 98 finished. Took 41.96 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  99%|█████████▉| 99/100 [1:09:49<00:42, 42.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.94it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.85it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.87it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.87it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.80it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.82it/s][A[INFO|trainer.py:570] 2024-04-28 22:19:27,191 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:19:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:19:27 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:19:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:19:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:19:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:19:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.70056856, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1144, 1174, 1355, 1000, 1087, 1087, 509, 440, 410, 281, 205, 228], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51537272, 'remaining_params': 33480328, 'pruned_model_sparsity': 0.6061953289671785, 'expected_sparsity': 0.60335, 'target_sparsity': 0.6, 'step': 11400}


Iteration:  13%|█▎        | 15/115 [00:06<01:17,  1.29it/s][A04/28/2024 22:19:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 11400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:03,  1.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.82it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:48,  2.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:43,  2.21it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:39,  2.40it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:38,  2.43it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:37,  2.51it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:35,  2.57it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:33,  2.68it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:33,  2.71it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.79it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.87it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.91it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.80it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:26,  2.81it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.85it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.89it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.89it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.96it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:20,  2.97it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  3.01it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.01it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.00it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  3.05it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.03it/s][A[INFO|trainer.py:570] 2024-04-28 22:19:45,687 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:19:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:19:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:19:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:19:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:19:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:19:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.68665147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1144, 1173, 1354, 999, 1087, 1086, 507, 440, 412, 279, 206, 227], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 2], 'pruned_params': 51538804, 'remaining_params': 33478796, 'pruned_model_sparsity': 0.6062133487654321, 'expected_sparsity': 0.60332, 'target_sparsity': 0.6, 'step': 11450}


Iteration:  57%|█████▋    | 65/115 [00:25<00:37,  1.34it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.83it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:22,  2.05it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.26it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.61it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.64it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.73it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.80it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.85it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.94it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.80it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.84it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.96it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.83it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.88it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.98it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.92it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:20:04,030 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:20:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:20:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:20:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:20:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.64it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:20:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:20:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903448275862069, 'combined_score': 0.8830966869506424, 'eval_loss': 0.7080289, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1160, 1188, 1370, 1015, 1102, 1104, 516, 466, 444, 300, 267, 248], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 9, 9, 5, 3], 'pruned_params': 51209424, 'remaining_params': 33808176, 'pruned_model_sparsity': 0.6023390921409214, 'expected_sparsity': 0.59799, 'target_sparsity': 0.6, 'step': 11500}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.37it/s][A04/28/2024 22:20:05 - INFO - trainer.trainer_mod_2 - Epoch 99 finished. Took 43.45 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch: 100%|██████████| 100/100 [1:10:33<00:00, 42.56s/it]Epoch: 100%|██████████| 100/100 [1:10:33<00:00, 42.33s/it]
[INFO|configuration_utils.py:439] 2024-04-28 22:20:05,424 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 22:20:07,454 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-28 22:20:07,456 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-28 22:20:07,480 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.6/special_tokens_map.json
04/28/2024 22:20:07 - INFO - __main__ - Training took 4245.08 seconds.
